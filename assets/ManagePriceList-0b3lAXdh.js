import{d as R,p as j,a as F,h as S,w as n,b as a,r as V,e as s,u as D,t as g,i as b,F as N,q as U,o as f,m as T,M as ee,l as J,V as te,v as se,x as oe,y as ae,s as E,z as G}from"./index-ChBN8f7M.js";import{u as K}from"./useToast-pLSG-zsw.js";import{u as ie}from"./payment-cards-CgiKwP1v.js";import{d as B}from"./pdfDownloader-Cg_wDO9M.js";import{f as ne}from"./format-Cn4G_mmc.js";import{u as q}from"./price-list-store-BB1m4lGl.js";import{u as re}from"./useForm-DvvDy_4m.js";import{h as W}from"./errorHandler-DijQ3xmc.js";import{v as le}from"./utils-BWc0LXoO.js";import{u as z}from"./quota-store-Cz5IOQ6B.js";import{u as H}from"./settings-store-CfSCLwjp.js";import{S as de}from"./SalesPackageForm-DY8tUGuB.js";import{E as ce}from"./jspdf.es.min-mVKIEOxC.js";import"./regulatrory-store-Bht79SxA.js";const ue=R({components:{},props:{priceListItem:{type:Object,required:!0},pdfData:{type:String,default:""}},data(){return{cardStore:ie(),format:ne}},computed:{loading(){return this.cardStore.loading},hasUpgradeFees(){return this.priceListItem.upgrade_fees&&this.priceListItem.upgrade_fees.length>0},speciesList(){var e;return this.priceListItem.species&&Array.isArray(this.priceListItem.species)?this.priceListItem.species:((e=this.priceListItem.sales_package)==null?void 0:e.species)||[]},companionHunterCosts(){return this.priceListItem.companion_hunter_costs&&Array.isArray(this.priceListItem.companion_hunter_costs)?this.priceListItem.companion_hunter_costs:this.priceListItem.componions_hunter||[]},observerHunterCosts(){return this.priceListItem.observer_hunter_costs&&Array.isArray(this.priceListItem.observer_hunter_costs)?this.priceListItem.observer_hunter_costs:this.priceListItem.observer||[]},currencySymbol(){var e,t,i;return((t=(e=this.priceListItem.price_list_type)==null?void 0:e.currency)==null?void 0:t.symbol)||((i=this.priceListItem.currency)==null?void 0:i.symbol)||"$"}},mounted(){this.cardStore.load()},methods:{formatDate(e){if(!e)return"N/A";try{return this.format(e,"MMM yyyy")}catch{return e}},getSpeciesName(e){var t;return e.name?e.name:((t=e.species)==null?void 0:t.name)||"Unknown"},getSpeciesScientificName(e){var t;return e.scientific_name?e.scientific_name:((t=e.species)==null?void 0:t.scientific_name)||""},formatChargesPer(e){return e?e.toLowerCase().replace("_"," "):""},formatAmount(e){if(e==null)return"N/A";const t=typeof e=="string"?parseFloat(e):e;return isNaN(t)?"N/A":t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},getSequenceLabel(e){const t=["th","st","nd","rd"],i=e%100,c=t[(i-20)%10]||t[i]||t[0];return`${e}${c}`},async downloadPriceListPdf(){var e,t;if(!this.pdfData){console.warn("No PDF data available");return}try{const c=`${(((t=(e=this.priceListItem)==null?void 0:e.sales_package)==null?void 0:t.name)||"price-list").replace(/\s+/g,"-")}-${Date.now()}.pdf`;await B(this.pdfData,c)}catch(i){console.error("Failed to download PDF:",i)}}}}),me={key:1,class:"price-list-details"},pe={class:"text-center"},ge={class:"va-h3 mb-2"},fe={class:"flex justify-center items-center gap-4 mb-3"},ye={class:"text-lg text-secondary"},he={class:"mt-4"},_e={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},be={class:"text-3xl font-bold"},ve={class:"text-3xl font-bold"},ke={class:"text-lg font-bold"},Ve={class:"text-lg font-bold"},Ie={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3"},Pe={class:"flex justify-between items-start"},Le={class:"flex-1"},Se={class:"font-semibold text-base"},Ae={class:"text-sm text-secondary italic"},Ce={key:0},we={class:"va-table-responsive"},$e={class:"va-table va-table--hoverable w-full"},Fe={class:"text-right"},Oe={class:"font-semibold"},De={class:"text-secondary italic"},Ne={class:"text-center"},xe={class:"text-right font-bold text-lg"},Te={class:"va-table-responsive"},Ee={class:"va-table va-table--hoverable w-full"},Ue={class:"font-semibold"},Me={class:"text-right font-bold text-lg"},qe={class:"text-secondary"},ze={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6"},He={class:"space-y-3"},Be={class:"flex justify-between items-start mb-2"},Re={class:"font-semibold text-base capitalize"},je={class:"text-sm text-secondary"},Qe={class:"text-right"},Ye={class:"font-bold text-lg"},Ge={class:"text-xs text-secondary"},Je={class:"space-y-4"},Ke={key:0},We={class:"flex justify-between items-center mb-2"},Xe={class:"font-bold text-xl"},Ze={class:"flex justify-between items-center"},et={class:"font-bold text-xl"},tt={class:"space-y-4"},st={key:0},ot={class:"flex justify-between items-center mb-2"},at={class:"font-bold text-xl"},it={class:"flex justify-between items-center"},nt={class:"font-bold text-xl"},rt={class:"flex items-center gap-2"},lt={class:"flex items-center gap-2"};function dt(e,t,i,c,k,$){const v=V("VaSkeleton"),d=V("VaSkeletonGroup"),u=V("VaIcon"),m=V("VaChip"),P=V("VaButton"),y=V("VaCardContent"),I=V("VaCard"),C=V("VaCardTitle"),A=V("VaBadge"),l=V("VaAlert");return e.cardStore.loading||!e.priceListItem||!e.priceListItem.sales_package?(f(),F(d,{key:0},{default:n(()=>[a(v,{class:"mb-4",height:"160px",variant:"squared"}),a(v,{class:"mb-4",height:"160px",variant:"squared"}),a(v,{height:"360px",variant:"squared"})]),_:1})):(f(),S("div",me,[a(I,{class:"mb-6",stripe:"","stripe-color":"primary"},{default:n(()=>[a(y,null,{default:n(()=>{var o,L,r,h,x,p;return[s("div",pe,[s("h1",ge,g((o=e.priceListItem.sales_package)==null?void 0:o.name),1),s("div",fe,[a(m,{color:"primary",size:"large"},{default:n(()=>{var _,O,w,M;return[a(u,{name:"calendar_month",class:"mr-1"}),b(" "+g(e.formatDate((O=(_=e.priceListItem.price_list_type)==null?void 0:_.price_list)==null?void 0:O.start_date))+" - "+g(e.formatDate((M=(w=e.priceListItem.price_list_type)==null?void 0:w.price_list)==null?void 0:M.end_date)),1)]}),_:1}),(L=e.priceListItem.price_list_type)!=null&&L.is_active?(f(),F(m,{key:0,color:"success",size:"large"},{default:n(()=>[a(u,{name:"check_circle",class:"mr-1"}),t[0]||(t[0]=b(" Active "))]),_:1})):(f(),F(m,{key:1,color:"danger",size:"large"},{default:n(()=>[a(u,{name:"cancel",class:"mr-1"}),t[1]||(t[1]=b(" Inactive "))]),_:1}))]),s("p",ye,[a(u,{name:"location_on",size:"small"}),b(" "+g((h=(r=e.priceListItem.sales_package)==null?void 0:r.area)==null?void 0:h.name)+" ("+g((p=(x=e.priceListItem.sales_package)==null?void 0:x.area)==null?void 0:p.description)+") ",1)]),s("div",he,[e.pdfData?(f(),F(P,{key:0,color:"primary",icon:"download",onClick:e.downloadPriceListPdf},{default:n(()=>t[2]||(t[2]=[b(" Download PDF ")])),_:1},8,["onClick"])):D("",!0)])])]}),_:1})]),_:1}),s("div",_e,[a(I,{stripe:"","stripe-color":"primary"},{default:n(()=>[a(y,{class:"text-center"},{default:n(()=>[a(u,{name:"attach_money",size:"large",color:"primary",class:"mb-2"}),s("div",be,g(e.priceListItem.price_list_type.currency.symbol)+g(e.formatAmount(e.priceListItem.price_list_type.amount)),1),t[3]||(t[3]=s("div",{class:"text-sm text-secondary mt-1"},"Base Amount",-1))]),_:1})]),_:1}),a(I,{stripe:"","stripe-color":"success"},{default:n(()=>[a(y,{class:"text-center"},{default:n(()=>[a(u,{name:"schedule",size:"large",color:"success",class:"mb-2"}),s("div",ve,g(e.priceListItem.price_list_type.duration),1),t[4]||(t[4]=s("div",{class:"text-sm text-secondary mt-1"},"Days Duration",-1))]),_:1})]),_:1}),a(I,{stripe:"","stripe-color":"warning"},{default:n(()=>[a(y,{class:"text-center"},{default:n(()=>{var o;return[a(u,{name:"verified",size:"large",color:"warning",class:"mb-2"}),s("div",ke,g((o=e.priceListItem.sales_package.regulatory_package)==null?void 0:o.name),1),t[5]||(t[5]=s("div",{class:"text-sm text-secondary mt-1"},"License Type",-1))]}),_:1})]),_:1}),a(I,{stripe:"","stripe-color":"info"},{default:n(()=>[a(y,{class:"text-center"},{default:n(()=>[a(u,{name:"category",size:"large",color:"info",class:"mb-2"}),s("div",Ve,g(e.priceListItem.price_list_type.hunting_type.name),1),t[6]||(t[6]=s("div",{class:"text-sm text-secondary mt-1"},"Hunting Type",-1))]),_:1})]),_:1})]),a(I,{class:"mb-6",stripe:"","stripe-color":"success"},{default:n(()=>[a(C,{class:"flex items-center gap-2"},{default:n(()=>[a(u,{name:"pets"}),b(" Available Species ("+g(e.speciesList.length)+") ",1)]),_:1}),a(y,null,{default:n(()=>[s("div",Ie,[(f(!0),S(N,null,U(e.speciesList,o=>(f(),F(I,{key:o.id,class:"species-card",color:o.quantity>0?"#f0f9ff":"#fef2f2"},{default:n(()=>[a(y,null,{default:n(()=>[s("div",Pe,[s("div",Le,[s("div",Se,g(e.getSpeciesName(o)),1),s("div",Ae,g(e.getSpeciesScientificName(o)),1)]),a(A,{color:o.quantity>0?"success":"danger",class:"ml-2"},{default:n(()=>[b(" Qty: "+g(o.quantity),1)]),_:2},1032,["color"])])]),_:2},1024)]),_:2},1032,["color"]))),128))])]),_:1})]),_:1}),a(I,{class:"mb-6",stripe:"","stripe-color":"warning"},{default:n(()=>[a(C,{class:"flex items-center gap-2"},{default:n(()=>[a(u,{name:"military_tech"}),b(" Trophy Fees ("+g(e.priceListItem.price_list_type.currency.name)+") ",1)]),_:1}),a(y,null,{default:n(()=>[e.priceListItem.trophy_fees&&e.priceListItem.trophy_fees.length>0?(f(),S("div",Ce,[s("div",we,[s("table",$e,[s("thead",null,[s("tr",null,[t[7]||(t[7]=s("th",{class:"text-left"},"Species",-1)),t[8]||(t[8]=s("th",{class:"text-left"},"Scientific Name",-1)),t[9]||(t[9]=s("th",{class:"text-center"},"Sequence",-1)),s("th",Fe,"Price ("+g(e.priceListItem.price_list_type.currency.symbol)+")",1)])]),s("tbody",null,[(f(!0),S(N,null,U(e.priceListItem.trophy_fees,o=>(f(),S("tr",{key:o.id},[s("td",Oe,g(o.species.name),1),s("td",De,g(o.species.scientific_name),1),s("td",Ne,[a(A,{text:e.getSequenceLabel(o.sequence_order),color:"primary"},null,8,["text"])]),s("td",xe,g(e.priceListItem.price_list_type.currency.symbol)+g(e.formatAmount(o.price_usd)),1)]))),128))])])])])):(f(),F(l,{key:1,color:"info",border:"top"},{default:n(()=>t[10]||(t[10]=[b(" No trophy fees available for this package ")])),_:1}))]),_:1})]),_:1}),e.priceListItem.upgrade_fees&&e.priceListItem.upgrade_fees.length>0?(f(),F(I,{key:0,class:"mb-6",stripe:"","stripe-color":"warning"},{default:n(()=>[a(C,{class:"flex items-center gap-2"},{default:n(()=>[a(u,{name:"upgrade"}),t[11]||(t[11]=b(" Upgrade Fees "))]),_:1}),a(y,null,{default:n(()=>[s("div",Te,[s("table",Ee,[t[12]||(t[12]=s("thead",null,[s("tr",null,[s("th",{class:"text-left"},"Species"),s("th",{class:"text-right"},"Amount"),s("th",{class:"text-left"},"Description")])],-1)),s("tbody",null,[(f(!0),S(N,null,U(e.priceListItem.upgrade_fees,o=>(f(),S("tr",{key:o.id},[s("td",Ue,g(o.species_name),1),s("td",Me,g(o.currency_symbol)+g(e.formatAmount(o.amount)),1),s("td",qe,g(o.description),1)]))),128))])])])]),_:1})]),_:1})):D("",!0),s("div",ze,[a(I,{stripe:"","stripe-color":"info"},{default:n(()=>[a(C,{class:"flex items-center gap-2"},{default:n(()=>[a(u,{name:"add_circle"}),t[13]||(t[13]=b(" Safari Extras "))]),_:1}),a(y,null,{default:n(()=>[s("div",He,[(f(!0),S(N,null,U(e.priceListItem.safari_extras,o=>(f(),S("div",{key:o.id,class:"p-4 rounded-lg bg-gray-50"},[s("div",Be,[s("div",null,[s("div",Re,g(o.name),1),s("div",je,g(o.description),1)]),s("div",Qe,[s("div",Ye,g(o.currency.symbol)+g(o.amount),1),s("div",Ge,g(e.formatChargesPer(o.charges_per)),1)])])]))),128)),!e.priceListItem.safari_extras||e.priceListItem.safari_extras.length===0?(f(),F(l,{key:0,color:"info",border:"top"},{default:n(()=>t[14]||(t[14]=[b(" No safari extras available ")])),_:1})):D("",!0)])]),_:1})]),_:1}),a(I,{stripe:"","stripe-color":"success"},{default:n(()=>[a(C,{class:"flex items-center gap-2"},{default:n(()=>[a(u,{name:"groups"}),t[15]||(t[15]=b(" Companion Hunter Costs "))]),_:1}),a(y,null,{default:n(()=>[s("div",Je,[e.companionHunterCosts&&e.companionHunterCosts.length>0?(f(),S("div",Ke,[t[18]||(t[18]=s("div",{class:"text-sm font-semibold text-secondary mb-2"},"Companion Hunter",-1)),(f(!0),S(N,null,U(e.companionHunterCosts,o=>(f(),S("div",{key:o.id,class:"p-4 rounded-lg bg-green-50 mb-2"},[s("div",We,[t[16]||(t[16]=s("span",{class:"text-base"},"Days",-1)),s("span",Xe,g(o.days),1)]),s("div",Ze,[t[17]||(t[17]=s("span",{class:"text-base"},"Rate",-1)),s("span",et,g(e.currencySymbol)+g(e.formatAmount(o.amount)),1)])]))),128))])):(f(),F(l,{key:1,color:"info",border:"top"},{default:n(()=>t[19]||(t[19]=[b(" No companion hunter costs available ")])),_:1}))])]),_:1})]),_:1}),a(I,{stripe:"","stripe-color":"warning"},{default:n(()=>[a(C,{class:"flex items-center gap-2"},{default:n(()=>[a(u,{name:"visibility"}),t[20]||(t[20]=b(" Observer Hunter Costs "))]),_:1}),a(y,null,{default:n(()=>[s("div",tt,[e.observerHunterCosts&&e.observerHunterCosts.length>0?(f(),S("div",st,[t[23]||(t[23]=s("div",{class:"text-sm font-semibold text-secondary mb-2"},"Observer Hunter",-1)),(f(!0),S(N,null,U(e.observerHunterCosts,o=>(f(),S("div",{key:o.id,class:"p-4 rounded-lg bg-amber-50 mb-2"},[s("div",ot,[t[21]||(t[21]=s("span",{class:"text-base"},"Days",-1)),s("span",at,g(o.days),1)]),s("div",it,[t[22]||(t[22]=s("span",{class:"text-base"},"Rate",-1)),s("span",nt,g(e.currencySymbol)+g(e.formatAmount(o.amount)),1)])]))),128))])):(f(),F(l,{key:1,color:"info",border:"top"},{default:n(()=>t[24]||(t[24]=[b(" No observer hunter costs available ")])),_:1}))])]),_:1})]),_:1})]),a(I,{class:"mb-6",stripe:"","stripe-color":"danger"},{default:n(()=>[a(y,null,{default:n(()=>[a(l,{color:"warning",border:"left",class:"mb-3"},{title:n(()=>[s("div",rt,[a(u,{name:"warning"}),t[25]||(t[25]=s("span",{class:"font-bold"},"Important Information",-1))])]),default:n(()=>[t[26]||(t[26]=b(" All hunts confirmation is subject to quota availability. Other safari packages are available on request and can be customized depending on client requirements. "))]),_:1}),e.hasUpgradeFees?(f(),F(l,{key:0,color:"info",border:"left"},{title:n(()=>[s("div",lt,[a(u,{name:"info"}),t[27]||(t[27]=s("span",{class:"font-bold"},"Upgrade Fees",-1))])]),default:n(()=>[t[28]||(t[28]=b(" If additional trophies beyond the standard package are taken, upgrade fees may apply (plus trophy fees). "))]),_:1})):D("",!0)]),_:1})]),_:1})]))}const ct=j(ue,[["render",dt],["__scopeId","data-v-65c5cca7"]]),ut=R({components:{SalesPackageForm:de,VaForm:ae,VaInput:oe,VaSelect:se,VaButton:te},props:{editMode:{type:Boolean,default:!1},editItem:{type:Object,default:null}},emits:["saved"],setup(){const e=E(),{isValid:t,validate:i,resetValidation:c,reset:k}=re(e),{init:$}=K(),v=E(!1),d=G({id:null,hunting_type_id:null,package:[],amount:null,currency:null,duration:null,season:null,end_date:null,species:null,quantity:null,companion_days:null,companion_amount:null,observer_days:null,observer_amount:null}),u=G({id:null,client_id:null,contact:"",contact_type:null,contactable:!1}),m=o=>{d.package=d.package.filter(L=>L!==o)},P=E([]),y=E([]),I=E([]),C=E([]),A=E([]),l=E(0);return{formRef:e,form:d,contactForm:u,showEditForm:v,countries:P,nationality:y,categoryOptions:I,contactsTypes:C,clients:A,step:l,init:$,isValidForm:t,validateForm:i,resetValidationForm:c,resetForm:k,deleteChip:m,validators:le}},data(){return{preferred_species:[],speciesOptions:[],speciesObjects:[],areasOptions:[],huntingTypesOptions:[],salesQuotasOptions:[],speciesItemOptions:[],currencyOptions:[],savingPriceList:!1,durationsOptions:[{value:1,text:"1 day"},{value:2,text:"2 days"},{value:3,text:"3 days"},{value:4,text:"4 days"},{value:5,text:"5 days"},{value:6,text:"6 days"},{value:7,text:"7 days"},{value:8,text:"8 days"},{value:9,text:"9 days"},{value:10,text:"10 days"},{value:11,text:"11 days"},{value:12,text:"12 days"},{value:13,text:"13 days"},{value:14,text:"14 days"},{value:15,text:"15 days"},{value:16,text:"16 days"},{value:17,text:"17 days"},{value:18,text:"18 days"},{value:19,text:"19 days"},{value:20,text:"20 days"},{value:21,text:"21 days"}],seasonsOptions:[],upgradeFees:[]}},computed:{...J(q,["salesPackages","packageOptions","latestPackage","loadingpackages"]),...ee(q,{_shM:"showModal"})},watch:{},async mounted(){await Promise.all([this.getAreas(),this.getHuntingTypes(),this.getQuotaList(),this.getCurrencyList(),this.getSalesPackages(),this.getSeasonList(),this.getSpeciesItems()]),this.editMode&&this.editItem&&this.populateFormForEdit()},methods:{...T(z,["getSpeciesList"]),...T(z,["getAllSpeciesPerQuotaPerArea"]),...T(z,["getAreaList"]),...T(H,["getHuntingsTypes"]),...T(H,["getCurrencies","getSeasons"]),...T(z,["getQuotas"]),...T(q,["createPriceList","updatePriceList"]),...T(q,["getSalesPackageList"]),onAreaChange(e){console.log(e)},async submit(){var i,c,k,$,v,d,u,m,P,y,I,C,A,l,o,L;this.savingPriceList=!0;const e=this.upgradeFees.filter(r=>r.species_id&&r.amount&&r.currency_id).map(r=>{var x,p;const h={species_id:((x=r.species_id)==null?void 0:x.value)||r.species_id,amount:parseFloat(r.amount),currency_id:((p=r.currency_id)==null?void 0:p.value)||r.currency_id,description:r.description||""};return r.id&&(h.id=r.id),h}),t={huntingTypeId:((i=this.form.hunting_type_id)==null?void 0:i.value)||this.form.hunting_type_id,sales_package_ids:(c=this.form.package)==null?void 0:c.filter(r=>(r==null?void 0:r.value)!==void 0).map(r=>r==null?void 0:r.value),price_type_packages:(k=this.form.package)==null?void 0:k.filter(r=>(r==null?void 0:r.value)!==void 0).map(r=>({sales_package_id:r==null?void 0:r.value})),amount:this.form.amount,currency:(($=this.form.currency)==null?void 0:$.value)||this.form.currency,duration:((v=this.form.duration)==null?void 0:v.value)||this.form.duration,season_id:((u=(d=this.form.season)==null?void 0:d.value)==null?void 0:u.id)||((m=this.form.season)==null?void 0:m.id),start_at:((y=(P=this.form.season)==null?void 0:P.value)==null?void 0:y.start_at)||((I=this.form.season)==null?void 0:I.start_at),end_at:((A=(C=this.form.season)==null?void 0:C.value)==null?void 0:A.end_at)||((l=this.form.season)==null?void 0:l.end_at),is_active:1,area_id:3,user_id:1,companionAmount:this.form.companion_amount!==null&&this.form.companion_amount!==void 0?Number(this.form.companion_amount):null,companionDays:((o=this.form.companion_days)==null?void 0:o.value)||this.form.companion_days,observerAmount:this.form.observer_amount!==null&&this.form.observer_amount!==void 0?Number(this.form.observer_amount):null,observerDays:((L=this.form.observer_days)==null?void 0:L.value)||this.form.observer_days,upgrade_fees:e.length>0?e:null};console.log("=== PRICE LIST SUBMIT PAYLOAD ==="),console.log("Edit Mode:",this.editMode),console.log("Full Request Data:",JSON.stringify(t,null,2)),console.log("Observer Amount:",t.observerAmount),console.log("Observer Days:",t.observerDays),console.log("Companion Amount:",t.companionAmount),console.log("Companion Days:",t.companionDays),console.log("=================================");try{let r;this.editMode&&this.editItem?(console.log("Updating price list with ID:",this.editItem.id),r=await this.updatePriceList(this.editItem.id,t),r.status===200&&(this.init({message:"Price list updated successfully",color:"success"}),this.savingPriceList=!1,this.$emit("saved"))):(r=await this.createPriceList(t),r.status===201&&(this.init({message:r.data.message,color:"success"}),this.resetForm(),this.resetValidationForm(),this.speciesObjects=[],this.upgradeFees=[],this.savingPriceList=!1))}catch(r){this.savingPriceList=!1,W(r.response),console.log(r),this.init({message:r.message,color:"danger"})}},populateFormForEdit(){var y,I,C,A;if(!this.editItem)return;console.log("Edit Item:",JSON.stringify(this.editItem,null,2)),console.log("Hunting Types Options:",this.huntingTypesOptions),console.log("Seasons Options:",this.seasonsOptions),console.log("Currency Options:",this.currencyOptions);const e=this.editItem.price_list_type||this.editItem,t=e.amount||this.editItem.amount;t&&(this.form.amount=String(t).replace("$","").replace(",",""));const i=e.duration||this.editItem.duration;i!=null&&(this.form.duration=this.durationsOptions.find(l=>l.value===i)||{value:i,text:`${i} days`});const c=((y=e.hunting_type)==null?void 0:y.name)||this.editItem.hunting_type;console.log("Hunting Type Name:",c),c&&(this.form.hunting_type_id=this.huntingTypesOptions.find(l=>l.text===c)),console.log("Selected Hunting Type:",this.form.hunting_type_id);const k=(I=e.price_list)==null?void 0:I.start_date,$=(C=e.price_list)==null?void 0:C.end_date;if(console.log("Season dates:",k,$),k&&$&&(this.form.season=this.seasonsOptions.find(l=>{var o,L;return((o=l.value)==null?void 0:o.start_at)===k&&((L=l.value)==null?void 0:L.end_at)===$}),!this.form.season)){const l=new Date(k).getFullYear();this.form.season=this.seasonsOptions.find(o=>{var L;return(L=o.text)==null?void 0:L.includes(String(l))})}console.log("Selected Season:",this.form.season);const v=(A=e.currency)==null?void 0:A.name;console.log("Currency Name:",v),v&&(this.form.currency=this.currencyOptions.find(l=>l.text===v)),this.form.currency||(this.form.currency=this.currencyOptions.find(l=>l.text==="USD")||this.currencyOptions[0]),console.log("Selected Currency:",this.form.currency);const d=this.editItem.companion_hunter_costs||e.companion_hunter_costs;if(d&&d.length>0){const l=d[0];this.form.companion_amount=l.amount||null,l.days&&(this.form.companion_days=this.durationsOptions.find(o=>o.value===l.days)||{value:l.days,text:`${l.days} days`})}else this.form.companion_amount=this.editItem.companion_amount||null,this.editItem.companion_days&&(this.form.companion_days=this.durationsOptions.find(l=>l.value===this.editItem.companion_days)||{value:this.editItem.companion_days,text:`${this.editItem.companion_days} days`});const u=this.editItem.observer_hunter_costs||e.observer_hunter_costs;if(u&&u.length>0){const l=u[0];this.form.observer_amount=l.amount||null,l.days&&(this.form.observer_days=this.durationsOptions.find(o=>o.value===l.days)||{value:l.days,text:`${l.days} days`})}else this.form.observer_amount=this.editItem.observer_amount||null,this.editItem.observer_days&&(this.form.observer_days=this.durationsOptions.find(l=>l.value===this.editItem.observer_days)||{value:this.editItem.observer_days,text:`${this.editItem.observer_days} days`});const m=this.editItem.sales_package;m?this.form.package=[{value:m.id,text:m.name}]:this.editItem.packages&&Array.isArray(this.editItem.packages)&&(this.form.package=this.editItem.packages.map(l=>({value:l.id,text:l.name})));const P=this.editItem.upgrade_fees||e.upgrade_fees;P&&Array.isArray(P)&&P.length>0&&(this.upgradeFees=P.map(l=>{var o,L;return{id:l.id,species_id:this.speciesOptions.find(r=>r.value===l.species_id)||{value:l.species_id,text:((o=l.species)==null?void 0:o.name)||`Species ${l.species_id}`},amount:l.amount,currency_id:this.currencyOptions.find(r=>r.value===l.currency_id)||{value:l.currency_id,text:((L=l.currency)==null?void 0:L.name)||"USD"},description:l.description||""}}))},async getSpeciesItems(){try{const e=await this.getSpeciesList();this.speciesOptions=e.data.map(t=>({value:t.id,text:t.name}))}catch(e){console.log(e)}},async getSeasonList(){try{const e=await this.getSeasons();this.seasonsOptions=e.data.map(t=>({value:t,text:t.name}))}catch(e){console.log(e)}},_showModal(){this._shM=!0},async getSalesPackages(){try{await this.getSalesPackageList(!0)}catch(e){console.log(e)}},deleteFromStorage(e){this.speciesObjects.splice(e,1),console.log("Species item deleted:",e)},async getAreas(){try{const e=await this.getAreaList();this.areasOptions=e.data.map(t=>({value:t.id,text:t.name}))}catch(e){console.log(e)}},async getHuntingTypes(){try{const e=await this.getHuntingsTypes();this.huntingTypesOptions=e.data.map(t=>({value:t.id,text:t.name}))}catch(e){console.log(e)}},onChangePackage(e){console.log(e.filter(t=>(t==null?void 0:t.value)!==void 0).map(t=>t==null?void 0:t.value))},async getQuotaList(){try{const e=await this.getQuotas(null);this.salesQuotasOptions=e.data.map(t=>({value:t.id,text:t.name}))}catch(e){console.log(e)}},async getCurrencyList(){try{const e=await this.getCurrencies();this.currencyOptions=e.data.map(t=>({value:t.id,text:t.name}))}catch(e){console.log(e)}},addUpgradeFee(){this.upgradeFees.push({species_id:null,amount:null,currency_id:null,description:""})},removeUpgradeFee(e){this.upgradeFees.splice(e,1)}}}),mt={class:"p-1"},pt={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},gt={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},ft={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},yt={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},ht={class:"mb-4"},_t={class:"flex items-center justify-between mb-2"},bt={key:0,class:"space-y-4"},vt={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},kt={class:"flex items-end"},Vt={class:"mt-3"},It={key:1,class:"text-center py-4 text-gray-400 border border-dashed border-gray-300 rounded-lg"},Pt={class:"mt-4 d-flex p-2"};function Lt(e,t,i,c,k,$){const v=V("VaChip"),d=V("VaIcon"),u=V("VaSelect"),m=V("VaInput"),P=V("VaButton"),y=V("VaCard"),I=V("VaForm"),C=V("VaInnerLoading"),A=V("SalesPackageForm"),l=V("VaModal");return f(),S(N,null,[a(C,{loading:e.savingPriceList,size:60},{default:n(()=>[a(I,{ref:"formRef"},{default:n(()=>[s("div",mt,[t[18]||(t[18]=s("h3",{class:"font-bold text-lg mb-2"},"Price list Infos",-1)),s("div",pt,[a(u,{modelValue:e.form.package,"onUpdate:modelValue":[t[1]||(t[1]=o=>e.form.package=o),e.onChangePackage],options:e.packageOptions,multiple:"",clearable:"",placeholder:"Select Package list here",rules:[o=>o||"Package is required"],label:"Packages","required-mark":""},{content:n(({value:o})=>[(f(!0),S(N,null,U(o,L=>(f(),F(v,{key:L,size:"small",color:"info",class:"mr-1 my-1",closeable:"","onUpdate:modelValue":r=>e.deleteChip(L)},{default:n(()=>[b(g(L.text),1)]),_:2},1032,["onUpdate:modelValue"]))),128))]),append:n(()=>[a(d,{name:"add",class:"ml-2",onClick:t[0]||(t[0]=o=>e._showModal())})]),_:1},8,["modelValue","options","rules","onUpdate:modelValue"]),a(u,{modelValue:e.form.hunting_type_id,"onUpdate:modelValue":t[2]||(t[2]=o=>e.form.hunting_type_id=o),placeholder:"Select Hunting Type",label:"Hunting Type",rules:[o=>o||"Hunting type is required"],options:e.huntingTypesOptions,searchable:"","required-mark":"","highlight-matched-text":""},null,8,["modelValue","rules","options"]),a(u,{modelValue:e.form.season,"onUpdate:modelValue":t[3]||(t[3]=o=>e.form.season=o),options:e.seasonsOptions,"required-mark":"",label:"Select season",placeholder:"Select season"},null,8,["modelValue","options"])]),t[19]||(t[19]=s("h3",{class:"font-bold text-lg mb-2"},"Charges",-1)),s("div",gt,[a(m,{modelValue:e.form.amount,"onUpdate:modelValue":t[4]||(t[4]=o=>e.form.amount=o),type:"text",placeholder:"Enter Amount",rules:[o=>o&&o.length>0||"Amount is required"],label:"Amount","required-mark":""},null,8,["modelValue","rules"]),a(u,{modelValue:e.form.currency,"onUpdate:modelValue":t[5]||(t[5]=o=>e.form.currency=o),placeholder:"Select Currency",label:"Currency",rules:[o=>o||"Currency is required"],options:e.currencyOptions,searchable:"","highlight-matched-text":"","required-mark":""},null,8,["modelValue","rules","options"]),a(u,{modelValue:e.form.duration,"onUpdate:modelValue":t[6]||(t[6]=o=>e.form.duration=o),type:"text",options:e.durationsOptions,"required-mark":"",placeholder:"Enter Duration eg: 21 days",rules:[o=>o||"Duration is required"],label:"Duration(days)"},null,8,["modelValue","options","rules"])]),t[20]||(t[20]=s("h3",{class:"font-bold text-lg mb-2"},"Companion Charges",-1)),s("div",ft,[a(m,{modelValue:e.form.companion_amount,"onUpdate:modelValue":t[7]||(t[7]=o=>e.form.companion_amount=o),type:"number",placeholder:"Enter Companion Amount",label:"Companion Cost"},null,8,["modelValue"]),a(u,{modelValue:e.form.companion_days,"onUpdate:modelValue":t[8]||(t[8]=o=>e.form.companion_days=o),options:e.durationsOptions,placeholder:"Select Companion Days",label:"Companion Days",clearable:""},null,8,["modelValue","options"])]),t[21]||(t[21]=s("h3",{class:"font-bold text-lg mb-2"},"Observer Charges",-1)),s("div",yt,[a(m,{modelValue:e.form.observer_amount,"onUpdate:modelValue":t[9]||(t[9]=o=>e.form.observer_amount=o),type:"number",placeholder:"Enter Observer Amount",label:"Observer Cost"},null,8,["modelValue"]),a(u,{modelValue:e.form.observer_days,"onUpdate:modelValue":t[10]||(t[10]=o=>e.form.observer_days=o),options:e.durationsOptions,placeholder:"Select Observer Days",label:"Observer Days",clearable:""},null,8,["modelValue","options"])]),s("div",ht,[s("div",_t,[t[14]||(t[14]=s("h3",{class:"font-bold text-lg"},"Upgrade Fees (Optional)",-1)),a(P,{size:"small",color:"primary",icon:"add",onClick:e.addUpgradeFee},{default:n(()=>t[13]||(t[13]=[b(" Add Upgrade Fee ")])),_:1},8,["onClick"])]),t[17]||(t[17]=s("p",{class:"text-sm text-gray-500 mb-3"}," Add upgrade fees for additional species that can be hunted beyond the standard package. ",-1)),e.upgradeFees.length>0?(f(),S("div",bt,[(f(!0),S(N,null,U(e.upgradeFees,(o,L)=>(f(),F(y,{key:L,class:"p-4 bg-gray-50",stripe:"","stripe-color":"warning"},{default:n(()=>[s("div",vt,[a(u,{modelValue:o.species_id,"onUpdate:modelValue":r=>o.species_id=r,options:e.speciesOptions,placeholder:"Select Species",label:"Species",searchable:"","highlight-matched-text":"",rules:[r=>r||"Species is required"]},null,8,["modelValue","onUpdate:modelValue","options","rules"]),a(m,{modelValue:o.amount,"onUpdate:modelValue":r=>o.amount=r,type:"number",placeholder:"Enter Amount",label:"Amount",rules:[r=>r||"Amount is required"]},null,8,["modelValue","onUpdate:modelValue","rules"]),a(u,{modelValue:o.currency_id,"onUpdate:modelValue":r=>o.currency_id=r,options:e.currencyOptions,placeholder:"Select Currency",label:"Currency",rules:[r=>r||"Currency is required"]},null,8,["modelValue","onUpdate:modelValue","options","rules"]),s("div",kt,[a(P,{color:"danger",icon:"delete",size:"small",onClick:r=>e.removeUpgradeFee(L)},{default:n(()=>t[15]||(t[15]=[b(" Remove ")])),_:2},1032,["onClick"])])]),s("div",Vt,[a(m,{modelValue:o.description,"onUpdate:modelValue":r=>o.description=r,type:"textarea",placeholder:"Enter description (optional)",label:"Description","min-rows":2},null,8,["modelValue","onUpdate:modelValue"])])]),_:2},1024))),128))])):(f(),S("div",It,[a(d,{name:"info",size:"small",class:"mr-1"}),t[16]||(t[16]=b(' No upgrade fees added. Click "Add Upgrade Fee" to add optional upgrade fees. '))]))])]),s("div",Pt,[a(P,{icon:"save",class:"mr-3 mb-2",loading:e.savingPriceList,disabled:!e.isValidForm,onClick:t[11]||(t[11]=o=>e.validateForm()&&e.submit())},{default:n(()=>[b(g(e.editMode?"Update":"Save"),1)]),_:1},8,["loading","disabled"])])]),_:1},512)]),_:1},8,["loading"]),a(l,{modelValue:e._shM,"onUpdate:modelValue":t[12]||(t[12]=o=>e._shM=o),"ok-text":"Apply","close-button":"",size:"large","hide-default-actions":!0},{default:n(()=>[a(A)]),_:1},8,["modelValue"])],64)}const St=j(ut,[["render",Lt]]),At=R({name:"ManagePriceList",components:{PricesListDetails:ct,CreatePricesListForm:St},setup(){return{formRef:E(null)}},data(){return{columns:[{key:"package_name",label:"Package Name",sortable:!0},{key:"area",label:"Area",sortable:!0},{key:"hunting_type",label:"Hunting Type",sortable:!0},{key:"amount",label:"Price",sortable:!0},{key:"duration",label:"Duration",sortable:!0},{key:"season_name",label:"Season",sortable:!0},{key:"species_count",label:"Species",sortable:!0},{key:"status",label:"Status",sortable:!0},{key:"actions",label:"Actions",sortable:!1,width:120}],items:[],printableDataList:[],item:null,toast:K(),areasOptions:[],huntingTypeOptions:[],seasonOptions:[],showPriceList:!0,ShowCreateNewPriceListForm:!1,loading:!1,loadingSeasons:!1,huntingTypeValue:null,areaValue:null,seasonValue:null,minAmount:null,maxAmount:null,poriceListPdf:"",individualPriceListPdf:"",downloadPdf:B,downloadingPdf:!1,showDeleteModal:!1,itemToDelete:null,deleting:!1,showEditForm:!1,editItem:null}},computed:{...J(H,["logo"]),activePackages(){return this.items.filter(e=>e.status==="Active").length},uniqueAreas(){return new Set(this.items.map(t=>t.area)).size}},mounted(){this.getSeasonOptions(),this.getPriceLists(),this.getAreas(),this.getHuntingTypesOptions(),this.loadLogo()},methods:{...T(q,["getPriceList","getPriceListByHuntingType","getPriceListById","deletePriceList","getCompletePriceListPdf"]),...T(z,["getAreaList"]),...T(H,["getHuntingsTypes","loadLogo","getSeasons"]),getActiveSpecies(e){return e.filter(t=>t.quantity>0)},formatDate(e){return e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"},async getSeasonOptions(){this.loadingSeasons=!0;try{const e=await this.getSeasons(!1);if(e.status===200){const t={value:"",text:"All Seasons"};this.seasonOptions=e.data.map(i=>({value:i.id,text:i.name})),this.seasonOptions.unshift(t),this.seasonValue=this.seasonOptions[0]}}catch(e){console.error("Error fetching seasons:",e)}finally{this.loadingSeasons=!1}},async toggleShowPriceListMethod(e){const t=e==null?void 0:e.id;if(t)try{const i=await this.getPriceListById(t);this.item=i.data.data||i.data,this.individualPriceListPdf=i.data.pdf||"",this.showPriceList=!1}catch(i){console.error("Error fetching price list detail:",i)}},async onDownloadSinglePriceList(e){var i;console.log("=== Download button clicked ==="),console.log("Row data for download:",e);const t=e==null?void 0:e.id;if(!t){console.error("No price list ID found in row data");return}try{console.log("Fetching price list detail for ID:",t);const c=await this.getPriceListById(t),k=c.data.data||c.data;console.log("Fetched price list data for PDF generation:",k),await this.generateIndividualPdf(k,t)}catch(c){console.error("Error downloading price list:",c),(i=this.toast)==null||i.init({message:"Failed to download price list",color:"danger"})}},async generateIndividualPdf(e,t){var i,c,k,$,v,d,u,m,P,y,I,C,A,l,o,L,r,h,x;try{const p=new ce;p.setProperties({title:`Price List ${t}`,subject:"Price List Details",author:"Bushman System",creator:"Bushman"});let _=20;const O=7,w=20,M=p.internal.pageSize.width;p.setFontSize(16),p.setFont("helvetica","bold"),p.text("INDIVIDUAL PRICE LIST DETAILS",M/2,_,{align:"center"}),_+=20,p.setFontSize(12),p.setFont("helvetica","bold"),p.text("PRICE LIST INFORMATION:",w,_),_+=O,p.setFont("helvetica","normal"),p.text(`ID: ${e.id||"N/A"}`,w,_),_+=O,p.text(`Package Name: ${((i=e.sales_package)==null?void 0:i.name)||"N/A"}`,w,_),_+=O,p.text(`Area: ${((k=(c=e.sales_package)==null?void 0:c.area)==null?void 0:k.name)||"N/A"}`,w,_),_+=O,p.text(`Hunting Type: ${((v=($=e.price_list_type)==null?void 0:$.hunting_type)==null?void 0:v.name)||"N/A"}`,w,_),_+=O,p.text(`Amount: ${((u=(d=e.price_list_type)==null?void 0:d.currency)==null?void 0:u.symbol)||""}${((m=e.price_list_type)==null?void 0:m.amount)||"N/A"}`,w,_),_+=O,p.text(`Duration: ${((P=e.price_list_type)==null?void 0:P.duration)||"N/A"} days`,w,_),_+=O,p.text(`Status: ${(y=e.price_list_type)!=null&&y.is_active?"Active":"Inactive"}`,w,_),_+=15,_>250&&(p.addPage(),_=20),p.setFont("helvetica","bold"),p.text("VALIDITY PERIOD:",w,_),_+=O,p.setFont("helvetica","normal"),p.text(`Start Date: ${((C=(I=e.price_list_type)==null?void 0:I.price_list)==null?void 0:C.start_date)||"N/A"}`,w,_),_+=O,p.text(`End Date: ${((l=(A=e.price_list_type)==null?void 0:A.price_list)==null?void 0:l.end_date)||"N/A"}`,w,_),_+=15,(o=e.sales_package)!=null&&o.regulatory_package&&(p.setFont("helvetica","bold"),p.text("REGULATORY PACKAGE:",w,_),_+=O,p.setFont("helvetica","normal"),p.text(`Name: ${e.sales_package.regulatory_package.name||"N/A"}`,w,_),_+=O,p.text(`Duration: ${e.sales_package.regulatory_package.duration||"N/A"} days`,w,_),_+=15),((r=(L=e.sales_package)==null?void 0:L.species)==null?void 0:r.length)>0&&(p.setFont("helvetica","bold"),p.text("INCLUDED SPECIES:",w,_),_+=O,p.setFont("helvetica","normal"),e.sales_package.species.forEach(Q=>{const Y=Q.species||{},X=`• ${Y.name} (${Y.scientific_name||"No scientific name"}) - Quantity: ${Q.quantity||1}`;p.splitTextToSize(X,M-w*2).forEach(Z=>{_>280&&(p.addPage(),_=20),p.text(Z,w,_),_+=O})}),_+=10),p.setFontSize(10),p.setTextColor(128,128,128),p.text(`Document generated on: ${new Date().toLocaleString()}`,w,285),p.text("This is an auto-generated individual price list document.",w,292),p.save(`price-list-${t}-${Date.now()}.pdf`),(h=this.toast)==null||h.init({message:"Price list downloaded successfully",color:"success"})}catch(p){console.error("Error generating individual PDF:",p),(x=this.toast)==null||x.init({message:"Failed to generate PDF. Please try the main Download button.",color:"warning"})}},createIndividualPdfContent(e){var v,d,u,m,P,y;const t=new Date().toLocaleString(),i=e.price_list_type||{},c=e.sales_package||{},k=c.area||{},$=c.regulatory_package||{};return`
INDIVIDUAL PRICE LIST DETAILS
==============================

PRICE LIST INFORMATION:
-----------------------
ID: ${e.id||"N/A"}
Package Name: ${c.name||"N/A"}
Area: ${k.name||"N/A"}
Area Description: ${k.description||"N/A"}
Hunting Type: ${((v=i.hunting_type)==null?void 0:v.name)||"N/A"}
Amount: ${((d=i.currency)==null?void 0:d.symbol)||""}${i.amount||"N/A"}
Duration: ${i.duration||"N/A"} days
Status: ${i.is_active?"Active":"Inactive"}

VALIDITY PERIOD:
----------------
Start Date: ${((u=i.price_list)==null?void 0:u.start_date)||"N/A"}
End Date: ${((m=i.price_list)==null?void 0:m.end_date)||"N/A"}

REGULATORY PACKAGE:
-------------------
Name: ${$.name||"N/A"}
Duration: ${$.duration||"N/A"} days

INCLUDED SPECIES:
-----------------
${this.formatIncludedSpecies(c.species||[])}

SAFARI EXTRAS:
--------------
${this.formatSafariExtras(e.safari_extras||[])}

TROPHY FEES:
------------
${this.formatTrophyFees(e.trophy_fees||[])}

COMPANION & OBSERVER COSTS:
---------------------------
${this.formatCompanionObserver(e.componions_hunter,e.observer)}

CURRENCY INFORMATION:
---------------------
Currency: ${((P=i.currency)==null?void 0:P.name)||"N/A"}
Symbol: ${((y=i.currency)==null?void 0:y.symbol)||"N/A"}

Document generated on: ${t}
This is an auto-generated individual price list document.
  `.trim()},formatIncludedSpecies(e){return e.length?e.map(t=>{const i=t.species||{};return`• ${i.name} (${i.scientific_name||"No scientific name"}) - Quantity: ${t.quantity||1}`}).join(`
`):"No species included"},formatSafariExtras(e){return e.length?e.map(t=>{const i=t.currency||{};return`• ${t.name}: ${i.symbol||""}${t.amount} ${t.charges_per||""}`}).join(`
`):"No safari extras available"},formatTrophyFees(e){return e.length?e.map(t=>{const i=t.species||{};return`• ${i.name} (${i.scientific_name||"No scientific name"}): $${t.price_usd||"N/A"}`}).join(`
`):"No trophy fees available"},formatCompanionObserver(e,t){let i="";return e&&e.length>0?e.forEach(c=>{var k;i+=`Companion: ${c.days||0} days - ${((k=c.currency)==null?void 0:k.symbol)||""}${c.amount||0}
`}):i+=`Companion: Not available
`,t&&t.length>0?t.forEach(c=>{var k;i+=`Observer: ${c.days||0} days - ${((k=c.currency)==null?void 0:k.symbol)||""}${c.amount||0}`}):i+="Observer: Not available",i},async onDownloadPdf(){var e,t,i,c;this.downloadingPdf=!0;try{const k=y=>y==null?"":typeof y=="object"&&"value"in y?y.value:y,$=k(this.huntingTypeValue)||"",v=k(this.areaValue)||"",d=k(this.seasonValue)||"",u=this.minAmount||"",m=this.maxAmount||"",P=await this.getCompletePriceListPdf($,v,d,u,m);if(P.status===200){const y=((e=P.data)==null?void 0:e.pdf)||P.data,I=A=>typeof A=="string"&&/^https?:\/\//i.test(A),C=A=>typeof A=="string"&&A.length>200&&/^[A-Za-z0-9+/=\r\n]+$/.test(A);if(!y||!I(y)&&!C(y)){(t=this.toast)==null||t.init({message:"PDF not available",color:"warning"});return}await B(y,`price-list-${Date.now()}.pdf`)}else(i=this.toast)==null||i.init({message:"Failed to generate PDF",color:"danger"})}catch(k){console.error("Error downloading PDF:",k),(c=this.toast)==null||c.init({message:"Failed to download PDF",color:"danger"})}finally{this.downloadingPdf=!1}},goBack(){this.showPriceList=!0,this.ShowCreateNewPriceListForm=!1,this.showEditForm=!1,this.editItem=null,this.getPriceLists()},showCreateNewPriceListFormMethod(){this.ShowCreateNewPriceListForm=!0,this.showPriceList=!1,this.showEditForm=!1},async editPriceList(e){var t;try{const i=await this.getPriceListById(e.id);this.editItem=i.data.data||i.data,this.showEditForm=!0,this.showPriceList=!1,this.ShowCreateNewPriceListForm=!1}catch(i){console.error("Error fetching price list for edit:",i),(t=this.toast)==null||t.init({message:"Failed to load price list details",color:"danger"})}},onEditSaved(){var e;this.showEditForm=!1,this.showPriceList=!0,this.editItem=null,this.getPriceLists(),(e=this.toast)==null||e.init({message:"Price list updated successfully",color:"success"})},confirmDelete(e){this.itemToDelete=e,this.showDeleteModal=!0},async confirmDeletePriceList(){var e,t;if(this.itemToDelete){this.deleting=!0;try{const i=await this.deletePriceList(this.itemToDelete.id,!0);(i.status===200||i.status===204)&&((e=this.toast)==null||e.init({message:"Price list deleted successfully",color:"success"}),this.showDeleteModal=!1,this.itemToDelete=null,this.getPriceLists())}catch(i){const c=W(i.response);(t=this.toast)==null||t.init({message:c.join(", ")||"Failed to delete price list",color:"danger"})}finally{this.deleting=!1}}},async getPriceLists(){this.loading=!0;try{const e=d=>d==null?"":typeof d=="object"&&"value"in d?d.value:d,t=e(this.huntingTypeValue)||"",i=e(this.areaValue)||"",c=e(this.seasonValue)||"",k=this.minAmount||"",$=this.maxAmount||"",v=await this.getPriceList(t,i,c,k,$);if(v.status===200){const d=v==null?void 0:v.data,u=Array.isArray(d)?d:(d==null?void 0:d.data)??[];this.printableDataList=d,this.poriceListPdf=(d==null?void 0:d.pdf)||"",Array.isArray(u)?this.items=u.map(m=>({id:m.id,package_name:m.package_name,area:m.area,area_package:m.area_package,hunting_type:m.hunting_type,amount:m.amount,duration:m.duration,status:m.status,start_date:m.start_date,end_date:m.end_date,season_id:m.season_id,season_name:m.season_name,species_count:m.species_count,species:m.species||[],companion_hunter_costs:m.companion_hunter_costs||[]})):this.items=[]}}catch(e){console.error("Error in getPriceLists:",e)}finally{this.loading=!1}},async getAreas(){var e;try{const t=await this.getAreaList(),i={value:"",text:"All Areas"};this.areasOptions=(e=t==null?void 0:t.data)==null?void 0:e.map(c=>({value:c.id,text:c.name})),this.areasOptions.unshift(i),this.areaValue=this.areasOptions[0]}catch(t){console.error("Error fetching areas:",t)}},async getHuntingTypesOptions(){var e;try{const t=await this.getHuntingsTypes();if(t.status===200){const i={value:"",text:"All Types"};this.huntingTypeOptions=(e=t==null?void 0:t.data)==null?void 0:e.map(c=>({value:c.id,text:c.name})),this.huntingTypeOptions.unshift(i),this.huntingTypeValue=this.huntingTypeOptions[0]}}catch(t){console.error("Error fetching hunting types:",t)}}}}),Ct={class:"flex flex-col md:flex-row gap-2 mb-4 justify-between items-center"},wt={class:"flex flex-col md:flex-row gap-2 justify-start items-center"},$t={key:1,class:"text-xl font-bold text-gray-700"},Ft={key:2,class:"text-xl font-bold text-gray-700"},Ot={class:"filters-section bg-gray-50 rounded-lg p-4 mb-6 mt-4"},Dt={class:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4"},Nt={class:"block text-sm font-medium text-gray-600 mb-1"},xt={class:"block text-sm font-medium text-gray-600 mb-1"},Tt={class:"block text-sm font-medium text-gray-600 mb-1"},Et={class:"block text-sm font-medium text-gray-600 mb-1"},Ut={class:"block text-sm font-medium text-gray-600 mb-1"},Mt={class:"flex items-end"},qt={key:0,class:"grid grid-cols-2 md:grid-cols-3 gap-4 mb-6"},zt={class:"stat-card bg-blue-50 rounded-lg p-4 text-center"},Ht={class:"text-2xl font-bold text-blue-600"},Bt={class:"stat-card bg-green-50 rounded-lg p-4 text-center"},Rt={class:"text-2xl font-bold text-green-600"},jt={class:"stat-card bg-amber-50 rounded-lg p-4 text-center"},Qt={class:"text-2xl font-bold text-amber-600"},Yt={key:0,class:"text-center py-12"},Gt={class:"font-semibold"},Jt={class:"flex items-center gap-1"},Kt={class:"font-semibold text-green-600"},Wt={class:"flex gap-2"},Xt={class:"flex gap-2 justify-end"};function Zt(e,t,i,c,k,$){const v=V("VaButton"),d=V("VaIcon"),u=V("VaDivider"),m=V("VaSelect"),P=V("VaInput"),y=V("VaBadge"),I=V("VaDataTable"),C=V("VaInnerLoading"),A=V("PricesListDetails"),l=V("CreatePricesListForm"),o=V("VaCardContent"),L=V("VaCard"),r=V("VaModal");return f(),S(N,null,[a(L,{class:"price-list-page"},{default:n(()=>[a(o,null,{default:n(()=>[s("div",Ct,[s("div",wt,[!e.showPriceList||e.showEditForm?(f(),F(v,{key:0,class:"px-3 py-2",icon:"arrow_back",size:"small",onClick:e.goBack},{default:n(()=>t[7]||(t[7]=[b(" Back to List ")])),_:1},8,["onClick"])):D("",!0),e.showPriceList&&!e.showEditForm?(f(),S("h2",$t,[a(d,{name:"list_alt",class:"mr-2"}),t[8]||(t[8]=b(" Price Lists "))])):D("",!0),e.showEditForm?(f(),S("h2",Ft,[a(d,{name:"edit",class:"mr-2"}),t[9]||(t[9]=b(" Edit Price List "))])):D("",!0)]),!e.ShowCreateNewPriceListForm&&e.showPriceList&&!e.showEditForm?(f(),F(v,{key:0,class:"px-4 py-2",color:"primary",icon:"add",round:"",onClick:e.showCreateNewPriceListFormMethod},{default:n(()=>t[10]||(t[10]=[b(" Add a new Price List ")])),_:1},8,["onClick"])):D("",!0)]),a(u),e.ShowCreateNewPriceListForm?D("",!0):(f(),S(N,{key:0},[e.showPriceList?(f(),S(N,{key:0},[s("div",Ot,[s("div",Dt,[s("div",null,[s("label",Nt,[a(d,{name:"date_range",size:"small",class:"mr-1"}),t[11]||(t[11]=b(" Season "))]),a(m,{modelValue:e.seasonValue,"onUpdate:modelValue":[t[0]||(t[0]=h=>e.seasonValue=h),e.getPriceLists],options:e.seasonOptions,placeholder:"Select Season",loading:e.loadingSeasons},null,8,["modelValue","options","loading","onUpdate:modelValue"])]),s("div",null,[s("label",xt,[a(d,{name:"pets",size:"small",class:"mr-1"}),t[12]||(t[12]=b(" Hunting Type "))]),a(m,{modelValue:e.huntingTypeValue,"onUpdate:modelValue":[t[1]||(t[1]=h=>e.huntingTypeValue=h),e.getPriceLists],options:e.huntingTypeOptions,placeholder:"Filter By Type"},null,8,["modelValue","options","onUpdate:modelValue"])]),s("div",null,[s("label",Tt,[a(d,{name:"location_on",size:"small",class:"mr-1"}),t[13]||(t[13]=b(" Hunting Area "))]),a(m,{modelValue:e.areaValue,"onUpdate:modelValue":[t[2]||(t[2]=h=>e.areaValue=h),e.getPriceLists],options:e.areasOptions,placeholder:"Filter By Area"},null,8,["modelValue","options","onUpdate:modelValue"])]),s("div",null,[s("label",Et,[a(d,{name:"attach_money",size:"small",class:"mr-1"}),t[14]||(t[14]=b(" Min Amount "))]),a(P,{modelValue:e.minAmount,"onUpdate:modelValue":t[3]||(t[3]=h=>e.minAmount=h),type:"number",placeholder:"Min price",onChange:e.getPriceLists},null,8,["modelValue","onChange"])]),s("div",null,[s("label",Ut,[a(d,{name:"attach_money",size:"small",class:"mr-1"}),t[15]||(t[15]=b(" Max Amount "))]),a(P,{modelValue:e.maxAmount,"onUpdate:modelValue":t[4]||(t[4]=h=>e.maxAmount=h),type:"number",placeholder:"Max price",onChange:e.getPriceLists},null,8,["modelValue","onChange"])]),s("div",Mt,[a(v,{class:"w-full",color:"secondary",icon:"download",loading:e.downloadingPdf,onClick:e.onDownloadPdf},{default:n(()=>t[16]||(t[16]=[b(" Download PDF ")])),_:1},8,["loading","onClick"])])])]),e.items.length>0?(f(),S("div",qt,[s("div",zt,[s("div",Ht,g(e.items.length),1),t[17]||(t[17]=s("div",{class:"text-sm text-gray-600"},"Total Packages",-1))]),s("div",Bt,[s("div",Rt,g(e.activePackages),1),t[18]||(t[18]=s("div",{class:"text-sm text-gray-600"},"Active",-1))]),s("div",jt,[s("div",Qt,g(e.uniqueAreas),1),t[19]||(t[19]=s("div",{class:"text-sm text-gray-600"},"Areas",-1))])])):D("",!0),a(C,{loading:e.loading},{default:n(()=>[e.items.length===0&&!e.loading?(f(),S("div",Yt,[a(d,{name:"inventory_2",size:"4rem",color:"#9B9FB5"}),t[20]||(t[20]=s("p",{class:"text-gray-500 mt-4"},"No price lists found for the selected filters.",-1))])):(f(),F(I,{key:1,items:e.items,columns:e.columns,hoverable:"",striped:"",loading:e.loading},{"cell(package_name)":n(({rowData:h})=>[s("div",Gt,g(h.package_name),1)]),"cell(area)":n(({rowData:h})=>[s("div",Jt,[a(d,{name:"location_on",size:"small",color:"secondary"}),b(" "+g(h.area),1)])]),"cell(amount)":n(({rowData:h})=>[s("span",Kt,g(h.amount),1)]),"cell(duration)":n(({rowData:h})=>[b(g(h.duration)+" Days ",1)]),"cell(status)":n(({rowData:h})=>[a(y,{text:h.status,color:h.status==="Active"?"success":"warning"},null,8,["text","color"])]),"cell(season_name)":n(({rowData:h})=>[b(g(h.season_name||"N/A"),1)]),"cell(species_count)":n(({rowData:h})=>[a(y,{text:String(h.species_count||0),color:"info"},null,8,["text"])]),"cell(actions)":n(({rowData:h})=>[s("div",Wt,[a(v,{preset:"plain",icon:"visibility",color:"primary",size:"small",title:"View Details",onClick:x=>e.toggleShowPriceListMethod(h)},null,8,["onClick"]),a(v,{preset:"plain",icon:"edit",color:"warning",size:"small",title:"Edit",onClick:x=>e.editPriceList(h)},null,8,["onClick"]),a(v,{preset:"plain",icon:"delete",color:"danger",size:"small",title:"Delete",onClick:x=>e.confirmDelete(h)},null,8,["onClick"])])]),_:1},8,["items","columns","loading"]))]),_:1},8,["loading"])],64)):e.showEditForm?e.showEditForm?(f(),F(l,{key:2,"edit-mode":!0,"edit-item":e.editItem,onSaved:e.onEditSaved},null,8,["edit-item","onSaved"])):D("",!0):(f(),F(A,{key:1,"price-list-item":e.item,"pdf-data":e.individualPriceListPdf},null,8,["price-list-item","pdf-data"]))],64)),e.ShowCreateNewPriceListForm?(f(),F(l,{key:1})):D("",!0)]),_:1})]),_:1}),a(r,{modelValue:e.showDeleteModal,"onUpdate:modelValue":t[6]||(t[6]=h=>e.showDeleteModal=h),"hide-default-actions":""},{header:n(()=>t[21]||(t[21]=[s("h3",{class:"va-h6"},"Confirm Delete",-1)])),footer:n(()=>[s("div",Xt,[a(v,{preset:"secondary",onClick:t[5]||(t[5]=h=>e.showDeleteModal=!1)},{default:n(()=>t[24]||(t[24]=[b("Cancel")])),_:1}),a(v,{color:"danger",loading:e.deleting,onClick:e.confirmDeletePriceList},{default:n(()=>t[25]||(t[25]=[b("Delete")])),_:1},8,["loading","onClick"])])]),default:n(()=>{var h;return[s("p",null,[t[22]||(t[22]=b(" Are you sure you want to delete ")),s("strong",null,g((h=e.itemToDelete)==null?void 0:h.package_name),1),t[23]||(t[23]=b("? "))])]}),_:1},8,["modelValue"])],64)}const fs=j(At,[["render",Zt],["__scopeId","data-v-5f3b9d56"]]);export{fs as default};
//# sourceMappingURL=ManagePriceList-0b3lAXdh.js.map
