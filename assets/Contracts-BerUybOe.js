import{d as B,_ as q,g as I,e,v as g,h as r,t as d,o as m,m as S,l as M,s as R,B as z,a as c,w as s,b as l,i as a,q as j,F as D}from"./index-CepPxMNg.js";import{u as F}from"./contracts-store-B6jQqP_r.js";import{d as G}from"./pdfDownloader-DiRJnS-k.js";import{f as L}from"./utils-BWc0LXoO.js";import{u as Q}from"./useForm-C2zo2Lif.js";import{u as J}from"./useToast-MdJILhkk.js";import{u as $}from"./sales-store-Dr-sTvKc.js";import{h as K}from"./errorHandler-DijQ3xmc.js";import"./format-Cn4G_mmc.js";const W=B({props:{contractItem:{type:Object,required:!0}},setup(){return{formatDateTime:L}}}),X={class:"contract-details"},Y={class:"contract-info"},Z={class:"info-item"},x={class:"info-item"},tt={class:"info-item"},ot={class:"info-item"},et={class:"info-item"},nt={class:"info-item"},at={key:0,class:"sales-confirmation"},st={class:"proposal-info"},lt={class:"info-item"},rt={class:"info-item"},it={class:"info-item"},dt={key:1,class:"client-info"},mt={class:"info-item"},ut={class:"info-item"},ct={class:"info-item"},pt={key:2,class:"price-breakdown"};function ft(t,o,_,V,T,h){var u,C,f,p,b,y,v,k,w,A,N,i,n,U,E,P,O,H;return m(),I("div",X,[o[17]||(o[17]=e("h1",{class:"contract-title"},"Contract Details",-1)),e("div",Y,[e("div",Z,[o[0]||(o[0]=e("strong",null,"Contract Number:",-1)),r(" "+d(((u=t.contractItem)==null?void 0:u.contract_number)||"N/A"),1)]),e("div",x,[o[1]||(o[1]=e("strong",null,"Description:",-1)),r(" "+d(((C=t.contractItem)==null?void 0:C.description)||"N/A"),1)]),e("div",tt,[o[2]||(o[2]=e("strong",null,"Start Date:",-1)),r(" "+d(t.formatDateTime((f=t.contractItem)==null?void 0:f.start_date)||"N/A"),1)]),e("div",ot,[o[3]||(o[3]=e("strong",null,"End Date:",-1)),r(" "+d(t.formatDateTime((p=t.contractItem)==null?void 0:p.end_date)||"N/A"),1)]),e("div",et,[o[4]||(o[4]=e("strong",null,"Created At:",-1)),r(" "+d(t.formatDateTime((b=t.contractItem)==null?void 0:b.created_at)||"N/A"),1)]),e("div",nt,[o[5]||(o[5]=e("strong",null,"Updated At:",-1)),r(" "+d(t.formatDateTime((y=t.contractItem)==null?void 0:y.updated_at)||"N/A"),1)])]),(v=t.contractItem)!=null&&v.sales_confirmation_proposal?(m(),I("section",at,[o[9]||(o[9]=e("h2",null,"Sales Confirmation Proposal",-1)),e("div",st,[e("div",lt,[o[6]||(o[6]=e("strong",null,"Sales Inquiry ID:",-1)),r(" "+d(((k=t.contractItem.sales_confirmation_proposal.sales_inquiry)==null?void 0:k.id)||"N/A"),1)]),e("div",rt,[o[7]||(o[7]=e("strong",null,"Preferred Date:",-1)),r(" "+d(t.formatDateTime((w=t.contractItem.sales_confirmation_proposal.preference)==null?void 0:w.preferred_date)||"N/A"),1)]),e("div",it,[o[8]||(o[8]=e("strong",null,"Area:",-1)),r(" "+d(((A=t.contractItem.sales_confirmation_proposal.area)==null?void 0:A.length)>0?(i=(N=t.contractItem.sales_confirmation_proposal.area[0])==null?void 0:N.area)==null?void 0:i.name:"N/A"),1)])])])):g("",!0),(n=t.contractItem)!=null&&n.entity?(m(),I("section",dt,[o[13]||(o[13]=e("h2",null,"Client Information",-1)),e("div",mt,[o[10]||(o[10]=e("strong",null,"Full Name:",-1)),r(" "+d(t.contractItem.entity.full_name||"N/A"),1)]),e("div",ut,[o[11]||(o[11]=e("strong",null,"Country:",-1)),r(" "+d(((U=t.contractItem.entity.country)==null?void 0:U.name)||"N/A"),1)]),e("div",ct,[o[12]||(o[12]=e("strong",null,"Email:",-1)),r(" "+d(((P=(E=t.contractItem.entity.contacts)==null?void 0:E[0])==null?void 0:P.contact)||"N/A"),1)])])):g("",!0),t.contractItem.price_break_down?(m(),I("section",pt,[o[16]||(o[16]=e("h2",null,"Price Breakdown",-1)),e("div",null,[o[14]||(o[14]=e("strong",null,"Total Amount:",-1)),r(" "+d((O=t.contractItem.price_break_down.total_amount.currency)==null?void 0:O.symbol)+d(t.contractItem.price_break_down.total_amount.amount||"N/A"),1)]),e("div",null,[o[15]||(o[15]=e("strong",null,"Number of Companions:",-1)),r(" "+d(((H=t.contractItem.price_break_down.companion_cost_details)==null?void 0:H.number_of_companions)||"N/A"),1)])])):g("",!0)])}const Ct=q(W,[["render",ft],["__scopeId","data-v-4a9ee03d"]]),gt=B({setup(){const{init:t}=J(),o=R(null),{isValid:_,validate:V,resetValidation:T,reset:h}=Q(o),u=R(!0),C=p=>{console.log(p),(p.value=="prior"||p.value=="after")&&(u.value=!1)},f=z({proposal:null,enity_id:null,start_date:null,end_date:null,description:""});return{iformRef:o,isValidForm:_,validateForm:V,resetValidationForm:T,resetForm:h,form:f,init:t,onInputChange:C,isNotUpBookingSelected:u}},data(){const t=[{icon:"feed",title:"Main Hunter ",content:"main_hunter_contract"},{icon:"feed",title:"Companion Hunter ",content:"companion_contract"}];return{packages:[],installments:[],regulatoryPackages:[],proposalOptions:[],loadingSales:!1,salesItem:null,tabs:t,value:t[0].title}},computed:{...M($,["companions"]),currentTab(){return this.tabs.find(({title:t})=>t===this.value)}},mounted(){this.getSalesProposalOptions()},methods:{...S(F,["createContract"]),...S($,["getallSalesConfirmation"]),...S($,["getCompanions"]),onValueChange(t){console.log(t),this.salesItem=t.selfitem,console.log(t.selfitem),this.getCompanions(t.selfitem.sales_inquiry.id,!0)},async onSubmit(){var o,_;const t={sales_confirmation_proposal_id:this.form.proposal.value,entity_id:((o=this.currentTab)==null?void 0:o.content)==="companion_contract"?this.form.enity_id.value:null,start_date:this.form.start_date,end_date:this.form.end_date,contractor_type:((_=this.currentTab)==null?void 0:_.content)==="companion_contract"?"COMPANION_HUNTER":"MAIN_HUNTER",description:this.form.description};try{(await this.createContract(t)).status===201&&this.init({message:"Contract created successfully",color:"success"})}catch(V){const T=K(V.response);this.init({message:`
`+T.map((h,u)=>`${u+1}. ${h}`).join(`
`),color:"danger"})}},async getSalesProposalOptions(){this.loadingSales=!0;const t=await this.getallSalesConfirmation();t.status===200?(this.loadingSales=!1,this.proposalOptions=t.data.map(o=>({text:`sales confirmation for ${o.sales_inquiry.entity.full_name}`,value:o.id,selfitem:o}))):this.loadingSales=!1}}}),_t={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},Vt={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},bt={class:"grid grid-cols-1 md:grid-cols-1 gap-4 mb-4"},yt={class:"flex justify-end"};function vt(t,o,_,V,T,h){const u=a("VaIcon"),C=a("VaTab"),f=a("VaCardTitle"),p=a("VaSelect"),b=a("VaDateInput"),y=a("VaTextarea"),v=a("VaButton"),k=a("VaForm"),w=a("VaCardContent"),A=a("VaCard"),N=a("VaTabs"),i=a("VaInnerLoading");return m(),c(i,{loading:t.loadingSales},{default:s(()=>[l(N,{modelValue:t.value,"onUpdate:modelValue":o[6]||(o[6]=n=>t.value=n),vertical:"",grow:""},{tabs:s(()=>[(m(!0),I(D,null,j(t.tabs,n=>(m(),c(C,{key:n.title,name:n.title},{default:s(()=>[l(u,{name:n.icon,size:"small",class:"mr-2"},null,8,["name"]),r(" "+d(n.title),1)]),_:2},1032,["name"]))),128))]),default:s(()=>[l(A,{square:"",outlined:""},{default:s(()=>[l(f,{class:"mb-4"},{default:s(()=>[r(d(t.currentTab.title),1)]),_:1}),l(w,null,{default:s(()=>[l(k,{ref:"iformRef"},{default:s(()=>[e("div",_t,[l(p,{modelValue:t.form.proposal,"onUpdate:modelValue":[o[0]||(o[0]=n=>t.form.proposal=n),t.onValueChange],options:t.proposalOptions,rules:[n=>n||"Sales confirmation is required"],placeholder:"Select confirmation ",label:"Choose sales confirmation"},null,8,["modelValue","options","rules","onUpdate:modelValue"]),t.currentTab.content==="companion_contract"?(m(),c(p,{key:0,modelValue:t.form.enity_id,"onUpdate:modelValue":o[1]||(o[1]=n=>t.form.enity_id=n),options:t.companions,rules:[n=>n||"Companion is required"],placeholder:"Select companion",label:"Choose companion"},null,8,["modelValue","options","rules"])):g("",!0)]),e("div",Vt,[l(b,{modelValue:t.form.start_date,"onUpdate:modelValue":o[2]||(o[2]=n=>t.form.start_date=n),placeholder:"Choose start date",rules:[n=>n||"Start date is required"],label:"Start Date"},null,8,["modelValue","rules"]),l(b,{modelValue:t.form.end_date,"onUpdate:modelValue":o[3]||(o[3]=n=>t.form.end_date=n),placeholder:"Choose End date",rules:[n=>n||"End date is required"],label:"End  Date"},null,8,["modelValue","rules"])]),e("div",bt,[l(y,{modelValue:t.form.description,"onUpdate:modelValue":o[4]||(o[4]=n=>t.form.description=n),"max-length":"125",label:"Short text about something",counter:"","required-mark":"",rules:[n=>n&&n.length>0||"Required",n=>n&&n.length<125]},null,8,["modelValue","rules"])]),e("div",yt,[l(v,{disabled:!t.isValidForm,onClick:o[5]||(o[5]=n=>t.validateForm()&&t.onSubmit())},{default:s(()=>o[7]||(o[7]=[r(" Submit")])),_:1},8,["disabled"])])]),_:1},512)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["loading"])}const kt=q(gt,[["render",vt],["__scopeId","data-v-ba34a00f"]]),It=B({components:{ContractDetails:Ct,ContractForm:kt},data(){const t=[{icon:"feed",title:"Main Hunter's ",content:"main_hunters_contracts"},{icon:"feed",title:"Componions ",content:"componions_contracts"}];return{columns:[{key:"contract_number",sortable:!0},{key:"client_name",sortable:!0},{key:"start_date",sortable:!0},{key:"end_date",sortable:!0},{key:"created_at",sortable:!0},{key:"actions",label:"Actions"}],downloadPdf:G,item:null,showDetails:!1,showAddContractForm:!1,tabs:t,value:t[0].title}},computed:{...M(F,["contracts","loadingContracts"]),currentTab(){return this.tabs.find(({title:t})=>t===this.value)}},mounted(){this.getContracts()},methods:{...S(F,["getContracts"]),viewContract(t){this.item=t,this.showDetails=!0,this.showAddContractForm=!1},gotBack(){this.getContracts(),this.showDetails=!1,this.showAddContractForm=!1},toggleAddSalesInquiriesForm(){this.showDetails=!1,this.showAddContractForm=!this.showAddContractForm}}}),Tt={class:"flex flex-col md:flex-row gap-2 mb-2 justify-between px-4 py-2"},ht={class:"flex flex-col md:flex-row gap-2 justify-start"};function wt(t,o,_,V,T,h){const u=a("VaButton"),C=a("VaButtonGroup"),f=a("VaIcon"),p=a("VaTab"),b=a("VaCardTitle"),y=a("VaDataTable"),v=a("VaCardContent"),k=a("VaCard"),w=a("VaTabs"),A=a("ContractForm"),N=a("ContractDetails");return m(),c(k,null,{default:s(()=>[l(v,null,{default:s(()=>[e("div",Tt,[e("div",ht,[t.showDetails||t.showAddContractForm?(m(),c(u,{key:0,class:"px-2 py-2",icon:"arrow_back",size:"small",onClick:o[0]||(o[0]=i=>t.gotBack())},{default:s(()=>o[4]||(o[4]=[r(" Go Back ")])),_:1})):g("",!0)]),!t.showAddContractForm&&!t.showDetails?(m(),c(C,{key:0},{default:s(()=>[l(u,{class:"px-2 py-2",color:"primary",label:"Add New Quota",round:"",present:"secondary","border-color":"primary",icon:"add",size:"small",onClick:o[1]||(o[1]=i=>t.toggleAddSalesInquiriesForm())},{default:s(()=>o[5]||(o[5]=[r("Create Contract")])),_:1})]),_:1})):g("",!0)]),t.showDetails?(m(),c(N,{key:1,"contract-item":t.item},null,8,["contract-item"])):(m(),I(D,{key:0},[t.showAddContractForm?(m(),c(A,{key:1})):(m(),c(w,{key:0,modelValue:t.value,"onUpdate:modelValue":o[3]||(o[3]=i=>t.value=i),vertical:"",grow:""},{tabs:s(()=>[(m(!0),I(D,null,j(t.tabs,i=>(m(),c(p,{key:i.title,name:i.title,class:"px-4 py-2",onClick:o[2]||(o[2]=n=>t.getContracts(t.currentTab.content==="componions_contracts"?"COMPANION_HUNTER":"MAIN_HUNTER"))},{default:s(()=>[l(f,{name:i.icon,size:"small",class:"mr-2"},null,8,["name"]),r(" "+d(i.title),1)]),_:2},1032,["name"]))),128))]),default:s(()=>[l(k,{square:"",outlined:"",stripe:!1},{default:s(()=>[l(b,null,{default:s(()=>[l(f,{name:t.currentTab.icon,size:"small",class:"mr-2",color:"background-element"},null,8,["name"]),r(" "+d(t.currentTab.title),1)]),_:1}),l(v,null,{default:s(()=>[t.currentTab.content==="main_hunters_contracts"?(m(),c(y,{key:0,items:t.contracts,columns:t.columns,loading:t.loadingContracts},{"cell(actions)":s(({rowData:i})=>[l(u,{preset:"plain",icon:"download",onClick:n=>t.downloadPdf(i.pdf)},null,8,["onClick"]),l(u,{preset:"plain",icon:"visibility",onClick:n=>t.viewContract(i.selfitem)},null,8,["onClick"])]),_:1},8,["items","columns","loading"])):g("",!0),t.currentTab.content==="componions_contracts"?(m(),c(y,{key:1,items:t.contracts,columns:t.columns,loading:t.loadingContracts},{"cell(actions)":s(({rowData:i})=>[l(u,{preset:"plain",icon:"download",onClick:n=>t.downloadPdf(i.pdf)},null,8,["onClick"]),l(u,{preset:"plain",icon:"visibility",onClick:n=>t.viewContract(i.selfitem)},null,8,["onClick"])]),_:1},8,["items","columns","loading"])):g("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]))],64))]),_:1})]),_:1})}const Et=q(It,[["render",wt]]);export{Et as default};
//# sourceMappingURL=Contracts-BerUybOe.js.map
