{"version":3,"file":"Login-ChEVCJHP.js","sources":["../../src/pages/auth/Login.vue"],"sourcesContent":["<template>\n  <BootstrapForm ref=\"form\" @keydown.enter=\"validateForm() && submit()\">\n    <h1 class=\"h3 mb-4\">Log in</h1>\n    <p class=\"mb-4\">\n      Bushman\n      <RouterLink :to=\"{ name: 'signup' }\" class=\"text-primary\">Sign up</RouterLink>\n    </p>\n    <BootstrapInput\n      v-model=\"formData.email\"\n      :rules=\"[validators.required, validators.email]\"\n      label=\"Email\"\n      type=\"email\"\n    />\n    <BootstrapInput\n      v-model=\"formData.password\"\n      :rules=\"[validators.required]\"\n      :type=\"isPasswordVisible ? 'text' : 'password'\"\n      label=\"Password\"\n    >\n      <template #appendInner>\n        <button class=\"btn btn-outline-secondary\" type=\"button\" @click=\"isPasswordVisible = !isPasswordVisible\">\n          <i class=\"material-icons\" style=\"font-size: 18px\">\n            {{ isPasswordVisible ? 'visibility_off' : 'visibility' }}\n          </i>\n        </button>\n      </template>\n    </BootstrapInput>\n\n    <div class=\"d-flex flex-column flex-sm-row justify-content-between align-items-start mb-3\">\n      <BootstrapCheckbox v-model=\"formData.keepLoggedIn\" label=\"Keep me signed in on this device\" />\n      <RouterLink :to=\"{ name: 'recover-password' }\" class=\"text-primary mt-2 mt-sm-0\"> Forgot password? </RouterLink>\n    </div>\n\n    <div class=\"d-flex justify-content-center mt-4\">\n      <BootstrapButton :loading=\"loading\" :disabled=\"!isValidForm\" class=\"w-100\" @click=\"validateForm() && submit()\">\n        Login\n      </BootstrapButton>\n    </div>\n  </BootstrapForm>\n</template>\n\n<script lang=\"ts\" setup>\nimport { reactive, ref } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { useToast } from '@/composables/useToast'\nimport { validators } from '../../services/utils'\nimport axios from 'axios'\nimport BootstrapForm from '@/components/bootstrap/Form.vue'\nimport BootstrapInput from '@/components/bootstrap/Input.vue'\nimport BootstrapButton from '@/components/bootstrap/Button.vue'\nimport BootstrapCheckbox from '@/components/bootstrap/Checkbox.vue'\n\nconst form = ref()\nconst { push } = useRouter()\nconst { init } = useToast()\nconst loading = ref(false)\nconst isPasswordVisible = ref(false)\n\nconst formData = reactive({\n  email: '',\n  password: '',\n  keepLoggedIn: false,\n})\n\n// Simple validation\nconst isValidForm = ref(true)\n\nconst validateForm = (): boolean => {\n  let valid = true\n\n  if (!formData.email) {\n    valid = false\n  }\n  if (!formData.password) {\n    valid = false\n  }\n\n  // Validate email format\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/\n  if (formData.email && !emailRegex.test(formData.email)) {\n    valid = false\n  }\n\n  isValidForm.value = valid\n  return valid\n}\n\nconst submit = async () => {\n  loading.value = true\n\n  try {\n    const loginUrl = import.meta.env.VITE_APP_BASE_URL + import.meta.env.VITE_APP_LOGIN_URL\n    const data = JSON.stringify({\n      username: formData.email,\n      password: formData.password,\n    })\n\n    const config = {\n      method: 'post',\n      maxBodyLength: Infinity,\n      url: loginUrl,\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      data: data,\n    }\n\n    const response = await axios.request(config)\n    if (response.status === 200) {\n      sessionStorage.setItem('access', JSON.stringify(response.data.access))\n      sessionStorage.setItem('refresh', JSON.stringify(response.data.refresh))\n      formData.email = ''\n      formData.password = ''\n      formData.keepLoggedIn = false\n      loading.value = false\n      init({ message: \"You've successfully logged in\", color: 'success' })\n      push({ name: 'dashboard' })\n    }\n  } catch (error: any) {\n    loading.value = false\n    init({ message: error.response?.data?.detail || 'Login failed', color: 'danger' })\n  }\n}\n</script>\n"],"names":["form","ref","push","useRouter","init","useToast","loading","isPasswordVisible","formData","reactive","isValidForm","validateForm","valid","emailRegex","submit","loginUrl","data","config","response","axios","error","_b","_a"],"mappings":"8cAoDA,MAAMA,EAAOC,EAAA,EACP,CAAE,KAAAC,CAAA,EAASC,EAAA,EACX,CAAE,KAAAC,CAAA,EAASC,EAAA,EACXC,EAAUL,EAAI,EAAK,EACnBM,EAAoBN,EAAI,EAAK,EAE7BO,EAAWC,EAAS,CACxB,MAAO,GACP,SAAU,GACV,aAAc,EAAA,CACf,EAGKC,EAAcT,EAAI,EAAI,EAEtBU,EAAe,IAAe,CAClC,IAAIC,EAAQ,GAEPJ,EAAS,QACZI,EAAQ,IAELJ,EAAS,WACZI,EAAQ,IAIV,MAAMC,EAAa,6BACnB,OAAIL,EAAS,OAAS,CAACK,EAAW,KAAKL,EAAS,KAAK,IACnDI,EAAQ,IAGVF,EAAY,MAAQE,EACbA,CACT,EAEME,EAAS,SAAY,SACzBR,EAAQ,MAAQ,GAEhB,GAAI,CACF,MAAMS,EAAW,qFACXC,EAAO,KAAK,UAAU,CAC1B,SAAUR,EAAS,MACnB,SAAUA,EAAS,QAAA,CACpB,EAEKS,EAAS,CACb,OAAQ,OACR,cAAe,IACf,IAAKF,EACL,QAAS,CACP,eAAgB,kBAAA,EAElB,KAAAC,CAAA,EAGIE,EAAW,MAAMC,EAAM,QAAQF,CAAM,EACvCC,EAAS,SAAW,MACtB,eAAe,QAAQ,SAAU,KAAK,UAAUA,EAAS,KAAK,MAAM,CAAC,EACrE,eAAe,QAAQ,UAAW,KAAK,UAAUA,EAAS,KAAK,OAAO,CAAC,EACvEV,EAAS,MAAQ,GACjBA,EAAS,SAAW,GACpBA,EAAS,aAAe,GACxBF,EAAQ,MAAQ,GAChBF,EAAK,CAAE,QAAS,gCAAiC,MAAO,UAAW,EACnEF,EAAK,CAAE,KAAM,YAAa,EAE9B,OAASkB,EAAY,CACnBd,EAAQ,MAAQ,GAChBF,EAAK,CAAE,UAASiB,GAAAC,EAAAF,EAAM,WAAN,YAAAE,EAAgB,OAAhB,YAAAD,EAAsB,SAAU,eAAgB,MAAO,SAAU,CACnF,CACF"}