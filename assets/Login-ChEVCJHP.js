import{d as L,z as m,ac as I,A as _,a as $,w as i,$ as S,ad as B,e as l,b as n,i as u,r as C,I as p,ae as w,t as N,af as j,ag as F,k as R,ah as U,o as q}from"./index-Dg6zTblr.js";import{v as g}from"./utils-BWc0LXoO.js";const J={class:"mb-4"},K={class:"material-icons",style:{"font-size":"18px"}},O={class:"d-flex flex-column flex-sm-row justify-content-between align-items-start mb-3"},T={class:"d-flex justify-content-center mt-4"},P=L({__name:"Login",setup(h){const x=m(),{push:k}=I(),{init:c}=U(),r=m(!1),d=m(!1),s=_({email:"",password:"",keepLoggedIn:!1}),v=m(!0),y=()=>{let t=!0;s.email||(t=!1),s.password||(t=!1);const e=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return s.email&&!e.test(s.email)&&(t=!1),v.value=t,t},b=async()=>{var t,e;r.value=!0;try{const o="https://backend-bushman-master-kxhmlj.laravel.cloud/api/v1.0/authentication/login/",a=JSON.stringify({username:s.email,password:s.password}),V={method:"post",maxBodyLength:1/0,url:o,headers:{"Content-Type":"application/json"},data:a},f=await R.request(V);f.status===200&&(sessionStorage.setItem("access",JSON.stringify(f.data.access)),sessionStorage.setItem("refresh",JSON.stringify(f.data.refresh)),s.email="",s.password="",s.keepLoggedIn=!1,r.value=!1,c({message:"You've successfully logged in",color:"success"}),k({name:"dashboard"}))}catch(o){r.value=!1,c({message:((e=(t=o.response)==null?void 0:t.data)==null?void 0:e.detail)||"Login failed",color:"danger"})}};return(t,e)=>{const o=C("RouterLink");return q(),$(B,{ref_key:"form",ref:x,onKeydown:e[5]||(e[5]=S(a=>y()&&b(),["enter"]))},{default:i(()=>[e[10]||(e[10]=l("h1",{class:"h3 mb-4"},"Log in",-1)),l("p",J,[e[7]||(e[7]=u(" Bushman ")),n(o,{to:{name:"signup"},class:"text-primary"},{default:i(()=>e[6]||(e[6]=[u("Sign up")])),_:1})]),n(w,{modelValue:s.email,"onUpdate:modelValue":e[0]||(e[0]=a=>s.email=a),rules:[p(g).required,p(g).email],label:"Email",type:"email"},null,8,["modelValue","rules"]),n(w,{modelValue:s.password,"onUpdate:modelValue":e[2]||(e[2]=a=>s.password=a),rules:[p(g).required],type:d.value?"text":"password",label:"Password"},{appendInner:i(()=>[l("button",{class:"btn btn-outline-secondary",type:"button",onClick:e[1]||(e[1]=a=>d.value=!d.value)},[l("i",K,N(d.value?"visibility_off":"visibility"),1)])]),_:1},8,["modelValue","rules","type"]),l("div",O,[n(j,{modelValue:s.keepLoggedIn,"onUpdate:modelValue":e[3]||(e[3]=a=>s.keepLoggedIn=a),label:"Keep me signed in on this device"},null,8,["modelValue"]),n(o,{to:{name:"recover-password"},class:"text-primary mt-2 mt-sm-0"},{default:i(()=>e[8]||(e[8]=[u(" Forgot password? ")])),_:1})]),l("div",T,[n(F,{loading:r.value,disabled:!v.value,class:"w-100",onClick:e[4]||(e[4]=a=>y()&&b())},{default:i(()=>e[9]||(e[9]=[u(" Login ")])),_:1},8,["loading","disabled"])])]),_:1},512)}}});export{P as default};
//# sourceMappingURL=Login-ChEVCJHP.js.map
