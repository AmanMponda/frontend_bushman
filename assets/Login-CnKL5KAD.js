import{d as B,a4 as F,s as N,B as S,a as h,w as l,W as U,i as a,e as u,b as t,h as p,u as r,X as j,k as q,o as J}from"./index-D6QR9FQk.js";import{u as K}from"./useForm-Dub-z-kP.js";import{u as O}from"./useToast-BcBMeA7k.js";import{v as f}from"./utils-BWc0LXoO.js";const R={class:"text-base mb-4 leading-5"},T={class:"auth-layout__options flex flex-col sm:flex-row items-start sm:items-center justify-between"},$={class:"flex justify-center mt-4"},X=B({__name:"Login",setup(A){const{isValid:y,validate:c,resetValidation:b,reset:x}=K("form"),{push:_}=F(),{init:g}=O(),i=N(!1),o=S({email:"",password:"",keepLoggedIn:!1}),V=async()=>{i.value=!0;try{const m="http://localhost:8000/api/v1.0/authentication/login/",e=JSON.stringify({username:o.email,password:o.password}),d={method:"post",maxBodyLength:1/0,url:m,headers:{"Content-Type":"application/json"},data:e},n=await q.request(d);n.status===200&&(sessionStorage.setItem("access",JSON.stringify(n.data.access)),sessionStorage.setItem("refresh",JSON.stringify(n.data.refresh)),x(),b(),i.value=!1,g({message:"You've successfully logged in",color:"success"}),_({name:"dashboard"}))}catch(m){i.value=!1,g({message:m.response.data.detail,color:"danger"})}};return(m,e)=>{const d=a("RouterLink"),n=a("VaInput"),w=a("VaIcon"),k=a("VaValue"),I=a("VaCheckbox"),C=a("VaButton"),L=a("VaForm");return J(),h(L,{ref:"form",onKeydown:e[4]||(e[4]=U(s=>r(c)()&&V(),["enter"]))},{default:l(()=>[e[9]||(e[9]=u("h1",{class:"font-semibold text-4xl mb-4"},"Log in",-1)),u("p",R,[e[6]||(e[6]=p(" Bushman ")),t(d,{to:{name:"signup"},class:"font-semibold text-primary"},{default:l(()=>e[5]||(e[5]=[p("Sign up")])),_:1})]),t(n,{modelValue:o.email,"onUpdate:modelValue":e[0]||(e[0]=s=>o.email=s),rules:[r(f).required,r(f).email],class:"mb-4",label:"Email",type:"email"},null,8,["modelValue","rules"]),t(k,{"default-value":!1},{default:l(s=>[t(n,{modelValue:o.password,"onUpdate:modelValue":e[1]||(e[1]=v=>o.password=v),rules:[r(f).required],type:s.value?"text":"password",class:"mb-4",label:"Password",onClickAppendInner:j(v=>s.value=!s.value,["stop"])},{appendInner:l(()=>[t(w,{name:s.value?"mso-visibility_off":"mso-visibility",class:"cursor-pointer",color:"secondary"},null,8,["name"])]),_:2},1032,["modelValue","rules","type","onClickAppendInner"])]),_:1}),u("div",T,[t(I,{modelValue:o.keepLoggedIn,"onUpdate:modelValue":e[2]||(e[2]=s=>o.keepLoggedIn=s),class:"mb-2 sm:mb-0",label:"Keep me signed in on this device"},null,8,["modelValue"]),t(d,{to:{name:"recover-password"},class:"mt-2 sm:mt-0 sm:ml-1 font-semibold text-primary"},{default:l(()=>e[7]||(e[7]=[p(" Forgot password? ")])),_:1})]),u("div",$,[t(C,{loading:i.value,disabled:!r(y),class:"w-full",onClick:e[3]||(e[3]=s=>r(c)()&&V())},{default:l(()=>e[8]||(e[8]=[p(" Login")])),_:1},8,["loading","disabled"])])]),_:1},512)}}});export{X as default};
//# sourceMappingURL=Login-CnKL5KAD.js.map
