import{d as U,p as N,h as p,e as s,s as $,t as m,b as o,r as u,a as I,w as l,i as b,E as M,F as S,g as O,o as i,l as B,k as z,q as D,j,m as T,G as Q}from"./index-Dg6zTblr.js";import{u as E,P as H}from"./ProposalView-BQM6_c6S.js";import{u as R}from"./useToast-Bi2Ekdco.js";import{u as L}from"./useForm-DyYUDtxi.js";import{f as A}from"./format-Cn4G_mmc.js";import"./settings-store-D7r1TkyV.js";const Z=U({name:"PipelineCard",props:{item:{type:Object,required:!0}},emits:["click","create-proposal","view","edit"],computed:{formatDateRange(){const e=this.item.hunting_details;if(!(e!=null&&e.start_date))return"N/A";const t=h=>{try{return new Date(h).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return h}},c=t(e.start_date),d=e.end_date?t(e.end_date):"",n=e.no_of_days?` (${e.no_of_days}d)`:"";return d?`${c} - ${d}${n}`:`${c}${n}`}},methods:{handleClick(){this.$emit("click",this.item)},truncateSpecies(e){return e?e.length>30?e.substring(0,30)+"...":e:"N/A"},formatCurrency(e){return e?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e):"$0"}}}),G={class:"card-header"},J={class:"inquiry-code"},K={class:"client-info"},W={class:"client-name"},X={class:"client-meta"},Y={class:"hunting-details"},x={class:"detail-row"},ee={class:"detail-text truncate"},te={class:"detail-row"},se={class:"detail-text"},oe={class:"detail-row"},ne={class:"detail-text"},ae={key:0,class:"detail-row amount-row"},ie={class:"detail-text amount"},le={key:1,class:"detail-row"},re={class:"detail-text"},de={key:0,class:"agent-info"},ue={class:"agent-name"},pe={class:"card-actions"};function me(e,t,c,d,n,h){var w,f,g,v,C;const y=u("VaIcon"),_=u("VaButton");return i(),p("div",{class:O(["pipeline-card",{"is-new":e.item.type==="inquiry"}]),onClick:t[3]||(t[3]=(...V)=>e.handleClick&&e.handleClick(...V))},[s("div",G,[s("span",J,m(e.item.code),1)]),s("div",K,[s("h4",W,m(((w=e.item.client)==null?void 0:w.full_name)||"Unknown Client"),1),s("p",X,m(((f=e.item.client)==null?void 0:f.country)||"N/A")+" â€¢ "+m(e.item.created_date_formatted||e.item.created_date),1)]),s("div",Y,[s("div",x,[o(y,{name:"pets",size:"small",color:"secondary"}),s("span",ee,m(e.truncateSpecies((g=e.item.hunting_details)==null?void 0:g.species)),1)]),s("div",te,[o(y,{name:"location_on",size:"small",color:"secondary"}),s("span",se,m(((v=e.item.hunting_details)==null?void 0:v.areas)||"N/A"),1)]),s("div",oe,[o(y,{name:"calendar_today",size:"small",color:"secondary"}),s("span",ne,m(e.formatDateRange),1)]),e.item.type==="proposal"&&e.item.total_amount?(i(),p("div",ae,[o(y,{name:"payments",size:"small",color:"success"}),s("span",ie,m(e.formatCurrency(e.item.total_amount)),1)])):(i(),p("div",le,[o(y,{name:"person",size:"small",color:"secondary"}),s("span",re,m(((C=e.item.hunting_details)==null?void 0:C.no_of_hunters)||0)+" hunter(s)",1)]))]),e.item.sales_agent?(i(),p("div",de,[o(y,{name:"support_agent",size:"small",color:"info"}),s("span",ue,m(e.item.sales_agent.name),1)])):$("",!0),s("div",pe,[e.item.type==="inquiry"?(i(),I(_,{key:0,size:"small",color:"primary",block:"",onClick:t[0]||(t[0]=M(V=>e.$emit("create-proposal",e.item),["stop"]))},{default:l(()=>t[4]||(t[4]=[b(" Create Quotation ")])),_:1})):(i(),p(S,{key:1},[o(_,{size:"small",preset:"secondary",onClick:t[1]||(t[1]=M(V=>e.$emit("view",e.item),["stop"]))},{default:l(()=>t[5]||(t[5]=[b(" View ")])),_:1}),o(_,{size:"small",preset:"plain",color:"info",onClick:t[2]||(t[2]=M(V=>e.$emit("edit",e.item),["stop"]))},{default:l(()=>t[6]||(t[6]=[b(" Edit ")])),_:1})],64))])],2)}const ce=N(Z,[["render",me],["__scopeId","data-v-dafd24fa"]]),ye=U({name:"ProposalForm",props:{proposal:{type:Object,default:null},isEdit:{type:Boolean,default:!1},preselectedInquiry:{type:Object,default:null}},emits:["save","cancel"],setup(){const{validate:e,reset:t}=L("formRef");return{validate:e,reset:t}},data(){return{form:{sales_inquiry_id:null,confirmation_date:new Date,hunting_license:"",remarks:"",status:"pending",installments:[]},salesInquiryOptions:[],loadingInquiries:!1,selectedInquiry:null,dueDaysTypeOptions:[{value:"upon_booking",text:"Upon Booking"},{value:"before_arrival",text:"Days Before Arrival"},{value:"upon_completion",text:"Upon Completion"}],statusOptions:[{value:"pending",text:"Pending"},{value:"provision_sales",text:"Provisional Sale"},{value:"confirmed",text:"Confirmed"},{value:"declined",text:"Declined"},{value:"cancelled",text:"Cancelled"},{value:"completed",text:"Completed"}],defaultInstallments:[{narration:"Deposit Due upon booking",amount_due:5e3,due_days:0,amount_due_type:"fixed",due_days_type:"upon_booking"},{narration:"2nd Deposit Due one year prior",amount_due:1e4,due_days:365,amount_due_type:"fixed",due_days_type:"before_arrival"},{narration:"Final Payment Due 90 days prior",amount_due:15e3,due_days:90,amount_due_type:"fixed",due_days_type:"before_arrival"},{narration:"Trophy Deposit Due 45 days prior",amount_due:2500,due_days:45,amount_due_type:"fixed",due_days_type:"before_arrival"}]}},computed:{...B(E,["saving"]),totalAmount(){return this.form.installments.reduce((e,t)=>e+(Number(t.amount_due)||0),0)},canSubmit(){return this.isEdit?!0:!!this.form.sales_inquiry_id&&this.form.installments.length>0}},mounted(){this.loadNewInquiries(),this.isEdit&&this.proposal?this.populateForm():(this.form.installments=[],this.preselectedInquiry&&this.handlePreselectedInquiry())},methods:{async loadNewInquiries(){var e;this.loadingInquiries=!0;try{const c=await z.get("https://backend-bushman-master-kxhmlj.laravel.cloud/api/v1.0/sales-confirmation/pipeline?stage=new_inquiries");if(c.data.success){const d=((e=c.data.data)==null?void 0:e.new_inquiries)||[];this.salesInquiryOptions=d.map(n=>{var h,y,_,w,f,g,v,C,V,P,a;return{value:n.id,text:`${n.code} - ${((h=n.client)==null?void 0:h.full_name)||"Unknown"}`,subtitle:`${((y=n.hunting_details)==null?void 0:y.areas)||"N/A"} | ${((_=n.hunting_details)==null?void 0:_.no_of_days)||0} days | ${((w=n.hunting_details)==null?void 0:w.no_of_hunters)||0} hunter(s)`,selfItem:{id:n.id,code:n.code,client_name:(f=n.client)==null?void 0:f.full_name,country:(g=n.client)==null?void 0:g.country,area:(v=n.hunting_details)==null?void 0:v.areas,species:(C=n.hunting_details)==null?void 0:C.species,no_of_days:(V=n.hunting_details)==null?void 0:V.no_of_days,no_of_hunters:(P=n.hunting_details)==null?void 0:P.no_of_hunters,season:(a=n.hunting_details)==null?void 0:a.season}}})}}catch(t){console.error("Error loading new inquiries:",t)}finally{this.loadingInquiries=!1}},handlePreselectedInquiry(){var d,n,h,y,_,w,f,g,v,C;const e=this.preselectedInquiry;if(!e)return;this.selectedInquiry={id:e.id,code:e.code,client_name:(d=e.client)==null?void 0:d.full_name,country:(n=e.client)==null?void 0:n.country,area:(h=e.hunting_details)==null?void 0:h.areas,species:(y=e.hunting_details)==null?void 0:y.species,no_of_days:(_=e.hunting_details)==null?void 0:_.no_of_days,no_of_hunters:(w=e.hunting_details)==null?void 0:w.no_of_hunters,season:(f=e.hunting_details)==null?void 0:f.season};const t={value:e.id,text:`${e.code} - ${((g=e.client)==null?void 0:g.full_name)||"Unknown"}`,subtitle:`${((v=e.hunting_details)==null?void 0:v.areas)||"N/A"} | ${((C=e.hunting_details)==null?void 0:C.no_of_days)||0} days`,selfItem:this.selectedInquiry};this.salesInquiryOptions.find(V=>V.value===e.id)||this.salesInquiryOptions.unshift(t),this.form.sales_inquiry_id=t},onInquirySelected(e){e!=null&&e.selfItem?this.selectedInquiry=e.selfItem:this.selectedInquiry=null},populateForm(){var e,t,c,d;this.proposal&&(this.form.confirmation_date=this.proposal.confirmation_date?new Date(this.proposal.confirmation_date):new Date,this.form.hunting_license=this.proposal.hunting_license||"",this.form.remarks=this.proposal.remarks||"",this.form.status=this.proposal.status||"pending",(e=this.proposal.pricing)!=null&&e.installments&&(this.form.installments=this.proposal.pricing.installments.map(n=>({narration:n.narration,amount_due:n.amount_due,due_days:n.due_days,amount_due_type:n.amount_due_type||"fixed",due_days_type:n.due_days_type||"upon_booking"}))),this.proposal.sales_inquiry&&(this.selectedInquiry={id:this.proposal.sales_inquiry.id,code:this.proposal.sales_inquiry.code,client_name:(t=this.proposal.client)==null?void 0:t.full_name,area:(c=this.proposal.hunting_trip)==null?void 0:c.hunting_area,no_of_days:(d=this.proposal.hunting_trip)==null?void 0:d.no_of_days,season:this.proposal.sales_inquiry.season}))},addInstallment(){this.form.installments.push({narration:"",amount_due:0,due_days:null,amount_due_type:"fixed",due_days_type:"upon_booking"})},removeInstallment(e){this.form.installments.splice(e,1)},formatCurrency(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)},async submitForm(){var c;if(!await this.validate())return;const t={confirmation_date:this.form.confirmation_date?A(new Date(this.form.confirmation_date),"yyyy-MM-dd"):A(new Date,"yyyy-MM-dd"),hunting_license:this.form.hunting_license||null,remarks:this.form.remarks||null,installments:this.form.installments.map(d=>{let n=d.due_days_type;typeof n=="object"&&n!==null&&(n=n.value||"upon_booking");let h=d.amount_due_type;return typeof h=="object"&&h!==null&&(h=h.value||"fixed"),{narration:d.narration,amount_due:Number(d.amount_due),due_days:d.due_days?Number(d.due_days):null,amount_due_type:String(h||"fixed"),due_days_type:String(n||"upon_booking")}})};this.isEdit||(t.sales_inquiry_id=((c=this.form.sales_inquiry_id)==null?void 0:c.value)||this.form.sales_inquiry_id),this.isEdit&&(t.status=this.form.status),this.$emit("save",t)}}}),fe={class:"proposal-form"},he={class:"text-2xl font-bold mb-6"},_e={key:0,class:"flex flex-col"},ge={class:"font-semibold"},ve={class:"text-xs text-gray-500"},Ve={key:0,class:"mt-4 p-4 bg-gray-50 rounded-lg"},be={class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm"},we={class:"ml-1 font-medium"},$e={class:"ml-1 font-medium"},Ce={class:"ml-1 font-medium"},qe={class:"ml-1 font-medium"},ke={key:0,class:"mt-2"},Ie={class:"ml-1 font-medium"},Pe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Se={class:"flex items-center gap-2"},De={key:1,class:"text-center text-gray-500 py-4"},Fe={class:"flex justify-between items-start mb-3"},Me={class:"font-semibold text-gray-700"},Ee={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},Ue={key:2,class:"mt-4 p-4 bg-primary rounded-lg text-white"},Ne={class:"flex justify-between items-center"},Ae={class:"text-2xl font-bold"},Be={class:"flex justify-end gap-3 mt-6"};function ze(e,t,c,d,n,h){const y=u("VaIcon"),_=u("VaCardTitle"),w=u("VaAlert"),f=u("VaSelect"),g=u("VaCardContent"),v=u("VaCard"),C=u("VaDateInput"),V=u("VaInput"),P=u("VaTextarea"),a=u("VaButton"),k=u("VaForm");return i(),p("div",fe,[s("h2",he,m(e.isEdit?"Edit Quotation":"Create New Quotation"),1),o(k,{ref:"formRef"},{default:l(()=>[e.isEdit?$("",!0):(i(),I(v,{key:0,outlined:"",class:"mb-6"},{default:l(()=>[o(_,{class:"flex items-center gap-2"},{default:l(()=>[o(y,{name:"search",color:"primary"}),t[6]||(t[6]=b(" Select Sales Inquiry "))]),_:1}),o(g,null,{default:l(()=>[o(w,{color:"info",class:"mb-4",border:"left"},{title:l(()=>t[7]||(t[7]=[b("Link to Sales Inquiry")])),default:l(()=>[t[8]||(t[8]=b(" Select a sales inquiry to create a quotation. Client and hunting details will be automatically populated. "))]),_:1}),o(f,{modelValue:e.form.sales_inquiry_id,"onUpdate:modelValue":[t[0]||(t[0]=r=>e.form.sales_inquiry_id=r),e.onInquirySelected],options:e.salesInquiryOptions,loading:e.loadingInquiries,label:"Sales Inquiry",placeholder:"Search and select a sales inquiry...",searchable:"","highlight-matched-text":"",rules:[r=>!!r||"Sales inquiry is required"]},{content:l(({value:r})=>[r?(i(),p("div",_e,[s("span",ge,m(r.text),1),s("span",ve,m(r.subtitle),1)])):$("",!0)]),_:1},8,["modelValue","options","loading","rules","onUpdate:modelValue"]),e.selectedInquiry?(i(),p("div",Ve,[t[14]||(t[14]=s("h4",{class:"font-semibold mb-2"},"Selected Inquiry Details",-1)),s("div",be,[s("div",null,[t[9]||(t[9]=s("span",{class:"text-gray-500"},"Client:",-1)),s("span",we,m(e.selectedInquiry.client_name),1)]),s("div",null,[t[10]||(t[10]=s("span",{class:"text-gray-500"},"Area:",-1)),s("span",$e,m(e.selectedInquiry.area),1)]),s("div",null,[t[11]||(t[11]=s("span",{class:"text-gray-500"},"Days:",-1)),s("span",Ce,m(e.selectedInquiry.no_of_days),1)]),s("div",null,[t[12]||(t[12]=s("span",{class:"text-gray-500"},"Season:",-1)),s("span",qe,m(e.selectedInquiry.season),1)])]),e.selectedInquiry.species?(i(),p("div",ke,[t[13]||(t[13]=s("span",{class:"text-gray-500"},"Species:",-1)),s("span",Ie,m(e.selectedInquiry.species),1)])):$("",!0)])):$("",!0)]),_:1})]),_:1})),o(v,{outlined:"",class:"mb-6"},{default:l(()=>[o(_,{class:"flex items-center gap-2"},{default:l(()=>[o(y,{name:"description",color:"primary"}),t[15]||(t[15]=b(" Quotation Details "))]),_:1}),o(g,null,{default:l(()=>[s("div",Pe,[o(C,{modelValue:e.form.confirmation_date,"onUpdate:modelValue":t[1]||(t[1]=r=>e.form.confirmation_date=r),label:"Confirmation Date",placeholder:"Select date"},null,8,["modelValue"]),o(V,{modelValue:e.form.hunting_license,"onUpdate:modelValue":t[2]||(t[2]=r=>e.form.hunting_license=r),label:"Hunting License",placeholder:"Enter license number (optional)"},null,8,["modelValue"])]),o(P,{modelValue:e.form.remarks,"onUpdate:modelValue":t[3]||(t[3]=r=>e.form.remarks=r),label:"Remarks",placeholder:"Add any additional notes or remarks...",class:"mt-4","min-rows":3},null,8,["modelValue"])]),_:1})]),_:1}),o(v,{outlined:"",class:"mb-6"},{default:l(()=>[o(_,{class:"flex items-center justify-between"},{default:l(()=>[s("div",Se,[o(y,{name:"payments",color:"primary"}),t[16]||(t[16]=b(" Payment Installments "))]),o(a,{preset:"secondary",size:"small",icon:"add",onClick:e.addInstallment},{default:l(()=>t[17]||(t[17]=[b(" Add Installment ")])),_:1},8,["onClick"])]),_:1}),o(g,null,{default:l(()=>[e.form.installments.length===0?(i(),I(w,{key:0,color:"warning",class:"mb-4",border:"left"},{title:l(()=>t[18]||(t[18]=[b("Required")])),default:l(()=>[t[19]||(t[19]=b(" At least one payment installment is required to create a quotation. "))]),_:1})):$("",!0),e.form.installments.length===0?(i(),p("div",De,' No installments added. Click "Add Installment" to create payment schedule. ')):$("",!0),(i(!0),p(S,null,D(e.form.installments,(r,F)=>(i(),p("div",{key:F,class:"installment-row mb-4 p-4 border rounded-lg"},[s("div",Fe,[s("span",Me,"Installment "+m(F+1),1),o(a,{preset:"plain",color:"danger",size:"small",icon:"delete",onClick:q=>e.removeInstallment(F)},null,8,["onClick"])]),s("div",Ee,[o(V,{modelValue:r.narration,"onUpdate:modelValue":q=>r.narration=q,label:"Description",placeholder:"e.g., Deposit Due upon booking",rules:[q=>!!q||"Description is required"]},null,8,["modelValue","onUpdate:modelValue","rules"]),o(V,{modelValue:r.amount_due,"onUpdate:modelValue":q=>r.amount_due=q,label:"Amount (USD)",type:"number",placeholder:"5000",rules:[q=>q>0||"Amount must be greater than 0"]},null,8,["modelValue","onUpdate:modelValue","rules"]),o(f,{modelValue:r.due_days_type,"onUpdate:modelValue":q=>r.due_days_type=q,options:e.dueDaysTypeOptions,label:"Due Type",placeholder:"Select when due","value-by":"value","text-by":"text"},null,8,["modelValue","onUpdate:modelValue","options"]),o(V,{modelValue:r.due_days,"onUpdate:modelValue":q=>r.due_days=q,label:r.due_days_type==="before_arrival"?"Days Before Arrival":"Due Days",type:"number",placeholder:"e.g., 90",disabled:r.due_days_type==="upon_booking"},null,8,["modelValue","onUpdate:modelValue","label","disabled"])])]))),128)),e.form.installments.length>0?(i(),p("div",Ue,[s("div",Ne,[t[20]||(t[20]=s("span",{class:"text-lg font-semibold"},"TOTAL",-1)),s("span",Ae,m(e.formatCurrency(e.totalAmount)),1)])])):$("",!0)]),_:1})]),_:1}),e.isEdit?(i(),I(v,{key:1,outlined:"",class:"mb-6"},{default:l(()=>[o(_,{class:"flex items-center gap-2"},{default:l(()=>[o(y,{name:"flag",color:"primary"}),t[21]||(t[21]=b(" Status "))]),_:1}),o(g,null,{default:l(()=>[o(f,{modelValue:e.form.status,"onUpdate:modelValue":t[4]||(t[4]=r=>e.form.status=r),options:e.statusOptions,label:"Quotation Status",placeholder:"Select status"},null,8,["modelValue","options"])]),_:1})]),_:1})):$("",!0),s("div",Be,[o(a,{preset:"secondary",onClick:t[5]||(t[5]=r=>e.$emit("cancel"))},{default:l(()=>t[22]||(t[22]=[b(" Cancel ")])),_:1}),o(a,{color:"primary",loading:e.saving,disabled:!e.canSubmit,onClick:e.submitForm},{default:l(()=>[b(m(e.isEdit?"Update Quotation":"Create Quotation"),1)]),_:1},8,["loading","disabled","onClick"])])]),_:1},512)])}const Oe=N(ye,[["render",ze],["__scopeId","data-v-d3fd6ab2"]]),je=j("global",{state:()=>({isSidebarMinimized:!1}),actions:{toggleSidebar(){this.isSidebarMinimized=!this.isSidebarMinimized}}}),Te=U({name:"SalesPipeline",components:{PipelineCard:ce,ProposalView:H,ProposalForm:Oe},setup(){const{init:e}=R(),t=je();return{init:e,globalStore:t}},data(){return{seasonFilter:null,seasonOptions:[],showViewModal:!1,showFormModal:!1,editingProposal:null,isEditMode:!1,preselectedInquiry:null}},computed:{...B(E,["pipeline","pipelineCounts","currentProposal","loading","saving"]),counts(){return this.pipelineCounts||{new_inquiries:0,pending:0,provision_sales:0,confirmed:0,cancelled:0,completed:0}},hasData(){return Object.values(this.counts).reduce((e,t)=>e+t,0)>0}},mounted(){this.globalStore.isSidebarMinimized=!0,this.loadPipeline(),this.loadSeasons()},methods:{...T(E,["fetchPipeline","fetchProposalById","createProposal","updateProposal","updateProposalStatus","clearCurrentProposal"]),async loadPipeline(){try{await this.fetchPipeline(void 0,this.seasonFilter||void 0)}catch{this.init({message:"Failed to load pipeline",color:"danger"})}},async loadSeasons(){try{const t=await z.get("https://backend-bushman-master-kxhmlj.laravel.cloud/api/v1.0/settings/seasons");if(t.data){const c=Array.isArray(t.data)?t.data:t.data.data||[];this.seasonOptions=c.map(d=>({value:d.id,text:d.name}))}}catch(e){console.error("Error loading seasons:",e)}},handleCardClick(e){e.type==="proposal"&&this.handleViewProposal(e)},async handleViewProposal(e){try{const t=e.proposal_id||e.confirmation_id;t?(await this.fetchProposalById(t),this.showViewModal=!0):this.init({message:"No quotation found for this item",color:"warning"})}catch{this.init({message:"Failed to load quotation details",color:"danger"})}},handleEditProposal(e){const t=e.proposal_id||e.confirmation_id;t&&this.fetchProposalById(t).then(()=>{this.editingProposal=this.currentProposal,this.isEditMode=!0,this.preselectedInquiry=null,this.showFormModal=!0})},handleEditFromView(){this.showViewModal=!1,this.editingProposal=this.currentProposal,this.isEditMode=!0,this.preselectedInquiry=null,this.showFormModal=!0},handleCreateProposal(e){this.editingProposal=null,this.isEditMode=!1,this.preselectedInquiry=e,this.showFormModal=!0},async handleSaveProposal(e){var t,c,d;try{this.isEditMode&&((t=this.editingProposal)!=null&&t.id)?(await this.updateProposal(this.editingProposal.id,e),this.init({message:"Quotation updated successfully",color:"success"})):(await this.createProposal(e),this.init({message:"Quotation created successfully",color:"success"})),this.showFormModal=!1,this.loadPipeline()}catch(n){this.init({message:((d=(c=n.response)==null?void 0:c.data)==null?void 0:d.message)||"Failed to save quotation",color:"danger"})}},async handleStatusChange(e){try{await this.updateProposalStatus(e.id,e.status),this.init({message:`Proposal status changed to ${e.status}`,color:"success"}),await this.fetchProposalById(e.id),this.loadPipeline()}catch{this.init({message:"Failed to update proposal status",color:"danger"})}}}}),Qe={class:"sales-pipeline-page"},He={class:"pipeline-header"},Re={class:"header-content"},Le={class:"header-actions"},Ze={class:"pipeline-content"},Ge={key:0,class:"loading-container py-8"},Je={key:1,class:"pipeline-columns"},Ke={class:"pipeline-column cancelled-column"},We={class:"column-header",style:{borderColor:"#6b7280"}},Xe={class:"column-title"},Ye={class:"column-content"},xe={key:0,class:"empty-column"},et={class:"pipeline-column"},tt={class:"column-header",style:{borderColor:"#f59e0b"}},st={class:"column-title"},ot={class:"column-content"},nt={key:0,class:"empty-column"},at={class:"pipeline-column merged-quotation"},it={class:"column-header",style:{borderColor:"#f59e0b"}},lt={class:"column-title"},rt={class:"column-content"},dt={key:0,class:"empty-column"},ut={class:"flex justify-end mt-4"};function pt(e,t,c,d,n,h){const y=u("VaSelect"),_=u("VaButton"),w=u("VaProgressBar"),f=u("VaIcon"),g=u("VaBadge"),v=u("PipelineCard"),C=u("ProposalView"),V=u("VaModal"),P=u("ProposalForm");return i(),p("div",Qe,[s("div",He,[s("div",Re,[t[6]||(t[6]=Q('<div class="header-title-section" data-v-c0c0558e><div class="title-icon" data-v-c0c0558e><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-c0c0558e><path d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19ZM7 10H9V17H7V10ZM11 7H13V17H11V7ZM15 13H17V17H15V13Z" fill="currentColor" data-v-c0c0558e></path></svg></div><div data-v-c0c0558e><h1 class="page-title" data-v-c0c0558e>Sales Pipeline</h1><p class="page-subtitle" data-v-c0c0558e>Manage your sales inquiries and quotations</p></div></div>',1)),s("div",Le,[o(y,{modelValue:e.seasonFilter,"onUpdate:modelValue":[t[0]||(t[0]=a=>e.seasonFilter=a),e.loadPipeline],options:e.seasonOptions,placeholder:"All Seasons",class:"season-select",clearable:""},null,8,["modelValue","options","onUpdate:modelValue"]),o(_,{preset:"secondary",icon:"refresh",loading:e.loading,onClick:e.loadPipeline},{default:l(()=>t[5]||(t[5]=[b(" Refresh ")])),_:1},8,["loading","onClick"])])])]),s("div",Ze,[e.loading&&!e.hasData?(i(),p("div",Ge,[o(w,{indeterminate:""}),t[7]||(t[7]=s("p",{class:"text-center mt-4 text-gray-600"},"Loading pipeline...",-1))])):(i(),p("div",Je,[s("div",Ke,[s("div",We,[s("div",Xe,[o(f,{name:"cancel",color:"secondary"}),t[8]||(t[8]=s("span",null,"Cancelled",-1))]),o(g,{text:String(e.counts.cancelled),color:"secondary"},null,8,["text"])]),s("div",Ye,[e.pipeline.cancelled.length===0?(i(),p("div",xe,[o(f,{name:"cancel",size:"2rem",color:"secondary"}),t[9]||(t[9]=s("span",null,"No cancelled items",-1))])):$("",!0),(i(!0),p(S,null,D(e.pipeline.cancelled,a=>(i(),I(v,{key:`cancelled-${a.id}`,item:a,onView:k=>e.handleViewProposal(a),onClick:k=>e.handleCardClick(a)},null,8,["item","onView","onClick"]))),128))])]),s("div",et,[s("div",tt,[s("div",st,[o(f,{name:"fiber_new",color:"warning"}),t[10]||(t[10]=s("span",null,"New Inquiries",-1))]),o(g,{text:String(e.counts.new_inquiries),color:"warning"},null,8,["text"])]),s("div",ot,[e.pipeline.new_inquiries.length===0?(i(),p("div",nt,[o(f,{name:"inbox",size:"2rem",color:"secondary"}),t[11]||(t[11]=s("span",null,"No new inquiries",-1))])):$("",!0),(i(!0),p(S,null,D(e.pipeline.new_inquiries,a=>(i(),I(v,{key:`new-${a.id}`,item:a,onCreateProposal:k=>e.handleCreateProposal(a),onClick:k=>e.handleCardClick(a)},null,8,["item","onCreateProposal","onClick"]))),128))])]),s("div",at,[s("div",it,[s("div",lt,[o(f,{name:"description",color:"warning"}),t[12]||(t[12]=s("span",null,"Quotation / Provision",-1))]),o(g,{text:String(e.counts.pending+e.counts.provision_sales),color:"warning"},null,8,["text"])]),s("div",rt,[e.pipeline.pending.length+e.pipeline.provision_sales.length===0?(i(),p("div",dt,[o(f,{name:"hourglass_empty",size:"2rem",color:"secondary"}),t[13]||(t[13]=s("span",null,"No quotation or provisional sales",-1))])):$("",!0),(i(!0),p(S,null,D([...e.pipeline.pending,...e.pipeline.provision_sales],a=>(i(),I(v,{key:`quoteprov-${a.id}`,item:a,onView:k=>e.handleViewProposal(a),onEdit:k=>e.handleEditProposal(a),onClick:k=>e.handleCardClick(a)},null,8,["item","onView","onEdit","onClick"]))),128))])])])),o(V,{modelValue:e.showViewModal,"onUpdate:modelValue":t[2]||(t[2]=a=>e.showViewModal=a),size:"large","hide-default-actions":!0,title:"Proposal Details"},{default:l(()=>[e.currentProposal?(i(),I(C,{key:0,proposal:e.currentProposal,onEdit:e.handleEditFromView,onStatusChange:e.handleStatusChange},null,8,["proposal","onEdit","onStatusChange"])):$("",!0),s("div",ut,[o(_,{preset:"secondary",onClick:t[1]||(t[1]=a=>e.showViewModal=!1)},{default:l(()=>t[14]||(t[14]=[b("Close")])),_:1})])]),_:1},8,["modelValue"]),o(V,{modelValue:e.showFormModal,"onUpdate:modelValue":t[4]||(t[4]=a=>e.showFormModal=a),size:"large","hide-default-actions":!0,title:e.isEditMode?"Edit Quotation":"Create Quotation"},{default:l(()=>[o(P,{proposal:e.editingProposal,"is-edit":e.isEditMode,"preselected-inquiry":e.preselectedInquiry,onSave:e.handleSaveProposal,onCancel:t[3]||(t[3]=a=>e.showFormModal=!1)},null,8,["proposal","is-edit","preselected-inquiry","onSave"])]),_:1},8,["modelValue","title"])])])}const gt=N(Te,[["render",pt],["__scopeId","data-v-c0c0558e"]]);export{gt as default};
//# sourceMappingURL=SalesPipeline-BEmqRs_O.js.map
