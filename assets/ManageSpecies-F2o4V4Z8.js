import{u as k}from"./quota-store-Ch_FUFDF.js";import{j as N,k as F,d as B,m as S,B as C,s as h,_ as I,a as u,w as r,e as l,g as T,b as a,v as q,i as n,h as f,o as p}from"./index-CepPxMNg.js";import{u as M}from"./useForm-C2zo2Lif.js";import{u as O}from"./useToast-MdJILhkk.js";import{M as $}from"./ModuleTable-B8P1NSrO.js";import{h as L}from"./errorHandler-DijQ3xmc.js";import"./format-Cn4G_mmc.js";const j=N("species-store",{state:()=>({itemsByHuntingType:[],logo:""}),actions:{async createSpecies(e){const s="https://backend-bushman-master-kxhmlj.laravel.cloud/api/v1.0/settings/species/",t=JSON.stringify({name:e.name,type:e.type,scientific_name:e.scientific_name,description:e.description}),i={method:"post",maxBodyLength:1/0,url:s,headers:{"Content-Type":"application/json",Authorization:"Bearer undefined"},data:t};return await F.request(i)}}}),A={name:"",start_date:null,end_date:null},D=B({name:"QuotaPage",components:{ModuleTable:$},setup(){const e=h(null),s=h(null),t=[{key:"id",sortable:!0,sortingOptions:["desc","asc"]},{key:"name",sortable:!0},{key:"scientific_name",sortable:!0},{key:"type",sortable:!0}],{isValid:i,validate:c,resetValidation:m,reset:d}=M(s);return{isValidSForm:i,validateSForm:c,resetValidationSForm:m,resetSForm:d,formRef:e,sformRef:s,columns:t}},data(){const e=[],s=C({id:null,name:"",type:null,scientific_name:"",description:""}),t=[{value:"MAIN",text:"Main Species"},{value:"NORMAL",text:"Normal Species"}],i=[];return{items:e,editedItemId:null,editedItem:null,createdItem:{...A},toast:O(),sform:s,speciesOptions:[],areasOptions:[],speciesObjects:[],showModal:!1,quotasOptions:i,showSpeciesList:!0,quotaItems:[],excellFile:[],loading:!1,saving:!1,TYPES:t}},mounted(){this.getSpeciesItems()},methods:{...S(k,["getSpeciesList"]),...S(j,["createSpecies"]),showSpecies(e){console.log(e.id),this.showSpeciesList=!this.showSpeciesList},deleteFromStorage(e){this.speciesObjects.splice(e,1),console.log("Species item deleted:",e)},async addNewSpecies(){this.saving=!0;const e={name:this.sform.name,type:this.sform.type.value,scientific_name:this.sform.scientific_name,description:this.sform.description};try{const s=await this.createSpecies(e);s.status===201&&(this.saving=!1,this.toast.init({message:s.data.message,color:"success"}),this.resetSForm(),this.getSpeciesItems())}catch(s){this.saving=!1;const t=L(s.response||s);console.log("Caught errors:",t);const i=t.length>0?`
`+t.map((c,m)=>`${m+1}. ${c}`).join(`
`):"An unexpected error occurred. Please try again later.";this.toast.init({message:i,color:"danger"})}},formatDate(e){const s=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0");return`${s}-${t}-${i}`},async getSpeciesItems(){var e;try{this.loading=!0;const s=await this.getSpeciesList();s.status===200?(this.items=(e=s==null?void 0:s.data)==null?void 0:e.map(t=>({id:t.id,name:t.name,type:t.type,scientific_name:t.scientific_name})),this.loading=!1):(this.loading=!1,this.toast.init({message:"Failed to fetch species items",color:"danger"}))}catch(s){this.loading=!1,console.log(s)}}}}),E={class:"flex flex-col md:flex-row gap-2 mb-2 justify-between"},P={class:"flex flex-col md:flex-row gap-2 justify-start"},R={key:1,class:"p-2"},U={class:"grid grid-cols-1 md:grid-cols-1 lg:grid-cols-3 gap-6 mb-4"},z={class:"mb-4 grid grid-cols-1 md:grid-cols-1"},G={class:"mb-4 grid grid-cols-1 md:grid-cols-1"},Q={class:"mb-6"};function Y(e,s,t,i,c,m){const d=n("VaButton"),y=n("VaButtonGroup"),V=n("ModuleTable"),g=n("VaInput"),b=n("VaSelect"),v=n("VaTextarea"),w=n("VaForm"),_=n("VaCard");return p(),u(_,{class:"p-6"},{default:r(()=>[l("div",E,[l("div",P,[e.showSpeciesList?q("",!0):(p(),u(d,{key:0,size:"small",class:"px-2",icon:"arrow_back",onClick:e.showSpecies},{default:r(()=>s[5]||(s[5]=[f(" Go Back ")])),_:1},8,["onClick"]))]),a(y,null,{default:r(()=>[a(d,{class:"px-2 py-2",color:"primary",label:"Add New Quota",icon:"add",size:"small",onClick:e.showSpecies},{default:r(()=>s[6]||(s[6]=[f("Add a new species")])),_:1},8,["onClick"])]),_:1})]),e.showSpeciesList?(p(),u(V,{key:0,items:e.items,columns:e.columns,loading:e.loading,onOnView:e.showSpecies},null,8,["items","columns","loading","onOnView"])):(p(),T("div",R,[a(w,{ref:"sformRef",class:"mb-6"},{default:r(()=>[l("div",U,[a(g,{modelValue:e.sform.name,"onUpdate:modelValue":s[0]||(s[0]=o=>e.sform.name=o),label:"Species Name",placeholder:"Enter Species Name",rules:[o=>!!o||"Species Name is required"],required:""},null,8,["modelValue","rules"]),a(g,{modelValue:e.sform.scientific_name,"onUpdate:modelValue":s[1]||(s[1]=o=>e.sform.scientific_name=o),label:"Scientific Name",placeholder:"Select Scientific Name",rules:[o=>!!o||"Scientific Name is required"],required:""},null,8,["modelValue","rules"]),l("div",z,[a(b,{modelValue:e.sform.type,"onUpdate:modelValue":s[2]||(s[2]=o=>e.sform.type=o),label:"Type",options:e.TYPES,rules:[o=>!!o||"Type is required"],"required-mark":""},null,8,["modelValue","options","rules"])])]),l("div",G,[a(v,{modelValue:e.sform.description,"onUpdate:modelValue":s[3]||(s[3]=o=>e.sform.description=o),label:"Description",placeholder:"Enter Description",rules:[o=>!!o||"Description is required"],required:""},null,8,["modelValue","rules"])])]),_:1},512),l("div",Q,[a(d,{disabled:!e.isValidSForm,color:"primary",icon:"save","icon-color":"#fff",onClick:s[4]||(s[4]=o=>e.validateSForm()&&e.addNewSpecies())},{default:r(()=>s[7]||(s[7]=[f(" Save ")])),_:1},8,["disabled"])])]))]),_:1})}const ee=I(D,[["render",Y]]);export{ee as default};
//# sourceMappingURL=ManageSpecies-F2o4V4Z8.js.map
