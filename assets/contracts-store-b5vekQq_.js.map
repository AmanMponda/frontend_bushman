{"version":3,"file":"contracts-store-b5vekQq_.js","sources":["../../src/stores/contracts-store.ts"],"sourcesContent":["// VITE_APP_SALES_CONFIRMATION_CONTRACT_VSET_URL\n\nimport { defineStore } from 'pinia'\nimport axios from 'axios'\nimport { format } from 'date-fns'\nimport { formatDateTime } from '../services/utils'\n\nexport const useContractsStore = defineStore('sales_contracts', {\n  state: () => {\n    return {\n      contracts: [] as any,\n      loadingContracts: false,\n      permits: [] as any,\n      loadingPermits: false,\n    }\n  },\n\n  actions: {\n    async getContracts(contractorType: string = 'MAIN_HUNTER') {\n      this.loadingContracts = true\n      const url =\n        import.meta.env.VITE_APP_BASE_URL +\n        import.meta.env.VITE_APP_SALES_CONFIRMATION_CONTRACT_VSET_URL +\n        '?contractor_type=' +\n        contractorType\n\n      const config = {\n        method: 'get',\n        maxBodyLength: Infinity,\n        url: url,\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      }\n      try {\n        const response = await axios.request(config)\n\n        if (response.status === 200) {\n          this.contracts = response.data.map((contract: any) => {\n            return {\n              contract_number: contract.contract_number,\n              start_date: formatDateTime(contract.start_date),\n              end_date: formatDateTime(contract.end_date),\n              created_at: formatDateTime(contract.created_at),\n              client_name: contract?.sales_confirmation_proposal?.sales_inquiry?.entity?.full_name,\n              pdf: contract.pdf,\n              selfitem: contract,\n            }\n          })\n          this.loadingContracts = false\n          return response\n        }\n        console.log(this.contracts)\n        return response\n      } catch (error) {\n        this.loadingContracts = false\n        console.log(error)\n        return error\n      }\n    },\n\n    async getContractPermits() {\n      const url = import.meta.env.VITE_APP_BASE_URL + import.meta.env.VITE_APP_ENTITY_CONTRACT_PERMIT_VSET_URL\n      const config = {\n        method: 'get',\n        maxBodyLength: Infinity,\n        url: url,\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      }\n      const response = await axios.request(config)\n\n      if (response.status === 200) {\n        this.permits = response.data.map((permit: any) => {\n          return {\n            permit_number: permit.permit_number,\n            issued_date: formatDateTime(permit.issued_date),\n            description: permit.description,\n            start_date: formatDateTime(permit.dates[0].start_date),\n            expiry_date: formatDateTime(permit.dates[0].end_date),\n            updated_at: formatDateTime(permit.updated_at),\n            entity_contract_id: permit.entity_contract_id,\n            package_type: permit.package_type,\n            pdf: permit.pdf,\n            selfitem: permit,\n          }\n        })\n\n        this.loadingPermits = false\n        return response\n      }\n    },\n\n    async createPermit(payload: any) {\n      const url = import.meta.env.VITE_APP_BASE_URL + import.meta.env.VITE_APP_ENTITY_CONTRACT_PERMIT_VSET_URL\n      const data = JSON.stringify({\n        entity_contract_id: payload.entity_contract_id,\n        permit_number: payload.permit_number,\n        issued_date: format(payload.issued_date, 'yyyy-MM-dd'),\n        package_type: payload.package_type,\n        description: payload.description,\n        start_date: format(payload.start_date, 'yyyy-MM-dd'),\n        end_date: format(payload.end_date, 'yyyy-MM-dd'),\n      })\n\n      const config = {\n        method: 'post',\n        maxBodyLength: Infinity,\n        url: url,\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        data: data,\n      }\n\n      const response = await axios.request(config)\n      return response\n    },\n\n    async createContract(payload: any) {\n      const url = import.meta.env.VITE_APP_BASE_URL + import.meta.env.VITE_APP_SALES_CONFIRMATION_CONTRACT_VSET_URL\n\n      const data = JSON.stringify({\n        sales_confirmation_proposal_id: payload.sales_confirmation_proposal_id,\n        entity_id: payload.entity_id,\n        start_date: format(payload.start_date, 'yyyy-MM-dd'),\n        contractor_type: payload.contractor_type,\n        end_date: format(payload.end_date, 'yyyy-MM-dd'),\n        description: 'Updated contract description.',\n      })\n\n      const config = {\n        method: 'post',\n        maxBodyLength: Infinity,\n        url: url,\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        data: data,\n      }\n\n      const response = await axios.request(config)\n\n      return response\n    },\n  },\n})\n"],"names":["useContractsStore","defineStore","contractorType","config","response","axios","contract","formatDateTime","_c","_b","_a","error","permit","payload","url","data","format"],"mappings":"gIAOO,MAAMA,EAAoBC,EAAY,kBAAmB,CAC9D,MAAO,KACE,CACL,UAAW,CAAA,EACX,iBAAkB,GAClB,QAAS,CAAA,EACT,eAAgB,EAAA,GAIpB,QAAS,CACP,MAAM,aAAaC,EAAyB,cAAe,CACzD,KAAK,iBAAmB,GAOxB,MAAMC,EAAS,CACb,OAAQ,MACR,cAAe,IACf,IARA,qIAGAD,EAMA,QAAS,CACP,eAAgB,kBAAA,CAClB,EAEF,GAAI,CACF,MAAME,EAAW,MAAMC,EAAM,QAAQF,CAAM,EAE3C,OAAIC,EAAS,SAAW,KACtB,KAAK,UAAYA,EAAS,KAAK,IAAKE,GAAkB,WACpD,MAAO,CACL,gBAAiBA,EAAS,gBAC1B,WAAYC,EAAeD,EAAS,UAAU,EAC9C,SAAUC,EAAeD,EAAS,QAAQ,EAC1C,WAAYC,EAAeD,EAAS,UAAU,EAC9C,aAAaE,GAAAC,GAAAC,EAAAJ,GAAA,YAAAA,EAAU,8BAAV,YAAAI,EAAuC,gBAAvC,YAAAD,EAAsD,SAAtD,YAAAD,EAA8D,UAC3E,IAAKF,EAAS,IACd,SAAUA,CAAA,CAEd,CAAC,EACD,KAAK,iBAAmB,GACjBF,IAET,QAAQ,IAAI,KAAK,SAAS,EACnBA,EACT,OAASO,EAAO,CACd,YAAK,iBAAmB,GACxB,QAAQ,IAAIA,CAAK,EACVA,CACT,CACF,EAEA,MAAM,oBAAqB,CAEzB,MAAMR,EAAS,CACb,OAAQ,MACR,cAAe,IACf,IAJU,+GAKV,QAAS,CACP,eAAgB,kBAAA,CAClB,EAEIC,EAAW,MAAMC,EAAM,QAAQF,CAAM,EAE3C,GAAIC,EAAS,SAAW,IACtB,YAAK,QAAUA,EAAS,KAAK,IAAKQ,IACzB,CACL,cAAeA,EAAO,cACtB,YAAaL,EAAeK,EAAO,WAAW,EAC9C,YAAaA,EAAO,YACpB,WAAYL,EAAeK,EAAO,MAAM,CAAC,EAAE,UAAU,EACrD,YAAaL,EAAeK,EAAO,MAAM,CAAC,EAAE,QAAQ,EACpD,WAAYL,EAAeK,EAAO,UAAU,EAC5C,mBAAoBA,EAAO,mBAC3B,aAAcA,EAAO,aACrB,IAAKA,EAAO,IACZ,SAAUA,CAAA,EAEb,EAED,KAAK,eAAiB,GACfR,CAEX,EAEA,MAAM,aAAaS,EAAc,CAC/B,MAAMC,EAAM,+GACNC,EAAO,KAAK,UAAU,CAC1B,mBAAoBF,EAAQ,mBAC5B,cAAeA,EAAQ,cACvB,YAAaG,EAAOH,EAAQ,YAAa,YAAY,EACrD,aAAcA,EAAQ,aACtB,YAAaA,EAAQ,YACrB,WAAYG,EAAOH,EAAQ,WAAY,YAAY,EACnD,SAAUG,EAAOH,EAAQ,SAAU,YAAY,CAAA,CAChD,EAEKV,EAAS,CACb,OAAQ,OACR,cAAe,IACf,IAAAW,EACA,QAAS,CACP,eAAgB,kBAAA,EAElB,KAAAC,CAAA,EAIF,OADiB,MAAMV,EAAM,QAAQF,CAAM,CAE7C,EAEA,MAAM,eAAeU,EAAc,CACjC,MAAMC,EAAM,oHAENC,EAAO,KAAK,UAAU,CAC1B,+BAAgCF,EAAQ,+BACxC,UAAWA,EAAQ,UACnB,WAAYG,EAAOH,EAAQ,WAAY,YAAY,EACnD,gBAAiBA,EAAQ,gBACzB,SAAUG,EAAOH,EAAQ,SAAU,YAAY,EAC/C,YAAa,+BAAA,CACd,EAEKV,EAAS,CACb,OAAQ,OACR,cAAe,IACf,IAAAW,EACA,QAAS,CACP,eAAgB,kBAAA,EAElB,KAAAC,CAAA,EAKF,OAFiB,MAAMV,EAAM,QAAQF,CAAM,CAG7C,CAAA,CAEJ,CAAC"}