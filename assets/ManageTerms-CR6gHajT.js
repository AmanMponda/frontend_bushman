import{d as z,m as S,s as A,p as _,h as f,b as s,w as l,r as p,e as r,u as h,i as a,a as N,t as m,F as O,o as T}from"./index-ChBN8f7M.js";import{u as U}from"./useForm-DvvDy_4m.js";import{u as R}from"./useToast-pLSG-zsw.js";import{u as q}from"./settings-store-CfSCLwjp.js";import{h as V}from"./errorHandler-DijQ3xmc.js";const L=z({name:"ManageTerms",setup(){const e=A(),t=A(),{validate:i}=U("termFormRef"),{validate:d}=U("termTypeFormRef");return{termFormRef:e,termTypeFormRef:t,validateTermForm:i,validateTermTypeForm:d}},data(){return{activeTab:"terms",termColumns:[{key:"id",label:"ID",sortable:!0},{key:"term_type",label:"Term Type",sortable:!1},{key:"title",label:"Title",sortable:!0},{key:"content",label:"Content",sortable:!1},{key:"order_position",label:"Order",sortable:!0},{key:"created_at",label:"Created",sortable:!0},{key:"actions",label:"Actions",width:120}],termTypeColumns:[{key:"id",label:"ID",sortable:!0},{key:"name",label:"Name",sortable:!0},{key:"description",label:"Description",sortable:!1},{key:"terms_count",label:"Terms Count",sortable:!1},{key:"created_at",label:"Created",sortable:!0},{key:"actions",label:"Actions",width:100}],toast:R(),loadingTerms:!1,savingTerm:!1,deletingTerm:!1,showTermFormModal:!1,showViewModal:!1,showDeleteTermModal:!1,isEditMode:!1,editItemId:null,itemToDelete:null,viewItem:null,selectedTermType:null,terms:[],termForm:{term_type_id:null,title:"",content:"",order_position:0},loadingTermTypes:!1,savingTermType:!1,deletingTermType:!1,showTermTypeFormModal:!1,showDeleteTermTypeModal:!1,isTermTypeEditMode:!1,editTermTypeId:null,termTypeToDelete:null,termTypes:[],termTypeOptions:[],termTypeForm:{name:"",description:""}}},mounted(){this.fetchTermTypes(),this.fetchTerms()},methods:{...S(q,["getTermTypes","getTerms","createTerm","updateTerm","deleteTerm","createTermType","updateTermType","deleteTermType"]),formatDate(e){return e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"},truncateContent(e){return e?e.length>100?e.substring(0,100)+"...":e:""},async fetchTermTypes(){this.loadingTermTypes=!0;try{const e=await this.getTermTypes();e.status===200&&(this.termTypes=e.data,this.termTypeOptions=e.data.map(t=>({value:t.id,text:t.name})))}catch(e){console.error("Error loading term types:",e)}finally{this.loadingTermTypes=!1}},openAddTermTypeModal(){this.isTermTypeEditMode=!1,this.editTermTypeId=null,this.termTypeForm={name:"",description:""},this.showTermTypeFormModal=!0},openEditTermTypeModal(e){this.isTermTypeEditMode=!0,this.editTermTypeId=e.id,this.termTypeForm={name:e.name||"",description:e.description||""},this.showTermTypeFormModal=!0},closeTermTypeFormModal(){this.showTermTypeFormModal=!1,this.termTypeForm={name:"",description:""}},async saveTermTypeForm(){var i,d,g;if(!await this.validateTermTypeForm())return;this.savingTermType=!0;const t={name:this.termTypeForm.name,description:this.termTypeForm.description||null};try{this.isTermTypeEditMode&&this.editTermTypeId?(await this.updateTermType(this.editTermTypeId,t)).status===200&&((i=this.toast)==null||i.init({message:"Term type updated successfully",color:"success"}),this.closeTermTypeFormModal(),this.fetchTermTypes()):(await this.createTermType(t)).status===201&&((d=this.toast)==null||d.init({message:"Term type created successfully",color:"success"}),this.closeTermTypeFormModal(),this.fetchTermTypes())}catch(c){const u=V(c.response);(g=this.toast)==null||g.init({message:u.join(", ")||"Failed to save",color:"danger"})}finally{this.savingTermType=!1}},confirmDeleteTermType(e){this.termTypeToDelete=e,this.showDeleteTermTypeModal=!0},async deleteTermTypeItem(){var e,t;if(this.termTypeToDelete){this.deletingTermType=!0;try{const i=await this.deleteTermType(this.termTypeToDelete.id);(i.status===200||i.status===204)&&((e=this.toast)==null||e.init({message:"Term type deleted successfully",color:"success"}),this.showDeleteTermTypeModal=!1,this.termTypeToDelete=null,this.fetchTermTypes(),this.fetchTerms())}catch(i){const d=V(i.response);(t=this.toast)==null||t.init({message:d.join(", ")||"Failed to delete",color:"danger"})}finally{this.deletingTermType=!1}}},async fetchTerms(){var e,t;this.loadingTerms=!0;try{const i=((e=this.selectedTermType)==null?void 0:e.value)||null,d=await this.getTerms(i);d.status===200&&(this.terms=d.data)}catch{(t=this.toast)==null||t.init({message:"Failed to load terms",color:"danger"})}finally{this.loadingTerms=!1}},openAddTermModal(){this.isEditMode=!1,this.editItemId=null,this.termForm={term_type_id:null,title:"",content:"",order_position:0},this.showTermFormModal=!0},openEditTermModal(e){var t;this.isEditMode=!0,this.editItemId=e.id,this.termForm={term_type_id:e.term_type_id?{value:e.term_type_id,text:((t=e.term_type)==null?void 0:t.name)||""}:null,title:e.title||"",content:e.content||"",order_position:e.order_position||0},this.showTermFormModal=!0},closeTermFormModal(){this.showTermFormModal=!1,this.termForm={term_type_id:null,title:"",content:"",order_position:0}},viewTerm(e){this.viewItem=e,this.showViewModal=!0},editFromView(){this.showViewModal=!1,this.openEditTermModal(this.viewItem)},async saveTermForm(){var i,d,g,c;if(!await this.validateTermForm())return;this.savingTerm=!0;const t={term_type_id:((i=this.termForm.term_type_id)==null?void 0:i.value)||this.termForm.term_type_id,title:this.termForm.title||null,content:this.termForm.content,order_position:this.termForm.order_position||0};try{this.isEditMode&&this.editItemId?(await this.updateTerm(this.editItemId,t)).status===200&&((d=this.toast)==null||d.init({message:"Term updated successfully",color:"success"}),this.closeTermFormModal(),this.fetchTerms()):(await this.createTerm(t)).status===201&&((g=this.toast)==null||g.init({message:"Term created successfully",color:"success"}),this.closeTermFormModal(),this.fetchTerms())}catch(u){const v=V(u.response);(c=this.toast)==null||c.init({message:v.join(", ")||"Failed to save",color:"danger"})}finally{this.savingTerm=!1}},confirmDeleteTerm(e){this.itemToDelete=e,this.showDeleteTermModal=!0},async deleteTermItem(){var e,t;if(this.itemToDelete){this.deletingTerm=!0;try{const i=await this.deleteTerm(this.itemToDelete.id);(i.status===200||i.status===204)&&((e=this.toast)==null||e.init({message:"Term deleted successfully",color:"success"}),this.showDeleteTermModal=!1,this.itemToDelete=null,this.fetchTerms())}catch(i){const d=V(i.response);(t=this.toast)==null||t.init({message:d.join(", ")||"Failed to delete",color:"danger"})}finally{this.deletingTerm=!1}}}}}),P={class:"flex flex-col md:flex-row gap-2 mb-4 justify-between items-center"},G={class:"text-xl font-bold text-gray-700"},H={key:0,class:"mt-4"},J={class:"flex flex-col md:flex-row gap-2 mb-4 justify-between items-center"},K={key:0,class:"text-center py-12"},Q={class:"font-semibold"},W={class:"text-sm text-gray-600 line-clamp-2"},X={class:"text-sm text-gray-600"},Y={class:"flex gap-2"},Z={key:1,class:"mt-4"},x={class:"flex justify-end mb-4"},ee={key:0,class:"text-center py-12"},te={class:"font-semibold"},oe={class:"text-sm text-gray-600"},se={class:"text-sm text-gray-600"},le={class:"flex gap-2"},re={class:"flex gap-2 justify-end"},ie={key:0,class:"space-y-4"},ae={class:"bg-gray-50 rounded-lg p-4"},ne={class:"grid grid-cols-2 gap-4"},me={class:"font-semibold"},de={class:"font-semibold"},pe={key:0},Te={class:"font-semibold text-lg"},ue={class:"bg-white border rounded-lg p-4 max-h-96 overflow-y-auto whitespace-pre-wrap"},ye={class:"text-sm text-gray-400"},fe={class:"flex gap-2 justify-end"},ce={key:0,class:"text-sm text-gray-500 mt-2"},he={class:"flex gap-2 justify-end"},ge={class:"flex gap-2 justify-end"},we={class:"text-red-500 text-sm mt-2"},Ve={key:0,class:"text-sm text-gray-500 mt-2"},ve={key:0},Fe={class:"flex gap-2 justify-end"};function be(e,t,i,d,g,c){const u=p("VaIcon"),v=p("VaDivider"),C=p("VaTab"),B=p("VaTabs"),k=p("VaSelect"),n=p("VaButton"),F=p("VaBadge"),M=p("VaDataTable"),D=p("VaInnerLoading"),j=p("VaCardContent"),$=p("VaCard"),b=p("VaInput"),I=p("VaTextarea"),E=p("VaForm"),w=p("VaModal");return T(),f(O,null,[s($,{class:"manage-terms-page"},{default:l(()=>[s(j,null,{default:l(()=>[r("div",P,[r("h2",G,[s(u,{name:"description",class:"mr-2"}),t[16]||(t[16]=a(" Terms & Conditions "))])]),s(v),s(B,{modelValue:e.activeTab,"onUpdate:modelValue":t[0]||(t[0]=o=>e.activeTab=o),class:"mt-4"},{tabs:l(()=>[s(C,{name:"terms"},{default:l(()=>t[17]||(t[17]=[a("Terms")])),_:1}),s(C,{name:"term-types"},{default:l(()=>t[18]||(t[18]=[a("Term Types")])),_:1})]),_:1},8,["modelValue"]),e.activeTab==="terms"?(T(),f("div",H,[r("div",J,[s(k,{modelValue:e.selectedTermType,"onUpdate:modelValue":[t[1]||(t[1]=o=>e.selectedTermType=o),e.fetchTerms],options:e.termTypeOptions,label:"Filter by Term Type",placeholder:"All Term Types",clearable:"",class:"max-w-xs"},null,8,["modelValue","options","onUpdate:modelValue"]),s(n,{color:"primary",icon:"add",round:"",onClick:e.openAddTermModal},{default:l(()=>t[19]||(t[19]=[a(" Add New Term ")])),_:1},8,["onClick"])]),s(D,{loading:e.loadingTerms},{default:l(()=>[e.terms.length===0&&!e.loadingTerms?(T(),f("div",K,[s(u,{name:"description",size:"4rem",color:"#9B9FB5"}),t[21]||(t[21]=r("p",{class:"text-gray-500 mt-4"},"No terms found.",-1)),s(n,{class:"mt-4",preset:"secondary",onClick:e.openAddTermModal},{default:l(()=>t[20]||(t[20]=[a("Add your first term")])),_:1},8,["onClick"])])):(T(),N(M,{key:1,items:e.terms,columns:e.termColumns,hoverable:"",striped:""},{"cell(term_type)":l(({rowData:o})=>{var y;return[s(F,{text:((y=o.term_type)==null?void 0:y.name)||"N/A",color:"info"},null,8,["text"])]}),"cell(title)":l(({rowData:o})=>[r("span",Q,m(o.title||"No Title"),1)]),"cell(content)":l(({rowData:o})=>[r("span",W,m(e.truncateContent(o.content)),1)]),"cell(order_position)":l(({rowData:o})=>[s(F,{text:String(o.order_position||0),color:"secondary"},null,8,["text"])]),"cell(created_at)":l(({rowData:o})=>[r("span",X,m(e.formatDate(o.created_at)),1)]),"cell(actions)":l(({rowData:o})=>[r("div",Y,[s(n,{preset:"plain",icon:"visibility",color:"info",size:"small",title:"View",onClick:y=>e.viewTerm(o)},null,8,["onClick"]),s(n,{preset:"plain",icon:"edit",color:"warning",size:"small",title:"Edit",onClick:y=>e.openEditTermModal(o)},null,8,["onClick"]),s(n,{preset:"plain",icon:"delete",color:"danger",size:"small",title:"Delete",onClick:y=>e.confirmDeleteTerm(o)},null,8,["onClick"])])]),_:1},8,["items","columns"]))]),_:1},8,["loading"])])):h("",!0),e.activeTab==="term-types"?(T(),f("div",Z,[r("div",x,[s(n,{color:"primary",icon:"add",round:"",onClick:e.openAddTermTypeModal},{default:l(()=>t[22]||(t[22]=[a(" Add New Term Type ")])),_:1},8,["onClick"])]),s(D,{loading:e.loadingTermTypes},{default:l(()=>[e.termTypes.length===0&&!e.loadingTermTypes?(T(),f("div",ee,[s(u,{name:"category",size:"4rem",color:"#9B9FB5"}),t[24]||(t[24]=r("p",{class:"text-gray-500 mt-4"},"No term types found.",-1)),s(n,{class:"mt-4",preset:"secondary",onClick:e.openAddTermTypeModal},{default:l(()=>t[23]||(t[23]=[a("Add your first term type")])),_:1},8,["onClick"])])):(T(),N(M,{key:1,items:e.termTypes,columns:e.termTypeColumns,hoverable:"",striped:""},{"cell(name)":l(({rowData:o})=>[r("span",te,m(o.name),1)]),"cell(description)":l(({rowData:o})=>[r("span",oe,m(o.description||"No description"),1)]),"cell(terms_count)":l(({rowData:o})=>{var y;return[s(F,{text:String(((y=o.terms)==null?void 0:y.length)||0),color:"info"},null,8,["text"])]}),"cell(created_at)":l(({rowData:o})=>[r("span",se,m(e.formatDate(o.created_at)),1)]),"cell(actions)":l(({rowData:o})=>[r("div",le,[s(n,{preset:"plain",icon:"edit",color:"warning",size:"small",title:"Edit",onClick:y=>e.openEditTermTypeModal(o)},null,8,["onClick"]),s(n,{preset:"plain",icon:"delete",color:"danger",size:"small",title:"Delete",onClick:y=>e.confirmDeleteTermType(o)},null,8,["onClick"])])]),_:1},8,["items","columns"]))]),_:1},8,["loading"])])):h("",!0)]),_:1})]),_:1}),s(w,{modelValue:e.showTermFormModal,"onUpdate:modelValue":t[6]||(t[6]=o=>e.showTermFormModal=o),title:e.isEditMode?"Edit Term":"Add New Term","hide-default-actions":"",size:"large"},{footer:l(()=>[r("div",re,[s(n,{preset:"secondary",onClick:e.closeTermFormModal},{default:l(()=>t[25]||(t[25]=[a("Cancel")])),_:1},8,["onClick"]),s(n,{color:"primary",loading:e.savingTerm,onClick:e.saveTermForm},{default:l(()=>[a(m(e.isEditMode?"Update":"Save"),1)]),_:1},8,["loading","onClick"])])]),default:l(()=>[s(E,{ref:"termFormRef",name:"termFormRef",class:"space-y-4"},{default:l(()=>[s(k,{modelValue:e.termForm.term_type_id,"onUpdate:modelValue":t[2]||(t[2]=o=>e.termForm.term_type_id=o),options:e.termTypeOptions,label:"Term Type",placeholder:"Select a term type",rules:[o=>!!o||"Term type is required"],"required-mark":"",loading:e.loadingTermTypes},null,8,["modelValue","options","rules","loading"]),s(b,{modelValue:e.termForm.title,"onUpdate:modelValue":t[3]||(t[3]=o=>e.termForm.title=o),label:"Title (Optional)",placeholder:"Enter term title"},null,8,["modelValue"]),s(I,{modelValue:e.termForm.content,"onUpdate:modelValue":t[4]||(t[4]=o=>e.termForm.content=o),label:"Content",placeholder:"Enter term content",rules:[o=>!!o||"Content is required"],"required-mark":"","min-rows":6,"max-rows":12},null,8,["modelValue","rules"]),s(b,{modelValue:e.termForm.order_position,"onUpdate:modelValue":t[5]||(t[5]=o=>e.termForm.order_position=o),modelModifiers:{number:!0},type:"number",label:"Order Position",placeholder:"Enter order position",min:"0"},null,8,["modelValue"])]),_:1},512)]),_:1},8,["modelValue","title"]),s(w,{modelValue:e.showViewModal,"onUpdate:modelValue":t[8]||(t[8]=o=>e.showViewModal=o),title:"View Term","hide-default-actions":"",size:"large"},{footer:l(()=>[r("div",fe,[s(n,{preset:"secondary",onClick:t[7]||(t[7]=o=>e.showViewModal=!1)},{default:l(()=>t[30]||(t[30]=[a("Close")])),_:1}),s(n,{color:"warning",icon:"edit",onClick:e.editFromView},{default:l(()=>t[31]||(t[31]=[a("Edit")])),_:1},8,["onClick"])])]),default:l(()=>{var o;return[e.viewItem?(T(),f("div",ie,[r("div",ae,[r("div",ne,[r("div",null,[t[26]||(t[26]=r("p",{class:"text-sm text-gray-500"},"Term Type",-1)),r("p",me,m(((o=e.viewItem.term_type)==null?void 0:o.name)||"N/A"),1)]),r("div",null,[t[27]||(t[27]=r("p",{class:"text-sm text-gray-500"},"Order Position",-1)),r("p",de,m(e.viewItem.order_position||0),1)])])]),e.viewItem.title?(T(),f("div",pe,[t[28]||(t[28]=r("p",{class:"text-sm text-gray-500"},"Title",-1)),r("p",Te,m(e.viewItem.title),1)])):h("",!0),r("div",null,[t[29]||(t[29]=r("p",{class:"text-sm text-gray-500 mb-2"},"Content",-1)),r("div",ue,m(e.viewItem.content),1)]),r("div",ye," Created: "+m(e.formatDate(e.viewItem.created_at))+" | Updated: "+m(e.formatDate(e.viewItem.updated_at)),1)])):h("",!0)]}),_:1},8,["modelValue"]),s(w,{modelValue:e.showDeleteTermModal,"onUpdate:modelValue":t[10]||(t[10]=o=>e.showDeleteTermModal=o),"hide-default-actions":""},{header:l(()=>t[32]||(t[32]=[r("h3",{class:"va-h6"},"Confirm Delete",-1)])),footer:l(()=>[r("div",he,[s(n,{preset:"secondary",onClick:t[9]||(t[9]=o=>e.showDeleteTermModal=!1)},{default:l(()=>t[35]||(t[35]=[a("Cancel")])),_:1}),s(n,{color:"danger",loading:e.deletingTerm,onClick:e.deleteTermItem},{default:l(()=>t[36]||(t[36]=[a("Delete")])),_:1},8,["loading","onClick"])])]),default:l(()=>{var o;return[t[37]||(t[37]=r("p",null,"Are you sure you want to delete this term?",-1)),e.itemToDelete?(T(),f("p",ce,[t[33]||(t[33]=r("strong",null,"Type:",-1)),a(" "+m(((o=e.itemToDelete.term_type)==null?void 0:o.name)||"N/A")+" | ",1),t[34]||(t[34]=r("strong",null,"Title:",-1)),a(" "+m(e.itemToDelete.title||"No Title"),1)])):h("",!0)]}),_:1},8,["modelValue"]),s(w,{modelValue:e.showTermTypeFormModal,"onUpdate:modelValue":t[13]||(t[13]=o=>e.showTermTypeFormModal=o),title:e.isTermTypeEditMode?"Edit Term Type":"Add New Term Type","hide-default-actions":"",size:"small"},{footer:l(()=>[r("div",ge,[s(n,{preset:"secondary",onClick:e.closeTermTypeFormModal},{default:l(()=>t[38]||(t[38]=[a("Cancel")])),_:1},8,["onClick"]),s(n,{color:"primary",loading:e.savingTermType,onClick:e.saveTermTypeForm},{default:l(()=>[a(m(e.isTermTypeEditMode?"Update":"Save"),1)]),_:1},8,["loading","onClick"])])]),default:l(()=>[s(E,{ref:"termTypeFormRef",name:"termTypeFormRef",class:"space-y-4"},{default:l(()=>[s(b,{modelValue:e.termTypeForm.name,"onUpdate:modelValue":t[11]||(t[11]=o=>e.termTypeForm.name=o),label:"Name",placeholder:"e.g., Booking Terms, Payment Terms",rules:[o=>!!o||"Name is required"],"required-mark":""},null,8,["modelValue","rules"]),s(I,{modelValue:e.termTypeForm.description,"onUpdate:modelValue":t[12]||(t[12]=o=>e.termTypeForm.description=o),label:"Description (Optional)",placeholder:"Enter description","min-rows":3,"max-rows":6},null,8,["modelValue"])]),_:1},512)]),_:1},8,["modelValue","title"]),s(w,{modelValue:e.showDeleteTermTypeModal,"onUpdate:modelValue":t[15]||(t[15]=o=>e.showDeleteTermTypeModal=o),"hide-default-actions":""},{header:l(()=>t[39]||(t[39]=[r("h3",{class:"va-h6"},"Confirm Delete",-1)])),footer:l(()=>[r("div",Fe,[s(n,{preset:"secondary",onClick:t[14]||(t[14]=o=>e.showDeleteTermTypeModal=!1)},{default:l(()=>t[42]||(t[42]=[a("Cancel")])),_:1}),s(n,{color:"danger",loading:e.deletingTermType,onClick:e.deleteTermTypeItem},{default:l(()=>t[43]||(t[43]=[a("Delete")])),_:1},8,["loading","onClick"])])]),default:l(()=>{var o;return[t[44]||(t[44]=r("p",null,"Are you sure you want to delete this term type?",-1)),r("p",we,[s(u,{name:"warning",size:"small"}),t[40]||(t[40]=a(" This will also delete all terms associated with this type. "))]),e.termTypeToDelete?(T(),f("p",Ve,[t[41]||(t[41]=r("strong",null,"Name:",-1)),a(" "+m(e.termTypeToDelete.name),1),(o=e.termTypeToDelete.terms)!=null&&o.length?(T(),f("span",ve," ("+m(e.termTypeToDelete.terms.length)+" terms will be deleted)",1)):h("",!0)])):h("",!0)]}),_:1},8,["modelValue"])],64)}const Ee=_(L,[["render",be],["__scopeId","data-v-ba01d80c"]]);export{Ee as default};
//# sourceMappingURL=ManageTerms-CR6gHajT.js.map
