{"version":3,"file":"Login-rDE3P3ge.js","sources":["../../src/pages/auth/Login.vue"],"sourcesContent":["<template>\n  <VaForm ref=\"form\" @keydown.enter=\"validateForm() && submit()\">\n    <h1 class=\"font-semibold text-4xl mb-4\">Log in</h1>\n    <p class=\"text-base mb-4 leading-5\">\n      Bushman\n      <RouterLink :to=\"{ name: 'signup' }\" class=\"font-semibold text-primary\">Sign up</RouterLink>\n    </p>\n    <VaInput\n      v-model=\"formData.email\"\n      :rules=\"[validators.required, validators.email]\"\n      class=\"mb-4\"\n      label=\"Email\"\n      type=\"email\"\n    />\n    <VaValue v-slot=\"isPasswordVisible\" :default-value=\"false\">\n      <VaInput\n        v-model=\"formData.password\"\n        :rules=\"[validators.required]\"\n        :type=\"isPasswordVisible.value ? 'text' : 'password'\"\n        class=\"mb-4\"\n        label=\"Password\"\n        @clickAppendInner.stop=\"isPasswordVisible.value = !isPasswordVisible.value\"\n      >\n        <template #appendInner>\n          <VaIcon\n            :name=\"isPasswordVisible.value ? 'mso-visibility_off' : 'mso-visibility'\"\n            class=\"cursor-pointer\"\n            color=\"secondary\"\n          />\n        </template>\n      </VaInput>\n    </VaValue>\n\n    <div class=\"auth-layout__options flex flex-col sm:flex-row items-start sm:items-center justify-between\">\n      <VaCheckbox v-model=\"formData.keepLoggedIn\" class=\"mb-2 sm:mb-0\" label=\"Keep me signed in on this device\" />\n      <RouterLink :to=\"{ name: 'recover-password' }\" class=\"mt-2 sm:mt-0 sm:ml-1 font-semibold text-primary\">\n        Forgot password?\n      </RouterLink>\n    </div>\n\n    <div class=\"flex justify-center mt-4\">\n      <VaButton :loading=\"loading\" :disabled=\"!isValidForm\" class=\"w-full\" @click=\"validateForm() && submit()\">\n        Login</VaButton\n      >\n    </div>\n  </VaForm>\n</template>\n\n<script lang=\"ts\" setup>\nimport { reactive, ref } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { useForm, useToast } from 'vuestic-ui'\nimport { validators } from '../../services/utils'\nimport axios from 'axios' // Import Axios\n\nconst {\n  isValid: isValidForm,\n  validate: validateForm,\n  resetValidation: resetValidationForm,\n  reset: resetForm,\n} = useForm('form')\nconst { push } = useRouter()\nconst { init } = useToast()\nconst loading = ref(false)\n\nconst formData = reactive({\n  email: '',\n  password: '',\n  keepLoggedIn: false,\n})\n\nconst submit = async () => {\n  loading.value = true\n\n  try {\n    const loginUrl = import.meta.env.VITE_APP_BASE_URL + import.meta.env.VITE_APP_LOGIN_URL\n    const data = JSON.stringify({\n      username: formData.email,\n      password: formData.password,\n    })\n\n    const config = {\n      method: 'post',\n      maxBodyLength: Infinity,\n      url: loginUrl,\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      data: data,\n    }\n\n    const response = await axios.request(config)\n    if (response.status === 200) {\n      sessionStorage.setItem('access', JSON.stringify(response.data.access))\n      sessionStorage.setItem('refresh', JSON.stringify(response.data.refresh))\n      resetForm()\n      resetValidationForm()\n      loading.value = false\n      init({ message: \"You've successfully logged in\", color: 'success' })\n      push({ name: 'dashboard' })\n    }\n  } catch (error: any) {\n    loading.value = false\n\n    init({ message: error.response.data.detail, color: 'danger' })\n  }\n}\n</script>\n"],"names":["isValidForm","validateForm","resetValidationForm","resetForm","useForm","push","useRouter","init","useToast","loading","ref","formData","reactive","submit","loginUrl","data","config","response","axios","error"],"mappings":"4dAuDA,KAAM,CACJ,QAASA,EACT,SAAUC,EACV,gBAAiBC,EACjB,MAAOC,CAAA,EACLC,EAAQ,MAAM,EACZ,CAAE,KAAAC,CAAA,EAASC,EAAA,EACX,CAAE,KAAAC,CAAA,EAASC,EAAA,EACXC,EAAUC,EAAI,EAAK,EAEnBC,EAAWC,EAAS,CACxB,MAAO,GACP,SAAU,GACV,aAAc,EAAA,CACf,EAEKC,EAAS,SAAY,CACzBJ,EAAQ,MAAQ,GAEhB,GAAI,CACF,MAAMK,EAAW,qFACXC,EAAO,KAAK,UAAU,CAC1B,SAAUJ,EAAS,MACnB,SAAUA,EAAS,QAAA,CACpB,EAEKK,EAAS,CACb,OAAQ,OACR,cAAe,IACf,IAAKF,EACL,QAAS,CACP,eAAgB,kBAAA,EAElB,KAAAC,CAAA,EAGIE,EAAW,MAAMC,EAAM,QAAQF,CAAM,EACvCC,EAAS,SAAW,MACtB,eAAe,QAAQ,SAAU,KAAK,UAAUA,EAAS,KAAK,MAAM,CAAC,EACrE,eAAe,QAAQ,UAAW,KAAK,UAAUA,EAAS,KAAK,OAAO,CAAC,EACvEd,EAAA,EACAD,EAAA,EACAO,EAAQ,MAAQ,GAChBF,EAAK,CAAE,QAAS,gCAAiC,MAAO,UAAW,EACnEF,EAAK,CAAE,KAAM,YAAa,EAE9B,OAASc,EAAY,CACnBV,EAAQ,MAAQ,GAEhBF,EAAK,CAAE,QAASY,EAAM,SAAS,KAAK,OAAQ,MAAO,SAAU,CAC/D,CACF"}