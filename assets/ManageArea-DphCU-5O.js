import{u as H}from"./quota-store-C74f-cSp.js";import{j as L,k,d as N,m as V,B as q,s as F,_ as $,a as c,w as m,e as l,g as B,v as b,i as g,h as A,b as d,o as p}from"./index-mc8yIoJz.js";import{u as y}from"./useForm-B0KXMGch.js";import{u as C}from"./useToast-CzWLUixe.js";import{h as S}from"./errorHandler-DijQ3xmc.js";import{M as I}from"./ModuleTable-CkO475L8.js";import"./format-Cn4G_mmc.js";const O=L("hunting-area-store",{state:()=>({}),actions:{async createHuntingArea(t){const e=JSON.stringify({name:t.name,description:t.description,coordinates_type:"Point",coordinates:t.coordinates,is_disabled:!1}),s={method:"post",maxBodyLength:1/0,url:"http://localhost:8000/api/v1.0/settings/hunting-areas/",headers:{"Content-Type":"application/json"},data:e};return await k.request(s)}}}),j={name:"",start_date:null,end_date:null},D=N({name:"QuotaPage",components:{ModuleTable:I},setup(){const t=F(null),e=F(null),{isValid:s,validate:o,resetValidation:r,reset:i}=y(t),{isValid:n,validate:f,resetValidation:h,reset:u}=y(e);return{isValidForm:s,validateForm:o,resetValidationForm:r,isValidareaForm:n,validateareaForm:f,resetValidationareaForm:h,resetForm:i,resetareaForm:u,formRef:t,areaFormRef:e}},data(){const t=[],e=q({id:null,name:null,description:"",lat:null,lng:null,location:null}),s=[{key:"name",sortable:!0},{key:"description",sortable:!0},{key:"lat",label:"Latitude",sortable:!1},{key:"lng",label:"Longitude",sortable:!1}],o=[];return{items:t,columns:s,editedItemId:null,editedItem:null,createdItem:{...j},toast:C(),areaForm:e,speciesOptions:[],areasOptions:[],speciesObjects:[],showCreatenewForm:!1,quotasOptions:o,showHuntingAreaList:!0,quotaItems:[],saving:!1,loading:!1}},mounted(){this.getAreas()},methods:{...V(H,["getAreaList"]),...V(O,["createHuntingArea"]),toggleFormAndList(){this.showHuntingAreaList=!this.showHuntingAreaList,this.getAreas()},showHuntingArea(){this.showHuntingAreaList=!this.showHuntingAreaList},async createNewHuntingArea(){this.saving=!0;const t=[{lat:this.areaForm.lat,lng:this.areaForm.lng}],e={name:this.areaForm.name,description:this.areaForm.description,coordinates:t};try{const s=await this.createHuntingArea(e);s.status===201?(this.saving=!1,this.toast.init({message:"Hunting Area created successfully",color:"success"}),this.resetareaForm()):console.log(s)}catch(s){this.saving=!1;const o=S(s);this.toast.init({message:`
`+o.map((r,i)=>`${i+1}. ${r}`).join(`
`),color:"danger"})}},formatDate(t){const e=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0");return`${e}-${s}-${o}`},async getAreas(){try{this.loading=!0;const t=await this.getAreaList();this.areasOptions=t.data.map(e=>({value:e.id,text:e.name})),t.status===200?(this.items=t.data.map(e=>{var o,r,i,n;const s=JSON.parse(((r=(o=e==null?void 0:e.location)==null?void 0:o.geo_coordinates)==null?void 0:r.coordinates)||"[]");return{id:e==null?void 0:e.id,name:e==null?void 0:e.name,description:e==null?void 0:e.description,lat:(i=s[0])==null?void 0:i.lat,lng:(n=s[0])==null?void 0:n.lng}}),this.loading=!1):(this.loading=!1,this.toast.init({message:"No hunting areas found",color:"info"}))}catch{this.loading=!1}}}}),E={class:"flex flex-col md:flex-row gap-2 mb-2 justify-between"},M={class:"flex flex-col md:flex-row gap-2 justify-start"},T={key:1,class:"p-2"},U={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},G={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},Q={class:"mb-6"};function R(t,e,s,o,r,i){const n=g("VaButton"),f=g("VaButtonGroup"),h=g("ModuleTable"),u=g("VaInput"),w=g("VaForm"),v=g("VaCard");return p(),c(v,{class:"p-6"},{default:m(()=>[l("div",E,[l("div",M,[t.showHuntingAreaList?b("",!0):(p(),c(n,{key:0,class:"px-2 py-2",icon:"arrow_back",size:"small",onClick:e[0]||(e[0]=a=>t.toggleFormAndList())},{default:m(()=>e[7]||(e[7]=[A(" Go Back ")])),_:1}))]),t.showHuntingAreaList?(p(),c(f,{key:0},{default:m(()=>[d(n,{class:"px-2 py-2",color:"primary",label:"Add New Quota",icon:"add",size:"small",onClick:e[1]||(e[1]=a=>t.toggleFormAndList())},{default:m(()=>e[8]||(e[8]=[A("Add a New Hunting Area")])),_:1})]),_:1})):b("",!0)]),t.showHuntingAreaList?(p(),c(h,{key:0,items:t.items,columns:t.columns,loading:t.loading,onOnView:t.showHuntingArea},null,8,["items","columns","loading","onOnView"])):(p(),B("div",T,[d(w,{ref:"areaFormRef",class:"mb-6"},{default:m(()=>[e[9]||(e[9]=l("h3",{class:"font-bold text-lg mb-2"},"Hunting are details",-1)),l("div",U,[d(u,{modelValue:t.areaForm.name,"onUpdate:modelValue":e[2]||(e[2]=a=>t.areaForm.name=a),label:"Name",placeholder:"Enter Hunting Area Name",rules:[a=>!!a||"Hunting Area Name is required"],required:""},null,8,["modelValue","rules"]),d(u,{modelValue:t.areaForm.description,"onUpdate:modelValue":e[3]||(e[3]=a=>t.areaForm.description=a),type:"textarea",label:"Description",placeholder:"Enter Hunting Area Description",rules:[a=>!!a||"Hunting Area Description is required"],required:""},null,8,["modelValue","rules"])]),e[10]||(e[10]=l("h3",{class:"font-bold text-lg mb-2"},"Area Location",-1)),l("div",G,[d(u,{modelValue:t.areaForm.lat,"onUpdate:modelValue":e[4]||(e[4]=a=>t.areaForm.lat=a),label:"Latitude",type:"text",placeholder:"Enter Hunting Area Latitude eg. 12.3456789",rules:[a=>!!a||"Latitude is required"],required:""},null,8,["modelValue","rules"]),d(u,{modelValue:t.areaForm.lng,"onUpdate:modelValue":e[5]||(e[5]=a=>t.areaForm.lng=a),label:"Longitude",placeholder:"Enter Hunting Area Longitude eg. 12.3456789",type:"text",rules:[a=>!!a||"Longitude is required"],required:""},null,8,["modelValue","rules"])])]),_:1},512),l("div",Q,[d(n,{disabled:!t.isValidareaForm,color:"primary",icon:"save",loading:t.saving,"icon-color":"#fff",onClick:e[6]||(e[6]=a=>t.validateareaForm()&&t.createNewHuntingArea())},{default:m(()=>e[11]||(e[11]=[A(" Save ")])),_:1},8,["disabled","loading"])])]))]),_:1})}const X=$(D,[["render",R]]);export{X as default};
//# sourceMappingURL=ManageArea-DphCU-5O.js.map
