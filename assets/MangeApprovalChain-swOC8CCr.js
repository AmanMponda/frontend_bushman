import{_ as S,g as A,e as a,h as r,t as p,F as U,q as L,o as d,d as x,m as D,l as I,s as T,v as $,b as s,w as i,i as n,a as F,x as k}from"./index-DdnbDYw8.js";import{u as y}from"./approval-store-BYlfV17P.js";import{u as q}from"./useForm-wORNMcUf.js";import{u as B}from"./useToast-DuJOzJbk.js";import{u as R}from"./user-store-sJsvqzZ2.js";import{h as E}from"./errorHandler-BXe9Gc4p.js";const j={props:{item:{type:Object,required:!0}},methods:{formatDate(o){return o?new Date(o).toLocaleString():"N/A"}}},G={class:"details-page"},M={class:"general-info"},z={class:"approval-levels"};function O(o,e,u,_,V,C){var m,f,b,g,v,c;return d(),A("div",G,[a("section",M,[e[5]||(e[5]=a("h2",null,"General Information",-1)),a("p",null,[e[0]||(e[0]=a("strong",null,"Name:",-1)),r(" "+p((m=u.item)==null?void 0:m.name),1)]),a("p",null,[e[1]||(e[1]=a("strong",null,"Description:",-1)),r(" "+p((f=u.item)==null?void 0:f.description),1)]),a("p",null,[e[2]||(e[2]=a("strong",null,"Status:",-1)),r(" "+p((b=u.item)!=null&&b.active?"Active":"Inactive"),1)]),a("p",null,[e[3]||(e[3]=a("strong",null,"Created At:",-1)),r(" "+p(C.formatDate((g=u.item)==null?void 0:g.created_at)),1)]),a("p",null,[e[4]||(e[4]=a("strong",null,"Updated At:",-1)),r(" "+p(C.formatDate((v=u.item)==null?void 0:v.updated_at)),1)])]),a("section",z,[e[11]||(e[11]=a("h2",null,"Approval Chain Levels",-1)),(d(!0),A(U,null,L((c=u.item)==null?void 0:c.approval_chain,t=>{var l,h,w,N;return d(),A("div",{key:t==null?void 0:t.id,class:"level"},[a("h3",null,"Level "+p((l=t==null?void 0:t.approval_chain_level)==null?void 0:l.level_number),1),a("p",null,[e[6]||(e[6]=a("strong",null,"Role:",-1)),r(" "+p((w=(h=t==null?void 0:t.approval_chain_level)==null?void 0:h.approval_chain_role)==null?void 0:w.name),1)]),a("p",null,[e[7]||(e[7]=a("strong",null,"Can Change Source:",-1)),r(" "+p((N=t==null?void 0:t.approval_chain_level)!=null&&N.can_change_source?"Yes":"No"),1)]),a("p",null,[e[8]||(e[8]=a("strong",null,"Created At:",-1)),r(" "+p(C.formatDate(t==null?void 0:t.created_at)),1)]),a("p",null,[e[9]||(e[9]=a("strong",null,"Updated At:",-1)),r(" "+p(C.formatDate(t==null?void 0:t.updated_at)),1)]),a("p",null,[e[10]||(e[10]=a("strong",null,"Assigned User ID:",-1)),r(" "+p(t==null?void 0:t.user),1)])])}),128))])])}const Q=S(j,[["render",O],["__scopeId","data-v-a6ded732"]]),Y=x({components:{},props:{},setup(){const{init:o}=B(),e=T(),u=T(),_=$({name:null,active:null,description:""}),V=$({can_change_source:null,approval_chain_role_id:null,level_number:null,user_id:null}),{isValid:C,validate:m,resetValidation:f,reset:b}=q(u),{isValid:g,validate:v,resetValidation:c,reset:t}=q(e);return{moduleForm:_,formRef:e,isValidForm:g,validateForm:v,resetValidationForm:c,init:o,resetForm:t,levelForm:V,isValidIform:C,validateIform:m,resetValidationIform:f,resetIform:b}},data(){return{addingitems:[],columns:[{label:"Level Number",key:"level_number",sortable:!0},{label:"User",key:"user_text",sortable:!0},{label:"Approval Chain Role",key:"role_text",sortable:!0},{label:"Can Change Source",key:"can_change_source",sortable:!0},{label:"Actions",key:"actions",sortable:!1}],saving:!1,currencyOptions:[],levelNumbers:[{value:1,text:"First level of approval"},{value:2,text:"Second level of approval"},{value:3,text:"Third level of approval"},{value:4,text:"Fourth level of approval"},{value:5,text:"Fifth level of approval"},{value:6,text:"Sixth level of approval"},{value:7,text:"Seventh level of approval"},{value:8,text:"Eighth level of approval"},{value:9,text:"Ninth level of approval"},{value:10,text:"Tenth level of approval"},{value:11,text:"Eleventh level of approval"},{value:12,text:"Twelfth level of approval"},{value:13,text:"Thirteenth level of approval"},{value:14,text:"Fourteenth level of approval"},{value:15,text:"Fifteenth level of approval"},{value:16,text:"Sixteenth level of approval"},{value:17,text:"Seventeenth level of approval"},{value:18,text:"Eighteenth level of approval"},{value:19,text:"Nineteenth level of approval"},{value:20,text:"Twentieth level of approval"}]}},computed:{...I(y,["approvalChainRoles"]),...I(R,["users"])},mounted(){this.getUsers(),this.getApprovalChainRoles()},methods:{...D(y,["getApprovalChainRoles","createApprovalChain"]),...D(R,["getUsers"]),async submit(){const o={name:this.moduleForm.name,description:this.moduleForm.description,active:this.moduleForm.active,approval_chain_levels:this.addingitems};this.saving=!0;try{(await this.createApprovalChain(o)).status===201?(this.saving=!1,this.init({message:"Requisition Item Created",color:"success"}),this.resetForm(),this.resetIform(),this.resetValidationForm(),this.resetValidationIform(),this.addingitems=[]):(this.saving=!1,this.init({message:"Something went wrong",color:"danger"}))}catch(e){this.saving=!1,this.saving=!1;const u=E(e.response);this.init({message:`
`+u.map((_,V)=>`${V+1}. ${_}`).join(`
`),color:"danger"})}},addTempSubItemList(){this.addingitems.push({level_number:this.levelForm.level_number.value,level_text:this.levelForm.level_number.text,user_id:this.levelForm.user_id.value,user_text:this.levelForm.user_id.text,can_change_source:this.levelForm.can_change_source,approval_chain_role_id:this.levelForm.approval_chain_role_id.value,role_text:this.levelForm.approval_chain_role_id.text})},deleteTempSubItemList(o){this.addingitems.splice(o,1)}}}),H={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},J={class:"grid grid-cols-1 md:grid-cols-1 gap-4 mb-4"},K={class:"grid grid-cols-1 md:grid-cols-1 gap-4 mb-4 bordered-items-form"},P={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4"},W={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"};function X(o,e,u,_,V,C){const m=n("VaInput"),f=n("VaCheckbox"),b=n("VaTextarea"),g=n("VaForm"),v=n("VaSelect"),c=n("VaButton"),t=n("VaDataTable");return d(),A("div",null,[s(g,{ref:"formRef"},{default:i(()=>[a("div",H,[s(m,{modelValue:o.moduleForm.name,"onUpdate:modelValue":e[0]||(e[0]=l=>o.moduleForm.name=l),label:"Approval Chain Name",placeholder:"Approval Chain Name",type:"text",required:"",rules:[l=>!!l||"Approval Chain Name is required"]},null,8,["modelValue","rules"]),s(f,{modelValue:o.moduleForm.active,"onUpdate:modelValue":e[1]||(e[1]=l=>o.moduleForm.active=l),class:"pt-5",rules:[l=>!!l||"Active is required"],label:"Active"},null,8,["modelValue","rules"])]),a("div",J,[s(b,{modelValue:o.moduleForm.description,"onUpdate:modelValue":e[2]||(e[2]=l=>o.moduleForm.description=l),label:"Description",type:"textarea",rows:3,placeholder:"Description",rules:[l=>!!l||"Description is required"]},null,8,["modelValue","rules"])])]),_:1},512),s(g,{ref:"iformRef"},{default:i(()=>[a("div",K,[a("div",P,[s(v,{modelValue:o.levelForm.level_number,"onUpdate:modelValue":e[3]||(e[3]=l=>o.levelForm.level_number=l),label:"Level Number",options:o.levelNumbers,placeholder:"Level Number",required:"",rules:[l=>!!l||"Level Number is required"]},null,8,["modelValue","options","rules"]),s(v,{modelValue:o.levelForm.user_id,"onUpdate:modelValue":e[4]||(e[4]=l=>o.levelForm.user_id=l),options:o.users,label:"User",placeholder:"User",required:"",rules:[l=>!!l||"User is required"]},null,8,["modelValue","options","rules"]),s(v,{modelValue:o.levelForm.approval_chain_role_id,"onUpdate:modelValue":e[5]||(e[5]=l=>o.levelForm.approval_chain_role_id=l),label:"Approval Chain Role",options:o.approvalChainRoles,placeholder:"Approval Chain Role",required:"",rules:[l=>!!l||"Approval Chain Role is required"]},null,8,["modelValue","options","rules"])]),a("div",W,[s(f,{modelValue:o.levelForm.can_change_source,"onUpdate:modelValue":e[6]||(e[6]=l=>o.levelForm.can_change_source=l),label:"Can Change Source",rules:[l=>!!l||"Can Change Source is required"]},null,8,["modelValue","rules"])]),s(c,{"border-color":"primary",round:"",preset:"secondary",onClick:e[7]||(e[7]=l=>o.addTempSubItemList())},{default:i(()=>e[9]||(e[9]=[r("Add Item")])),_:1}),s(t,{items:o.addingitems,columns:o.columns},{"cell(actions)":i(({rowData:l})=>[s(c,{preset:"plain",icon:"delete",onClick:h=>o.deleteTempSubItemList(l.index)},null,8,["onClick"])]),_:1},8,["items","columns"])])]),_:1},512),s(c,{type:"submit",icon:"save",loading:o.saving,disabled:!o.isValidForm||o.addingitems.length===0||o.saving,onClick:e[8]||(e[8]=l=>o.validateForm()&&o.submit())},{default:i(()=>e[10]||(e[10]=[r("Save")])),_:1},8,["loading","disabled"])])}const Z=S(Y,[["render",X],["__scopeId","data-v-18414e7c"]]),ee=x({name:"ManageApprovalChain",components:{ApprovalChainDetails:Q,ApprovalchainForm:Z},setup(){return{}},data(){return{showDetail:!1,columns:[{key:"name",label:"Name"},{key:"is_active",label:"status"},{key:"actions",label:"Actions"}],showCreateForm:!1,selectedItem:null}},computed:{...I(y,["approvalChainModules","loadingApprovalChain","approvalChainLevels","loadingApprovalChainLevels"])},mounted(){this.getRequisitionsApprovalChain(!1)},methods:{...D(y,["getRequisitionsApprovalChain"]),goBack(){this.showDetail=!1,this.selectedItem=null,this.showCreateForm=!1,this.getRequisitionsApprovalChain(!1)},_showCreateForm(){this.showCreateForm=!0},_showDetails(o){this.showDetail=!0,this.selectedItem=o.selfitem},statusColor(o){return o?"success":"danger"},statusText(o){return o?"Active":"Inactive"}}}),oe={class:"flex flex-col md:flex-row gap-2 mb-2 justify-between"},le={class:"flex flex-col md:flex-row gap-2 justify-start"};function ae(o,e,u,_,V,C){const m=n("VaButton"),f=n("VaButtonGroup"),b=n("ApprovalChainDetails"),g=n("VaChip"),v=n("VaDataTable"),c=n("ApprovalchainForm"),t=n("VaCardContent"),l=n("VaCard");return d(),F(l,null,{default:i(()=>[s(t,null,{default:i(()=>[a("div",oe,[a("div",le,[o.showDetail||o.showCreateForm?(d(),F(m,{key:0,class:"px-2 py-2",icon:"arrow_back",size:"small",onClick:e[0]||(e[0]=h=>o.goBack())},{default:i(()=>e[2]||(e[2]=[r(" Go Back ")])),_:1})):k("",!0)]),o.showCreateForm?k("",!0):(d(),F(f,{key:0},{default:i(()=>[s(m,{class:"px-2 py-2",color:"primary",label:"Add New Quota",icon:"add",size:"small",onClick:e[1]||(e[1]=h=>o._showCreateForm())},{default:i(()=>e[3]||(e[3]=[r("Create Approval Chain")])),_:1})]),_:1}))]),o.showCreateForm?k("",!0):(d(),A(U,{key:0},[o.showDetail?(d(),F(b,{key:0,item:o.selectedItem},null,8,["item"])):(d(),F(v,{key:1,items:o.approvalChainModules,loading:o.loadingApprovalChain,columns:o.columns},{"cell(is_active)":i(({value:h})=>[s(g,{size:"small",color:o.statusColor(h)},{default:i(()=>[r(p(o.statusText(h)),1)]),_:2},1032,["color"])]),"cell(actions)":i(({rowData:h})=>[s(m,{preset:"plain",icon:"visibility",class:"px-2",onClick:w=>o._showDetails(h)},null,8,["onClick"])]),_:1},8,["items","loading","columns"]))],64)),o.showCreateForm?(d(),F(c,{key:1})):k("",!0)]),_:1})]),_:1})}const pe=S(ee,[["render",ae]]);export{pe as default};
//# sourceMappingURL=MangeApprovalChain-swOC8CCr.js.map
