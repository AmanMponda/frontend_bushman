{"version":3,"file":"SalesPipeline-BEmqRs_O.js","sources":["../../src/pages/client/dashboard/components/PipelineCard.vue","../../src/pages/client/dashboard/components/PipelineCard.vue","../../src/pages/client/dashboard/components/ProposalForm.vue","../../src/pages/client/dashboard/components/ProposalForm.vue","../../src/stores/global-store.ts","../../src/pages/client/dashboard/SalesPipeline.vue","../../src/pages/client/dashboard/SalesPipeline.vue"],"sourcesContent":["<template>\n  <div class=\"pipeline-card\" :class=\"{ 'is-new': item.type === 'inquiry' }\" @click=\"handleClick\">\n    <!-- Header -->\n    <div class=\"card-header\">\n      <span class=\"inquiry-code\">{{ item.code }}</span>\n    </div>\n\n    <!-- Client Info -->\n    <div class=\"client-info\">\n      <h4 class=\"client-name\">{{ item.client?.full_name || 'Unknown Client' }}</h4>\n      <p class=\"client-meta\">\n        {{ item.client?.country || 'N/A' }} • {{ item.created_date_formatted || item.created_date }}\n      </p>\n    </div>\n\n    <!-- Hunting Details -->\n    <div class=\"hunting-details\">\n      <div class=\"detail-row\">\n        <VaIcon name=\"pets\" size=\"small\" color=\"secondary\" />\n        <span class=\"detail-text truncate\">{{ truncateSpecies(item.hunting_details?.species) }}</span>\n      </div>\n      <div class=\"detail-row\">\n        <VaIcon name=\"location_on\" size=\"small\" color=\"secondary\" />\n        <span class=\"detail-text\">{{ item.hunting_details?.areas || 'N/A' }}</span>\n      </div>\n      <div class=\"detail-row\">\n        <VaIcon name=\"calendar_today\" size=\"small\" color=\"secondary\" />\n        <span class=\"detail-text\">{{ formatDateRange }}</span>\n      </div>\n      <div v-if=\"item.type === 'proposal' && item.total_amount\" class=\"detail-row amount-row\">\n        <VaIcon name=\"payments\" size=\"small\" color=\"success\" />\n        <span class=\"detail-text amount\">{{ formatCurrency(item.total_amount) }}</span>\n      </div>\n      <div v-else class=\"detail-row\">\n        <VaIcon name=\"person\" size=\"small\" color=\"secondary\" />\n        <span class=\"detail-text\">{{ item.hunting_details?.no_of_hunters || 0 }} hunter(s)</span>\n      </div>\n    </div>\n\n    <!-- Sales Agent (for proposals) -->\n    <div v-if=\"item.sales_agent\" class=\"agent-info\">\n      <VaIcon name=\"support_agent\" size=\"small\" color=\"info\" />\n      <span class=\"agent-name\">{{ item.sales_agent.name }}</span>\n    </div>\n\n    <!-- Actions -->\n    <div class=\"card-actions\">\n      <template v-if=\"item.type === 'inquiry'\">\n        <VaButton size=\"small\" color=\"primary\" block @click.stop=\"$emit('create-proposal', item)\">\n          Create Quotation\n        </VaButton>\n      </template>\n      <template v-else>\n        <VaButton size=\"small\" preset=\"secondary\" @click.stop=\"$emit('view', item)\"> View </VaButton>\n        <VaButton size=\"small\" preset=\"plain\" color=\"info\" @click.stop=\"$emit('edit', item)\"> Edit </VaButton>\n      </template>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from 'vue'\n\ninterface PipelineItem {\n  id: number\n  type: 'inquiry' | 'proposal'\n  stage: string\n  code: string\n  created_date: string\n  created_date_formatted?: string\n  client?: {\n    id?: number\n    full_name: string\n    country: string\n    email?: string\n    phone?: string\n  }\n  hunting_details?: {\n    season?: string\n    areas: string\n    species?: string\n    start_date?: string\n    end_date?: string\n    no_of_days?: number\n    no_of_hunters?: number\n  }\n  proposal_id?: number | null\n  confirmation_id?: number | null\n  sales_agent?: {\n    id: number\n    name: string\n  } | null\n  total_amount?: number | null\n}\n\nexport default defineComponent({\n  name: 'PipelineCard',\n  props: {\n    item: {\n      type: Object as PropType<PipelineItem>,\n      required: true,\n    },\n  },\n  emits: ['click', 'create-proposal', 'view', 'edit'],\n  computed: {\n    formatDateRange(): string {\n      const details = this.item.hunting_details\n      if (!details?.start_date) return 'N/A'\n\n      const formatDate = (dateStr: string) => {\n        try {\n          const date = new Date(dateStr)\n          return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })\n        } catch {\n          return dateStr\n        }\n      }\n\n      const start = formatDate(details.start_date)\n      const end = details.end_date ? formatDate(details.end_date) : ''\n      const days = details.no_of_days ? ` (${details.no_of_days}d)` : ''\n\n      return end ? `${start} - ${end}${days}` : `${start}${days}`\n    },\n  },\n  methods: {\n    handleClick() {\n      this.$emit('click', this.item)\n    },\n\n    truncateSpecies(species: string | undefined): string {\n      if (!species) return 'N/A'\n      if (species.length > 30) {\n        return species.substring(0, 30) + '...'\n      }\n      return species\n    },\n\n    formatCurrency(amount: number | null | undefined): string {\n      if (!amount) return '$0'\n      return new Intl.NumberFormat('en-US', {\n        style: 'currency',\n        currency: 'USD',\n        minimumFractionDigits: 0,\n        maximumFractionDigits: 0,\n      }).format(amount)\n    },\n  },\n})\n</script>\n\n<style scoped>\n.pipeline-card {\n  background: white;\n  border: 1px solid #e5e7eb;\n  border-radius: 6px;\n  padding: 10px;\n  cursor: pointer;\n  transition: all 0.15s ease;\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\n  width: 100%;\n  box-sizing: border-box;\n}\n\n.pipeline-card:hover {\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.12);\n  transform: translateY(-1px);\n}\n\n.pipeline-card.is-new {\n  border-left: 3px solid var(--va-warning);\n}\n\n.card-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 4px;\n}\n\n.inquiry-code {\n  font-size: 0.7rem;\n  font-weight: 600;\n  color: #6b7280;\n  font-family: monospace;\n}\n\n.client-info {\n  margin-bottom: 6px;\n}\n\n.client-name {\n  font-size: 0.9rem;\n  font-weight: 600;\n  color: #1f2937;\n  margin: 0 0 2px 0;\n  line-height: 1.3;\n}\n\n.client-meta {\n  font-size: 0.7rem;\n  color: #9ca3af;\n  margin: 0;\n}\n\n.hunting-details {\n  background: #f9fafb;\n  border-radius: 4px;\n  padding: 6px;\n  margin-bottom: 6px;\n}\n\n.detail-row {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  margin-bottom: 2px;\n}\n\n.detail-row:last-child {\n  margin-bottom: 0;\n}\n\n.detail-text {\n  font-size: 0.75rem;\n  color: #4b5563;\n  flex: 1;\n}\n\n.detail-text.truncate {\n  word-break: break-word;\n}\n\n.amount-row .amount {\n  font-weight: 600;\n  color: var(--va-success);\n}\n\n.agent-info {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  padding: 4px 6px;\n  background: #eff6ff;\n  border-radius: 4px;\n  margin-bottom: 6px;\n}\n\n.agent-name {\n  font-size: 0.75rem;\n  color: #3b82f6;\n  flex: 1;\n}\n\n.card-actions {\n  display: flex;\n  gap: 4px;\n}\n\n.card-actions :deep(.va-button) {\n  flex: 1;\n  font-size: 0.75rem;\n  padding: 4px 8px;\n}\n</style>\n","<template>\n  <div class=\"pipeline-card\" :class=\"{ 'is-new': item.type === 'inquiry' }\" @click=\"handleClick\">\n    <!-- Header -->\n    <div class=\"card-header\">\n      <span class=\"inquiry-code\">{{ item.code }}</span>\n    </div>\n\n    <!-- Client Info -->\n    <div class=\"client-info\">\n      <h4 class=\"client-name\">{{ item.client?.full_name || 'Unknown Client' }}</h4>\n      <p class=\"client-meta\">\n        {{ item.client?.country || 'N/A' }} • {{ item.created_date_formatted || item.created_date }}\n      </p>\n    </div>\n\n    <!-- Hunting Details -->\n    <div class=\"hunting-details\">\n      <div class=\"detail-row\">\n        <VaIcon name=\"pets\" size=\"small\" color=\"secondary\" />\n        <span class=\"detail-text truncate\">{{ truncateSpecies(item.hunting_details?.species) }}</span>\n      </div>\n      <div class=\"detail-row\">\n        <VaIcon name=\"location_on\" size=\"small\" color=\"secondary\" />\n        <span class=\"detail-text\">{{ item.hunting_details?.areas || 'N/A' }}</span>\n      </div>\n      <div class=\"detail-row\">\n        <VaIcon name=\"calendar_today\" size=\"small\" color=\"secondary\" />\n        <span class=\"detail-text\">{{ formatDateRange }}</span>\n      </div>\n      <div v-if=\"item.type === 'proposal' && item.total_amount\" class=\"detail-row amount-row\">\n        <VaIcon name=\"payments\" size=\"small\" color=\"success\" />\n        <span class=\"detail-text amount\">{{ formatCurrency(item.total_amount) }}</span>\n      </div>\n      <div v-else class=\"detail-row\">\n        <VaIcon name=\"person\" size=\"small\" color=\"secondary\" />\n        <span class=\"detail-text\">{{ item.hunting_details?.no_of_hunters || 0 }} hunter(s)</span>\n      </div>\n    </div>\n\n    <!-- Sales Agent (for proposals) -->\n    <div v-if=\"item.sales_agent\" class=\"agent-info\">\n      <VaIcon name=\"support_agent\" size=\"small\" color=\"info\" />\n      <span class=\"agent-name\">{{ item.sales_agent.name }}</span>\n    </div>\n\n    <!-- Actions -->\n    <div class=\"card-actions\">\n      <template v-if=\"item.type === 'inquiry'\">\n        <VaButton size=\"small\" color=\"primary\" block @click.stop=\"$emit('create-proposal', item)\">\n          Create Quotation\n        </VaButton>\n      </template>\n      <template v-else>\n        <VaButton size=\"small\" preset=\"secondary\" @click.stop=\"$emit('view', item)\"> View </VaButton>\n        <VaButton size=\"small\" preset=\"plain\" color=\"info\" @click.stop=\"$emit('edit', item)\"> Edit </VaButton>\n      </template>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from 'vue'\n\ninterface PipelineItem {\n  id: number\n  type: 'inquiry' | 'proposal'\n  stage: string\n  code: string\n  created_date: string\n  created_date_formatted?: string\n  client?: {\n    id?: number\n    full_name: string\n    country: string\n    email?: string\n    phone?: string\n  }\n  hunting_details?: {\n    season?: string\n    areas: string\n    species?: string\n    start_date?: string\n    end_date?: string\n    no_of_days?: number\n    no_of_hunters?: number\n  }\n  proposal_id?: number | null\n  confirmation_id?: number | null\n  sales_agent?: {\n    id: number\n    name: string\n  } | null\n  total_amount?: number | null\n}\n\nexport default defineComponent({\n  name: 'PipelineCard',\n  props: {\n    item: {\n      type: Object as PropType<PipelineItem>,\n      required: true,\n    },\n  },\n  emits: ['click', 'create-proposal', 'view', 'edit'],\n  computed: {\n    formatDateRange(): string {\n      const details = this.item.hunting_details\n      if (!details?.start_date) return 'N/A'\n\n      const formatDate = (dateStr: string) => {\n        try {\n          const date = new Date(dateStr)\n          return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })\n        } catch {\n          return dateStr\n        }\n      }\n\n      const start = formatDate(details.start_date)\n      const end = details.end_date ? formatDate(details.end_date) : ''\n      const days = details.no_of_days ? ` (${details.no_of_days}d)` : ''\n\n      return end ? `${start} - ${end}${days}` : `${start}${days}`\n    },\n  },\n  methods: {\n    handleClick() {\n      this.$emit('click', this.item)\n    },\n\n    truncateSpecies(species: string | undefined): string {\n      if (!species) return 'N/A'\n      if (species.length > 30) {\n        return species.substring(0, 30) + '...'\n      }\n      return species\n    },\n\n    formatCurrency(amount: number | null | undefined): string {\n      if (!amount) return '$0'\n      return new Intl.NumberFormat('en-US', {\n        style: 'currency',\n        currency: 'USD',\n        minimumFractionDigits: 0,\n        maximumFractionDigits: 0,\n      }).format(amount)\n    },\n  },\n})\n</script>\n\n<style scoped>\n.pipeline-card {\n  background: white;\n  border: 1px solid #e5e7eb;\n  border-radius: 6px;\n  padding: 10px;\n  cursor: pointer;\n  transition: all 0.15s ease;\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\n  width: 100%;\n  box-sizing: border-box;\n}\n\n.pipeline-card:hover {\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.12);\n  transform: translateY(-1px);\n}\n\n.pipeline-card.is-new {\n  border-left: 3px solid var(--va-warning);\n}\n\n.card-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 4px;\n}\n\n.inquiry-code {\n  font-size: 0.7rem;\n  font-weight: 600;\n  color: #6b7280;\n  font-family: monospace;\n}\n\n.client-info {\n  margin-bottom: 6px;\n}\n\n.client-name {\n  font-size: 0.9rem;\n  font-weight: 600;\n  color: #1f2937;\n  margin: 0 0 2px 0;\n  line-height: 1.3;\n}\n\n.client-meta {\n  font-size: 0.7rem;\n  color: #9ca3af;\n  margin: 0;\n}\n\n.hunting-details {\n  background: #f9fafb;\n  border-radius: 4px;\n  padding: 6px;\n  margin-bottom: 6px;\n}\n\n.detail-row {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  margin-bottom: 2px;\n}\n\n.detail-row:last-child {\n  margin-bottom: 0;\n}\n\n.detail-text {\n  font-size: 0.75rem;\n  color: #4b5563;\n  flex: 1;\n}\n\n.detail-text.truncate {\n  word-break: break-word;\n}\n\n.amount-row .amount {\n  font-weight: 600;\n  color: var(--va-success);\n}\n\n.agent-info {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  padding: 4px 6px;\n  background: #eff6ff;\n  border-radius: 4px;\n  margin-bottom: 6px;\n}\n\n.agent-name {\n  font-size: 0.75rem;\n  color: #3b82f6;\n  flex: 1;\n}\n\n.card-actions {\n  display: flex;\n  gap: 4px;\n}\n\n.card-actions :deep(.va-button) {\n  flex: 1;\n  font-size: 0.75rem;\n  padding: 4px 8px;\n}\n</style>\n","<template>\n  <div class=\"proposal-form\">\n    <h2 class=\"text-2xl font-bold mb-6\">\n      {{ isEdit ? 'Edit Quotation' : 'Create New Quotation' }}\n    </h2>\n\n    <VaForm ref=\"formRef\">\n      <!-- Sales Inquiry Selection (only for new proposals) -->\n      <VaCard v-if=\"!isEdit\" outlined class=\"mb-6\">\n        <VaCardTitle class=\"flex items-center gap-2\">\n          <VaIcon name=\"search\" color=\"primary\" />\n          Select Sales Inquiry\n        </VaCardTitle>\n        <VaCardContent>\n          <VaAlert color=\"info\" class=\"mb-4\" border=\"left\">\n            <template #title>Link to Sales Inquiry</template>\n            Select a sales inquiry to create a quotation. Client and hunting details will be automatically populated.\n          </VaAlert>\n\n          <VaSelect\n            v-model=\"form.sales_inquiry_id\"\n            :options=\"salesInquiryOptions\"\n            :loading=\"loadingInquiries\"\n            label=\"Sales Inquiry\"\n            placeholder=\"Search and select a sales inquiry...\"\n            searchable\n            highlight-matched-text\n            :rules=\"[(v: any) => !!v || 'Sales inquiry is required']\"\n            @update:modelValue=\"onInquirySelected\"\n          >\n            <template #content=\"{ value }\">\n              <div v-if=\"value\" class=\"flex flex-col\">\n                <span class=\"font-semibold\">{{ value.text }}</span>\n                <span class=\"text-xs text-gray-500\">{{ value.subtitle }}</span>\n              </div>\n            </template>\n          </VaSelect>\n\n          <!-- Selected Inquiry Preview -->\n          <div v-if=\"selectedInquiry\" class=\"mt-4 p-4 bg-gray-50 rounded-lg\">\n            <h4 class=\"font-semibold mb-2\">Selected Inquiry Details</h4>\n            <div class=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm\">\n              <div>\n                <span class=\"text-gray-500\">Client:</span>\n                <span class=\"ml-1 font-medium\">{{ selectedInquiry.client_name }}</span>\n              </div>\n              <div>\n                <span class=\"text-gray-500\">Area:</span>\n                <span class=\"ml-1 font-medium\">{{ selectedInquiry.area }}</span>\n              </div>\n              <div>\n                <span class=\"text-gray-500\">Days:</span>\n                <span class=\"ml-1 font-medium\">{{ selectedInquiry.no_of_days }}</span>\n              </div>\n              <div>\n                <span class=\"text-gray-500\">Season:</span>\n                <span class=\"ml-1 font-medium\">{{ selectedInquiry.season }}</span>\n              </div>\n            </div>\n            <div v-if=\"selectedInquiry.species\" class=\"mt-2\">\n              <span class=\"text-gray-500\">Species:</span>\n              <span class=\"ml-1 font-medium\">{{ selectedInquiry.species }}</span>\n            </div>\n          </div>\n        </VaCardContent>\n      </VaCard>\n\n      <!-- Quotation Details -->\n      <VaCard outlined class=\"mb-6\">\n        <VaCardTitle class=\"flex items-center gap-2\">\n          <VaIcon name=\"description\" color=\"primary\" />\n          Quotation Details\n        </VaCardTitle>\n        <VaCardContent>\n          <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <VaDateInput v-model=\"form.confirmation_date\" label=\"Confirmation Date\" placeholder=\"Select date\" />\n            <VaInput\n              v-model=\"form.hunting_license\"\n              label=\"Hunting License\"\n              placeholder=\"Enter license number (optional)\"\n            />\n          </div>\n          <VaTextarea\n            v-model=\"form.remarks\"\n            label=\"Remarks\"\n            placeholder=\"Add any additional notes or remarks...\"\n            class=\"mt-4\"\n            :min-rows=\"3\"\n          />\n        </VaCardContent>\n      </VaCard>\n\n      <!-- Payment Installments -->\n      <VaCard outlined class=\"mb-6\">\n        <VaCardTitle class=\"flex items-center justify-between\">\n          <div class=\"flex items-center gap-2\">\n            <VaIcon name=\"payments\" color=\"primary\" />\n            Payment Installments\n          </div>\n          <VaButton preset=\"secondary\" size=\"small\" icon=\"add\" @click=\"addInstallment\"> Add Installment </VaButton>\n        </VaCardTitle>\n        <VaCardContent>\n          <VaAlert v-if=\"form.installments.length === 0\" color=\"warning\" class=\"mb-4\" border=\"left\">\n            <template #title>Required</template>\n            At least one payment installment is required to create a quotation.\n          </VaAlert>\n\n          <div v-if=\"form.installments.length === 0\" class=\"text-center text-gray-500 py-4\">\n            No installments added. Click \"Add Installment\" to create payment schedule.\n          </div>\n\n          <div\n            v-for=\"(installment, index) in form.installments\"\n            :key=\"index\"\n            class=\"installment-row mb-4 p-4 border rounded-lg\"\n          >\n            <div class=\"flex justify-between items-start mb-3\">\n              <span class=\"font-semibold text-gray-700\">Installment {{ index + 1 }}</span>\n              <VaButton preset=\"plain\" color=\"danger\" size=\"small\" icon=\"delete\" @click=\"removeInstallment(index)\" />\n            </div>\n            <div class=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n              <VaInput\n                v-model=\"installment.narration\"\n                label=\"Description\"\n                placeholder=\"e.g., Deposit Due upon booking\"\n                :rules=\"[(v: any) => !!v || 'Description is required']\"\n              />\n              <VaInput\n                v-model=\"installment.amount_due\"\n                label=\"Amount (USD)\"\n                type=\"number\"\n                placeholder=\"5000\"\n                :rules=\"[(v: any) => v > 0 || 'Amount must be greater than 0']\"\n              />\n              <VaSelect\n                v-model=\"installment.due_days_type\"\n                :options=\"dueDaysTypeOptions\"\n                label=\"Due Type\"\n                placeholder=\"Select when due\"\n                value-by=\"value\"\n                text-by=\"text\"\n              />\n              <VaInput\n                v-model=\"installment.due_days\"\n                :label=\"installment.due_days_type === 'before_arrival' ? 'Days Before Arrival' : 'Due Days'\"\n                type=\"number\"\n                placeholder=\"e.g., 90\"\n                :disabled=\"installment.due_days_type === 'upon_booking'\"\n              />\n            </div>\n          </div>\n\n          <!-- Total -->\n          <div v-if=\"form.installments.length > 0\" class=\"mt-4 p-4 bg-primary rounded-lg text-white\">\n            <div class=\"flex justify-between items-center\">\n              <span class=\"text-lg font-semibold\">TOTAL</span>\n              <span class=\"text-2xl font-bold\">{{ formatCurrency(totalAmount) }}</span>\n            </div>\n          </div>\n        </VaCardContent>\n      </VaCard>\n\n      <!-- Status (only for edit mode) -->\n      <VaCard v-if=\"isEdit\" outlined class=\"mb-6\">\n        <VaCardTitle class=\"flex items-center gap-2\">\n          <VaIcon name=\"flag\" color=\"primary\" />\n          Status\n        </VaCardTitle>\n        <VaCardContent>\n          <VaSelect\n            v-model=\"form.status\"\n            :options=\"statusOptions\"\n            label=\"Quotation Status\"\n            placeholder=\"Select status\"\n          />\n        </VaCardContent>\n      </VaCard>\n\n      <!-- Form Actions -->\n      <div class=\"flex justify-end gap-3 mt-6\">\n        <VaButton preset=\"secondary\" @click=\"$emit('cancel')\"> Cancel </VaButton>\n        <VaButton color=\"primary\" :loading=\"saving\" :disabled=\"!canSubmit\" @click=\"submitForm\">\n          {{ isEdit ? 'Update Quotation' : 'Create Quotation' }}\n        </VaButton>\n      </div>\n    </VaForm>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from 'vue'\nimport { useForm } from 'vuestic-ui'\nimport { mapState } from 'pinia'\nimport { useProposalStore } from '../../../../stores/proposal-store'\nimport { format } from 'date-fns'\nimport axios from 'axios'\n\ninterface Installment {\n  narration: string\n  amount_due: number\n  due_days: number | null\n  amount_due_type: string\n  due_days_type: string\n}\n\ninterface PipelineInquiry {\n  id: number\n  code: string\n  client?: {\n    full_name: string\n    country: string\n  }\n  hunting_details?: {\n    areas: string\n    species: string\n    no_of_days: number\n    season: string\n    no_of_hunters: number\n  }\n}\n\nexport default defineComponent({\n  name: 'ProposalForm',\n  props: {\n    proposal: {\n      type: Object as PropType<any>,\n      default: null,\n    },\n    isEdit: {\n      type: Boolean,\n      default: false,\n    },\n    preselectedInquiry: {\n      type: Object as PropType<PipelineInquiry | null>,\n      default: null,\n    },\n  },\n  emits: ['save', 'cancel'],\n  setup() {\n    const { validate, reset } = useForm('formRef')\n    return { validate, reset }\n  },\n  data() {\n    return {\n      form: {\n        sales_inquiry_id: null as any,\n        confirmation_date: new Date(),\n        hunting_license: '',\n        remarks: '',\n        status: 'pending',\n        installments: [] as Installment[],\n      },\n      salesInquiryOptions: [] as any[],\n      loadingInquiries: false,\n      selectedInquiry: null as any,\n      dueDaysTypeOptions: [\n        { value: 'upon_booking', text: 'Upon Booking' },\n        { value: 'before_arrival', text: 'Days Before Arrival' },\n        { value: 'upon_completion', text: 'Upon Completion' },\n      ],\n      statusOptions: [\n        { value: 'pending', text: 'Pending' },\n        { value: 'provision_sales', text: 'Provisional Sale' },\n        { value: 'confirmed', text: 'Confirmed' },\n        { value: 'declined', text: 'Declined' },\n        { value: 'cancelled', text: 'Cancelled' },\n        { value: 'completed', text: 'Completed' },\n      ],\n      defaultInstallments: [\n        {\n          narration: 'Deposit Due upon booking',\n          amount_due: 5000,\n          due_days: 0,\n          amount_due_type: 'fixed',\n          due_days_type: 'upon_booking',\n        },\n        {\n          narration: '2nd Deposit Due one year prior',\n          amount_due: 10000,\n          due_days: 365,\n          amount_due_type: 'fixed',\n          due_days_type: 'before_arrival',\n        },\n        {\n          narration: 'Final Payment Due 90 days prior',\n          amount_due: 15000,\n          due_days: 90,\n          amount_due_type: 'fixed',\n          due_days_type: 'before_arrival',\n        },\n        {\n          narration: 'Trophy Deposit Due 45 days prior',\n          amount_due: 2500,\n          due_days: 45,\n          amount_due_type: 'fixed',\n          due_days_type: 'before_arrival',\n        },\n      ],\n    }\n  },\n  computed: {\n    ...mapState(useProposalStore, ['saving']),\n\n    totalAmount(): number {\n      return this.form.installments.reduce((sum, inst) => sum + (Number(inst.amount_due) || 0), 0)\n    },\n\n    canSubmit(): boolean {\n      if (this.isEdit) {\n        return true\n      }\n      // Require sales inquiry and at least one installment\n      return !!this.form.sales_inquiry_id && this.form.installments.length > 0\n    },\n  },\n  mounted() {\n    this.loadNewInquiries()\n    if (this.isEdit && this.proposal) {\n      this.populateForm()\n    } else {\n      // Start with empty installments for new proposals\n      this.form.installments = []\n\n      // Handle preselected inquiry from pipeline\n      if (this.preselectedInquiry) {\n        this.handlePreselectedInquiry()\n      }\n    }\n  },\n  methods: {\n    async loadNewInquiries() {\n      this.loadingInquiries = true\n      try {\n        // Fetch only NEW inquiries from the pipeline API\n        const url = `${import.meta.env.VITE_APP_BASE_URL}sales-confirmation/pipeline?stage=new_inquiries`\n        const response = await axios.get(url)\n\n        if (response.data.success) {\n          const newInquiries = response.data.data?.new_inquiries || []\n          this.salesInquiryOptions = newInquiries.map((item: PipelineInquiry) => ({\n            value: item.id,\n            text: `${item.code} - ${item.client?.full_name || 'Unknown'}`,\n            subtitle: `${item.hunting_details?.areas || 'N/A'} | ${item.hunting_details?.no_of_days || 0} days | ${\n              item.hunting_details?.no_of_hunters || 0\n            } hunter(s)`,\n            selfItem: {\n              id: item.id,\n              code: item.code,\n              client_name: item.client?.full_name,\n              country: item.client?.country,\n              area: item.hunting_details?.areas,\n              species: item.hunting_details?.species,\n              no_of_days: item.hunting_details?.no_of_days,\n              no_of_hunters: item.hunting_details?.no_of_hunters,\n              season: item.hunting_details?.season,\n            },\n          }))\n        }\n      } catch (error) {\n        console.error('Error loading new inquiries:', error)\n      } finally {\n        this.loadingInquiries = false\n      }\n    },\n\n    handlePreselectedInquiry() {\n      const inquiry = this.preselectedInquiry\n      if (!inquiry) return\n\n      // Set the selected inquiry details\n      this.selectedInquiry = {\n        id: inquiry.id,\n        code: inquiry.code,\n        client_name: inquiry.client?.full_name,\n        country: inquiry.client?.country,\n        area: inquiry.hunting_details?.areas,\n        species: inquiry.hunting_details?.species,\n        no_of_days: inquiry.hunting_details?.no_of_days,\n        no_of_hunters: inquiry.hunting_details?.no_of_hunters,\n        season: inquiry.hunting_details?.season,\n      }\n\n      // Create the option object for the select\n      const option = {\n        value: inquiry.id,\n        text: `${inquiry.code} - ${inquiry.client?.full_name || 'Unknown'}`,\n        subtitle: `${inquiry.hunting_details?.areas || 'N/A'} | ${inquiry.hunting_details?.no_of_days || 0} days`,\n        selfItem: this.selectedInquiry,\n      }\n\n      // Add to options if not already there\n      const exists = this.salesInquiryOptions.find((opt) => opt.value === inquiry.id)\n      if (!exists) {\n        this.salesInquiryOptions.unshift(option)\n      }\n\n      // Set the form value\n      this.form.sales_inquiry_id = option\n    },\n\n    onInquirySelected(selected: any) {\n      if (selected?.selfItem) {\n        this.selectedInquiry = selected.selfItem\n      } else {\n        this.selectedInquiry = null\n      }\n    },\n\n    populateForm() {\n      if (!this.proposal) return\n\n      this.form.confirmation_date = this.proposal.confirmation_date\n        ? new Date(this.proposal.confirmation_date)\n        : new Date()\n      this.form.hunting_license = this.proposal.hunting_license || ''\n      this.form.remarks = this.proposal.remarks || ''\n      this.form.status = this.proposal.status || 'pending'\n\n      if (this.proposal.pricing?.installments) {\n        this.form.installments = this.proposal.pricing.installments.map((inst: any) => ({\n          narration: inst.narration,\n          amount_due: inst.amount_due,\n          due_days: inst.due_days,\n          amount_due_type: inst.amount_due_type || 'fixed',\n          due_days_type: inst.due_days_type || 'upon_booking',\n        }))\n      }\n\n      if (this.proposal.sales_inquiry) {\n        this.selectedInquiry = {\n          id: this.proposal.sales_inquiry.id,\n          code: this.proposal.sales_inquiry.code,\n          client_name: this.proposal.client?.full_name,\n          area: this.proposal.hunting_trip?.hunting_area,\n          no_of_days: this.proposal.hunting_trip?.no_of_days,\n          season: this.proposal.sales_inquiry.season,\n        }\n      }\n    },\n\n    addInstallment() {\n      this.form.installments.push({\n        narration: '',\n        amount_due: 0,\n        due_days: null,\n        amount_due_type: 'fixed',\n        due_days_type: 'upon_booking',\n      })\n    },\n\n    removeInstallment(index: number) {\n      this.form.installments.splice(index, 1)\n    },\n\n    formatCurrency(amount: number): string {\n      return new Intl.NumberFormat('en-US', {\n        style: 'currency',\n        currency: 'USD',\n        minimumFractionDigits: 0,\n        maximumFractionDigits: 0,\n      }).format(amount)\n    },\n\n    async submitForm() {\n      const isValid = await this.validate()\n      if (!isValid) return\n\n      const payload: any = {\n        confirmation_date: this.form.confirmation_date\n          ? format(new Date(this.form.confirmation_date), 'yyyy-MM-dd')\n          : format(new Date(), 'yyyy-MM-dd'),\n        hunting_license: this.form.hunting_license || null,\n        remarks: this.form.remarks || null,\n        installments: this.form.installments.map((inst) => {\n          // Handle VaSelect returning object instead of string\n          let dueType = inst.due_days_type\n          if (typeof dueType === 'object' && dueType !== null) {\n            dueType = (dueType as any).value || 'upon_booking'\n          }\n          let amountType = inst.amount_due_type\n          if (typeof amountType === 'object' && amountType !== null) {\n            amountType = (amountType as any).value || 'fixed'\n          }\n\n          return {\n            narration: inst.narration,\n            amount_due: Number(inst.amount_due),\n            due_days: inst.due_days ? Number(inst.due_days) : null,\n            amount_due_type: String(amountType || 'fixed'),\n            due_days_type: String(dueType || 'upon_booking'),\n          }\n        }),\n      }\n\n      if (!this.isEdit) {\n        payload.sales_inquiry_id = this.form.sales_inquiry_id?.value || this.form.sales_inquiry_id\n      }\n\n      if (this.isEdit) {\n        payload.status = this.form.status\n      }\n\n      this.$emit('save', payload)\n    },\n  },\n})\n</script>\n\n<style scoped>\n.proposal-form {\n  max-width: 900px;\n  margin: 0 auto;\n}\n\n.installment-row {\n  background-color: #fafafa;\n  transition: background-color 0.2s;\n}\n\n.installment-row:hover {\n  background-color: #f0f7ff;\n}\n</style>\n","<template>\n  <div class=\"proposal-form\">\n    <h2 class=\"text-2xl font-bold mb-6\">\n      {{ isEdit ? 'Edit Quotation' : 'Create New Quotation' }}\n    </h2>\n\n    <VaForm ref=\"formRef\">\n      <!-- Sales Inquiry Selection (only for new proposals) -->\n      <VaCard v-if=\"!isEdit\" outlined class=\"mb-6\">\n        <VaCardTitle class=\"flex items-center gap-2\">\n          <VaIcon name=\"search\" color=\"primary\" />\n          Select Sales Inquiry\n        </VaCardTitle>\n        <VaCardContent>\n          <VaAlert color=\"info\" class=\"mb-4\" border=\"left\">\n            <template #title>Link to Sales Inquiry</template>\n            Select a sales inquiry to create a quotation. Client and hunting details will be automatically populated.\n          </VaAlert>\n\n          <VaSelect\n            v-model=\"form.sales_inquiry_id\"\n            :options=\"salesInquiryOptions\"\n            :loading=\"loadingInquiries\"\n            label=\"Sales Inquiry\"\n            placeholder=\"Search and select a sales inquiry...\"\n            searchable\n            highlight-matched-text\n            :rules=\"[(v: any) => !!v || 'Sales inquiry is required']\"\n            @update:modelValue=\"onInquirySelected\"\n          >\n            <template #content=\"{ value }\">\n              <div v-if=\"value\" class=\"flex flex-col\">\n                <span class=\"font-semibold\">{{ value.text }}</span>\n                <span class=\"text-xs text-gray-500\">{{ value.subtitle }}</span>\n              </div>\n            </template>\n          </VaSelect>\n\n          <!-- Selected Inquiry Preview -->\n          <div v-if=\"selectedInquiry\" class=\"mt-4 p-4 bg-gray-50 rounded-lg\">\n            <h4 class=\"font-semibold mb-2\">Selected Inquiry Details</h4>\n            <div class=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm\">\n              <div>\n                <span class=\"text-gray-500\">Client:</span>\n                <span class=\"ml-1 font-medium\">{{ selectedInquiry.client_name }}</span>\n              </div>\n              <div>\n                <span class=\"text-gray-500\">Area:</span>\n                <span class=\"ml-1 font-medium\">{{ selectedInquiry.area }}</span>\n              </div>\n              <div>\n                <span class=\"text-gray-500\">Days:</span>\n                <span class=\"ml-1 font-medium\">{{ selectedInquiry.no_of_days }}</span>\n              </div>\n              <div>\n                <span class=\"text-gray-500\">Season:</span>\n                <span class=\"ml-1 font-medium\">{{ selectedInquiry.season }}</span>\n              </div>\n            </div>\n            <div v-if=\"selectedInquiry.species\" class=\"mt-2\">\n              <span class=\"text-gray-500\">Species:</span>\n              <span class=\"ml-1 font-medium\">{{ selectedInquiry.species }}</span>\n            </div>\n          </div>\n        </VaCardContent>\n      </VaCard>\n\n      <!-- Quotation Details -->\n      <VaCard outlined class=\"mb-6\">\n        <VaCardTitle class=\"flex items-center gap-2\">\n          <VaIcon name=\"description\" color=\"primary\" />\n          Quotation Details\n        </VaCardTitle>\n        <VaCardContent>\n          <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <VaDateInput v-model=\"form.confirmation_date\" label=\"Confirmation Date\" placeholder=\"Select date\" />\n            <VaInput\n              v-model=\"form.hunting_license\"\n              label=\"Hunting License\"\n              placeholder=\"Enter license number (optional)\"\n            />\n          </div>\n          <VaTextarea\n            v-model=\"form.remarks\"\n            label=\"Remarks\"\n            placeholder=\"Add any additional notes or remarks...\"\n            class=\"mt-4\"\n            :min-rows=\"3\"\n          />\n        </VaCardContent>\n      </VaCard>\n\n      <!-- Payment Installments -->\n      <VaCard outlined class=\"mb-6\">\n        <VaCardTitle class=\"flex items-center justify-between\">\n          <div class=\"flex items-center gap-2\">\n            <VaIcon name=\"payments\" color=\"primary\" />\n            Payment Installments\n          </div>\n          <VaButton preset=\"secondary\" size=\"small\" icon=\"add\" @click=\"addInstallment\"> Add Installment </VaButton>\n        </VaCardTitle>\n        <VaCardContent>\n          <VaAlert v-if=\"form.installments.length === 0\" color=\"warning\" class=\"mb-4\" border=\"left\">\n            <template #title>Required</template>\n            At least one payment installment is required to create a quotation.\n          </VaAlert>\n\n          <div v-if=\"form.installments.length === 0\" class=\"text-center text-gray-500 py-4\">\n            No installments added. Click \"Add Installment\" to create payment schedule.\n          </div>\n\n          <div\n            v-for=\"(installment, index) in form.installments\"\n            :key=\"index\"\n            class=\"installment-row mb-4 p-4 border rounded-lg\"\n          >\n            <div class=\"flex justify-between items-start mb-3\">\n              <span class=\"font-semibold text-gray-700\">Installment {{ index + 1 }}</span>\n              <VaButton preset=\"plain\" color=\"danger\" size=\"small\" icon=\"delete\" @click=\"removeInstallment(index)\" />\n            </div>\n            <div class=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n              <VaInput\n                v-model=\"installment.narration\"\n                label=\"Description\"\n                placeholder=\"e.g., Deposit Due upon booking\"\n                :rules=\"[(v: any) => !!v || 'Description is required']\"\n              />\n              <VaInput\n                v-model=\"installment.amount_due\"\n                label=\"Amount (USD)\"\n                type=\"number\"\n                placeholder=\"5000\"\n                :rules=\"[(v: any) => v > 0 || 'Amount must be greater than 0']\"\n              />\n              <VaSelect\n                v-model=\"installment.due_days_type\"\n                :options=\"dueDaysTypeOptions\"\n                label=\"Due Type\"\n                placeholder=\"Select when due\"\n                value-by=\"value\"\n                text-by=\"text\"\n              />\n              <VaInput\n                v-model=\"installment.due_days\"\n                :label=\"installment.due_days_type === 'before_arrival' ? 'Days Before Arrival' : 'Due Days'\"\n                type=\"number\"\n                placeholder=\"e.g., 90\"\n                :disabled=\"installment.due_days_type === 'upon_booking'\"\n              />\n            </div>\n          </div>\n\n          <!-- Total -->\n          <div v-if=\"form.installments.length > 0\" class=\"mt-4 p-4 bg-primary rounded-lg text-white\">\n            <div class=\"flex justify-between items-center\">\n              <span class=\"text-lg font-semibold\">TOTAL</span>\n              <span class=\"text-2xl font-bold\">{{ formatCurrency(totalAmount) }}</span>\n            </div>\n          </div>\n        </VaCardContent>\n      </VaCard>\n\n      <!-- Status (only for edit mode) -->\n      <VaCard v-if=\"isEdit\" outlined class=\"mb-6\">\n        <VaCardTitle class=\"flex items-center gap-2\">\n          <VaIcon name=\"flag\" color=\"primary\" />\n          Status\n        </VaCardTitle>\n        <VaCardContent>\n          <VaSelect\n            v-model=\"form.status\"\n            :options=\"statusOptions\"\n            label=\"Quotation Status\"\n            placeholder=\"Select status\"\n          />\n        </VaCardContent>\n      </VaCard>\n\n      <!-- Form Actions -->\n      <div class=\"flex justify-end gap-3 mt-6\">\n        <VaButton preset=\"secondary\" @click=\"$emit('cancel')\"> Cancel </VaButton>\n        <VaButton color=\"primary\" :loading=\"saving\" :disabled=\"!canSubmit\" @click=\"submitForm\">\n          {{ isEdit ? 'Update Quotation' : 'Create Quotation' }}\n        </VaButton>\n      </div>\n    </VaForm>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from 'vue'\nimport { useForm } from 'vuestic-ui'\nimport { mapState } from 'pinia'\nimport { useProposalStore } from '../../../../stores/proposal-store'\nimport { format } from 'date-fns'\nimport axios from 'axios'\n\ninterface Installment {\n  narration: string\n  amount_due: number\n  due_days: number | null\n  amount_due_type: string\n  due_days_type: string\n}\n\ninterface PipelineInquiry {\n  id: number\n  code: string\n  client?: {\n    full_name: string\n    country: string\n  }\n  hunting_details?: {\n    areas: string\n    species: string\n    no_of_days: number\n    season: string\n    no_of_hunters: number\n  }\n}\n\nexport default defineComponent({\n  name: 'ProposalForm',\n  props: {\n    proposal: {\n      type: Object as PropType<any>,\n      default: null,\n    },\n    isEdit: {\n      type: Boolean,\n      default: false,\n    },\n    preselectedInquiry: {\n      type: Object as PropType<PipelineInquiry | null>,\n      default: null,\n    },\n  },\n  emits: ['save', 'cancel'],\n  setup() {\n    const { validate, reset } = useForm('formRef')\n    return { validate, reset }\n  },\n  data() {\n    return {\n      form: {\n        sales_inquiry_id: null as any,\n        confirmation_date: new Date(),\n        hunting_license: '',\n        remarks: '',\n        status: 'pending',\n        installments: [] as Installment[],\n      },\n      salesInquiryOptions: [] as any[],\n      loadingInquiries: false,\n      selectedInquiry: null as any,\n      dueDaysTypeOptions: [\n        { value: 'upon_booking', text: 'Upon Booking' },\n        { value: 'before_arrival', text: 'Days Before Arrival' },\n        { value: 'upon_completion', text: 'Upon Completion' },\n      ],\n      statusOptions: [\n        { value: 'pending', text: 'Pending' },\n        { value: 'provision_sales', text: 'Provisional Sale' },\n        { value: 'confirmed', text: 'Confirmed' },\n        { value: 'declined', text: 'Declined' },\n        { value: 'cancelled', text: 'Cancelled' },\n        { value: 'completed', text: 'Completed' },\n      ],\n      defaultInstallments: [\n        {\n          narration: 'Deposit Due upon booking',\n          amount_due: 5000,\n          due_days: 0,\n          amount_due_type: 'fixed',\n          due_days_type: 'upon_booking',\n        },\n        {\n          narration: '2nd Deposit Due one year prior',\n          amount_due: 10000,\n          due_days: 365,\n          amount_due_type: 'fixed',\n          due_days_type: 'before_arrival',\n        },\n        {\n          narration: 'Final Payment Due 90 days prior',\n          amount_due: 15000,\n          due_days: 90,\n          amount_due_type: 'fixed',\n          due_days_type: 'before_arrival',\n        },\n        {\n          narration: 'Trophy Deposit Due 45 days prior',\n          amount_due: 2500,\n          due_days: 45,\n          amount_due_type: 'fixed',\n          due_days_type: 'before_arrival',\n        },\n      ],\n    }\n  },\n  computed: {\n    ...mapState(useProposalStore, ['saving']),\n\n    totalAmount(): number {\n      return this.form.installments.reduce((sum, inst) => sum + (Number(inst.amount_due) || 0), 0)\n    },\n\n    canSubmit(): boolean {\n      if (this.isEdit) {\n        return true\n      }\n      // Require sales inquiry and at least one installment\n      return !!this.form.sales_inquiry_id && this.form.installments.length > 0\n    },\n  },\n  mounted() {\n    this.loadNewInquiries()\n    if (this.isEdit && this.proposal) {\n      this.populateForm()\n    } else {\n      // Start with empty installments for new proposals\n      this.form.installments = []\n\n      // Handle preselected inquiry from pipeline\n      if (this.preselectedInquiry) {\n        this.handlePreselectedInquiry()\n      }\n    }\n  },\n  methods: {\n    async loadNewInquiries() {\n      this.loadingInquiries = true\n      try {\n        // Fetch only NEW inquiries from the pipeline API\n        const url = `${import.meta.env.VITE_APP_BASE_URL}sales-confirmation/pipeline?stage=new_inquiries`\n        const response = await axios.get(url)\n\n        if (response.data.success) {\n          const newInquiries = response.data.data?.new_inquiries || []\n          this.salesInquiryOptions = newInquiries.map((item: PipelineInquiry) => ({\n            value: item.id,\n            text: `${item.code} - ${item.client?.full_name || 'Unknown'}`,\n            subtitle: `${item.hunting_details?.areas || 'N/A'} | ${item.hunting_details?.no_of_days || 0} days | ${\n              item.hunting_details?.no_of_hunters || 0\n            } hunter(s)`,\n            selfItem: {\n              id: item.id,\n              code: item.code,\n              client_name: item.client?.full_name,\n              country: item.client?.country,\n              area: item.hunting_details?.areas,\n              species: item.hunting_details?.species,\n              no_of_days: item.hunting_details?.no_of_days,\n              no_of_hunters: item.hunting_details?.no_of_hunters,\n              season: item.hunting_details?.season,\n            },\n          }))\n        }\n      } catch (error) {\n        console.error('Error loading new inquiries:', error)\n      } finally {\n        this.loadingInquiries = false\n      }\n    },\n\n    handlePreselectedInquiry() {\n      const inquiry = this.preselectedInquiry\n      if (!inquiry) return\n\n      // Set the selected inquiry details\n      this.selectedInquiry = {\n        id: inquiry.id,\n        code: inquiry.code,\n        client_name: inquiry.client?.full_name,\n        country: inquiry.client?.country,\n        area: inquiry.hunting_details?.areas,\n        species: inquiry.hunting_details?.species,\n        no_of_days: inquiry.hunting_details?.no_of_days,\n        no_of_hunters: inquiry.hunting_details?.no_of_hunters,\n        season: inquiry.hunting_details?.season,\n      }\n\n      // Create the option object for the select\n      const option = {\n        value: inquiry.id,\n        text: `${inquiry.code} - ${inquiry.client?.full_name || 'Unknown'}`,\n        subtitle: `${inquiry.hunting_details?.areas || 'N/A'} | ${inquiry.hunting_details?.no_of_days || 0} days`,\n        selfItem: this.selectedInquiry,\n      }\n\n      // Add to options if not already there\n      const exists = this.salesInquiryOptions.find((opt) => opt.value === inquiry.id)\n      if (!exists) {\n        this.salesInquiryOptions.unshift(option)\n      }\n\n      // Set the form value\n      this.form.sales_inquiry_id = option\n    },\n\n    onInquirySelected(selected: any) {\n      if (selected?.selfItem) {\n        this.selectedInquiry = selected.selfItem\n      } else {\n        this.selectedInquiry = null\n      }\n    },\n\n    populateForm() {\n      if (!this.proposal) return\n\n      this.form.confirmation_date = this.proposal.confirmation_date\n        ? new Date(this.proposal.confirmation_date)\n        : new Date()\n      this.form.hunting_license = this.proposal.hunting_license || ''\n      this.form.remarks = this.proposal.remarks || ''\n      this.form.status = this.proposal.status || 'pending'\n\n      if (this.proposal.pricing?.installments) {\n        this.form.installments = this.proposal.pricing.installments.map((inst: any) => ({\n          narration: inst.narration,\n          amount_due: inst.amount_due,\n          due_days: inst.due_days,\n          amount_due_type: inst.amount_due_type || 'fixed',\n          due_days_type: inst.due_days_type || 'upon_booking',\n        }))\n      }\n\n      if (this.proposal.sales_inquiry) {\n        this.selectedInquiry = {\n          id: this.proposal.sales_inquiry.id,\n          code: this.proposal.sales_inquiry.code,\n          client_name: this.proposal.client?.full_name,\n          area: this.proposal.hunting_trip?.hunting_area,\n          no_of_days: this.proposal.hunting_trip?.no_of_days,\n          season: this.proposal.sales_inquiry.season,\n        }\n      }\n    },\n\n    addInstallment() {\n      this.form.installments.push({\n        narration: '',\n        amount_due: 0,\n        due_days: null,\n        amount_due_type: 'fixed',\n        due_days_type: 'upon_booking',\n      })\n    },\n\n    removeInstallment(index: number) {\n      this.form.installments.splice(index, 1)\n    },\n\n    formatCurrency(amount: number): string {\n      return new Intl.NumberFormat('en-US', {\n        style: 'currency',\n        currency: 'USD',\n        minimumFractionDigits: 0,\n        maximumFractionDigits: 0,\n      }).format(amount)\n    },\n\n    async submitForm() {\n      const isValid = await this.validate()\n      if (!isValid) return\n\n      const payload: any = {\n        confirmation_date: this.form.confirmation_date\n          ? format(new Date(this.form.confirmation_date), 'yyyy-MM-dd')\n          : format(new Date(), 'yyyy-MM-dd'),\n        hunting_license: this.form.hunting_license || null,\n        remarks: this.form.remarks || null,\n        installments: this.form.installments.map((inst) => {\n          // Handle VaSelect returning object instead of string\n          let dueType = inst.due_days_type\n          if (typeof dueType === 'object' && dueType !== null) {\n            dueType = (dueType as any).value || 'upon_booking'\n          }\n          let amountType = inst.amount_due_type\n          if (typeof amountType === 'object' && amountType !== null) {\n            amountType = (amountType as any).value || 'fixed'\n          }\n\n          return {\n            narration: inst.narration,\n            amount_due: Number(inst.amount_due),\n            due_days: inst.due_days ? Number(inst.due_days) : null,\n            amount_due_type: String(amountType || 'fixed'),\n            due_days_type: String(dueType || 'upon_booking'),\n          }\n        }),\n      }\n\n      if (!this.isEdit) {\n        payload.sales_inquiry_id = this.form.sales_inquiry_id?.value || this.form.sales_inquiry_id\n      }\n\n      if (this.isEdit) {\n        payload.status = this.form.status\n      }\n\n      this.$emit('save', payload)\n    },\n  },\n})\n</script>\n\n<style scoped>\n.proposal-form {\n  max-width: 900px;\n  margin: 0 auto;\n}\n\n.installment-row {\n  background-color: #fafafa;\n  transition: background-color 0.2s;\n}\n\n.installment-row:hover {\n  background-color: #f0f7ff;\n}\n</style>\n","import { defineStore } from 'pinia'\n\nexport const useGlobalStore = defineStore('global', {\n  state: () => {\n    return {\n      isSidebarMinimized: false,\n    }\n  },\n\n  actions: {\n    toggleSidebar() {\n      this.isSidebarMinimized = !this.isSidebarMinimized\n    },\n  },\n})\n","<template>\n  <div class=\"sales-pipeline-page\">\n    <!-- Header Section -->\n    <div class=\"pipeline-header\">\n      <div class=\"header-content\">\n        <div class=\"header-title-section\">\n          <div class=\"title-icon\">\n            <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n              <path\n                d=\"M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19ZM7 10H9V17H7V10ZM11 7H13V17H11V7ZM15 13H17V17H15V13Z\"\n                fill=\"currentColor\"\n              />\n            </svg>\n          </div>\n          <div>\n            <h1 class=\"page-title\">Sales Pipeline</h1>\n            <p class=\"page-subtitle\">Manage your sales inquiries and quotations</p>\n          </div>\n        </div>\n        <div class=\"header-actions\">\n          <VaSelect\n            v-model=\"seasonFilter\"\n            :options=\"seasonOptions\"\n            placeholder=\"All Seasons\"\n            class=\"season-select\"\n            clearable\n            @update:modelValue=\"loadPipeline\"\n          />\n          <VaButton preset=\"secondary\" icon=\"refresh\" :loading=\"loading\" @click=\"loadPipeline\"> Refresh </VaButton>\n        </div>\n      </div>\n    </div>\n\n    <!-- Pipeline Content -->\n    <div class=\"pipeline-content\">\n      <!-- Loading State -->\n      <div v-if=\"loading && !hasData\" class=\"loading-container py-8\">\n        <VaProgressBar indeterminate />\n        <p class=\"text-center mt-4 text-gray-600\">Loading pipeline...</p>\n      </div>\n\n      <!-- Pipeline Columns -->\n      <div v-else class=\"pipeline-columns\">\n        <!-- Cancelled Column (moved to beginning) -->\n        <div class=\"pipeline-column cancelled-column\">\n          <div class=\"column-header\" :style=\"{ borderColor: '#6b7280' }\">\n            <div class=\"column-title\">\n              <VaIcon name=\"cancel\" color=\"secondary\" />\n              <span>Cancelled</span>\n            </div>\n            <VaBadge :text=\"String(counts.cancelled)\" color=\"secondary\" />\n          </div>\n          <div class=\"column-content\">\n            <div v-if=\"pipeline.cancelled.length === 0\" class=\"empty-column\">\n              <VaIcon name=\"cancel\" size=\"2rem\" color=\"secondary\" />\n              <span>No cancelled items</span>\n            </div>\n            <PipelineCard\n              v-for=\"item in pipeline.cancelled\"\n              :key=\"`cancelled-${item.id}`\"\n              :item=\"item\"\n              @view=\"handleViewProposal(item)\"\n              @click=\"handleCardClick(item)\"\n            />\n          </div>\n        </div>\n\n        <!-- New Inquiries Column -->\n        <div class=\"pipeline-column\">\n          <div class=\"column-header\" :style=\"{ borderColor: '#f59e0b' }\">\n            <div class=\"column-title\">\n              <VaIcon name=\"fiber_new\" color=\"warning\" />\n              <span>New Inquiries</span>\n            </div>\n            <VaBadge :text=\"String(counts.new_inquiries)\" color=\"warning\" />\n          </div>\n          <div class=\"column-content\">\n            <div v-if=\"pipeline.new_inquiries.length === 0\" class=\"empty-column\">\n              <VaIcon name=\"inbox\" size=\"2rem\" color=\"secondary\" />\n              <span>No new inquiries</span>\n            </div>\n            <PipelineCard\n              v-for=\"item in pipeline.new_inquiries\"\n              :key=\"`new-${item.id}`\"\n              :item=\"item\"\n              @createProposal=\"handleCreateProposal(item)\"\n              @click=\"handleCardClick(item)\"\n            />\n          </div>\n        </div>\n\n        <!-- Quotation + Provision (merged) -->\n        <div class=\"pipeline-column merged-quotation\">\n          <div class=\"column-header\" :style=\"{ borderColor: '#f59e0b' }\">\n            <div class=\"column-title\">\n              <VaIcon name=\"description\" color=\"warning\" />\n              <span>Quotation / Provision</span>\n            </div>\n            <VaBadge :text=\"String(counts.pending + counts.provision_sales)\" color=\"warning\" />\n          </div>\n          <div class=\"column-content\">\n            <div v-if=\"pipeline.pending.length + pipeline.provision_sales.length === 0\" class=\"empty-column\">\n              <VaIcon name=\"hourglass_empty\" size=\"2rem\" color=\"secondary\" />\n              <span>No quotation or provisional sales</span>\n            </div>\n            <PipelineCard\n              v-for=\"item in [...pipeline.pending, ...pipeline.provision_sales]\"\n              :key=\"`quoteprov-${item.id}`\"\n              :item=\"item\"\n              @view=\"handleViewProposal(item)\"\n              @edit=\"handleEditProposal(item)\"\n              @click=\"handleCardClick(item)\"\n            />\n          </div>\n        </div>\n      </div>\n\n      <!-- Proposal View Modal -->\n      <VaModal v-model=\"showViewModal\" size=\"large\" :hide-default-actions=\"true\" title=\"Proposal Details\">\n        <ProposalView\n          v-if=\"currentProposal\"\n          :proposal=\"currentProposal\"\n          @edit=\"handleEditFromView\"\n          @statusChange=\"handleStatusChange\"\n        />\n        <div class=\"flex justify-end mt-4\">\n          <VaButton preset=\"secondary\" @click=\"showViewModal = false\">Close</VaButton>\n        </div>\n      </VaModal>\n\n      <!-- Proposal Form Modal -->\n      <VaModal\n        v-model=\"showFormModal\"\n        size=\"large\"\n        :hide-default-actions=\"true\"\n        :title=\"isEditMode ? 'Edit Quotation' : 'Create Quotation'\"\n      >\n        <ProposalForm\n          :proposal=\"editingProposal\"\n          :is-edit=\"isEditMode\"\n          :preselected-inquiry=\"preselectedInquiry\"\n          @save=\"handleSaveProposal\"\n          @cancel=\"showFormModal = false\"\n        />\n      </VaModal>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue'\nimport { mapActions, mapState } from 'pinia'\nimport { useProposalStore } from '../../../stores/proposal-store'\nimport { useToast } from 'vuestic-ui'\nimport axios from 'axios'\nimport PipelineCard from './components/PipelineCard.vue'\nimport ProposalView from './components/ProposalView.vue'\nimport ProposalForm from './components/ProposalForm.vue'\nimport { useGlobalStore } from '../../../stores/global-store'\n\nexport default defineComponent({\n  name: 'SalesPipeline',\n  components: {\n    PipelineCard,\n    ProposalView,\n    ProposalForm,\n  },\n  setup() {\n    const { init } = useToast()\n    const globalStore = useGlobalStore()\n    return { init, globalStore }\n  },\n  data() {\n    return {\n      seasonFilter: null as number | null,\n      seasonOptions: [] as { value: number; text: string }[],\n      showViewModal: false,\n      showFormModal: false,\n      editingProposal: null as any,\n      isEditMode: false,\n      preselectedInquiry: null as any,\n    }\n  },\n  computed: {\n    ...mapState(useProposalStore, ['pipeline', 'pipelineCounts', 'currentProposal', 'loading', 'saving']),\n    counts(): any {\n      return (\n        this.pipelineCounts || {\n          new_inquiries: 0,\n          pending: 0,\n          provision_sales: 0,\n          confirmed: 0,\n          cancelled: 0,\n          completed: 0,\n        }\n      )\n    },\n    hasData(): boolean {\n      return Object.values(this.counts).reduce((sum: number, count: any) => sum + count, 0) > 0\n    },\n  },\n  mounted() {\n    // Collapse sidebar to show full pipeline without horizontal scroll\n    this.globalStore.isSidebarMinimized = true\n    this.loadPipeline()\n    this.loadSeasons()\n  },\n  methods: {\n    ...mapActions(useProposalStore, [\n      'fetchPipeline',\n      'fetchProposalById',\n      'createProposal',\n      'updateProposal',\n      'updateProposalStatus',\n      'clearCurrentProposal',\n    ]),\n\n    async loadPipeline() {\n      try {\n        await this.fetchPipeline(undefined, this.seasonFilter || undefined)\n      } catch (error) {\n        this.init({\n          message: 'Failed to load pipeline',\n          color: 'danger',\n        })\n      }\n    },\n\n    async loadSeasons() {\n      try {\n        const url = `${import.meta.env.VITE_APP_BASE_URL}settings/seasons`\n        const response = await axios.get(url)\n        if (response.data) {\n          const seasons = Array.isArray(response.data) ? response.data : response.data.data || []\n          this.seasonOptions = seasons.map((s: any) => ({\n            value: s.id,\n            text: s.name,\n          }))\n        }\n      } catch (error) {\n        console.error('Error loading seasons:', error)\n      }\n    },\n\n    handleCardClick(item: any) {\n      if (item.type === 'proposal') {\n        this.handleViewProposal(item)\n      }\n    },\n\n    async handleViewProposal(item: any) {\n      try {\n        const proposalId = item.proposal_id || item.confirmation_id\n        if (proposalId) {\n          await this.fetchProposalById(proposalId)\n          this.showViewModal = true\n        } else {\n          this.init({\n            message: 'No quotation found for this item',\n            color: 'warning',\n          })\n        }\n      } catch (error) {\n        this.init({\n          message: 'Failed to load quotation details',\n          color: 'danger',\n        })\n      }\n    },\n\n    handleEditProposal(item: any) {\n      const proposalId = item.proposal_id || item.confirmation_id\n      if (proposalId) {\n        this.fetchProposalById(proposalId).then(() => {\n          this.editingProposal = this.currentProposal\n          this.isEditMode = true\n          this.preselectedInquiry = null\n          this.showFormModal = true\n        })\n      }\n    },\n\n    handleEditFromView() {\n      this.showViewModal = false\n      this.editingProposal = this.currentProposal\n      this.isEditMode = true\n      this.preselectedInquiry = null\n      this.showFormModal = true\n    },\n\n    handleCreateProposal(inquiry: any) {\n      this.editingProposal = null\n      this.isEditMode = false\n      this.preselectedInquiry = inquiry\n      this.showFormModal = true\n    },\n\n    async handleSaveProposal(data: any) {\n      try {\n        if (this.isEditMode && this.editingProposal?.id) {\n          await this.updateProposal(this.editingProposal.id, data)\n          this.init({\n            message: 'Quotation updated successfully',\n            color: 'success',\n          })\n        } else {\n          await this.createProposal(data)\n          this.init({\n            message: 'Quotation created successfully',\n            color: 'success',\n          })\n        }\n        this.showFormModal = false\n        this.loadPipeline()\n      } catch (error: any) {\n        this.init({\n          message: error.response?.data?.message || 'Failed to save quotation',\n          color: 'danger',\n        })\n      }\n    },\n\n    async handleStatusChange(data: { id: number; status: string }) {\n      try {\n        await this.updateProposalStatus(data.id, data.status)\n        this.init({\n          message: `Proposal status changed to ${data.status}`,\n          color: 'success',\n        })\n        await this.fetchProposalById(data.id)\n        this.loadPipeline()\n      } catch (error) {\n        this.init({\n          message: 'Failed to update proposal status',\n          color: 'danger',\n        })\n      }\n    },\n  },\n})\n</script>\n\n<style lang=\"scss\" scoped>\n.sales-pipeline-page {\n  min-height: 100vh;\n  background: #f8fafc;\n  padding: 24px;\n}\n\n.pipeline-header {\n  background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);\n  border-radius: 12px;\n  padding: 24px;\n  margin-bottom: 24px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);\n  border: 1px solid #e2e8f0;\n}\n\n.header-content {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  flex-wrap: wrap;\n  gap: 16px;\n}\n\n.header-title-section {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n}\n\n.title-icon {\n  width: 48px;\n  height: 48px;\n  background: linear-gradient(135deg, #4f46e5, #06b6d4);\n  border-radius: 12px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);\n}\n\n.page-title {\n  font-size: 28px;\n  font-weight: 700;\n  color: #1e293b;\n  margin: 0;\n  line-height: 1.2;\n}\n\n.page-subtitle {\n  font-size: 14px;\n  color: #64748b;\n  margin: 4px 0 0 0;\n}\n\n.header-actions {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n\n.season-select {\n  min-width: 200px;\n}\n\n.pipeline-content {\n  width: 100%;\n}\n\n/* Pipeline Columns - Responsive Grid Layout */\n.pipeline-columns {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\n  gap: 16px;\n  align-items: start;\n  padding-bottom: 24px;\n}\n\n.pipeline-column {\n  background: #ffffff;\n  border-radius: 12px;\n  display: flex;\n  flex-direction: column;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);\n  border: 1px solid #e2e8f0;\n  min-height: 200px;\n  max-height: none;\n  transition: all 0.3s ease;\n\n  &:hover {\n    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);\n  }\n}\n\n.column-header {\n  padding: 16px;\n  border-bottom: 3px solid;\n  background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);\n  border-radius: 12px 12px 0 0;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  flex-shrink: 0;\n  position: sticky;\n  top: 0;\n  z-index: 10;\n}\n\n.column-title {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-weight: 600;\n  font-size: 15px;\n  color: #1e293b;\n}\n\n.column-content {\n  flex: 1;\n  padding: 16px;\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n  overflow: visible;\n  min-height: 100px;\n}\n\n.table-content {\n  padding: 0;\n  overflow-x: auto;\n\n  table {\n    width: 100%;\n    border-collapse: collapse;\n\n    thead {\n      background: #f8fafc;\n      position: sticky;\n      top: 0;\n      z-index: 5;\n\n      th {\n        padding: 12px;\n        text-align: left;\n        font-weight: 600;\n        font-size: 13px;\n        color: #475569;\n        border-bottom: 2px solid #e2e8f0;\n        white-space: nowrap;\n      }\n    }\n\n    tbody {\n      tr {\n        border-bottom: 1px solid #f1f5f9;\n        transition: background 0.2s ease;\n\n        &:hover {\n          background: #f8fafc;\n        }\n\n        td {\n          padding: 12px;\n          font-size: 13px;\n          color: #64748b;\n        }\n      }\n    }\n  }\n}\n\n.empty-column {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 48px 24px;\n  color: #94a3b8;\n  text-align: center;\n  gap: 12px;\n  min-height: 200px;\n\n  span {\n    font-size: 14px;\n    font-weight: 500;\n  }\n}\n\n.loading-container {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 80px 20px;\n  background: #ffffff;\n  border-radius: 12px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);\n}\n\n/* Column-specific styling */\n.cancelled-column .column-header {\n  border-color: #94a3b8;\n  background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);\n}\n\n.merged-quotation .column-header {\n  border-color: #f59e0b;\n}\n\n/* Responsive Design */\n@media (min-width: 1600px) {\n  .pipeline-columns {\n    grid-template-columns: repeat(4, 1fr);\n  }\n}\n\n@media (max-width: 1400px) {\n  .pipeline-columns {\n    grid-template-columns: repeat(3, 1fr);\n  }\n}\n\n@media (max-width: 1024px) {\n  .sales-pipeline-page {\n    padding: 16px;\n  }\n\n  .pipeline-columns {\n    grid-template-columns: repeat(2, 1fr);\n  }\n\n  .header-content {\n    flex-direction: column;\n    align-items: flex-start;\n  }\n\n  .header-actions {\n    width: 100%;\n    justify-content: flex-end;\n  }\n}\n\n@media (max-width: 768px) {\n  .pipeline-columns {\n    grid-template-columns: 1fr;\n  }\n\n  .table-content {\n    overflow-x: auto;\n\n    table {\n      min-width: 800px;\n    }\n  }\n\n  .page-title {\n    font-size: 24px;\n  }\n\n  .header-actions {\n    flex-direction: column;\n    width: 100%;\n\n    .season-select {\n      width: 100%;\n    }\n  }\n}\n\n/* Scrollbar styling for table */\n.table-content::-webkit-scrollbar {\n  height: 8px;\n}\n\n.table-content::-webkit-scrollbar-track {\n  background: #f1f5f9;\n  border-radius: 4px;\n}\n\n.table-content::-webkit-scrollbar-thumb {\n  background: #cbd5e1;\n  border-radius: 4px;\n}\n\n.table-content::-webkit-scrollbar-thumb:hover {\n  background: #94a3b8;\n}\n</style>\n","<template>\n  <div class=\"sales-pipeline-page\">\n    <!-- Header Section -->\n    <div class=\"pipeline-header\">\n      <div class=\"header-content\">\n        <div class=\"header-title-section\">\n          <div class=\"title-icon\">\n            <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n              <path\n                d=\"M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19ZM7 10H9V17H7V10ZM11 7H13V17H11V7ZM15 13H17V17H15V13Z\"\n                fill=\"currentColor\"\n              />\n            </svg>\n          </div>\n          <div>\n            <h1 class=\"page-title\">Sales Pipeline</h1>\n            <p class=\"page-subtitle\">Manage your sales inquiries and quotations</p>\n          </div>\n        </div>\n        <div class=\"header-actions\">\n          <VaSelect\n            v-model=\"seasonFilter\"\n            :options=\"seasonOptions\"\n            placeholder=\"All Seasons\"\n            class=\"season-select\"\n            clearable\n            @update:modelValue=\"loadPipeline\"\n          />\n          <VaButton preset=\"secondary\" icon=\"refresh\" :loading=\"loading\" @click=\"loadPipeline\"> Refresh </VaButton>\n        </div>\n      </div>\n    </div>\n\n    <!-- Pipeline Content -->\n    <div class=\"pipeline-content\">\n      <!-- Loading State -->\n      <div v-if=\"loading && !hasData\" class=\"loading-container py-8\">\n        <VaProgressBar indeterminate />\n        <p class=\"text-center mt-4 text-gray-600\">Loading pipeline...</p>\n      </div>\n\n      <!-- Pipeline Columns -->\n      <div v-else class=\"pipeline-columns\">\n        <!-- Cancelled Column (moved to beginning) -->\n        <div class=\"pipeline-column cancelled-column\">\n          <div class=\"column-header\" :style=\"{ borderColor: '#6b7280' }\">\n            <div class=\"column-title\">\n              <VaIcon name=\"cancel\" color=\"secondary\" />\n              <span>Cancelled</span>\n            </div>\n            <VaBadge :text=\"String(counts.cancelled)\" color=\"secondary\" />\n          </div>\n          <div class=\"column-content\">\n            <div v-if=\"pipeline.cancelled.length === 0\" class=\"empty-column\">\n              <VaIcon name=\"cancel\" size=\"2rem\" color=\"secondary\" />\n              <span>No cancelled items</span>\n            </div>\n            <PipelineCard\n              v-for=\"item in pipeline.cancelled\"\n              :key=\"`cancelled-${item.id}`\"\n              :item=\"item\"\n              @view=\"handleViewProposal(item)\"\n              @click=\"handleCardClick(item)\"\n            />\n          </div>\n        </div>\n\n        <!-- New Inquiries Column -->\n        <div class=\"pipeline-column\">\n          <div class=\"column-header\" :style=\"{ borderColor: '#f59e0b' }\">\n            <div class=\"column-title\">\n              <VaIcon name=\"fiber_new\" color=\"warning\" />\n              <span>New Inquiries</span>\n            </div>\n            <VaBadge :text=\"String(counts.new_inquiries)\" color=\"warning\" />\n          </div>\n          <div class=\"column-content\">\n            <div v-if=\"pipeline.new_inquiries.length === 0\" class=\"empty-column\">\n              <VaIcon name=\"inbox\" size=\"2rem\" color=\"secondary\" />\n              <span>No new inquiries</span>\n            </div>\n            <PipelineCard\n              v-for=\"item in pipeline.new_inquiries\"\n              :key=\"`new-${item.id}`\"\n              :item=\"item\"\n              @createProposal=\"handleCreateProposal(item)\"\n              @click=\"handleCardClick(item)\"\n            />\n          </div>\n        </div>\n\n        <!-- Quotation + Provision (merged) -->\n        <div class=\"pipeline-column merged-quotation\">\n          <div class=\"column-header\" :style=\"{ borderColor: '#f59e0b' }\">\n            <div class=\"column-title\">\n              <VaIcon name=\"description\" color=\"warning\" />\n              <span>Quotation / Provision</span>\n            </div>\n            <VaBadge :text=\"String(counts.pending + counts.provision_sales)\" color=\"warning\" />\n          </div>\n          <div class=\"column-content\">\n            <div v-if=\"pipeline.pending.length + pipeline.provision_sales.length === 0\" class=\"empty-column\">\n              <VaIcon name=\"hourglass_empty\" size=\"2rem\" color=\"secondary\" />\n              <span>No quotation or provisional sales</span>\n            </div>\n            <PipelineCard\n              v-for=\"item in [...pipeline.pending, ...pipeline.provision_sales]\"\n              :key=\"`quoteprov-${item.id}`\"\n              :item=\"item\"\n              @view=\"handleViewProposal(item)\"\n              @edit=\"handleEditProposal(item)\"\n              @click=\"handleCardClick(item)\"\n            />\n          </div>\n        </div>\n      </div>\n\n      <!-- Proposal View Modal -->\n      <VaModal v-model=\"showViewModal\" size=\"large\" :hide-default-actions=\"true\" title=\"Proposal Details\">\n        <ProposalView\n          v-if=\"currentProposal\"\n          :proposal=\"currentProposal\"\n          @edit=\"handleEditFromView\"\n          @statusChange=\"handleStatusChange\"\n        />\n        <div class=\"flex justify-end mt-4\">\n          <VaButton preset=\"secondary\" @click=\"showViewModal = false\">Close</VaButton>\n        </div>\n      </VaModal>\n\n      <!-- Proposal Form Modal -->\n      <VaModal\n        v-model=\"showFormModal\"\n        size=\"large\"\n        :hide-default-actions=\"true\"\n        :title=\"isEditMode ? 'Edit Quotation' : 'Create Quotation'\"\n      >\n        <ProposalForm\n          :proposal=\"editingProposal\"\n          :is-edit=\"isEditMode\"\n          :preselected-inquiry=\"preselectedInquiry\"\n          @save=\"handleSaveProposal\"\n          @cancel=\"showFormModal = false\"\n        />\n      </VaModal>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue'\nimport { mapActions, mapState } from 'pinia'\nimport { useProposalStore } from '../../../stores/proposal-store'\nimport { useToast } from 'vuestic-ui'\nimport axios from 'axios'\nimport PipelineCard from './components/PipelineCard.vue'\nimport ProposalView from './components/ProposalView.vue'\nimport ProposalForm from './components/ProposalForm.vue'\nimport { useGlobalStore } from '../../../stores/global-store'\n\nexport default defineComponent({\n  name: 'SalesPipeline',\n  components: {\n    PipelineCard,\n    ProposalView,\n    ProposalForm,\n  },\n  setup() {\n    const { init } = useToast()\n    const globalStore = useGlobalStore()\n    return { init, globalStore }\n  },\n  data() {\n    return {\n      seasonFilter: null as number | null,\n      seasonOptions: [] as { value: number; text: string }[],\n      showViewModal: false,\n      showFormModal: false,\n      editingProposal: null as any,\n      isEditMode: false,\n      preselectedInquiry: null as any,\n    }\n  },\n  computed: {\n    ...mapState(useProposalStore, ['pipeline', 'pipelineCounts', 'currentProposal', 'loading', 'saving']),\n    counts(): any {\n      return (\n        this.pipelineCounts || {\n          new_inquiries: 0,\n          pending: 0,\n          provision_sales: 0,\n          confirmed: 0,\n          cancelled: 0,\n          completed: 0,\n        }\n      )\n    },\n    hasData(): boolean {\n      return Object.values(this.counts).reduce((sum: number, count: any) => sum + count, 0) > 0\n    },\n  },\n  mounted() {\n    // Collapse sidebar to show full pipeline without horizontal scroll\n    this.globalStore.isSidebarMinimized = true\n    this.loadPipeline()\n    this.loadSeasons()\n  },\n  methods: {\n    ...mapActions(useProposalStore, [\n      'fetchPipeline',\n      'fetchProposalById',\n      'createProposal',\n      'updateProposal',\n      'updateProposalStatus',\n      'clearCurrentProposal',\n    ]),\n\n    async loadPipeline() {\n      try {\n        await this.fetchPipeline(undefined, this.seasonFilter || undefined)\n      } catch (error) {\n        this.init({\n          message: 'Failed to load pipeline',\n          color: 'danger',\n        })\n      }\n    },\n\n    async loadSeasons() {\n      try {\n        const url = `${import.meta.env.VITE_APP_BASE_URL}settings/seasons`\n        const response = await axios.get(url)\n        if (response.data) {\n          const seasons = Array.isArray(response.data) ? response.data : response.data.data || []\n          this.seasonOptions = seasons.map((s: any) => ({\n            value: s.id,\n            text: s.name,\n          }))\n        }\n      } catch (error) {\n        console.error('Error loading seasons:', error)\n      }\n    },\n\n    handleCardClick(item: any) {\n      if (item.type === 'proposal') {\n        this.handleViewProposal(item)\n      }\n    },\n\n    async handleViewProposal(item: any) {\n      try {\n        const proposalId = item.proposal_id || item.confirmation_id\n        if (proposalId) {\n          await this.fetchProposalById(proposalId)\n          this.showViewModal = true\n        } else {\n          this.init({\n            message: 'No quotation found for this item',\n            color: 'warning',\n          })\n        }\n      } catch (error) {\n        this.init({\n          message: 'Failed to load quotation details',\n          color: 'danger',\n        })\n      }\n    },\n\n    handleEditProposal(item: any) {\n      const proposalId = item.proposal_id || item.confirmation_id\n      if (proposalId) {\n        this.fetchProposalById(proposalId).then(() => {\n          this.editingProposal = this.currentProposal\n          this.isEditMode = true\n          this.preselectedInquiry = null\n          this.showFormModal = true\n        })\n      }\n    },\n\n    handleEditFromView() {\n      this.showViewModal = false\n      this.editingProposal = this.currentProposal\n      this.isEditMode = true\n      this.preselectedInquiry = null\n      this.showFormModal = true\n    },\n\n    handleCreateProposal(inquiry: any) {\n      this.editingProposal = null\n      this.isEditMode = false\n      this.preselectedInquiry = inquiry\n      this.showFormModal = true\n    },\n\n    async handleSaveProposal(data: any) {\n      try {\n        if (this.isEditMode && this.editingProposal?.id) {\n          await this.updateProposal(this.editingProposal.id, data)\n          this.init({\n            message: 'Quotation updated successfully',\n            color: 'success',\n          })\n        } else {\n          await this.createProposal(data)\n          this.init({\n            message: 'Quotation created successfully',\n            color: 'success',\n          })\n        }\n        this.showFormModal = false\n        this.loadPipeline()\n      } catch (error: any) {\n        this.init({\n          message: error.response?.data?.message || 'Failed to save quotation',\n          color: 'danger',\n        })\n      }\n    },\n\n    async handleStatusChange(data: { id: number; status: string }) {\n      try {\n        await this.updateProposalStatus(data.id, data.status)\n        this.init({\n          message: `Proposal status changed to ${data.status}`,\n          color: 'success',\n        })\n        await this.fetchProposalById(data.id)\n        this.loadPipeline()\n      } catch (error) {\n        this.init({\n          message: 'Failed to update proposal status',\n          color: 'danger',\n        })\n      }\n    },\n  },\n})\n</script>\n\n<style lang=\"scss\" scoped>\n.sales-pipeline-page {\n  min-height: 100vh;\n  background: #f8fafc;\n  padding: 24px;\n}\n\n.pipeline-header {\n  background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);\n  border-radius: 12px;\n  padding: 24px;\n  margin-bottom: 24px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);\n  border: 1px solid #e2e8f0;\n}\n\n.header-content {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  flex-wrap: wrap;\n  gap: 16px;\n}\n\n.header-title-section {\n  display: flex;\n  align-items: center;\n  gap: 16px;\n}\n\n.title-icon {\n  width: 48px;\n  height: 48px;\n  background: linear-gradient(135deg, #4f46e5, #06b6d4);\n  border-radius: 12px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);\n}\n\n.page-title {\n  font-size: 28px;\n  font-weight: 700;\n  color: #1e293b;\n  margin: 0;\n  line-height: 1.2;\n}\n\n.page-subtitle {\n  font-size: 14px;\n  color: #64748b;\n  margin: 4px 0 0 0;\n}\n\n.header-actions {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n\n.season-select {\n  min-width: 200px;\n}\n\n.pipeline-content {\n  width: 100%;\n}\n\n/* Pipeline Columns - Responsive Grid Layout */\n.pipeline-columns {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\n  gap: 16px;\n  align-items: start;\n  padding-bottom: 24px;\n}\n\n.pipeline-column {\n  background: #ffffff;\n  border-radius: 12px;\n  display: flex;\n  flex-direction: column;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);\n  border: 1px solid #e2e8f0;\n  min-height: 200px;\n  max-height: none;\n  transition: all 0.3s ease;\n\n  &:hover {\n    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);\n  }\n}\n\n.column-header {\n  padding: 16px;\n  border-bottom: 3px solid;\n  background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);\n  border-radius: 12px 12px 0 0;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  flex-shrink: 0;\n  position: sticky;\n  top: 0;\n  z-index: 10;\n}\n\n.column-title {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-weight: 600;\n  font-size: 15px;\n  color: #1e293b;\n}\n\n.column-content {\n  flex: 1;\n  padding: 16px;\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n  overflow: visible;\n  min-height: 100px;\n}\n\n.table-content {\n  padding: 0;\n  overflow-x: auto;\n\n  table {\n    width: 100%;\n    border-collapse: collapse;\n\n    thead {\n      background: #f8fafc;\n      position: sticky;\n      top: 0;\n      z-index: 5;\n\n      th {\n        padding: 12px;\n        text-align: left;\n        font-weight: 600;\n        font-size: 13px;\n        color: #475569;\n        border-bottom: 2px solid #e2e8f0;\n        white-space: nowrap;\n      }\n    }\n\n    tbody {\n      tr {\n        border-bottom: 1px solid #f1f5f9;\n        transition: background 0.2s ease;\n\n        &:hover {\n          background: #f8fafc;\n        }\n\n        td {\n          padding: 12px;\n          font-size: 13px;\n          color: #64748b;\n        }\n      }\n    }\n  }\n}\n\n.empty-column {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 48px 24px;\n  color: #94a3b8;\n  text-align: center;\n  gap: 12px;\n  min-height: 200px;\n\n  span {\n    font-size: 14px;\n    font-weight: 500;\n  }\n}\n\n.loading-container {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 80px 20px;\n  background: #ffffff;\n  border-radius: 12px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);\n}\n\n/* Column-specific styling */\n.cancelled-column .column-header {\n  border-color: #94a3b8;\n  background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);\n}\n\n.merged-quotation .column-header {\n  border-color: #f59e0b;\n}\n\n/* Responsive Design */\n@media (min-width: 1600px) {\n  .pipeline-columns {\n    grid-template-columns: repeat(4, 1fr);\n  }\n}\n\n@media (max-width: 1400px) {\n  .pipeline-columns {\n    grid-template-columns: repeat(3, 1fr);\n  }\n}\n\n@media (max-width: 1024px) {\n  .sales-pipeline-page {\n    padding: 16px;\n  }\n\n  .pipeline-columns {\n    grid-template-columns: repeat(2, 1fr);\n  }\n\n  .header-content {\n    flex-direction: column;\n    align-items: flex-start;\n  }\n\n  .header-actions {\n    width: 100%;\n    justify-content: flex-end;\n  }\n}\n\n@media (max-width: 768px) {\n  .pipeline-columns {\n    grid-template-columns: 1fr;\n  }\n\n  .table-content {\n    overflow-x: auto;\n\n    table {\n      min-width: 800px;\n    }\n  }\n\n  .page-title {\n    font-size: 24px;\n  }\n\n  .header-actions {\n    flex-direction: column;\n    width: 100%;\n\n    .season-select {\n      width: 100%;\n    }\n  }\n}\n\n/* Scrollbar styling for table */\n.table-content::-webkit-scrollbar {\n  height: 8px;\n}\n\n.table-content::-webkit-scrollbar-track {\n  background: #f1f5f9;\n  border-radius: 4px;\n}\n\n.table-content::-webkit-scrollbar-thumb {\n  background: #cbd5e1;\n  border-radius: 4px;\n}\n\n.table-content::-webkit-scrollbar-thumb:hover {\n  background: #94a3b8;\n}\n</style>\n"],"names":["_sfc_main$2","defineComponent","details","formatDate","dateStr","start","end","days","species","amount","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_14","_hoisted_16","_hoisted_18","_hoisted_19","_createElementBlock","_normalizeClass","_ctx","_cache","args","_createElementVNode","_toDisplayString","_a","_b","_createVNode","_component_VaIcon","_c","_d","_openBlock","_hoisted_13","_hoisted_15","_e","_hoisted_17","_createCommentVNode","_createBlock","_component_VaButton","_withModifiers","$event","_withCtx","_createTextVNode","_Fragment","_sfc_main$1","validate","reset","useForm","mapState","useProposalStore","sum","inst","response","axios","newInquiries","item","_f","_g","_h","_i","_j","_k","error","inquiry","option","opt","selected","index","payload","format","dueType","amountType","_hoisted_21","_hoisted_22","_hoisted_23","_component_VaForm","_component_VaCard","_component_VaCardTitle","_component_VaCardContent","_component_VaAlert","_component_VaSelect","v","value","_component_VaDateInput","_component_VaInput","_component_VaTextarea","_renderList","installment","_hoisted_20","useGlobalStore","defineStore","_sfc_main","PipelineCard","ProposalView","ProposalForm","init","useToast","globalStore","count","mapActions","seasons","s","proposalId","data","_createStaticVNode","_component_VaProgressBar","_component_VaBadge","_component_PipelineCard","_component_VaModal","_component_ProposalView","_component_ProposalForm"],"mappings":"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"}