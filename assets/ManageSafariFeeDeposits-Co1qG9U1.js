import{d as v,m as S,s as T,_ as E,g as y,b as o,w as a,i as r,e as i,h as l,a as N,t as p,v as A,F as B,o as c}from"./index-P4QeRV7n.js";import{u as $}from"./useForm-XQT-jLAz.js";import{u as U}from"./useToast-DVuIP6Z-.js";import{u as j}from"./settings-store-BoS8g_yz.js";import{h as _}from"./errorHandler-DijQ3xmc.js";const z=v({name:"ManageSafariFeeDeposits",setup(){const e=T(),{validate:t}=$("formRef");return{formRef:e,validate:t}},data(){return{columns:[{key:"id",label:"ID",sortable:!0,width:80},{key:"safari_duration",label:"Safari Duration",sortable:!0},{key:"trophy_fee_deposit",label:"Trophy Fee Deposit",sortable:!0},{key:"created_at",label:"Created",sortable:!0},{key:"actions",label:"Actions",width:100}],toast:U(),loading:!1,saving:!1,deleting:!1,showFormModal:!1,showDeleteModal:!1,isEditMode:!1,editItemId:null,itemToDelete:null,items:[],form:{safari_duration:"",trophy_fee_deposit:null}}},mounted(){this.fetchItems()},methods:{...S(j,["getSafariFeeDeposits","createSafariFeeDeposit","updateSafariFeeDeposit","deleteSafariFeeDeposit"]),formatDate(e){return e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"},formatNumber(e){return!e&&e!==0?"0.00":parseFloat(String(e)).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},async fetchItems(){var e;this.loading=!0;try{const t=await this.getSafariFeeDeposits();t.status===200&&(this.items=t.data.data||t.data)}catch(t){console.error("Error loading safari fee deposits:",t),(e=this.toast)==null||e.init({message:"Failed to load safari fee deposits",color:"danger"})}finally{this.loading=!1}},openAddModal(){this.isEditMode=!1,this.editItemId=null,this.form={safari_duration:"",trophy_fee_deposit:null},this.showFormModal=!0},openEditModal(e){this.isEditMode=!0,this.editItemId=e.id,this.form={safari_duration:e.safari_duration||"",trophy_fee_deposit:parseFloat(e.trophy_fee_deposit)||null},this.showFormModal=!0},closeFormModal(){this.showFormModal=!1,this.form={safari_duration:"",trophy_fee_deposit:null}},async saveForm(){var n,f,h;if(!await this.validate())return;this.saving=!0;const t={safari_duration:this.form.safari_duration,trophy_fee_deposit:this.form.trophy_fee_deposit};try{this.isEditMode&&this.editItemId?(await this.updateSafariFeeDeposit(this.editItemId,t)).status===200&&((n=this.toast)==null||n.init({message:"Deposit updated successfully",color:"success"}),this.closeFormModal(),this.fetchItems()):(await this.createSafariFeeDeposit(t)).status===201&&((f=this.toast)==null||f.init({message:"Deposit created successfully",color:"success"}),this.closeFormModal(),this.fetchItems())}catch(u){const m=_(u.response);(h=this.toast)==null||h.init({message:m.join(", ")||"Failed to save",color:"danger"})}finally{this.saving=!1}},confirmDelete(e){this.itemToDelete=e,this.showDeleteModal=!0},async deleteItem(){var e,t;if(this.itemToDelete){this.deleting=!0;try{const n=await this.deleteSafariFeeDeposit(this.itemToDelete.id);(n.status===200||n.status===204)&&((e=this.toast)==null||e.init({message:"Deposit deleted successfully",color:"success"}),this.showDeleteModal=!1,this.itemToDelete=null,this.fetchItems())}catch(n){const f=_(n.response);(t=this.toast)==null||t.init({message:f.join(", ")||"Failed to delete",color:"danger"})}finally{this.deleting=!1}}}}}),L={class:"flex flex-col md:flex-row gap-2 mb-4 justify-between items-center"},R={class:"text-xl font-bold text-gray-700"},q={key:0,class:"text-center py-12"},G={class:"flex items-center gap-2"},H={class:"font-semibold"},J={class:"text-sm text-gray-600"},K={class:"flex gap-2"},O={class:"flex gap-2 justify-end"},P={key:0,class:"text-sm text-gray-500 mt-2"},Q={class:"flex gap-2 justify-end"};function W(e,t,n,f,h,u){const m=r("VaIcon"),d=r("VaButton"),V=r("VaDivider"),F=r("VaBadge"),M=r("VaDataTable"),C=r("VaInnerLoading"),k=r("VaCardContent"),w=r("VaCard"),g=r("VaInput"),b=r("VaForm"),D=r("VaModal");return c(),y(B,null,[o(w,{class:"manage-safari-fee-deposits-page"},{default:a(()=>[o(k,null,{default:a(()=>[i("div",L,[i("h2",R,[o(m,{name:"payments",class:"mr-2"}),t[5]||(t[5]=l(" Safari Fee Deposits "))]),o(d,{color:"primary",icon:"add",round:"",onClick:e.openAddModal},{default:a(()=>t[6]||(t[6]=[l(" Add New Deposit ")])),_:1},8,["onClick"])]),o(V),o(C,{loading:e.loading},{default:a(()=>[e.items.length===0&&!e.loading?(c(),y("div",q,[o(m,{name:"payments",size:"4rem",color:"#9B9FB5"}),t[8]||(t[8]=i("p",{class:"text-gray-500 mt-4"},"No safari fee deposits found.",-1)),o(d,{class:"mt-4",preset:"secondary",onClick:e.openAddModal},{default:a(()=>t[7]||(t[7]=[l("Add your first deposit")])),_:1},8,["onClick"])])):(c(),N(M,{key:1,items:e.items,columns:e.columns,hoverable:"",striped:""},{"cell(safari_duration)":a(({rowData:s})=>[i("div",G,[o(m,{name:"calendar_today",size:"small",color:"primary"}),i("span",H,p(s.safari_duration),1)])]),"cell(trophy_fee_deposit)":a(({rowData:s})=>[o(F,{text:"$"+e.formatNumber(s.trophy_fee_deposit),color:"success"},null,8,["text"])]),"cell(created_at)":a(({rowData:s})=>[i("span",J,p(e.formatDate(s.created_at)),1)]),"cell(actions)":a(({rowData:s})=>[i("div",K,[o(d,{preset:"plain",icon:"edit",color:"warning",size:"small",title:"Edit",onClick:I=>e.openEditModal(s)},null,8,["onClick"]),o(d,{preset:"plain",icon:"delete",color:"danger",size:"small",title:"Delete",onClick:I=>e.confirmDelete(s)},null,8,["onClick"])])]),_:1},8,["items","columns"]))]),_:1},8,["loading"])]),_:1})]),_:1}),o(D,{modelValue:e.showFormModal,"onUpdate:modelValue":t[2]||(t[2]=s=>e.showFormModal=s),title:e.isEditMode?"Edit Deposit":"Add New Deposit","hide-default-actions":""},{footer:a(()=>[i("div",O,[o(d,{preset:"secondary",onClick:e.closeFormModal},{default:a(()=>t[9]||(t[9]=[l("Cancel")])),_:1},8,["onClick"]),o(d,{color:"primary",loading:e.saving,onClick:e.saveForm},{default:a(()=>[l(p(e.isEditMode?"Update":"Save"),1)]),_:1},8,["loading","onClick"])])]),default:a(()=>[o(b,{ref:"formRef",name:"formRef",class:"space-y-4"},{default:a(()=>[o(g,{modelValue:e.form.safari_duration,"onUpdate:modelValue":t[0]||(t[0]=s=>e.form.safari_duration=s),label:"Safari Duration",placeholder:"e.g., 10 Days, 14 Days, 21 Days",rules:[s=>!!s||"Safari duration is required"],"required-mark":""},{prepend:a(()=>[o(m,{name:"calendar_today"})]),_:1},8,["modelValue","rules"]),o(g,{modelValue:e.form.trophy_fee_deposit,"onUpdate:modelValue":t[1]||(t[1]=s=>e.form.trophy_fee_deposit=s),modelModifiers:{number:!0},type:"number",label:"Trophy Fee Deposit (USD)",placeholder:"0.00",step:"0.01",min:"0",rules:[s=>Number(s)>0||"Deposit amount must be greater than 0"],"required-mark":""},{prepend:a(()=>[o(m,{name:"attach_money"})]),_:1},8,["modelValue","rules"])]),_:1},512)]),_:1},8,["modelValue","title"]),o(D,{modelValue:e.showDeleteModal,"onUpdate:modelValue":t[4]||(t[4]=s=>e.showDeleteModal=s),"hide-default-actions":""},{header:a(()=>t[10]||(t[10]=[i("h3",{class:"va-h6"},"Confirm Delete",-1)])),footer:a(()=>[i("div",Q,[o(d,{preset:"secondary",onClick:t[3]||(t[3]=s=>e.showDeleteModal=!1)},{default:a(()=>t[13]||(t[13]=[l("Cancel")])),_:1}),o(d,{color:"danger",loading:e.deleting,onClick:e.deleteItem},{default:a(()=>t[14]||(t[14]=[l("Delete")])),_:1},8,["loading","onClick"])])]),default:a(()=>[t[15]||(t[15]=i("p",null,"Are you sure you want to delete this safari fee deposit?",-1)),e.itemToDelete?(c(),y("p",P,[t[11]||(t[11]=i("strong",null,"Duration:",-1)),l(" "+p(e.itemToDelete.safari_duration)+" | ",1),t[12]||(t[12]=i("strong",null,"Deposit:",-1)),l(" $"+p(e.formatNumber(e.itemToDelete.trophy_fee_deposit)),1)])):A("",!0)]),_:1},8,["modelValue"])],64)}const te=E(z,[["render",W],["__scopeId","data-v-e502c98c"]]);export{te as default};
//# sourceMappingURL=ManageSafariFeeDeposits-Co1qG9U1.js.map
