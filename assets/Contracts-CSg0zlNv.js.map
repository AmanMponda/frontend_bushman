{"version":3,"file":"Contracts-CSg0zlNv.js","sources":["../../src/pages/client/dashboard/components/ContractDetails.vue","../../src/pages/client/dashboard/components/ContractDetails.vue","../../src/pages/client/dashboard/components/ContractForm.vue","../../src/pages/client/dashboard/components/ContractForm.vue","../../src/pages/client/dashboard/Contracts.vue","../../src/pages/client/dashboard/Contracts.vue"],"sourcesContent":["<template>\n  <div class=\"contract-details-page\">\n    <!-- Header Section -->\n    <div class=\"contract-header\">\n      <div class=\"header-content\">\n        <div class=\"header-icon\">\n          <svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n            <path\n              d=\"M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.89 22 5.99 22H18C19.1 22 20 21.1 20 20V8L14 2ZM18 20H6V4H13V9H18V20Z\"\n              fill=\"currentColor\"\n            />\n          </svg>\n        </div>\n        <div class=\"header-text\">\n          <h1 class=\"page-title\">{{ isEditMode ? 'Upload Documents' : 'Contract Details' }}</h1>\n          <p class=\"page-subtitle\">{{ contractItem?.contract_number || 'Contract Information' }}</p>\n        </div>\n        <div class=\"header-actions\">\n          <span class=\"status-badge\" :class=\"getContractStatusClass()\">\n            {{ contractItem?.contractor_type || 'CONTRACT' }}\n          </span>\n          <VaButton\n            v-if=\"!isEditMode\"\n            color=\"primary\"\n            icon=\"download\"\n            :loading=\"downloadingPdf\"\n            class=\"download-pdf-btn\"\n            @click=\"downloadContractPdf\"\n          >\n            Download PDF\n          </VaButton>\n        </div>\n      </div>\n    </div>\n\n    <!-- Contract Overview Card -->\n    <div class=\"contract-overview-card\">\n      <div class=\"card-header\">\n        <h3 class=\"card-title\">\n          <svg\n            class=\"card-icon\"\n            width=\"20\"\n            height=\"20\"\n            viewBox=\"0 0 24 24\"\n            fill=\"none\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <path\n              d=\"M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19ZM7 10H9V17H7V10ZM11 7H13V17H11V7ZM15 13H17V17H15V13Z\"\n              fill=\"currentColor\"\n            />\n          </svg>\n          Contract Overview\n        </h3>\n      </div>\n      <div class=\"card-content\">\n        <div class=\"overview-grid\">\n          <div class=\"overview-item\">\n            <span class=\"overview-label\">Contract Number</span>\n            <span class=\"overview-value highlight\">{{ contractItem?.contract_number || 'N/A' }}</span>\n          </div>\n          <div class=\"overview-item\">\n            <span class=\"overview-label\">Description</span>\n            <span class=\"overview-value\">{{ contractItem?.description || 'N/A' }}</span>\n          </div>\n          <div class=\"overview-item\">\n            <span class=\"overview-label\">Start Date</span>\n            <span class=\"overview-value\">{{ formatDateTime(contractItem?.start_date) || 'N/A' }}</span>\n          </div>\n          <div class=\"overview-item\">\n            <span class=\"overview-label\">End Date</span>\n            <span class=\"overview-value\">{{ formatDateTime(contractItem?.end_date) || 'N/A' }}</span>\n          </div>\n          <div class=\"overview-item\">\n            <span class=\"overview-label\">Duration</span>\n            <span class=\"overview-value\">{{ calculateDuration() }}</span>\n          </div>\n          <div class=\"overview-item\">\n            <span class=\"overview-label\">Created</span>\n            <span class=\"overview-value\">{{ formatDateTime(contractItem?.created_at) || 'N/A' }}</span>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Client Information Card -->\n    <div v-if=\"contractItem?.entity\" class=\"info-card\">\n      <div class=\"card-header\">\n        <h3 class=\"card-title\">\n          <svg\n            class=\"card-icon\"\n            width=\"20\"\n            height=\"20\"\n            viewBox=\"0 0 24 24\"\n            fill=\"none\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <path\n              d=\"M12 12C14.21 12 16 10.21 16 8C16 5.79 14.21 4 12 4C9.79 4 8 5.79 8 8C8 10.21 9.79 12 12 12ZM12 14C9.33 14 4 15.34 4 18V20H20V18C20 15.34 14.67 14 12 14Z\"\n              fill=\"currentColor\"\n            />\n          </svg>\n          Client Information\n        </h3>\n      </div>\n      <div class=\"card-content\">\n        <div class=\"info-grid\">\n          <div class=\"info-item\">\n            <span class=\"info-label\">Full Name</span>\n            <span class=\"info-value\">{{ contractItem.entity.full_name || 'N/A' }}</span>\n          </div>\n          <div v-if=\"contractItem.entity.nick_name\" class=\"info-item\">\n            <span class=\"info-label\">Nick Name</span>\n            <span class=\"info-value\">{{ contractItem.entity.nick_name }}</span>\n          </div>\n          <div v-if=\"contractItem.entity.country_name || contractItem.entity.country?.name\" class=\"info-item\">\n            <span class=\"info-label\">Country</span>\n            <span class=\"info-value\">{{\n              contractItem.entity.country_name || contractItem.entity.country?.name || 'N/A'\n            }}</span>\n          </div>\n          <div v-if=\"contractItem.entity.nationality_name || contractItem.entity.nationality?.name\" class=\"info-item\">\n            <span class=\"info-label\">Nationality</span>\n            <span class=\"info-value\">{{\n              contractItem.entity.nationality_name || contractItem.entity.nationality?.name || 'N/A'\n            }}</span>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Sales Confirmation Proposal Card -->\n    <div v-if=\"contractItem?.sales_confirmation_proposal\" class=\"info-card\">\n      <div class=\"card-header\">\n        <h3 class=\"card-title\">\n          <svg\n            class=\"card-icon\"\n            width=\"20\"\n            height=\"20\"\n            viewBox=\"0 0 24 24\"\n            fill=\"none\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <path\n              d=\"M12 2C8.13 2 5 5.13 5 9C5 14.25 12 22 12 22C12 22 19 14.25 19 9C19 5.13 15.87 2 12 2ZM12 11.5C10.62 11.5 9.5 10.38 9.5 9C9.5 7.62 10.62 6.5 12 6.5C13.38 6.5 14.5 7.62 14.5 9C14.5 10.38 13.38 11.5 12 11.5Z\"\n              fill=\"currentColor\"\n            />\n          </svg>\n          Sales Confirmation Details\n        </h3>\n      </div>\n      <div class=\"card-content\">\n        <div class=\"info-grid\">\n          <div class=\"info-item\">\n            <span class=\"info-label\">Proposal ID</span>\n            <span class=\"info-value\">{{ contractItem.sales_confirmation_proposal.id || 'N/A' }}</span>\n          </div>\n          <div v-if=\"contractItem.sales_confirmation_proposal.confirmation_date\" class=\"info-item\">\n            <span class=\"info-label\">Confirmation Date</span>\n            <span class=\"info-value\">{{\n              formatDateTime(contractItem.sales_confirmation_proposal.confirmation_date)\n            }}</span>\n          </div>\n          <div v-if=\"contractItem.sales_confirmation_proposal.sales_inquiry_id\" class=\"info-item\">\n            <span class=\"info-label\">Sales Inquiry ID</span>\n            <span class=\"info-value\">{{ contractItem.sales_confirmation_proposal.sales_inquiry_id }}</span>\n          </div>\n          <div v-if=\"contractItem.sales_confirmation_proposal.hunting_license\" class=\"info-item\">\n            <span class=\"info-label\">Hunting License</span>\n            <span class=\"info-value\">{{ contractItem.sales_confirmation_proposal.hunting_license }}</span>\n          </div>\n          <div v-if=\"contractItem.sales_confirmation_proposal.remarks\" class=\"info-item\">\n            <span class=\"info-label\">Remarks</span>\n            <span class=\"info-value\">{{ contractItem.sales_confirmation_proposal.remarks }}</span>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Documents Section -->\n    <div class=\"info-card\">\n      <div class=\"card-header\">\n        <h3 class=\"card-title\">\n          <svg\n            class=\"card-icon\"\n            width=\"20\"\n            height=\"20\"\n            viewBox=\"0 0 24 24\"\n            fill=\"none\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <path\n              d=\"M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.89 22 5.99 22H18C19.1 22 20 21.1 20 20V8L14 2ZM18 20H6V4H13V9H18V20Z\"\n              fill=\"currentColor\"\n            />\n          </svg>\n          Documents\n          <span v-if=\"hasDocuments\" class=\"doc-count-badge\">{{ displayDocuments.length }}</span>\n        </h3>\n      </div>\n      <div class=\"card-content\">\n        <div v-if=\"hasDocuments\" class=\"documents-grid\">\n          <div v-for=\"(doc, index) in displayDocuments\" :key=\"index\" class=\"document-card-item\">\n            <div class=\"document-icon-wrapper\">\n              <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                <path\n                  d=\"M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.89 22 5.99 22H18C19.1 22 20 21.1 20 20V8L14 2ZM18 20H6V4H13V9H18V20Z\"\n                  fill=\"currentColor\"\n                />\n              </svg>\n            </div>\n            <div class=\"document-details-content\">\n              <div class=\"document-type-name\">{{ doc.document_type || doc.doc_type || 'Document' }}</div>\n              <div class=\"document-meta\">\n                <span v-if=\"doc.uploaded_at\" class=\"document-date\">{{ formatDateTime(doc.uploaded_at) }}</span>\n                <span v-if=\"doc.forWho\" class=\"document-for\">{{ doc.forWho }}</span>\n              </div>\n            </div>\n            <div class=\"document-actions\">\n              <a\n                v-if=\"doc.document_url || doc.document\"\n                :href=\"doc.document_url || doc.document\"\n                target=\"_blank\"\n                class=\"document-view-btn\"\n              >\n                View\n              </a>\n              <button\n                v-if=\"!isEditMode\"\n                class=\"document-delete-btn\"\n                :disabled=\"isDeleting && deletingDocId === (doc.id || doc.document_id)\"\n                @click=\"deleteDocument(doc.id || doc.document_id)\"\n              >\n                Delete\n              </button>\n            </div>\n          </div>\n        </div>\n        <div v-else class=\"no-documents-message\">\n          <svg width=\"48\" height=\"48\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n            <path\n              d=\"M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.89 22 5.99 22H18C19.1 22 20 21.1 20 20V8L14 2ZM18 20H6V4H13V9H18V20Z\"\n              fill=\"currentColor\"\n            />\n          </svg>\n          <p>{{ isEditMode ? 'Upload documents to this contract' : 'No documents uploaded for this contract' }}</p>\n        </div>\n      </div>\n    </div>\n\n    <!-- Document Upload Form - Only in Edit Mode -->\n    <div v-if=\"isEditMode\" class=\"info-card document-upload-card\">\n      <div class=\"card-header\">\n        <h3 class=\"card-title\">\n          <svg\n            class=\"card-icon\"\n            width=\"20\"\n            height=\"20\"\n            viewBox=\"0 0 24 24\"\n            fill=\"none\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <path d=\"M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z\" fill=\"currentColor\" />\n          </svg>\n          Upload Documents\n        </h3>\n      </div>\n      <div class=\"card-content\">\n        <div class=\"document-upload-form\">\n          <h3 class=\"upload-title\">Upload Supporting Documents</h3>\n          <p class=\"upload-description\">\n            Choose a document type, select a file, and click \"Add Document\". Repeat to add more documents.\n          </p>\n\n          <!-- Upload Section -->\n          <div class=\"upload-section\">\n            <div class=\"upload-row\">\n              <div class=\"upload-field\">\n                <label class=\"field-label\">Document Type *</label>\n                <select v-model=\"newDocument.type\" class=\"form-select\" :disabled=\"isUploading\">\n                  <option value=\"\">-- Select Type --</option>\n                  <option value=\"Passport_Copy\">Passport Copy</option>\n                  <option value=\"Passport_Photo\">Passport Photo</option>\n                  <option value=\"Visa\">Visa</option>\n                  <option value=\"Gun_Permits\">Gun Permits</option>\n                  <option value=\"CITES_Documentation\">CITES Documentation</option>\n                  <option value=\"sales_invoice\">Sales Invoice</option>\n                  <option value=\"receipt\">Receipt</option>\n                  <option value=\"document\">General Document</option>\n                </select>\n              </div>\n              <div class=\"upload-field\">\n                <label class=\"field-label\">Select File *</label>\n                <input\n                  ref=\"fileInput\"\n                  type=\"file\"\n                  accept=\".pdf,.jpg,.jpeg,.png,.doc,.docx,.xls,.xlsx\"\n                  class=\"form-input\"\n                  :disabled=\"isUploading\"\n                  @change=\"onFileSelected\"\n                />\n              </div>\n            </div>\n            <div class=\"upload-actions-row\">\n              <button\n                class=\"btn-add-document\"\n                :disabled=\"!newDocument.file || !newDocument.type || isUploading\"\n                @click=\"addDocument\"\n              >\n                ‚ûï Add Document\n              </button>\n            </div>\n            <small class=\"help-text\">Select document type and file, then click to add</small>\n          </div>\n\n          <!-- Upload Status Messages -->\n          <div v-if=\"uploadMessage\" :class=\"['upload-message', uploadMessageType]\">\n            {{ uploadMessage }}\n          </div>\n\n          <!-- Upload Progress -->\n          <div v-if=\"isUploading && uploadProgress > 0\" class=\"progress-bar-container\">\n            <div class=\"progress-bar\" :style=\"{ width: uploadProgress + '%' }\"></div>\n            <span class=\"progress-text\">{{ uploadProgress }}%</span>\n          </div>\n\n          <!-- List of Added Documents -->\n          <div v-if=\"selectedFiles.length > 0\" class=\"added-documents\">\n            <h4 class=\"documents-title\">üìã Documents to Upload ({{ selectedFiles.length }}):</h4>\n            <div class=\"documents-list\">\n              <div v-for=\"(doc, index) in selectedFiles\" :key=\"index\" class=\"document-item\">\n                <div class=\"doc-info\">\n                  <span class=\"doc-type\">{{ doc.type }}</span>\n                  <span class=\"doc-name\">{{ doc.file.name }}</span>\n                  <span class=\"doc-size\">({{ (doc.file.size / 1024 / 1024).toFixed(2) }} MB)</span>\n                </div>\n                <button\n                  class=\"btn-remove-doc\"\n                  :disabled=\"isUploading\"\n                  title=\"Remove this document\"\n                  @click=\"removeFromQueue(index)\"\n                >\n                  ‚úï\n                </button>\n              </div>\n            </div>\n            <div class=\"upload-all-actions\">\n              <button\n                :disabled=\"isUploading || selectedFiles.length === 0\"\n                class=\"btn-upload-all\"\n                @click=\"uploadBatchDocuments\"\n              >\n                {{\n                  isUploading\n                    ? `‚è≥ Uploading ${selectedFiles.length}...`\n                    : `‚úÖ Upload ${selectedFiles.length} Document(s)`\n                }}\n              </button>\n              <button class=\"btn-clear-all\" :disabled=\"isUploading\" @click=\"clearQueue\">üóëÔ∏è Clear All</button>\n            </div>\n          </div>\n          <div v-else class=\"no-documents-message\">‚ö†Ô∏è No documents added yet. Add documents and click Upload.</div>\n\n          <p class=\"upload-help\">\n            <strong>How it works:</strong> Select type ‚Üí Choose file ‚Üí Click \"Add Document\" ‚Üí Repeat for more ‚Üí Click\n            \"Upload All\"\n          </p>\n          <p class=\"upload-help\">\n            <strong>Supported formats:</strong> PDF, JPG, PNG, DOC, DOCX, XLS, XLSX (Max 10MB per file)\n          </p>\n\n          <!-- Submit Section -->\n          <div class=\"submit-section\">\n            <hr class=\"divider\" />\n            <div class=\"submit-actions\">\n              <button class=\"btn-cancel-submit\" @click=\"$emit('close')\">‚ùå Close</button>\n            </div>\n            <small class=\"submit-help\">Upload documents or close to go back</small>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from 'vue'\nimport { formatDateTime } from '../../../../services/utils'\nimport { useToast } from 'vuestic-ui'\nimport downloadPdf from '../../../../utils/pdfDownloader'\n\nexport default defineComponent({\n  props: {\n    contractItem: {\n      type: Object as PropType<any>,\n      required: true,\n    },\n    isEditMode: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  emits: ['close'],\n  setup() {\n    const { init } = useToast()\n    return {\n      formatDateTime,\n      init,\n    }\n  },\n  data() {\n    return {\n      documents: [] as any[], // Local documents list\n      newDocument: {\n        type: '',\n        file: null as any,\n      },\n      selectedFiles: [] as any[], // Multiple files for batch upload\n      uploadMessage: '',\n      uploadMessageType: '',\n      isUploading: false,\n      uploadProgress: 0,\n      isDeleting: false,\n      deletingDocId: null as any,\n      downloadingPdf: false,\n    }\n  },\n  computed: {\n    isMainHunterContract(): boolean {\n      return this.contractItem?.contractor_type === 'MAIN_HUNTER'\n    },\n    displayDocuments(): any[] {\n      // Show either local documents list or contract item documents\n      return this.documents.length > 0 ? this.documents : this.contractItem?.client_docs || []\n    },\n    hasDocuments(): boolean {\n      return this.displayDocuments.length > 0\n    },\n  },\n  watch: {\n    // Watch contractItem to sync documents when it changes\n    contractItem: {\n      handler(newVal) {\n        if (newVal?.client_docs && newVal.client_docs.length > 0) {\n          this.documents = newVal.client_docs\n        }\n      },\n      deep: true,\n    },\n    // Watch isEditMode to refetch documents when switching from edit to view mode\n    isEditMode(newVal: boolean) {\n      if (newVal === false) {\n        // Switching to view mode - refetch documents from backend\n        this.fetchDocuments()\n      }\n    },\n  },\n  mounted() {\n    // Initialize documents from contractItem\n    if (this.contractItem?.client_docs && this.contractItem.client_docs.length > 0) {\n      this.documents = this.contractItem.client_docs\n    }\n    // Also fetch documents from backend to ensure we have the latest\n    this.fetchDocuments()\n  },\n  methods: {\n    getContractStatusClass() {\n      const type = this.contractItem?.contractor_type\n      if (type === 'MAIN_HUNTER') return 'status-main-hunter'\n      if (type === 'COMPANION_HUNTER') return 'status-companion-hunter'\n      return 'status-default'\n    },\n    calculateDuration() {\n      if (!this.contractItem?.start_date || !this.contractItem?.end_date) return 'N/A'\n      try {\n        const start = new Date(this.contractItem.start_date)\n        const end = new Date(this.contractItem.end_date)\n        const diffTime = Math.abs(end.getTime() - start.getTime())\n        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24))\n        return `${diffDays} day${diffDays !== 1 ? 's' : ''}`\n      } catch {\n        return 'N/A'\n      }\n    },\n    async downloadContractPdf() {\n      if (!this.contractItem?.id) {\n        this.init({\n          message: 'Contract ID is missing. Cannot download PDF.',\n          color: 'warning',\n        })\n        return\n      }\n\n      this.downloadingPdf = true\n      try {\n        const baseUrl = import.meta.env.VITE_APP_BASE_URL\n        const contractId = this.contractItem.id\n        const endpoint = `sales-confirmation/contracts/${contractId}/pdf`\n        const pdfUrl = `${baseUrl}${endpoint}`\n\n        const contractNumber = this.contractItem.contract_number || `contract-${contractId}`\n        const filename = `${contractNumber}.pdf`\n\n        await downloadPdf(pdfUrl, filename)\n\n        this.init({\n          message: 'PDF downloaded successfully',\n          color: 'success',\n        })\n      } catch (error: any) {\n        console.error('PDF download error:', error)\n        const message = error?.message || 'Unknown error'\n\n        if (message.includes('500') || message.includes('503')) {\n          this.init({\n            message: 'The PDF generation service is temporarily unavailable. Please try again in a few moments.',\n            color: 'warning',\n          })\n        } else if (message.includes('404')) {\n          this.init({\n            message: 'The PDF file was not found. The contract may not have been processed yet.',\n            color: 'warning',\n          })\n        } else {\n          this.init({\n            message: `Failed to download PDF: ${message}`,\n            color: 'danger',\n          })\n        }\n      } finally {\n        this.downloadingPdf = false\n      }\n    },\n    async deleteDocument(docId: any) {\n      if (!docId) {\n        this.uploadMessage = '‚ùå Document ID is missing'\n        this.uploadMessageType = 'error'\n        return\n      }\n\n      if (!confirm('Are you sure you want to delete this document?')) {\n        return\n      }\n\n      this.isDeleting = true\n      this.deletingDocId = docId\n      this.uploadMessage = '‚è≥ Deleting document...'\n      this.uploadMessageType = 'info'\n\n      try {\n        const baseUrl = import.meta.env.VITE_APP_BASE_URL\n        const endpoint = `sales-confirmation/contract-documents/${docId}`\n        const response = await fetch(`${baseUrl}${endpoint}`, {\n          method: 'DELETE',\n        })\n\n        const responseData = await response.json().catch(() => ({}))\n\n        if (response.ok) {\n          console.log('Delete successful:', responseData)\n\n          // Remove the document from the local list\n          this.documents = this.documents.filter((doc) => (doc.id || doc.document_id) !== docId)\n\n          this.uploadMessage = '‚úì Document deleted successfully!'\n          this.uploadMessageType = 'success'\n\n          // Clear message after 2 seconds\n          setTimeout(() => {\n            this.uploadMessage = ''\n            this.uploadMessageType = ''\n            this.deletingDocId = null\n          }, 2000)\n        } else {\n          const errorMsg = responseData?.message || responseData?.error || 'Unknown error'\n          this.uploadMessage = `‚ùå Delete failed: ${errorMsg}`\n          this.uploadMessageType = 'error'\n          console.error('Delete error response:', responseData)\n        }\n      } catch (error: any) {\n        console.error('Delete error:', error)\n        this.uploadMessage = `‚ùå Error: ${error.message || 'Failed to delete document'}`\n        this.uploadMessageType = 'error'\n      } finally {\n        this.isDeleting = false\n      }\n    },\n    async fetchDocuments() {\n      // Use contract ID as entity_id parameter\n      const contractId = this.contractItem?.id\n\n      if (!contractId) {\n        console.warn('No contract ID found')\n        return\n      }\n\n      try {\n        const baseUrl = import.meta.env.VITE_APP_BASE_URL\n        const endpoint = `sales-confirmation/contract-documents/?entity_id=${contractId}`\n\n        const response = await fetch(`${baseUrl}${endpoint}`, {\n          method: 'GET',\n        })\n\n        if (response.ok) {\n          const responseData = await response.json().catch(() => ({}))\n\n          // Handle different response formats\n          let fetchedDocuments = []\n          if (responseData.data && Array.isArray(responseData.data)) {\n            fetchedDocuments = responseData.data\n          } else if (responseData.value && Array.isArray(responseData.value)) {\n            fetchedDocuments = responseData.value\n          } else if (Array.isArray(responseData)) {\n            fetchedDocuments = responseData\n          }\n\n          this.documents = fetchedDocuments\n        }\n      } catch (error: any) {\n        console.error('Error fetching documents:', error)\n      }\n    },\n    onFileSelected(event: any) {\n      const file = event.target.files[0]\n      if (file) {\n        // Check file size (max 50MB)\n        if (file.size > 50 * 1024 * 1024) {\n          this.uploadMessage = '‚ùå File size exceeds 50MB limit'\n          this.uploadMessageType = 'error'\n          this.newDocument.file = null\n          return\n        }\n\n        // Check file type\n        const allowedTypes = [\n          'application/pdf',\n          'image/jpeg',\n          'image/png',\n          'application/msword',\n          'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n          'application/vnd.ms-excel',\n          'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n        ]\n\n        if (!allowedTypes.includes(file.type)) {\n          this.uploadMessage = '‚ùå File type not supported. Use PDF, JPG, PNG, DOC, or XLS'\n          this.uploadMessageType = 'error'\n          this.newDocument.file = null\n          return\n        }\n\n        this.newDocument.file = file\n        this.uploadMessage = `‚úì Selected: ${file.name} (${(file.size / 1024 / 1024).toFixed(2)} MB)`\n        this.uploadMessageType = 'info'\n      }\n    },\n    addDocument() {\n      if (!this.newDocument.file || !this.newDocument.type) {\n        this.uploadMessage = '‚ùå Please select both a document type and file'\n        this.uploadMessageType = 'error'\n        return\n      }\n\n      // Add to queue\n      this.selectedFiles.push({\n        file: this.newDocument.file,\n        type: this.newDocument.type,\n      })\n\n      this.uploadMessage = `‚úÖ Added: ${this.newDocument.file.name} (${this.newDocument.type})`\n      this.uploadMessageType = 'success'\n\n      // Reset form for next document\n      this.newDocument = { type: '', file: null }\n      if (this.$refs.fileInput) {\n        ;(this.$refs.fileInput as HTMLInputElement).value = ''\n      }\n\n      // Clear message after 2 seconds\n      setTimeout(() => {\n        this.uploadMessage = ''\n        this.uploadMessageType = ''\n      }, 2000)\n    },\n    removeFromQueue(index: number) {\n      this.selectedFiles.splice(index, 1)\n    },\n    clearQueue() {\n      this.selectedFiles = []\n      this.newDocument = { type: '', file: null }\n      this.uploadMessage = ''\n      this.uploadMessageType = ''\n    },\n    async uploadBatchDocuments() {\n      // Validate files are selected\n      if (this.selectedFiles.length === 0) {\n        this.uploadMessage = '‚ùå Please select at least one file'\n        this.uploadMessageType = 'error'\n        return\n      }\n\n      // Validate contract ID\n      if (!this.contractItem?.id) {\n        this.uploadMessage = '‚ùå Error: Contract ID is missing. Cannot upload documents.'\n        this.uploadMessageType = 'error'\n        return\n      }\n\n      this.isUploading = true\n      this.uploadMessage = `‚è≥ Uploading ${this.selectedFiles.length} document(s)...`\n      this.uploadMessageType = 'info'\n      this.uploadProgress = 0\n\n      try {\n        const baseUrl = import.meta.env.VITE_APP_BASE_URL\n        const contractId = this.contractItem.id\n        const endpoint = `sales-confirmation/contracts/${contractId}/documents`\n\n        // Prepare FormData with multiple files\n        const formData = new FormData()\n\n        // Loop through selectedFiles and append each file properly\n        this.selectedFiles.forEach((item: any, index: number) => {\n          // item = { file: File, type: string }\n          formData.append('documents[]', item.file) // Append the actual File object\n          formData.append(`doc_types[${index}]`, item.type) // Append the document type\n        })\n\n        console.log(`Uploading ${this.selectedFiles.length} documents to:`, endpoint)\n\n        const response = await fetch(`${baseUrl}${endpoint}`, {\n          method: 'POST',\n          body: formData,\n        })\n\n        const responseData = await response.json().catch(() => ({}))\n        console.log('Batch upload response:', responseData)\n\n        if (response.ok || response.status === 201) {\n          console.log('Batch upload successful:', responseData)\n\n          // Add all newly uploaded documents to the local list\n          if (responseData.data && Array.isArray(responseData.data)) {\n            responseData.data.forEach((doc: any) => {\n              this.documents.push({\n                id: doc.id,\n                document_type: doc.doc_type,\n                doc_type: doc.doc_type,\n                forWho: this.contractItem?.client_name || 'Unknown',\n                document_url: doc.url || doc.document,\n                document: doc.document,\n                uploaded_at: doc.created_at || new Date().toISOString(),\n              })\n            })\n          }\n\n          const count = responseData.total || responseData.data?.length || this.selectedFiles.length\n          this.uploadMessage = `‚úì ${count} document(s) uploaded successfully!`\n          this.uploadMessageType = 'success'\n\n          // Refetch documents from backend after a short delay to ensure backend processed the upload\n          setTimeout(() => {\n            this.fetchDocuments()\n          }, 500)\n\n          // Reset form after 2 seconds\n          setTimeout(() => {\n            this.clearQueue()\n          }, 2000)\n        } else {\n          let errorMsg = responseData?.message || `Upload failed with status ${response.status}`\n\n          if (responseData?.errors) {\n            const errorFields = Object.keys(responseData.errors)\n            const fieldErrors = errorFields\n              .map((field) => {\n                const errors = responseData.errors[field]\n                const errorText = Array.isArray(errors) ? errors.join(', ') : String(errors)\n                return `${field}: ${errorText}`\n              })\n              .join(' | ')\n            errorMsg = fieldErrors || errorMsg\n            console.error('Validation errors:', responseData.errors)\n          }\n\n          this.uploadMessage = `‚ùå Upload failed: ${errorMsg}`\n          this.uploadMessageType = 'error'\n          console.error('Upload error response:', responseData)\n        }\n      } catch (error: any) {\n        console.error('Upload error:', error)\n        this.uploadMessage = `‚ùå Error: ${error.message || 'Failed to upload documents'}`\n        this.uploadMessageType = 'error'\n      } finally {\n        this.isUploading = false\n        this.uploadProgress = 0\n      }\n    },\n    resetUploadForm() {\n      this.newDocument = {\n        type: '',\n        file: null,\n      }\n      // Clear file input\n      if (this.$refs.fileInput) {\n        ;(this.$refs.fileInput as HTMLInputElement).value = ''\n      }\n      // Clear message after a delay if it's success\n      if (this.uploadMessageType === 'success') {\n        setTimeout(() => {\n          this.uploadMessage = ''\n          this.uploadMessageType = ''\n        }, 3000)\n      }\n    },\n  },\n})\n</script>\n\n<style lang=\"scss\" scoped>\n.contract-details-page {\n  padding: 24px;\n  background: #f8fafc;\n  min-height: 100vh;\n}\n\n/* Header Section */\n.contract-header {\n  background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);\n  border-radius: 16px;\n  padding: 24px;\n  margin-bottom: 24px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);\n  border: 1px solid #e2e8f0;\n}\n\n.header-content {\n  display: flex;\n  align-items: center;\n  gap: 20px;\n}\n\n.header-icon {\n  width: 64px;\n  height: 64px;\n  background: linear-gradient(135deg, #4f46e5, #06b6d4);\n  border-radius: 16px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);\n  flex-shrink: 0;\n}\n\n.header-text {\n  flex: 1;\n}\n\n.page-title {\n  font-size: 28px;\n  font-weight: 700;\n  color: #1e293b;\n  margin: 0 0 4px 0;\n  line-height: 1.2;\n}\n\n.page-subtitle {\n  font-size: 14px;\n  color: #64748b;\n  margin: 0;\n}\n\n.header-actions {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  flex-shrink: 0;\n}\n\n.download-pdf-btn {\n  box-shadow: 0 2px 8px rgba(79, 70, 229, 0.2);\n  transition: all 0.3s ease;\n\n  &:hover:not(:disabled) {\n    box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);\n    transform: translateY(-1px);\n  }\n}\n\n.status-badge {\n  padding: 8px 16px;\n  border-radius: 20px;\n  font-size: 12px;\n  font-weight: 600;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n\n  &.status-main-hunter {\n    background: linear-gradient(135deg, #3b82f6, #2563eb);\n    color: white;\n  }\n\n  &.status-companion-hunter {\n    background: linear-gradient(135deg, #10b981, #059669);\n    color: white;\n  }\n\n  &.status-default {\n    background: #f1f5f9;\n    color: #475569;\n  }\n}\n\n/* Info Cards */\n.info-card {\n  background: #ffffff;\n  border: 1px solid #e2e8f0;\n  border-radius: 12px;\n  margin-bottom: 24px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);\n  overflow: hidden;\n  transition: all 0.3s ease;\n\n  &:hover {\n    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);\n  }\n}\n\n.contract-overview-card {\n  background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);\n  border: 1px solid #e2e8f0;\n  border-radius: 12px;\n  margin-bottom: 24px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);\n  overflow: hidden;\n}\n\n.card-header {\n  padding: 20px 24px;\n  background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%);\n  border-bottom: 2px solid #f1f5f9;\n}\n\n.card-title {\n  font-size: 18px;\n  font-weight: 600;\n  color: #1e293b;\n  margin: 0;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n}\n\n.card-icon {\n  color: #4f46e5;\n  flex-shrink: 0;\n}\n\n.doc-count-badge {\n  background: #4f46e5;\n  color: white;\n  padding: 4px 10px;\n  border-radius: 12px;\n  font-size: 12px;\n  font-weight: 600;\n  margin-left: 8px;\n}\n\n.card-content {\n  padding: 24px;\n}\n\n.overview-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n  gap: 20px;\n}\n\n.overview-item {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.overview-label {\n  font-size: 13px;\n  font-weight: 500;\n  color: #64748b;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n\n.overview-value {\n  font-size: 16px;\n  font-weight: 600;\n  color: #1e293b;\n\n  &.highlight {\n    color: #4f46e5;\n    font-size: 18px;\n  }\n}\n\n.info-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n  gap: 20px;\n}\n\n.info-item {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.info-label {\n  font-size: 13px;\n  font-weight: 500;\n  color: #64748b;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n\n.info-value {\n  font-size: 15px;\n  font-weight: 500;\n  color: #1e293b;\n}\n\n/* Documents Section */\n.documents-grid {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.document-card-item {\n  background: #f8fafc;\n  border: 1px solid #e2e8f0;\n  border-radius: 10px;\n  padding: 16px;\n  display: flex;\n  align-items: center;\n  gap: 16px;\n  transition: all 0.2s ease;\n\n  &:hover {\n    border-color: #cbd5e1;\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\n  }\n}\n\n.document-icon-wrapper {\n  width: 48px;\n  height: 48px;\n  background: linear-gradient(135deg, #6366f1, #8b5cf6);\n  border-radius: 10px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  flex-shrink: 0;\n}\n\n.document-details-content {\n  flex: 1;\n  min-width: 0;\n}\n\n.document-type-name {\n  font-size: 15px;\n  font-weight: 600;\n  color: #1e293b;\n  margin-bottom: 4px;\n}\n\n.document-meta {\n  display: flex;\n  gap: 12px;\n  font-size: 13px;\n  color: #64748b;\n}\n\n.document-date,\n.document-for {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n}\n\n.document-actions {\n  display: flex;\n  gap: 8px;\n  flex-shrink: 0;\n}\n\n.document-view-btn {\n  padding: 8px 16px;\n  background: linear-gradient(135deg, #4f46e5, #6366f1);\n  color: white;\n  border: none;\n  border-radius: 8px;\n  font-size: 13px;\n  font-weight: 600;\n  cursor: pointer;\n  text-decoration: none;\n  transition: all 0.2s ease;\n\n  &:hover {\n    box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);\n    transform: translateY(-1px);\n  }\n}\n\n.document-delete-btn {\n  padding: 8px 16px;\n  background: #fee2e2;\n  color: #991b1b;\n  border: 1px solid #fecaca;\n  border-radius: 8px;\n  font-size: 13px;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s ease;\n\n  &:hover:not(:disabled) {\n    background: #fecaca;\n    border-color: #f87171;\n  }\n\n  &:disabled {\n    opacity: 0.6;\n    cursor: not-allowed;\n  }\n}\n\n.no-documents-message {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 48px 24px;\n  color: #94a3b8;\n  text-align: center;\n  gap: 16px;\n\n  svg {\n    color: #cbd5e1;\n  }\n\n  p {\n    font-size: 15px;\n    font-weight: 500;\n    margin: 0;\n  }\n}\n\n/* Document Upload Form */\n.document-upload-card {\n  border: 2px dashed #cbd5e1;\n\n  &:hover {\n    border-color: #94a3b8;\n  }\n}\n\n.document-upload-form {\n  background: #f8fafc;\n  border-radius: 10px;\n  padding: 20px;\n}\n\n.upload-title {\n  font-size: 16px;\n  font-weight: 700;\n  color: #333;\n  margin-bottom: 8px;\n}\n\n.upload-description {\n  font-size: 13px;\n  color: #666;\n  margin-bottom: 15px;\n  font-style: italic;\n}\n\n.upload-grid {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 15px;\n  margin-bottom: 15px;\n}\n\n@media (max-width: 768px) {\n  .upload-grid {\n    grid-template-columns: 1fr;\n  }\n}\n\n.upload-field {\n  display: flex;\n  flex-direction: column;\n}\n\n.field-label {\n  font-weight: 700;\n  font-size: 12px;\n  color: #333;\n  margin-bottom: 8px;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n\n.form-select,\n.form-input {\n  padding: 10px 12px;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  font-size: 13px;\n  font-family: inherit;\n  background: white;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.form-select:disabled,\n.form-input:disabled {\n  background: #f5f5f5;\n  cursor: not-allowed;\n  opacity: 0.6;\n}\n\n.form-select:hover:not(:disabled),\n.form-input:hover:not(:disabled) {\n  border-color: #ea4335;\n  box-shadow: 0 0 0 2px rgba(234, 67, 53, 0.05);\n}\n\n.form-select:focus,\n.form-input:focus {\n  outline: none;\n  border-color: #ea4335;\n  box-shadow: 0 0 0 3px rgba(234, 67, 53, 0.1);\n}\n\n.upload-actions {\n  display: flex;\n  gap: 10px;\n  margin-bottom: 15px;\n  flex-wrap: wrap;\n}\n\n.btn-upload,\n.btn-cancel {\n  padding: 10px 20px;\n  border: none;\n  border-radius: 4px;\n  font-size: 13px;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s;\n  white-space: nowrap;\n}\n\n.btn-upload {\n  background: linear-gradient(135deg, #34a853, #0d652d);\n  color: white;\n  flex: 1;\n  min-width: 150px;\n}\n\n.btn-upload:hover:not(:disabled) {\n  box-shadow: 0 4px 12px rgba(52, 168, 83, 0.3);\n  transform: translateY(-1px);\n}\n\n.btn-upload:active:not(:disabled) {\n  transform: translateY(0);\n}\n\n.btn-upload:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n  background: linear-gradient(135deg, #ccc, #999);\n}\n\n.btn-cancel {\n  background: #f5f5f5;\n  color: #666;\n  border: 1px solid #ddd;\n  min-width: 100px;\n}\n\n.btn-cancel:hover:not(:disabled) {\n  background: #e8e8e8;\n  border-color: #999;\n}\n\n.btn-cancel:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n\n.upload-message {\n  padding: 12px 15px;\n  border-radius: 4px;\n  font-size: 13px;\n  margin-bottom: 15px;\n  border-left: 4px solid transparent;\n}\n\n.upload-message.success {\n  background: #d4edda;\n  color: #155724;\n  border-left-color: #28a745;\n  border: 1px solid #c3e6cb;\n}\n\n.upload-message.error {\n  background: #f8d7da;\n  color: #721c24;\n  border-left-color: #dc3545;\n  border: 1px solid #f5c6cb;\n}\n\n.upload-message.info {\n  background: #d1ecf1;\n  color: #0c5460;\n  border-left-color: #17a2b8;\n  border: 1px solid #bee5eb;\n}\n\n.upload-help {\n  font-size: 12px;\n  color: #999;\n  margin-top: 10px;\n  margin-bottom: 0;\n}\n\n.document-actions {\n  margin-top: 10px;\n  padding-top: 10px;\n  border-top: 1px solid #eee;\n  display: flex;\n  gap: 10px;\n}\n\n.btn-delete {\n  padding: 8px 12px;\n  border: none;\n  border-radius: 4px;\n  font-size: 12px;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s;\n  background: #dc3545;\n  color: white;\n  flex: 1;\n}\n\n.btn-delete:hover:not(:disabled) {\n  background: #c82333;\n  box-shadow: 0 2px 8px rgba(220, 53, 69, 0.3);\n  transform: translateY(-1px);\n}\n\n.btn-delete:active:not(:disabled) {\n  transform: translateY(0);\n}\n\n.btn-delete:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n  background: #999;\n}\n\n/* Batch Upload Styles */\n.batch-upload-section {\n  margin-top: 20px;\n  border-top: 2px solid #ddd;\n  padding-top: 20px;\n}\n\n.file-count {\n  display: block;\n  margin-top: 5px;\n  color: #666;\n  font-size: 12px;\n}\n\n.doc-types-section {\n  margin: 15px 0;\n  padding: 15px;\n  background: #f5f5f5;\n  border-radius: 6px;\n}\n\n.doc-types-section h4 {\n  margin: 0 0 10px 0;\n  font-size: 13px;\n  color: #333;\n}\n\n.doc-types-list {\n  max-height: 400px;\n  overflow-y: auto;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  background: white;\n}\n\n.doc-type-row {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  padding: 10px;\n  border-bottom: 1px solid #eee;\n}\n\n.doc-type-row:last-child {\n  border-bottom: none;\n}\n\n.file-name {\n  flex: 1;\n  font-size: 13px;\n  color: #333;\n  word-break: break-all;\n  font-weight: 500;\n}\n\n.file-size {\n  flex: 0 0 auto;\n  font-size: 12px;\n  color: #999;\n}\n\n.doc-type-row .form-select {\n  flex: 0 0 auto;\n  min-width: 150px;\n  padding: 6px 8px;\n  font-size: 12px;\n}\n\n.progress-bar-container {\n  margin: 15px 0;\n  height: 24px;\n  background: #e0e0e0;\n  border-radius: 4px;\n  overflow: hidden;\n  display: flex;\n  align-items: center;\n  position: relative;\n}\n\n.progress-bar {\n  height: 100%;\n  background: linear-gradient(90deg, #4caf50, #45a049);\n  transition: width 0.3s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.progress-text {\n  position: absolute;\n  width: 100%;\n  text-align: center;\n  font-size: 12px;\n  font-weight: 600;\n  color: #333;\n}\n\n/* Submit Section */\n.submit-section {\n  margin-top: 30px;\n  padding-top: 20px;\n  border-top: 2px solid #e0e0e0;\n}\n\n.divider {\n  border: none;\n  border-top: 2px solid #e0e0e0;\n  margin: 20px 0;\n}\n\n.submit-actions {\n  display: flex;\n  gap: 12px;\n  justify-content: flex-end;\n  flex-wrap: wrap;\n}\n\n.btn-submit {\n  padding: 12px 24px;\n  border: none;\n  border-radius: 4px;\n  font-size: 14px;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s;\n  background: linear-gradient(135deg, #4caf50, #2e7d32);\n  color: white;\n  min-width: 160px;\n  box-shadow: 0 2px 8px rgba(76, 175, 80, 0.2);\n}\n\n.btn-submit:hover:not(:disabled) {\n  box-shadow: 0 4px 12px rgba(76, 175, 80, 0.4);\n  transform: translateY(-2px);\n}\n\n.btn-submit:active:not(:disabled) {\n  transform: translateY(0);\n}\n\n.btn-submit:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n\n.btn-cancel-submit {\n  padding: 12px 24px;\n  border: 1px solid #e0e0e0;\n  border-radius: 4px;\n  font-size: 14px;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s;\n  background: white;\n  color: #666;\n  min-width: 120px;\n}\n\n.btn-cancel-submit:hover {\n  border-color: #ea4335;\n  color: #ea4335;\n  background: #fef8f7;\n}\n\n.btn-cancel-submit:active {\n  background: #f5f5f5;\n}\n\n.submit-help {\n  display: block;\n  margin-top: 12px;\n  font-size: 12px;\n  color: #666;\n  text-align: center;\n  font-style: italic;\n}\n\n/* Responsive Design */\n@media (max-width: 1024px) {\n  .contract-details-page {\n    padding: 16px;\n  }\n\n  .overview-grid,\n  .info-grid {\n    grid-template-columns: 1fr;\n  }\n\n  .header-content {\n    flex-direction: column;\n    align-items: flex-start;\n    gap: 16px;\n  }\n\n  .header-actions {\n    width: 100%;\n    flex-direction: column;\n    align-items: stretch;\n\n    .download-pdf-btn {\n      width: 100%;\n    }\n  }\n}\n\n@media (max-width: 768px) {\n  .page-title {\n    font-size: 24px;\n  }\n\n  .card-content {\n    padding: 16px;\n  }\n\n  .document-card-item {\n    flex-direction: column;\n    align-items: flex-start;\n  }\n\n  .document-actions {\n    width: 100%;\n    justify-content: flex-end;\n  }\n}\n</style>\n","<template>\n  <div class=\"contract-details-page\">\n    <!-- Header Section -->\n    <div class=\"contract-header\">\n      <div class=\"header-content\">\n        <div class=\"header-icon\">\n          <svg width=\"32\" height=\"32\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n            <path\n              d=\"M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.89 22 5.99 22H18C19.1 22 20 21.1 20 20V8L14 2ZM18 20H6V4H13V9H18V20Z\"\n              fill=\"currentColor\"\n            />\n          </svg>\n        </div>\n        <div class=\"header-text\">\n          <h1 class=\"page-title\">{{ isEditMode ? 'Upload Documents' : 'Contract Details' }}</h1>\n          <p class=\"page-subtitle\">{{ contractItem?.contract_number || 'Contract Information' }}</p>\n        </div>\n        <div class=\"header-actions\">\n          <span class=\"status-badge\" :class=\"getContractStatusClass()\">\n            {{ contractItem?.contractor_type || 'CONTRACT' }}\n          </span>\n          <VaButton\n            v-if=\"!isEditMode\"\n            color=\"primary\"\n            icon=\"download\"\n            :loading=\"downloadingPdf\"\n            class=\"download-pdf-btn\"\n            @click=\"downloadContractPdf\"\n          >\n            Download PDF\n          </VaButton>\n        </div>\n      </div>\n    </div>\n\n    <!-- Contract Overview Card -->\n    <div class=\"contract-overview-card\">\n      <div class=\"card-header\">\n        <h3 class=\"card-title\">\n          <svg\n            class=\"card-icon\"\n            width=\"20\"\n            height=\"20\"\n            viewBox=\"0 0 24 24\"\n            fill=\"none\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <path\n              d=\"M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19ZM7 10H9V17H7V10ZM11 7H13V17H11V7ZM15 13H17V17H15V13Z\"\n              fill=\"currentColor\"\n            />\n          </svg>\n          Contract Overview\n        </h3>\n      </div>\n      <div class=\"card-content\">\n        <div class=\"overview-grid\">\n          <div class=\"overview-item\">\n            <span class=\"overview-label\">Contract Number</span>\n            <span class=\"overview-value highlight\">{{ contractItem?.contract_number || 'N/A' }}</span>\n          </div>\n          <div class=\"overview-item\">\n            <span class=\"overview-label\">Description</span>\n            <span class=\"overview-value\">{{ contractItem?.description || 'N/A' }}</span>\n          </div>\n          <div class=\"overview-item\">\n            <span class=\"overview-label\">Start Date</span>\n            <span class=\"overview-value\">{{ formatDateTime(contractItem?.start_date) || 'N/A' }}</span>\n          </div>\n          <div class=\"overview-item\">\n            <span class=\"overview-label\">End Date</span>\n            <span class=\"overview-value\">{{ formatDateTime(contractItem?.end_date) || 'N/A' }}</span>\n          </div>\n          <div class=\"overview-item\">\n            <span class=\"overview-label\">Duration</span>\n            <span class=\"overview-value\">{{ calculateDuration() }}</span>\n          </div>\n          <div class=\"overview-item\">\n            <span class=\"overview-label\">Created</span>\n            <span class=\"overview-value\">{{ formatDateTime(contractItem?.created_at) || 'N/A' }}</span>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Client Information Card -->\n    <div v-if=\"contractItem?.entity\" class=\"info-card\">\n      <div class=\"card-header\">\n        <h3 class=\"card-title\">\n          <svg\n            class=\"card-icon\"\n            width=\"20\"\n            height=\"20\"\n            viewBox=\"0 0 24 24\"\n            fill=\"none\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <path\n              d=\"M12 12C14.21 12 16 10.21 16 8C16 5.79 14.21 4 12 4C9.79 4 8 5.79 8 8C8 10.21 9.79 12 12 12ZM12 14C9.33 14 4 15.34 4 18V20H20V18C20 15.34 14.67 14 12 14Z\"\n              fill=\"currentColor\"\n            />\n          </svg>\n          Client Information\n        </h3>\n      </div>\n      <div class=\"card-content\">\n        <div class=\"info-grid\">\n          <div class=\"info-item\">\n            <span class=\"info-label\">Full Name</span>\n            <span class=\"info-value\">{{ contractItem.entity.full_name || 'N/A' }}</span>\n          </div>\n          <div v-if=\"contractItem.entity.nick_name\" class=\"info-item\">\n            <span class=\"info-label\">Nick Name</span>\n            <span class=\"info-value\">{{ contractItem.entity.nick_name }}</span>\n          </div>\n          <div v-if=\"contractItem.entity.country_name || contractItem.entity.country?.name\" class=\"info-item\">\n            <span class=\"info-label\">Country</span>\n            <span class=\"info-value\">{{\n              contractItem.entity.country_name || contractItem.entity.country?.name || 'N/A'\n            }}</span>\n          </div>\n          <div v-if=\"contractItem.entity.nationality_name || contractItem.entity.nationality?.name\" class=\"info-item\">\n            <span class=\"info-label\">Nationality</span>\n            <span class=\"info-value\">{{\n              contractItem.entity.nationality_name || contractItem.entity.nationality?.name || 'N/A'\n            }}</span>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Sales Confirmation Proposal Card -->\n    <div v-if=\"contractItem?.sales_confirmation_proposal\" class=\"info-card\">\n      <div class=\"card-header\">\n        <h3 class=\"card-title\">\n          <svg\n            class=\"card-icon\"\n            width=\"20\"\n            height=\"20\"\n            viewBox=\"0 0 24 24\"\n            fill=\"none\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <path\n              d=\"M12 2C8.13 2 5 5.13 5 9C5 14.25 12 22 12 22C12 22 19 14.25 19 9C19 5.13 15.87 2 12 2ZM12 11.5C10.62 11.5 9.5 10.38 9.5 9C9.5 7.62 10.62 6.5 12 6.5C13.38 6.5 14.5 7.62 14.5 9C14.5 10.38 13.38 11.5 12 11.5Z\"\n              fill=\"currentColor\"\n            />\n          </svg>\n          Sales Confirmation Details\n        </h3>\n      </div>\n      <div class=\"card-content\">\n        <div class=\"info-grid\">\n          <div class=\"info-item\">\n            <span class=\"info-label\">Proposal ID</span>\n            <span class=\"info-value\">{{ contractItem.sales_confirmation_proposal.id || 'N/A' }}</span>\n          </div>\n          <div v-if=\"contractItem.sales_confirmation_proposal.confirmation_date\" class=\"info-item\">\n            <span class=\"info-label\">Confirmation Date</span>\n            <span class=\"info-value\">{{\n              formatDateTime(contractItem.sales_confirmation_proposal.confirmation_date)\n            }}</span>\n          </div>\n          <div v-if=\"contractItem.sales_confirmation_proposal.sales_inquiry_id\" class=\"info-item\">\n            <span class=\"info-label\">Sales Inquiry ID</span>\n            <span class=\"info-value\">{{ contractItem.sales_confirmation_proposal.sales_inquiry_id }}</span>\n          </div>\n          <div v-if=\"contractItem.sales_confirmation_proposal.hunting_license\" class=\"info-item\">\n            <span class=\"info-label\">Hunting License</span>\n            <span class=\"info-value\">{{ contractItem.sales_confirmation_proposal.hunting_license }}</span>\n          </div>\n          <div v-if=\"contractItem.sales_confirmation_proposal.remarks\" class=\"info-item\">\n            <span class=\"info-label\">Remarks</span>\n            <span class=\"info-value\">{{ contractItem.sales_confirmation_proposal.remarks }}</span>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Documents Section -->\n    <div class=\"info-card\">\n      <div class=\"card-header\">\n        <h3 class=\"card-title\">\n          <svg\n            class=\"card-icon\"\n            width=\"20\"\n            height=\"20\"\n            viewBox=\"0 0 24 24\"\n            fill=\"none\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <path\n              d=\"M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.89 22 5.99 22H18C19.1 22 20 21.1 20 20V8L14 2ZM18 20H6V4H13V9H18V20Z\"\n              fill=\"currentColor\"\n            />\n          </svg>\n          Documents\n          <span v-if=\"hasDocuments\" class=\"doc-count-badge\">{{ displayDocuments.length }}</span>\n        </h3>\n      </div>\n      <div class=\"card-content\">\n        <div v-if=\"hasDocuments\" class=\"documents-grid\">\n          <div v-for=\"(doc, index) in displayDocuments\" :key=\"index\" class=\"document-card-item\">\n            <div class=\"document-icon-wrapper\">\n              <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                <path\n                  d=\"M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.89 22 5.99 22H18C19.1 22 20 21.1 20 20V8L14 2ZM18 20H6V4H13V9H18V20Z\"\n                  fill=\"currentColor\"\n                />\n              </svg>\n            </div>\n            <div class=\"document-details-content\">\n              <div class=\"document-type-name\">{{ doc.document_type || doc.doc_type || 'Document' }}</div>\n              <div class=\"document-meta\">\n                <span v-if=\"doc.uploaded_at\" class=\"document-date\">{{ formatDateTime(doc.uploaded_at) }}</span>\n                <span v-if=\"doc.forWho\" class=\"document-for\">{{ doc.forWho }}</span>\n              </div>\n            </div>\n            <div class=\"document-actions\">\n              <a\n                v-if=\"doc.document_url || doc.document\"\n                :href=\"doc.document_url || doc.document\"\n                target=\"_blank\"\n                class=\"document-view-btn\"\n              >\n                View\n              </a>\n              <button\n                v-if=\"!isEditMode\"\n                class=\"document-delete-btn\"\n                :disabled=\"isDeleting && deletingDocId === (doc.id || doc.document_id)\"\n                @click=\"deleteDocument(doc.id || doc.document_id)\"\n              >\n                Delete\n              </button>\n            </div>\n          </div>\n        </div>\n        <div v-else class=\"no-documents-message\">\n          <svg width=\"48\" height=\"48\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n            <path\n              d=\"M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.89 22 5.99 22H18C19.1 22 20 21.1 20 20V8L14 2ZM18 20H6V4H13V9H18V20Z\"\n              fill=\"currentColor\"\n            />\n          </svg>\n          <p>{{ isEditMode ? 'Upload documents to this contract' : 'No documents uploaded for this contract' }}</p>\n        </div>\n      </div>\n    </div>\n\n    <!-- Document Upload Form - Only in Edit Mode -->\n    <div v-if=\"isEditMode\" class=\"info-card document-upload-card\">\n      <div class=\"card-header\">\n        <h3 class=\"card-title\">\n          <svg\n            class=\"card-icon\"\n            width=\"20\"\n            height=\"20\"\n            viewBox=\"0 0 24 24\"\n            fill=\"none\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <path d=\"M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z\" fill=\"currentColor\" />\n          </svg>\n          Upload Documents\n        </h3>\n      </div>\n      <div class=\"card-content\">\n        <div class=\"document-upload-form\">\n          <h3 class=\"upload-title\">Upload Supporting Documents</h3>\n          <p class=\"upload-description\">\n            Choose a document type, select a file, and click \"Add Document\". Repeat to add more documents.\n          </p>\n\n          <!-- Upload Section -->\n          <div class=\"upload-section\">\n            <div class=\"upload-row\">\n              <div class=\"upload-field\">\n                <label class=\"field-label\">Document Type *</label>\n                <select v-model=\"newDocument.type\" class=\"form-select\" :disabled=\"isUploading\">\n                  <option value=\"\">-- Select Type --</option>\n                  <option value=\"Passport_Copy\">Passport Copy</option>\n                  <option value=\"Passport_Photo\">Passport Photo</option>\n                  <option value=\"Visa\">Visa</option>\n                  <option value=\"Gun_Permits\">Gun Permits</option>\n                  <option value=\"CITES_Documentation\">CITES Documentation</option>\n                  <option value=\"sales_invoice\">Sales Invoice</option>\n                  <option value=\"receipt\">Receipt</option>\n                  <option value=\"document\">General Document</option>\n                </select>\n              </div>\n              <div class=\"upload-field\">\n                <label class=\"field-label\">Select File *</label>\n                <input\n                  ref=\"fileInput\"\n                  type=\"file\"\n                  accept=\".pdf,.jpg,.jpeg,.png,.doc,.docx,.xls,.xlsx\"\n                  class=\"form-input\"\n                  :disabled=\"isUploading\"\n                  @change=\"onFileSelected\"\n                />\n              </div>\n            </div>\n            <div class=\"upload-actions-row\">\n              <button\n                class=\"btn-add-document\"\n                :disabled=\"!newDocument.file || !newDocument.type || isUploading\"\n                @click=\"addDocument\"\n              >\n                ‚ûï Add Document\n              </button>\n            </div>\n            <small class=\"help-text\">Select document type and file, then click to add</small>\n          </div>\n\n          <!-- Upload Status Messages -->\n          <div v-if=\"uploadMessage\" :class=\"['upload-message', uploadMessageType]\">\n            {{ uploadMessage }}\n          </div>\n\n          <!-- Upload Progress -->\n          <div v-if=\"isUploading && uploadProgress > 0\" class=\"progress-bar-container\">\n            <div class=\"progress-bar\" :style=\"{ width: uploadProgress + '%' }\"></div>\n            <span class=\"progress-text\">{{ uploadProgress }}%</span>\n          </div>\n\n          <!-- List of Added Documents -->\n          <div v-if=\"selectedFiles.length > 0\" class=\"added-documents\">\n            <h4 class=\"documents-title\">üìã Documents to Upload ({{ selectedFiles.length }}):</h4>\n            <div class=\"documents-list\">\n              <div v-for=\"(doc, index) in selectedFiles\" :key=\"index\" class=\"document-item\">\n                <div class=\"doc-info\">\n                  <span class=\"doc-type\">{{ doc.type }}</span>\n                  <span class=\"doc-name\">{{ doc.file.name }}</span>\n                  <span class=\"doc-size\">({{ (doc.file.size / 1024 / 1024).toFixed(2) }} MB)</span>\n                </div>\n                <button\n                  class=\"btn-remove-doc\"\n                  :disabled=\"isUploading\"\n                  title=\"Remove this document\"\n                  @click=\"removeFromQueue(index)\"\n                >\n                  ‚úï\n                </button>\n              </div>\n            </div>\n            <div class=\"upload-all-actions\">\n              <button\n                :disabled=\"isUploading || selectedFiles.length === 0\"\n                class=\"btn-upload-all\"\n                @click=\"uploadBatchDocuments\"\n              >\n                {{\n                  isUploading\n                    ? `‚è≥ Uploading ${selectedFiles.length}...`\n                    : `‚úÖ Upload ${selectedFiles.length} Document(s)`\n                }}\n              </button>\n              <button class=\"btn-clear-all\" :disabled=\"isUploading\" @click=\"clearQueue\">üóëÔ∏è Clear All</button>\n            </div>\n          </div>\n          <div v-else class=\"no-documents-message\">‚ö†Ô∏è No documents added yet. Add documents and click Upload.</div>\n\n          <p class=\"upload-help\">\n            <strong>How it works:</strong> Select type ‚Üí Choose file ‚Üí Click \"Add Document\" ‚Üí Repeat for more ‚Üí Click\n            \"Upload All\"\n          </p>\n          <p class=\"upload-help\">\n            <strong>Supported formats:</strong> PDF, JPG, PNG, DOC, DOCX, XLS, XLSX (Max 10MB per file)\n          </p>\n\n          <!-- Submit Section -->\n          <div class=\"submit-section\">\n            <hr class=\"divider\" />\n            <div class=\"submit-actions\">\n              <button class=\"btn-cancel-submit\" @click=\"$emit('close')\">‚ùå Close</button>\n            </div>\n            <small class=\"submit-help\">Upload documents or close to go back</small>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, PropType } from 'vue'\nimport { formatDateTime } from '../../../../services/utils'\nimport { useToast } from 'vuestic-ui'\nimport downloadPdf from '../../../../utils/pdfDownloader'\n\nexport default defineComponent({\n  props: {\n    contractItem: {\n      type: Object as PropType<any>,\n      required: true,\n    },\n    isEditMode: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  emits: ['close'],\n  setup() {\n    const { init } = useToast()\n    return {\n      formatDateTime,\n      init,\n    }\n  },\n  data() {\n    return {\n      documents: [] as any[], // Local documents list\n      newDocument: {\n        type: '',\n        file: null as any,\n      },\n      selectedFiles: [] as any[], // Multiple files for batch upload\n      uploadMessage: '',\n      uploadMessageType: '',\n      isUploading: false,\n      uploadProgress: 0,\n      isDeleting: false,\n      deletingDocId: null as any,\n      downloadingPdf: false,\n    }\n  },\n  computed: {\n    isMainHunterContract(): boolean {\n      return this.contractItem?.contractor_type === 'MAIN_HUNTER'\n    },\n    displayDocuments(): any[] {\n      // Show either local documents list or contract item documents\n      return this.documents.length > 0 ? this.documents : this.contractItem?.client_docs || []\n    },\n    hasDocuments(): boolean {\n      return this.displayDocuments.length > 0\n    },\n  },\n  watch: {\n    // Watch contractItem to sync documents when it changes\n    contractItem: {\n      handler(newVal) {\n        if (newVal?.client_docs && newVal.client_docs.length > 0) {\n          this.documents = newVal.client_docs\n        }\n      },\n      deep: true,\n    },\n    // Watch isEditMode to refetch documents when switching from edit to view mode\n    isEditMode(newVal: boolean) {\n      if (newVal === false) {\n        // Switching to view mode - refetch documents from backend\n        this.fetchDocuments()\n      }\n    },\n  },\n  mounted() {\n    // Initialize documents from contractItem\n    if (this.contractItem?.client_docs && this.contractItem.client_docs.length > 0) {\n      this.documents = this.contractItem.client_docs\n    }\n    // Also fetch documents from backend to ensure we have the latest\n    this.fetchDocuments()\n  },\n  methods: {\n    getContractStatusClass() {\n      const type = this.contractItem?.contractor_type\n      if (type === 'MAIN_HUNTER') return 'status-main-hunter'\n      if (type === 'COMPANION_HUNTER') return 'status-companion-hunter'\n      return 'status-default'\n    },\n    calculateDuration() {\n      if (!this.contractItem?.start_date || !this.contractItem?.end_date) return 'N/A'\n      try {\n        const start = new Date(this.contractItem.start_date)\n        const end = new Date(this.contractItem.end_date)\n        const diffTime = Math.abs(end.getTime() - start.getTime())\n        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24))\n        return `${diffDays} day${diffDays !== 1 ? 's' : ''}`\n      } catch {\n        return 'N/A'\n      }\n    },\n    async downloadContractPdf() {\n      if (!this.contractItem?.id) {\n        this.init({\n          message: 'Contract ID is missing. Cannot download PDF.',\n          color: 'warning',\n        })\n        return\n      }\n\n      this.downloadingPdf = true\n      try {\n        const baseUrl = import.meta.env.VITE_APP_BASE_URL\n        const contractId = this.contractItem.id\n        const endpoint = `sales-confirmation/contracts/${contractId}/pdf`\n        const pdfUrl = `${baseUrl}${endpoint}`\n\n        const contractNumber = this.contractItem.contract_number || `contract-${contractId}`\n        const filename = `${contractNumber}.pdf`\n\n        await downloadPdf(pdfUrl, filename)\n\n        this.init({\n          message: 'PDF downloaded successfully',\n          color: 'success',\n        })\n      } catch (error: any) {\n        console.error('PDF download error:', error)\n        const message = error?.message || 'Unknown error'\n\n        if (message.includes('500') || message.includes('503')) {\n          this.init({\n            message: 'The PDF generation service is temporarily unavailable. Please try again in a few moments.',\n            color: 'warning',\n          })\n        } else if (message.includes('404')) {\n          this.init({\n            message: 'The PDF file was not found. The contract may not have been processed yet.',\n            color: 'warning',\n          })\n        } else {\n          this.init({\n            message: `Failed to download PDF: ${message}`,\n            color: 'danger',\n          })\n        }\n      } finally {\n        this.downloadingPdf = false\n      }\n    },\n    async deleteDocument(docId: any) {\n      if (!docId) {\n        this.uploadMessage = '‚ùå Document ID is missing'\n        this.uploadMessageType = 'error'\n        return\n      }\n\n      if (!confirm('Are you sure you want to delete this document?')) {\n        return\n      }\n\n      this.isDeleting = true\n      this.deletingDocId = docId\n      this.uploadMessage = '‚è≥ Deleting document...'\n      this.uploadMessageType = 'info'\n\n      try {\n        const baseUrl = import.meta.env.VITE_APP_BASE_URL\n        const endpoint = `sales-confirmation/contract-documents/${docId}`\n        const response = await fetch(`${baseUrl}${endpoint}`, {\n          method: 'DELETE',\n        })\n\n        const responseData = await response.json().catch(() => ({}))\n\n        if (response.ok) {\n          console.log('Delete successful:', responseData)\n\n          // Remove the document from the local list\n          this.documents = this.documents.filter((doc) => (doc.id || doc.document_id) !== docId)\n\n          this.uploadMessage = '‚úì Document deleted successfully!'\n          this.uploadMessageType = 'success'\n\n          // Clear message after 2 seconds\n          setTimeout(() => {\n            this.uploadMessage = ''\n            this.uploadMessageType = ''\n            this.deletingDocId = null\n          }, 2000)\n        } else {\n          const errorMsg = responseData?.message || responseData?.error || 'Unknown error'\n          this.uploadMessage = `‚ùå Delete failed: ${errorMsg}`\n          this.uploadMessageType = 'error'\n          console.error('Delete error response:', responseData)\n        }\n      } catch (error: any) {\n        console.error('Delete error:', error)\n        this.uploadMessage = `‚ùå Error: ${error.message || 'Failed to delete document'}`\n        this.uploadMessageType = 'error'\n      } finally {\n        this.isDeleting = false\n      }\n    },\n    async fetchDocuments() {\n      // Use contract ID as entity_id parameter\n      const contractId = this.contractItem?.id\n\n      if (!contractId) {\n        console.warn('No contract ID found')\n        return\n      }\n\n      try {\n        const baseUrl = import.meta.env.VITE_APP_BASE_URL\n        const endpoint = `sales-confirmation/contract-documents/?entity_id=${contractId}`\n\n        const response = await fetch(`${baseUrl}${endpoint}`, {\n          method: 'GET',\n        })\n\n        if (response.ok) {\n          const responseData = await response.json().catch(() => ({}))\n\n          // Handle different response formats\n          let fetchedDocuments = []\n          if (responseData.data && Array.isArray(responseData.data)) {\n            fetchedDocuments = responseData.data\n          } else if (responseData.value && Array.isArray(responseData.value)) {\n            fetchedDocuments = responseData.value\n          } else if (Array.isArray(responseData)) {\n            fetchedDocuments = responseData\n          }\n\n          this.documents = fetchedDocuments\n        }\n      } catch (error: any) {\n        console.error('Error fetching documents:', error)\n      }\n    },\n    onFileSelected(event: any) {\n      const file = event.target.files[0]\n      if (file) {\n        // Check file size (max 50MB)\n        if (file.size > 50 * 1024 * 1024) {\n          this.uploadMessage = '‚ùå File size exceeds 50MB limit'\n          this.uploadMessageType = 'error'\n          this.newDocument.file = null\n          return\n        }\n\n        // Check file type\n        const allowedTypes = [\n          'application/pdf',\n          'image/jpeg',\n          'image/png',\n          'application/msword',\n          'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n          'application/vnd.ms-excel',\n          'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n        ]\n\n        if (!allowedTypes.includes(file.type)) {\n          this.uploadMessage = '‚ùå File type not supported. Use PDF, JPG, PNG, DOC, or XLS'\n          this.uploadMessageType = 'error'\n          this.newDocument.file = null\n          return\n        }\n\n        this.newDocument.file = file\n        this.uploadMessage = `‚úì Selected: ${file.name} (${(file.size / 1024 / 1024).toFixed(2)} MB)`\n        this.uploadMessageType = 'info'\n      }\n    },\n    addDocument() {\n      if (!this.newDocument.file || !this.newDocument.type) {\n        this.uploadMessage = '‚ùå Please select both a document type and file'\n        this.uploadMessageType = 'error'\n        return\n      }\n\n      // Add to queue\n      this.selectedFiles.push({\n        file: this.newDocument.file,\n        type: this.newDocument.type,\n      })\n\n      this.uploadMessage = `‚úÖ Added: ${this.newDocument.file.name} (${this.newDocument.type})`\n      this.uploadMessageType = 'success'\n\n      // Reset form for next document\n      this.newDocument = { type: '', file: null }\n      if (this.$refs.fileInput) {\n        ;(this.$refs.fileInput as HTMLInputElement).value = ''\n      }\n\n      // Clear message after 2 seconds\n      setTimeout(() => {\n        this.uploadMessage = ''\n        this.uploadMessageType = ''\n      }, 2000)\n    },\n    removeFromQueue(index: number) {\n      this.selectedFiles.splice(index, 1)\n    },\n    clearQueue() {\n      this.selectedFiles = []\n      this.newDocument = { type: '', file: null }\n      this.uploadMessage = ''\n      this.uploadMessageType = ''\n    },\n    async uploadBatchDocuments() {\n      // Validate files are selected\n      if (this.selectedFiles.length === 0) {\n        this.uploadMessage = '‚ùå Please select at least one file'\n        this.uploadMessageType = 'error'\n        return\n      }\n\n      // Validate contract ID\n      if (!this.contractItem?.id) {\n        this.uploadMessage = '‚ùå Error: Contract ID is missing. Cannot upload documents.'\n        this.uploadMessageType = 'error'\n        return\n      }\n\n      this.isUploading = true\n      this.uploadMessage = `‚è≥ Uploading ${this.selectedFiles.length} document(s)...`\n      this.uploadMessageType = 'info'\n      this.uploadProgress = 0\n\n      try {\n        const baseUrl = import.meta.env.VITE_APP_BASE_URL\n        const contractId = this.contractItem.id\n        const endpoint = `sales-confirmation/contracts/${contractId}/documents`\n\n        // Prepare FormData with multiple files\n        const formData = new FormData()\n\n        // Loop through selectedFiles and append each file properly\n        this.selectedFiles.forEach((item: any, index: number) => {\n          // item = { file: File, type: string }\n          formData.append('documents[]', item.file) // Append the actual File object\n          formData.append(`doc_types[${index}]`, item.type) // Append the document type\n        })\n\n        console.log(`Uploading ${this.selectedFiles.length} documents to:`, endpoint)\n\n        const response = await fetch(`${baseUrl}${endpoint}`, {\n          method: 'POST',\n          body: formData,\n        })\n\n        const responseData = await response.json().catch(() => ({}))\n        console.log('Batch upload response:', responseData)\n\n        if (response.ok || response.status === 201) {\n          console.log('Batch upload successful:', responseData)\n\n          // Add all newly uploaded documents to the local list\n          if (responseData.data && Array.isArray(responseData.data)) {\n            responseData.data.forEach((doc: any) => {\n              this.documents.push({\n                id: doc.id,\n                document_type: doc.doc_type,\n                doc_type: doc.doc_type,\n                forWho: this.contractItem?.client_name || 'Unknown',\n                document_url: doc.url || doc.document,\n                document: doc.document,\n                uploaded_at: doc.created_at || new Date().toISOString(),\n              })\n            })\n          }\n\n          const count = responseData.total || responseData.data?.length || this.selectedFiles.length\n          this.uploadMessage = `‚úì ${count} document(s) uploaded successfully!`\n          this.uploadMessageType = 'success'\n\n          // Refetch documents from backend after a short delay to ensure backend processed the upload\n          setTimeout(() => {\n            this.fetchDocuments()\n          }, 500)\n\n          // Reset form after 2 seconds\n          setTimeout(() => {\n            this.clearQueue()\n          }, 2000)\n        } else {\n          let errorMsg = responseData?.message || `Upload failed with status ${response.status}`\n\n          if (responseData?.errors) {\n            const errorFields = Object.keys(responseData.errors)\n            const fieldErrors = errorFields\n              .map((field) => {\n                const errors = responseData.errors[field]\n                const errorText = Array.isArray(errors) ? errors.join(', ') : String(errors)\n                return `${field}: ${errorText}`\n              })\n              .join(' | ')\n            errorMsg = fieldErrors || errorMsg\n            console.error('Validation errors:', responseData.errors)\n          }\n\n          this.uploadMessage = `‚ùå Upload failed: ${errorMsg}`\n          this.uploadMessageType = 'error'\n          console.error('Upload error response:', responseData)\n        }\n      } catch (error: any) {\n        console.error('Upload error:', error)\n        this.uploadMessage = `‚ùå Error: ${error.message || 'Failed to upload documents'}`\n        this.uploadMessageType = 'error'\n      } finally {\n        this.isUploading = false\n        this.uploadProgress = 0\n      }\n    },\n    resetUploadForm() {\n      this.newDocument = {\n        type: '',\n        file: null,\n      }\n      // Clear file input\n      if (this.$refs.fileInput) {\n        ;(this.$refs.fileInput as HTMLInputElement).value = ''\n      }\n      // Clear message after a delay if it's success\n      if (this.uploadMessageType === 'success') {\n        setTimeout(() => {\n          this.uploadMessage = ''\n          this.uploadMessageType = ''\n        }, 3000)\n      }\n    },\n  },\n})\n</script>\n\n<style lang=\"scss\" scoped>\n.contract-details-page {\n  padding: 24px;\n  background: #f8fafc;\n  min-height: 100vh;\n}\n\n/* Header Section */\n.contract-header {\n  background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);\n  border-radius: 16px;\n  padding: 24px;\n  margin-bottom: 24px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);\n  border: 1px solid #e2e8f0;\n}\n\n.header-content {\n  display: flex;\n  align-items: center;\n  gap: 20px;\n}\n\n.header-icon {\n  width: 64px;\n  height: 64px;\n  background: linear-gradient(135deg, #4f46e5, #06b6d4);\n  border-radius: 16px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);\n  flex-shrink: 0;\n}\n\n.header-text {\n  flex: 1;\n}\n\n.page-title {\n  font-size: 28px;\n  font-weight: 700;\n  color: #1e293b;\n  margin: 0 0 4px 0;\n  line-height: 1.2;\n}\n\n.page-subtitle {\n  font-size: 14px;\n  color: #64748b;\n  margin: 0;\n}\n\n.header-actions {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  flex-shrink: 0;\n}\n\n.download-pdf-btn {\n  box-shadow: 0 2px 8px rgba(79, 70, 229, 0.2);\n  transition: all 0.3s ease;\n\n  &:hover:not(:disabled) {\n    box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);\n    transform: translateY(-1px);\n  }\n}\n\n.status-badge {\n  padding: 8px 16px;\n  border-radius: 20px;\n  font-size: 12px;\n  font-weight: 600;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n\n  &.status-main-hunter {\n    background: linear-gradient(135deg, #3b82f6, #2563eb);\n    color: white;\n  }\n\n  &.status-companion-hunter {\n    background: linear-gradient(135deg, #10b981, #059669);\n    color: white;\n  }\n\n  &.status-default {\n    background: #f1f5f9;\n    color: #475569;\n  }\n}\n\n/* Info Cards */\n.info-card {\n  background: #ffffff;\n  border: 1px solid #e2e8f0;\n  border-radius: 12px;\n  margin-bottom: 24px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);\n  overflow: hidden;\n  transition: all 0.3s ease;\n\n  &:hover {\n    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);\n  }\n}\n\n.contract-overview-card {\n  background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);\n  border: 1px solid #e2e8f0;\n  border-radius: 12px;\n  margin-bottom: 24px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);\n  overflow: hidden;\n}\n\n.card-header {\n  padding: 20px 24px;\n  background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%);\n  border-bottom: 2px solid #f1f5f9;\n}\n\n.card-title {\n  font-size: 18px;\n  font-weight: 600;\n  color: #1e293b;\n  margin: 0;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n}\n\n.card-icon {\n  color: #4f46e5;\n  flex-shrink: 0;\n}\n\n.doc-count-badge {\n  background: #4f46e5;\n  color: white;\n  padding: 4px 10px;\n  border-radius: 12px;\n  font-size: 12px;\n  font-weight: 600;\n  margin-left: 8px;\n}\n\n.card-content {\n  padding: 24px;\n}\n\n.overview-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n  gap: 20px;\n}\n\n.overview-item {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.overview-label {\n  font-size: 13px;\n  font-weight: 500;\n  color: #64748b;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n\n.overview-value {\n  font-size: 16px;\n  font-weight: 600;\n  color: #1e293b;\n\n  &.highlight {\n    color: #4f46e5;\n    font-size: 18px;\n  }\n}\n\n.info-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n  gap: 20px;\n}\n\n.info-item {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.info-label {\n  font-size: 13px;\n  font-weight: 500;\n  color: #64748b;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n\n.info-value {\n  font-size: 15px;\n  font-weight: 500;\n  color: #1e293b;\n}\n\n/* Documents Section */\n.documents-grid {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.document-card-item {\n  background: #f8fafc;\n  border: 1px solid #e2e8f0;\n  border-radius: 10px;\n  padding: 16px;\n  display: flex;\n  align-items: center;\n  gap: 16px;\n  transition: all 0.2s ease;\n\n  &:hover {\n    border-color: #cbd5e1;\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\n  }\n}\n\n.document-icon-wrapper {\n  width: 48px;\n  height: 48px;\n  background: linear-gradient(135deg, #6366f1, #8b5cf6);\n  border-radius: 10px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  flex-shrink: 0;\n}\n\n.document-details-content {\n  flex: 1;\n  min-width: 0;\n}\n\n.document-type-name {\n  font-size: 15px;\n  font-weight: 600;\n  color: #1e293b;\n  margin-bottom: 4px;\n}\n\n.document-meta {\n  display: flex;\n  gap: 12px;\n  font-size: 13px;\n  color: #64748b;\n}\n\n.document-date,\n.document-for {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n}\n\n.document-actions {\n  display: flex;\n  gap: 8px;\n  flex-shrink: 0;\n}\n\n.document-view-btn {\n  padding: 8px 16px;\n  background: linear-gradient(135deg, #4f46e5, #6366f1);\n  color: white;\n  border: none;\n  border-radius: 8px;\n  font-size: 13px;\n  font-weight: 600;\n  cursor: pointer;\n  text-decoration: none;\n  transition: all 0.2s ease;\n\n  &:hover {\n    box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);\n    transform: translateY(-1px);\n  }\n}\n\n.document-delete-btn {\n  padding: 8px 16px;\n  background: #fee2e2;\n  color: #991b1b;\n  border: 1px solid #fecaca;\n  border-radius: 8px;\n  font-size: 13px;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s ease;\n\n  &:hover:not(:disabled) {\n    background: #fecaca;\n    border-color: #f87171;\n  }\n\n  &:disabled {\n    opacity: 0.6;\n    cursor: not-allowed;\n  }\n}\n\n.no-documents-message {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 48px 24px;\n  color: #94a3b8;\n  text-align: center;\n  gap: 16px;\n\n  svg {\n    color: #cbd5e1;\n  }\n\n  p {\n    font-size: 15px;\n    font-weight: 500;\n    margin: 0;\n  }\n}\n\n/* Document Upload Form */\n.document-upload-card {\n  border: 2px dashed #cbd5e1;\n\n  &:hover {\n    border-color: #94a3b8;\n  }\n}\n\n.document-upload-form {\n  background: #f8fafc;\n  border-radius: 10px;\n  padding: 20px;\n}\n\n.upload-title {\n  font-size: 16px;\n  font-weight: 700;\n  color: #333;\n  margin-bottom: 8px;\n}\n\n.upload-description {\n  font-size: 13px;\n  color: #666;\n  margin-bottom: 15px;\n  font-style: italic;\n}\n\n.upload-grid {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 15px;\n  margin-bottom: 15px;\n}\n\n@media (max-width: 768px) {\n  .upload-grid {\n    grid-template-columns: 1fr;\n  }\n}\n\n.upload-field {\n  display: flex;\n  flex-direction: column;\n}\n\n.field-label {\n  font-weight: 700;\n  font-size: 12px;\n  color: #333;\n  margin-bottom: 8px;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n\n.form-select,\n.form-input {\n  padding: 10px 12px;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  font-size: 13px;\n  font-family: inherit;\n  background: white;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.form-select:disabled,\n.form-input:disabled {\n  background: #f5f5f5;\n  cursor: not-allowed;\n  opacity: 0.6;\n}\n\n.form-select:hover:not(:disabled),\n.form-input:hover:not(:disabled) {\n  border-color: #ea4335;\n  box-shadow: 0 0 0 2px rgba(234, 67, 53, 0.05);\n}\n\n.form-select:focus,\n.form-input:focus {\n  outline: none;\n  border-color: #ea4335;\n  box-shadow: 0 0 0 3px rgba(234, 67, 53, 0.1);\n}\n\n.upload-actions {\n  display: flex;\n  gap: 10px;\n  margin-bottom: 15px;\n  flex-wrap: wrap;\n}\n\n.btn-upload,\n.btn-cancel {\n  padding: 10px 20px;\n  border: none;\n  border-radius: 4px;\n  font-size: 13px;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s;\n  white-space: nowrap;\n}\n\n.btn-upload {\n  background: linear-gradient(135deg, #34a853, #0d652d);\n  color: white;\n  flex: 1;\n  min-width: 150px;\n}\n\n.btn-upload:hover:not(:disabled) {\n  box-shadow: 0 4px 12px rgba(52, 168, 83, 0.3);\n  transform: translateY(-1px);\n}\n\n.btn-upload:active:not(:disabled) {\n  transform: translateY(0);\n}\n\n.btn-upload:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n  background: linear-gradient(135deg, #ccc, #999);\n}\n\n.btn-cancel {\n  background: #f5f5f5;\n  color: #666;\n  border: 1px solid #ddd;\n  min-width: 100px;\n}\n\n.btn-cancel:hover:not(:disabled) {\n  background: #e8e8e8;\n  border-color: #999;\n}\n\n.btn-cancel:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n\n.upload-message {\n  padding: 12px 15px;\n  border-radius: 4px;\n  font-size: 13px;\n  margin-bottom: 15px;\n  border-left: 4px solid transparent;\n}\n\n.upload-message.success {\n  background: #d4edda;\n  color: #155724;\n  border-left-color: #28a745;\n  border: 1px solid #c3e6cb;\n}\n\n.upload-message.error {\n  background: #f8d7da;\n  color: #721c24;\n  border-left-color: #dc3545;\n  border: 1px solid #f5c6cb;\n}\n\n.upload-message.info {\n  background: #d1ecf1;\n  color: #0c5460;\n  border-left-color: #17a2b8;\n  border: 1px solid #bee5eb;\n}\n\n.upload-help {\n  font-size: 12px;\n  color: #999;\n  margin-top: 10px;\n  margin-bottom: 0;\n}\n\n.document-actions {\n  margin-top: 10px;\n  padding-top: 10px;\n  border-top: 1px solid #eee;\n  display: flex;\n  gap: 10px;\n}\n\n.btn-delete {\n  padding: 8px 12px;\n  border: none;\n  border-radius: 4px;\n  font-size: 12px;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s;\n  background: #dc3545;\n  color: white;\n  flex: 1;\n}\n\n.btn-delete:hover:not(:disabled) {\n  background: #c82333;\n  box-shadow: 0 2px 8px rgba(220, 53, 69, 0.3);\n  transform: translateY(-1px);\n}\n\n.btn-delete:active:not(:disabled) {\n  transform: translateY(0);\n}\n\n.btn-delete:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n  background: #999;\n}\n\n/* Batch Upload Styles */\n.batch-upload-section {\n  margin-top: 20px;\n  border-top: 2px solid #ddd;\n  padding-top: 20px;\n}\n\n.file-count {\n  display: block;\n  margin-top: 5px;\n  color: #666;\n  font-size: 12px;\n}\n\n.doc-types-section {\n  margin: 15px 0;\n  padding: 15px;\n  background: #f5f5f5;\n  border-radius: 6px;\n}\n\n.doc-types-section h4 {\n  margin: 0 0 10px 0;\n  font-size: 13px;\n  color: #333;\n}\n\n.doc-types-list {\n  max-height: 400px;\n  overflow-y: auto;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  background: white;\n}\n\n.doc-type-row {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  padding: 10px;\n  border-bottom: 1px solid #eee;\n}\n\n.doc-type-row:last-child {\n  border-bottom: none;\n}\n\n.file-name {\n  flex: 1;\n  font-size: 13px;\n  color: #333;\n  word-break: break-all;\n  font-weight: 500;\n}\n\n.file-size {\n  flex: 0 0 auto;\n  font-size: 12px;\n  color: #999;\n}\n\n.doc-type-row .form-select {\n  flex: 0 0 auto;\n  min-width: 150px;\n  padding: 6px 8px;\n  font-size: 12px;\n}\n\n.progress-bar-container {\n  margin: 15px 0;\n  height: 24px;\n  background: #e0e0e0;\n  border-radius: 4px;\n  overflow: hidden;\n  display: flex;\n  align-items: center;\n  position: relative;\n}\n\n.progress-bar {\n  height: 100%;\n  background: linear-gradient(90deg, #4caf50, #45a049);\n  transition: width 0.3s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.progress-text {\n  position: absolute;\n  width: 100%;\n  text-align: center;\n  font-size: 12px;\n  font-weight: 600;\n  color: #333;\n}\n\n/* Submit Section */\n.submit-section {\n  margin-top: 30px;\n  padding-top: 20px;\n  border-top: 2px solid #e0e0e0;\n}\n\n.divider {\n  border: none;\n  border-top: 2px solid #e0e0e0;\n  margin: 20px 0;\n}\n\n.submit-actions {\n  display: flex;\n  gap: 12px;\n  justify-content: flex-end;\n  flex-wrap: wrap;\n}\n\n.btn-submit {\n  padding: 12px 24px;\n  border: none;\n  border-radius: 4px;\n  font-size: 14px;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s;\n  background: linear-gradient(135deg, #4caf50, #2e7d32);\n  color: white;\n  min-width: 160px;\n  box-shadow: 0 2px 8px rgba(76, 175, 80, 0.2);\n}\n\n.btn-submit:hover:not(:disabled) {\n  box-shadow: 0 4px 12px rgba(76, 175, 80, 0.4);\n  transform: translateY(-2px);\n}\n\n.btn-submit:active:not(:disabled) {\n  transform: translateY(0);\n}\n\n.btn-submit:disabled {\n  opacity: 0.6;\n  cursor: not-allowed;\n}\n\n.btn-cancel-submit {\n  padding: 12px 24px;\n  border: 1px solid #e0e0e0;\n  border-radius: 4px;\n  font-size: 14px;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s;\n  background: white;\n  color: #666;\n  min-width: 120px;\n}\n\n.btn-cancel-submit:hover {\n  border-color: #ea4335;\n  color: #ea4335;\n  background: #fef8f7;\n}\n\n.btn-cancel-submit:active {\n  background: #f5f5f5;\n}\n\n.submit-help {\n  display: block;\n  margin-top: 12px;\n  font-size: 12px;\n  color: #666;\n  text-align: center;\n  font-style: italic;\n}\n\n/* Responsive Design */\n@media (max-width: 1024px) {\n  .contract-details-page {\n    padding: 16px;\n  }\n\n  .overview-grid,\n  .info-grid {\n    grid-template-columns: 1fr;\n  }\n\n  .header-content {\n    flex-direction: column;\n    align-items: flex-start;\n    gap: 16px;\n  }\n\n  .header-actions {\n    width: 100%;\n    flex-direction: column;\n    align-items: stretch;\n\n    .download-pdf-btn {\n      width: 100%;\n    }\n  }\n}\n\n@media (max-width: 768px) {\n  .page-title {\n    font-size: 24px;\n  }\n\n  .card-content {\n    padding: 16px;\n  }\n\n  .document-card-item {\n    flex-direction: column;\n    align-items: flex-start;\n  }\n\n  .document-actions {\n    width: 100%;\n    justify-content: flex-end;\n  }\n}\n</style>\n","<template>\n  <VaInnerLoading :loading=\"loadingSales\">\n    <VaCard square outlined class=\"contract-form-card\">\n      <div class=\"form-header flex items-start gap-4 p-4\">\n        <div\n          class=\"header-icon bg-primary-500 text-white rounded-full w-12 h-12 flex items-center justify-center shadow-md\"\n        >\n          <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n            <path d=\"M12 2L15 8H21L16.5 12L18.5 18L12 14L5.5 18L7.5 12L3 8H9L12 2Z\" fill=\"currentColor\" />\n          </svg>\n        </div>\n        <div class=\"header-text\">\n          <div class=\"text-2xl font-semibold\">Create Contract</div>\n          <div class=\"text-sm text-muted\">\n            Create a contract for a completed sales confirmation. Upload required documents below.\n          </div>\n        </div>\n      </div>\n      <VaCardContent class=\"p-6\">\n        <VaForm ref=\"iformRef\" class=\"space-y-6\">\n          <!-- Sales Confirmation Selection -->\n          <div class=\"mb-6\">\n            <VaSelect\n              v-model=\"form.proposal\"\n              :options=\"proposalOptions\"\n              :rules=\"[(value: any) => value || 'Sales confirmation is required']\"\n              placeholder=\"Select sales confirmation\"\n              label=\"Sales Confirmation\"\n              class=\"mb-4\"\n              @update:modelValue=\"onValueChange\"\n            />\n\n            <!-- Enhanced Proposal Details Card -->\n            <div v-if=\"salesItem\" class=\"proposal-details-card mt-4\">\n              <div class=\"details-header\">\n                <h3 class=\"details-title\">Sales Confirmation Details</h3>\n                <div class=\"status-badge\" :class=\"getStatusClass(salesItem)\">\n                  {{ getStatusText(salesItem) }}\n                </div>\n              </div>\n\n              <div class=\"details-content\">\n                <!-- Client Information Section -->\n                <div class=\"info-section\">\n                  <h4 class=\"section-title\">\n                    <svg\n                      class=\"section-icon\"\n                      width=\"18\"\n                      height=\"18\"\n                      viewBox=\"0 0 24 24\"\n                      fill=\"none\"\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                    >\n                      <path\n                        d=\"M12 12C14.21 12 16 10.21 16 8C16 5.79 14.21 4 12 4C9.79 4 8 5.79 8 8C8 10.21 9.79 12 12 12ZM12 14C9.33 14 4 15.34 4 18V20H20V18C20 15.34 14.67 14 12 14Z\"\n                        fill=\"currentColor\"\n                      />\n                    </svg>\n                    Client Information\n                  </h4>\n                  <div class=\"info-grid\">\n                    <div class=\"info-item\">\n                      <span class=\"info-label\">Full Name:</span>\n                      <span class=\"info-value\">{{ salesItem.client?.full_name || '-' }}</span>\n                    </div>\n                    <div v-if=\"salesItem.client?.email\" class=\"info-item\">\n                      <span class=\"info-label\">Email:</span>\n                      <span class=\"info-value\">{{ salesItem.client.email }}</span>\n                    </div>\n                    <div v-if=\"salesItem.client?.country\" class=\"info-item\">\n                      <span class=\"info-label\">Country:</span>\n                      <span class=\"info-value\">{{ salesItem.client.country }}</span>\n                    </div>\n                    <div v-if=\"salesItem.client?.nationality\" class=\"info-item\">\n                      <span class=\"info-label\">Nationality:</span>\n                      <span class=\"info-value\">{{ salesItem.client.nationality }}</span>\n                    </div>\n                    <div v-if=\"salesItem.client?.cell\" class=\"info-item\">\n                      <span class=\"info-label\">Phone:</span>\n                      <span class=\"info-value\">{{ salesItem.client.cell }}</span>\n                    </div>\n                  </div>\n                </div>\n\n                <!-- Hunting Trip Information Section -->\n                <div class=\"info-section\">\n                  <h4 class=\"section-title\">\n                    <svg\n                      class=\"section-icon\"\n                      width=\"18\"\n                      height=\"18\"\n                      viewBox=\"0 0 24 24\"\n                      fill=\"none\"\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                    >\n                      <path\n                        d=\"M12 2C8.13 2 5 5.13 5 9C5 14.25 12 22 12 22C12 22 19 14.25 19 9C19 5.13 15.87 2 12 2ZM12 11.5C10.62 11.5 9.5 10.38 9.5 9C9.5 7.62 10.62 6.5 12 6.5C13.38 6.5 14.5 7.62 14.5 9C14.5 10.38 13.38 11.5 12 11.5Z\"\n                        fill=\"currentColor\"\n                      />\n                    </svg>\n                    Hunting Trip Details\n                  </h4>\n                  <div class=\"info-grid\">\n                    <div class=\"info-item\">\n                      <span class=\"info-label\">Hunting Area:</span>\n                      <span class=\"info-value\">{{ salesItem.hunting_trip?.hunting_area || '-' }}</span>\n                    </div>\n                    <div v-if=\"salesItem.hunting_trip?.type\" class=\"info-item\">\n                      <span class=\"info-label\">Safari Type:</span>\n                      <span class=\"info-value\">{{ salesItem.hunting_trip.type }}</span>\n                    </div>\n                    <div v-if=\"salesItem.hunting_trip?.outfitter\" class=\"info-item\">\n                      <span class=\"info-label\">Outfitter:</span>\n                      <span class=\"info-value\">{{ salesItem.hunting_trip.outfitter }}</span>\n                    </div>\n                    <div class=\"info-item\">\n                      <span class=\"info-label\">Dates:</span>\n                      <span class=\"info-value\">{{\n                        salesItem.hunting_trip?.dates || salesItem.confirmation_date_formatted || '-'\n                      }}</span>\n                    </div>\n                    <div\n                      v-if=\"salesItem.hunting_trip?.start_date && salesItem.hunting_trip?.end_date\"\n                      class=\"info-item\"\n                    >\n                      <span class=\"info-label\">Start Date:</span>\n                      <span class=\"info-value\">{{ formatDate(salesItem.hunting_trip.start_date) }}</span>\n                    </div>\n                    <div v-if=\"salesItem.hunting_trip?.end_date\" class=\"info-item\">\n                      <span class=\"info-label\">End Date:</span>\n                      <span class=\"info-value\">{{ formatDate(salesItem.hunting_trip.end_date) }}</span>\n                    </div>\n                    <div v-if=\"salesItem.hunting_trip?.no_of_days\" class=\"info-item\">\n                      <span class=\"info-label\">Duration:</span>\n                      <span class=\"info-value\">{{ salesItem.hunting_trip.no_of_days }} days</span>\n                    </div>\n                  </div>\n                </div>\n\n                <!-- Species & Participants Section -->\n                <div class=\"info-section\">\n                  <h4 class=\"section-title\">\n                    <svg\n                      class=\"section-icon\"\n                      width=\"18\"\n                      height=\"18\"\n                      viewBox=\"0 0 24 24\"\n                      fill=\"none\"\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                    >\n                      <path d=\"M12 2L2 7L12 12L22 7L12 2Z\" fill=\"currentColor\" />\n                      <path d=\"M2 17L12 22L22 17V12L12 17L2 12V17Z\" fill=\"currentColor\" />\n                    </svg>\n                    Species & Participants\n                  </h4>\n                  <div class=\"info-grid\">\n                    <div v-if=\"getSpeciesList().length > 0\" class=\"info-item\">\n                      <span class=\"info-label\">Species:</span>\n                      <div class=\"species-tags\">\n                        <span v-for=\"(species, idx) in getSpeciesList()\" :key=\"idx\" class=\"species-tag\">\n                          {{ species }}\n                        </span>\n                      </div>\n                    </div>\n                    <div class=\"info-item\">\n                      <span class=\"info-label\">Hunters:</span>\n                      <span class=\"info-value\">{{ salesItem.trip_details?.no_of_hunters || '-' }}</span>\n                    </div>\n                    <div\n                      v-if=\"salesItem.companion_observer?.no_of_companions || salesItem.trip_details?.no_of_companions\"\n                      class=\"info-item\"\n                    >\n                      <span class=\"info-label\">Companions:</span>\n                      <span class=\"info-value\">{{\n                        salesItem.companion_observer?.no_of_companions ||\n                        salesItem.trip_details?.no_of_companions ||\n                        '-'\n                      }}</span>\n                    </div>\n                    <div\n                      v-if=\"salesItem.companion_observer?.no_of_observers || salesItem.trip_details?.no_of_observers\"\n                      class=\"info-item\"\n                    >\n                      <span class=\"info-label\">Observers:</span>\n                      <span class=\"info-value\">{{\n                        salesItem.companion_observer?.no_of_observers || salesItem.trip_details?.no_of_observers || '-'\n                      }}</span>\n                    </div>\n                  </div>\n                </div>\n\n                <!-- Pricing Information Section -->\n                <div v-if=\"salesItem.pricing\" class=\"info-section\">\n                  <h4 class=\"section-title\">\n                    <svg\n                      class=\"section-icon\"\n                      width=\"18\"\n                      height=\"18\"\n                      viewBox=\"0 0 24 24\"\n                      fill=\"none\"\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                    >\n                      <path\n                        d=\"M11.8 10.9C9.53 10.31 8.8 9.7 8.8 8.75C8.8 7.66 9.81 6.9 11.5 6.9C13.28 6.9 13.94 7.75 14 9H16.21C16.14 7.28 15.09 5.7 13 5.19V3H10V5.16C8.06 5.58 6.5 6.84 6.5 8.77C6.5 10.65 8.2 11.96 11 12.58C13.5 13.11 14.2 13.85 14.2 14.9C14.2 15.91 13.36 16.75 11.5 16.75C9.45 16.75 8.7 15.81 8.6 14.5H6.39C6.5 16.47 7.88 17.9 10 18.29V21H13V18.33C14.95 17.9 16.5 16.66 16.5 14.7C16.5 12.36 14.47 11.1 11.8 10.9Z\"\n                        fill=\"currentColor\"\n                      />\n                    </svg>\n                    Pricing Information\n                  </h4>\n                  <div class=\"info-grid\">\n                    <div class=\"info-item pricing-highlight\">\n                      <span class=\"info-label\">Total Amount:</span>\n                      <span class=\"info-value price-value\">\n                        {{ salesItem.pricing.currency || '' }} {{ formatNumber(salesItem.pricing.total_amount) }}\n                      </span>\n                    </div>\n                    <div\n                      v-if=\"salesItem.pricing.installments && salesItem.pricing.installments.length > 0\"\n                      class=\"info-item\"\n                    >\n                      <span class=\"info-label\">Installments:</span>\n                      <span class=\"info-value\">{{ salesItem.pricing.installments.length }} payment(s)</span>\n                    </div>\n                  </div>\n                </div>\n\n                <!-- Additional Information -->\n                <div\n                  v-if=\"salesItem.sales_inquiry || salesItem.confirmation_date_formatted || salesItem.hunting_license\"\n                  class=\"info-section\"\n                >\n                  <h4 class=\"section-title\">\n                    <svg\n                      class=\"section-icon\"\n                      width=\"18\"\n                      height=\"18\"\n                      viewBox=\"0 0 24 24\"\n                      fill=\"none\"\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                    >\n                      <path\n                        d=\"M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19ZM7 10H9V17H7V10ZM11 7H13V17H11V7ZM15 13H17V17H15V13Z\"\n                        fill=\"currentColor\"\n                      />\n                    </svg>\n                    Additional Information\n                  </h4>\n                  <div class=\"info-grid\">\n                    <div v-if=\"salesItem.sales_inquiry?.code\" class=\"info-item\">\n                      <span class=\"info-label\">Sales Inquiry Code:</span>\n                      <span class=\"info-value\">{{ salesItem.sales_inquiry.code }}</span>\n                    </div>\n                    <div v-if=\"salesItem.sales_inquiry?.season\" class=\"info-item\">\n                      <span class=\"info-label\">Season:</span>\n                      <span class=\"info-value\">{{ salesItem.sales_inquiry.season }}</span>\n                    </div>\n                    <div v-if=\"salesItem.confirmation_date_formatted\" class=\"info-item\">\n                      <span class=\"info-label\">Confirmation Date:</span>\n                      <span class=\"info-value\">{{ salesItem.confirmation_date_formatted }}</span>\n                    </div>\n                    <div v-if=\"salesItem.hunting_license\" class=\"info-item\">\n                      <span class=\"info-label\">Hunting License:</span>\n                      <span class=\"info-value\">{{ salesItem.hunting_license }}</span>\n                    </div>\n                    <div v-if=\"salesItem.remarks\" class=\"info-item\">\n                      <span class=\"info-label\">Remarks:</span>\n                      <span class=\"info-value\">{{ salesItem.remarks }}</span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <!-- Contract Description Section -->\n          <div class=\"description-section\">\n            <div class=\"section-header\">\n              <h3 class=\"section-title-large\">\n                <svg\n                  class=\"section-icon-large\"\n                  width=\"20\"\n                  height=\"20\"\n                  viewBox=\"0 0 24 24\"\n                  fill=\"none\"\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                >\n                  <path\n                    d=\"M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.89 22 5.99 22H18C19.1 22 20 21.1 20 20V8L14 2ZM18 20H6V4H13V9H18V20Z\"\n                    fill=\"currentColor\"\n                  />\n                </svg>\n                Contract Description\n              </h3>\n              <p class=\"section-description\">\n                Provide a detailed description for this contract. This will be pre-filled with sales confirmation\n                details, but you can edit it as needed.\n              </p>\n            </div>\n\n            <div class=\"description-input-area\">\n              <VaTextarea\n                v-model=\"form.description\"\n                label=\"Description\"\n                placeholder=\"Enter contract description...\"\n                :min-rows=\"6\"\n                :max-rows=\"12\"\n                counter\n                autosize\n                required-mark\n                :rules=\"[(v: any) => (v && v.length > 0) || 'Description is required']\"\n                class=\"description-textarea\"\n              />\n            </div>\n          </div>\n\n          <!-- Document Upload Section - COMMENTED OUT FOR NOW -->\n          <!--\n            <div class=\"document-section\">\n              <div class=\"section-header\">\n                <h3 class=\"section-title-large\">\n                  <svg class=\"section-icon-large\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                    <path d=\"M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.89 22 5.99 22H18C19.1 22 20 21.1 20 20V8L14 2ZM18 20H6V4H13V9H18V20Z\" fill=\"currentColor\"/>\n                  </svg>\n                  Supporting Documents\n                  <span class=\"required-badge\">Required</span>\n              </h3>\n                <p class=\"section-description\">Upload required documents for contract creation. At least one document must be provided.</p>\n              </div>\n              \n              <div class=\"document-upload-area\">\n              <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4\">\n                <VaSelect\n                  v-model=\"form.doc_type\"\n                  :options=\"documentTypes\"\n                  placeholder=\"Select document type\"\n                  label=\"Document Type\"\n                  searchable\n                  highlight-matched-text\n                  :rules=\"[]\"\n                />\n                <VaFileUpload\n                  v-model=\"form.documents\"\n                    upload-button-text=\"Choose File\"\n                  color=\"secondary\"\n                  label=\"Upload Document\"\n                  dropzone\n                  undo\n                  size=\"50mb\"\n                  file-types=\"image/jpeg, image/png, image/pdf, application/pdf, application/msword, application/vnd.openxmlformats-officedocument.wordprocessingml.document, application/vnd.ms-excel, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"\n                  undo-duration=\"500\"\n                  :max-files=\"1\"\n                />\n              </div>\n              <VaButton\n                icon=\"add\"\n                  size=\"medium\"\n                color=\"secondary\"\n                :disabled=\"!form.doc_type || form.documents.length === 0\"\n                @click=\"addDocument\"\n                  class=\"add-doc-button\"\n              >\n                Add Document\n              </VaButton>\n              </div>\n\n              <div v-if=\"form.uploadedDocuments.length > 0\" class=\"documents-list\">\n                <h4 class=\"documents-list-title\">Added Documents ({{ form.uploadedDocuments.length }})</h4>\n                <div class=\"documents-grid\">\n                  <div\n                    v-for=\"(doc, index) in form.uploadedDocuments\"\n                    :key=\"index\"\n                    class=\"document-item\"\n                  >\n                    <div class=\"document-item-content\">\n                      <svg class=\"document-icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                        <path d=\"M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.89 22 5.99 22H18C19.1 22 20 21.1 20 20V8L14 2ZM18 20H6V4H13V9H18V20Z\" fill=\"currentColor\"/>\n                      </svg>\n                      <div class=\"document-info\">\n                        <div class=\"document-type\">{{ doc.type }}</div>\n                        <div class=\"document-name\">{{ doc.file.name }}</div>\n                        <div class=\"document-size\">{{ formatFileSize(doc.file.size) }}</div>\n                  </div>\n                </div>\n                    <VaButton \n                      preset=\"plain\" \n                      icon=\"delete\" \n                      size=\"small\" \n                      color=\"danger\" \n                      @click=\"removeDocument(index)\"\n                      class=\"remove-doc-button\"\n                    />\n              </div>\n              </div>\n            </div>\n              <div v-else class=\"documents-warning\">\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                  <path d=\"M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM13 17H11V15H13V17ZM13 13H11V7H13V13Z\" fill=\"currentColor\"/>\n                </svg>\n                <span>At least one document is required to create the contract</span>\n              </div>\n            </div>\n            -->\n\n          <div class=\"form-actions\">\n            <VaButton preset=\"outline\" color=\"danger\" size=\"medium\" class=\"action-button\" @click=\"handleReset\">\n              Cancel\n            </VaButton>\n            <VaButton\n              color=\"primary\"\n              size=\"large\"\n              :disabled=\"!isValidForm\"\n              class=\"action-button primary-action\"\n              @click=\"validateForm() && onSubmit()\"\n            >\n              <svg\n                width=\"18\"\n                height=\"18\"\n                viewBox=\"0 0 24 24\"\n                fill=\"none\"\n                xmlns=\"http://www.w3.org/2000/svg\"\n                style=\"margin-right: 8px\"\n              >\n                <path d=\"M9 16.17L4.83 12L3.41 13.41L9 19L21 7L19.59 5.59L9 16.17Z\" fill=\"currentColor\" />\n              </svg>\n              Create Contract\n            </VaButton>\n          </div>\n        </VaForm>\n      </VaCardContent>\n    </VaCard>\n  </VaInnerLoading>\n</template>\n\n<script lang=\"ts\">\nimport { useForm, useToast } from 'vuestic-ui'\nimport { defineComponent, ref, reactive } from 'vue'\nimport { useSalesInquiriesStore } from '../../../../stores/sales-store'\nimport { mapActions, mapState } from 'pinia'\nimport { useContractsStore } from '../../../../stores/contracts-store'\nimport handleErrors from '../../../../utils/errorHandler'\n\nexport default defineComponent({\n  setup() {\n    const { init } = useToast()\n\n    const iformRef = ref(null as any)\n    const {\n      isValid: isValidForm,\n      validate: validateForm,\n      resetValidation: resetValidationForm,\n      reset: resetForm,\n    } = useForm(iformRef)\n\n    const isNotUpBookingSelected = ref(true)\n\n    const onInputChange = (event: any) => {\n      console.log(event)\n      if (event.value == 'prior' || event.value == 'after') {\n        isNotUpBookingSelected.value = false\n      }\n    }\n\n    const form = reactive({\n      proposal: null as any,\n      enity_id: null as any,\n      description: '',\n      doc_type: null as any,\n      documents: [] as any,\n      uploadedDocuments: [] as any,\n    })\n\n    return {\n      iformRef,\n      isValidForm,\n      validateForm,\n      resetValidationForm,\n      resetForm,\n      form,\n      init,\n      onInputChange,\n      isNotUpBookingSelected,\n    }\n  },\n\n  data() {\n    // Tabs removed - unified contract creation per sales confirmation\n    const packages = [] as any\n    const documentTypes = [\n      {\n        text: 'Travel Packet (Passport Copy)',\n        value: 'Passport_Copy',\n      },\n      {\n        text: 'Travel Packet (Passport Photo)',\n        value: 'Passport_Photo',\n      },\n      {\n        text: 'Visa',\n        value: 'Visa',\n      },\n      {\n        text: 'Gun Permits',\n        value: 'Gun_Permits',\n      },\n      {\n        text: 'CITES Documentation',\n        value: 'CITES_Documentation',\n      },\n      {\n        text: 'Sales Invoice',\n        value: 'sales_invoice',\n      },\n      {\n        text: 'Receipt',\n        value: 'receipt',\n      },\n    ]\n    return {\n      packages,\n      installments: [] as any,\n      regulatoryPackages: [] as any,\n      proposalOptions: [] as any,\n      documentTypes,\n      loadingSales: false,\n      salesItem: null as any,\n      // no tabs or value needed\n    }\n  },\n  computed: {\n    ...mapState(useSalesInquiriesStore, ['companions']),\n  },\n\n  mounted() {\n    this.getSalesProposalOptions()\n  },\n\n  methods: {\n    ...mapActions(useContractsStore, ['createContract']),\n    ...mapActions(useSalesInquiriesStore, ['getallSalesConfirmation', 'getSalesConfirmationProposals']),\n\n    ...mapActions(useSalesInquiriesStore, ['getCompanions']),\n    onValueChange(value: any) {\n      if (!value) return\n\n      // The VaSelect may return either the option object or just the value (id).\n      // Normalize to an option object so we can read the underlying proposal (`selfitem`).\n      let selectedOption: any = null\n      // If the select gives us the full option object\n      if (typeof value === 'object' && (value.selfitem || value.value)) {\n        selectedOption = value\n      } else if (typeof value === 'number' || typeof value === 'string') {\n        // Find the matching option by value\n        selectedOption = this.proposalOptions.find((opt: any) => String(opt.value) === String(value)) || null\n      }\n\n      const selectedItem = selectedOption?.selfitem || selectedOption || null\n      console.log('Selected proposal full object:', selectedItem)\n      console.log('Entity ID locations - sales_inquiry.entity.id:', selectedItem?.sales_inquiry?.entity?.id)\n      console.log('Entity ID locations - entity.id:', selectedItem?.entity?.id)\n      console.log('Entity ID locations - client.id:', selectedItem?.client?.id)\n\n      // Normalize the form's proposal value to the option object for easier later use\n      if (selectedOption) {\n        this.form.proposal = selectedOption\n      }\n\n      this.salesItem = selectedItem\n\n      // Populate form with useful sales confirmation info for creating a contract\n      const clientName =\n        selectedItem?.client?.full_name ||\n        selectedItem?.sales_inquiry?.entity?.full_name ||\n        selectedItem?.entity?.full_name ||\n        selectedItem?.client_name ||\n        ''\n\n      if (clientName) {\n        this.form.description = this.buildDetailedDescription(selectedItem, clientName)\n      }\n\n      // Derive and store entity id on the form for submit\n      this.form.enity_id =\n        selectedItem?.sales_inquiry?.entity?.id || selectedItem?.entity?.id || selectedItem?.client?.id || null\n      // No companion selection in the unified form. If needed, companions can still be fetched\n      // but the form always creates a single contract tied to the sales confirmation.\n    },\n    async onSubmit() {\n      // Extract the actual ID value from the selected proposal\n      // The proposal form field contains the entire option object with { text, value, selfitem }\n      let proposalValue = null\n      let selectedProposal = null\n\n      if (this.form.proposal) {\n        // If it's an option object with value property\n        if (typeof this.form.proposal === 'object' && this.form.proposal.value) {\n          proposalValue = this.form.proposal.value\n          selectedProposal = this.form.proposal.selfitem\n        }\n        // If it's already just the ID\n        else if (typeof this.form.proposal === 'number') {\n          proposalValue = this.form.proposal\n        }\n      }\n\n      // For unified contract creation, derive entity from the sales confirmation proposal\n      const entityValue =\n        selectedProposal?.sales_inquiry?.entity?.id ||\n        selectedProposal?.entity?.id ||\n        selectedProposal?.client?.id ||\n        null\n\n      // Validate required fields\n      if (!proposalValue) {\n        this.init({ message: 'Sales confirmation is required', color: 'warning' })\n        return\n      }\n\n      if (!selectedProposal || !selectedProposal.id) {\n        this.init({\n          message: 'Invalid sales confirmation selected. Please select again from the list.',\n          color: 'warning',\n        })\n        return\n      }\n\n      // Start/end dates are taken from the sales inquiry; no local validation required\n\n      if (!entityValue) {\n        this.init({\n          message: 'Entity information is missing. Please select a valid sales confirmation.',\n          color: 'warning',\n        })\n        return\n      }\n\n      // No local date comparison needed - backend derives dates from the sales inquiry\n\n      // Document validation commented out - document upload is disabled for now\n      // if (!this.form.uploadedDocuments || this.form.uploadedDocuments.length === 0) {\n      //   this.init({\n      //     message: 'At least one document is required. Please upload a supporting document.',\n      //     color: 'warning',\n      //   })\n      //   return\n      // }\n\n      // Ensure the selected proposal is actually completed (defensive check)\n      const selStatus = selectedProposal?.status?.status || selectedProposal?.status || ''\n      if (String(selStatus).toLowerCase() !== 'completed') {\n        this.init({ message: 'Contracts can only be created for completed sales confirmations.', color: 'warning' })\n        return\n      }\n\n      // Backend automatically gets start_date and end_date from sales inquiry preferences\n      // Only need to send: sales_confirmation_proposal_id, entity_id, and description\n      const data = {\n        sales_confirmation_proposal_id: proposalValue,\n        entity_id: entityValue,\n        description: this.form.description,\n      }\n\n      console.log('Form submission data:', data)\n      console.log('Selected proposal object:', selectedProposal)\n\n      try {\n        const response: any = await this.createContract(data)\n        if (response.status === 201) {\n          // Document upload commented out - disabled for now\n          // const createdContractId = response.data?.id || response.data?.data?.id\n          // if (createdContractId && this.form.uploadedDocuments.length > 0) {\n          //   await this.uploadDocumentsForContract(createdContractId)\n          // }\n\n          this.init({ message: 'Contract created successfully', color: 'success' })\n          // Reset form after successful submission\n          this.resetForm()\n          this.resetValidationForm()\n        }\n      } catch (error: any) {\n        console.error('Contract creation error:', error)\n        console.error('Error response:', error.response)\n        console.error('Error message:', error.message)\n\n        const errorData = error.response?.data\n        const errorMessage = errorData?.error || errorData?.message || error.message || ''\n\n        // Check if it's a duplicate entry constraint error\n        if (errorMessage.includes('Duplicate entry') || errorMessage.includes('constraint')) {\n          this.init({\n            message:\n              'A contract already exists for this sales confirmation and client combination. Please select a different sales confirmation to create a new contract.',\n            color: 'danger',\n          })\n        }\n        // Check if it's a foreign key constraint error\n        else if (errorMessage.includes('FOREIGN KEY')) {\n          this.init({\n            message:\n              'The selected sales confirmation is no longer available. Please refresh and select a different one.',\n            color: 'danger',\n          })\n          // Reload proposals\n          this.getSalesProposalOptions()\n        }\n        // Handle validation errors\n        else if (error.response && error.response.data) {\n          const errors = handleErrors(error.response)\n          if (errors.length > 0) {\n            this.init({\n              message: errors.map((err, index) => `${index + 1}. ${err}`).join('\\n'),\n              color: 'danger',\n            })\n          } else {\n            this.init({\n              message: errorMessage || 'Failed to create contract. Please check the form data and try again.',\n              color: 'danger',\n            })\n          }\n        }\n        // Handle network or other errors\n        else {\n          this.init({\n            message: errorMessage || 'An unexpected error occurred while creating the contract. Please try again.',\n            color: 'danger',\n          })\n        }\n      }\n    },\n\n    // getCompanions(proposalId: any) {\n    //   // TODO: Implement this method\n    //   //\n    // },\n\n    async getSalesProposalOptions() {\n      this.loadingSales = true\n      try {\n        const response: any = await this.getSalesConfirmationProposals()\n        if (response && response.status === 200) {\n          this.loadingSales = false\n          const data = Array.isArray(response.data) ? response.data : response.data?.data || []\n          console.log('Raw proposal data:', data)\n          // Only allow proposals whose status is COMPLETED\n          const completedProposals = data.filter((item: any) => {\n            const status = item?.status?.status || item?.status || ''\n            return String(status).toLowerCase() === 'completed'\n          })\n\n          this.proposalOptions = completedProposals\n            .filter((item: any) => item && item.id)\n            .map((item: any) => {\n              console.log('Processing item:', item)\n              // The API returns client info in item.client.full_name\n              let clientName = ''\n\n              if (item.client?.full_name) {\n                clientName = item.client.full_name\n              } else if (item.sales_inquiry?.entity?.full_name) {\n                clientName = item.sales_inquiry.entity.full_name\n              } else if (item.entity?.full_name) {\n                clientName = item.entity.full_name\n              } else if (typeof item.client_name === 'string') {\n                clientName = item.client_name\n              } else {\n                clientName = 'Proposal'\n              }\n\n              const proposalId = item.id\n              // Only show client name in the select to keep it simple (remove '#ID -')\n              const optionText = clientName || `Proposal ${proposalId}`\n              console.log('Option text:', optionText)\n\n              return {\n                text: optionText,\n                value: item.id,\n                selfitem: item,\n              }\n            })\n          console.log('Final proposalOptions:', this.proposalOptions)\n        } else {\n          this.loadingSales = false\n        }\n      } catch (error) {\n        console.error('Error loading sales proposals:', error)\n        this.loadingSales = false\n      }\n    },\n\n    buildDetailedDescription(item: any, clientName = '') {\n      if (!item) return clientName || ''\n\n      // Prefer fields actually present on the proposal object\n      const huntingTrip = item.hunting_trip || {}\n      const pricing = item.pricing || {}\n      const huntCombination = Array.isArray(item.hunt_combination) ? item.hunt_combination : []\n      const tripDetails = item.trip_details || {}\n      const companionObserver = item.companion_observer || {}\n\n      const title = huntCombination[0]?.title || huntCombination[0]?.name || huntingTrip?.type || ''\n      const area = huntingTrip?.hunting_area || (huntingTrip?.hunting_areas && huntingTrip.hunting_areas[0]) || ''\n      const safariModel = huntingTrip?.type || ''\n      const cost = pricing?.total_amount ? `${pricing.currency || ''} ${pricing.total_amount}`.trim() : ''\n      const dates = huntingTrip?.dates || item.confirmation_date_formatted || ''\n      const speciesList = huntCombination.map((hc: any) => hc.species || hc.name || hc.title).filter(Boolean)\n      const numberToHunt = tripDetails?.no_of_hunters || tripDetails?.no_of_hunters || ''\n      const companionCount = companionObserver?.no_of_companions || tripDetails?.no_of_companions || ''\n      const observerCount = companionObserver?.no_of_observers || tripDetails?.no_of_observers || ''\n\n      // Try to pick companion/observer costs from pricing breakdown if present\n      const companionCost = item.companion_hunter_cost || pricing?.companion_hunter_cost || ''\n      const observerFee = item.observer_fee || pricing?.observer_fee || ''\n\n      // Extras and trophy fees may be on huntingTrip or pricing\n      const extras = huntingTrip?.extras || item.extras || pricing?.extras || []\n      const trophyFees = item.trophy_fees || pricing?.trophy_fees || []\n\n      const lines: string[] = []\n      if (title) lines.push(`${title}`)\n      if (area) lines.push(`Area: ${area}`)\n      if (safariModel) lines.push(`Safari Model: ${safariModel}`)\n      if (cost) lines.push(`Cost: ${cost}`)\n      if (dates) lines.push(`Dates: ${dates}`)\n      if (speciesList.length) lines.push(`Species: ${speciesList.join(', ')}`)\n      if (numberToHunt) lines.push(`Number SP to be hunted: ${numberToHunt}`)\n      if (companionCount) lines.push(`Companion(s): ${companionCount}`)\n      if (companionCost) lines.push(`Companion Hunter Cost: ${companionCost}`)\n      if (observerCount) lines.push(`Observers: ${observerCount}`)\n      if (observerFee) lines.push(`Observer Fee: ${observerFee}`)\n\n      if (Array.isArray(extras) && extras.length > 0) {\n        lines.push('Safari Extras:')\n        extras.forEach((ex: any) => {\n          const label = ex.label || ex.name || ex.type || JSON.stringify(ex)\n          const amount = ex.amount || ex.price || ex.fee || ''\n          lines.push(`  - ${label}${amount ? `: ${amount}` : ''}`)\n        })\n      }\n\n      if (Array.isArray(trophyFees) && trophyFees.length > 0) {\n        lines.push('Trophy Fees:')\n        trophyFees.forEach((tf: any) => {\n          const tlabel = tf.label || tf.name || tf.trophy || ''\n          const tamount = tf.amount || tf.price || tf.fee || ''\n          lines.push(`  - ${tlabel}${tamount ? `: ${tamount}` : ''}`)\n        })\n      }\n\n      if (lines.length === 0 && clientName) return clientName\n      return lines.join('\\n')\n    },\n\n    getSpeciesList() {\n      if (!this.salesItem || !this.salesItem.hunt_combination) return []\n      return this.salesItem.hunt_combination\n        .map((h: any) => h.species_name || h.species || h.name || h.title)\n        .filter(Boolean)\n    },\n\n    getStatusClass(item: any) {\n      const status = item?.status?.status || item?.status || ''\n      const statusLower = String(status).toLowerCase()\n      if (statusLower === 'completed') return 'status-completed'\n      if (statusLower === 'confirmed') return 'status-confirmed'\n      if (statusLower === 'pending') return 'status-pending'\n      return 'status-default'\n    },\n\n    getStatusText(item: any) {\n      const status = item?.status?.status || item?.status || ''\n      return String(status).charAt(0).toUpperCase() + String(status).slice(1).toLowerCase()\n    },\n\n    formatDate(dateString: string) {\n      if (!dateString) return '-'\n      try {\n        const date = new Date(dateString)\n        return date.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' })\n      } catch {\n        return dateString\n      }\n    },\n\n    formatNumber(num: number) {\n      if (!num && num !== 0) return '-'\n      return new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(num)\n    },\n\n    formatFileSize(bytes: number) {\n      if (!bytes) return '0 Bytes'\n      const k = 1024\n      const sizes = ['Bytes', 'KB', 'MB', 'GB']\n      const i = Math.floor(Math.log(bytes) / Math.log(k))\n      return Math.round((bytes / Math.pow(k, i)) * 100) / 100 + ' ' + sizes[i]\n    },\n\n    addDocument() {\n      if (!this.form.doc_type) {\n        this.init({ message: 'Please select a document type', color: 'warning' })\n        return\n      }\n\n      if (!this.form.documents || this.form.documents.length === 0) {\n        this.init({ message: 'Please upload a file', color: 'warning' })\n        return\n      }\n\n      const docType = this.form.doc_type.text || this.form.doc_type\n      this.form.uploadedDocuments.push({\n        type: docType,\n        file: this.form.documents[0],\n      })\n      // Reset the upload fields\n      this.form.doc_type = null\n      this.form.documents = []\n      this.init({ message: 'Document added successfully', color: 'success' })\n    },\n\n    removeDocument(index: number) {\n      this.form.uploadedDocuments.splice(index, 1)\n      this.init({ message: 'Document removed', color: 'info' })\n    },\n\n    async uploadDocumentsForContract(contractId: number) {\n      try {\n        const baseUrl = import.meta.env.VITE_APP_BASE_URL\n        const endpoint = `sales-confirmation/contracts/${contractId}/documents`\n\n        // Prepare FormData with documents\n        const formData = new FormData()\n\n        this.form.uploadedDocuments.forEach((item: any, index: number) => {\n          formData.append('documents[]', item.file)\n          formData.append(`doc_types[${index}]`, item.type)\n        })\n\n        console.log('Uploading documents for contract:', contractId)\n\n        const response = await fetch(`${baseUrl}${endpoint}`, {\n          method: 'POST',\n          body: formData,\n        })\n\n        const responseData = await response.json().catch(() => ({}))\n\n        if (response.ok || response.status === 201) {\n          console.log('Documents uploaded successfully:', responseData)\n          this.init({\n            message: `‚úì ${this.form.uploadedDocuments.length} document(s) uploaded successfully!`,\n            color: 'success',\n          })\n        } else {\n          console.error('Document upload failed:', responseData)\n          this.init({\n            message: `Warning: Contract created but document upload failed. Please upload documents manually.`,\n            color: 'warning',\n          })\n        }\n      } catch (error: any) {\n        console.error('Document upload error:', error)\n        this.init({\n          message: `Warning: Contract created but document upload encountered an error. Please upload documents manually.`,\n          color: 'warning',\n        })\n      }\n    },\n\n    handleReset() {\n      this.resetForm()\n      this.resetValidationForm()\n    },\n  },\n})\n</script>\n\n<style lang=\"scss\" scoped>\n.sales-inquiry {\n  margin: 20px;\n}\n\n.split-demo {\n  & .custom-grabber {\n    height: 100%;\n    width: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background-color: var(--va-background-element);\n  }\n}\n\n/* Contract form visual improvements */\n.contract-form-card {\n  border-radius: 16px;\n  box-shadow: 0 8px 24px rgba(15, 23, 42, 0.08);\n  overflow: hidden;\n  border: 1px solid rgba(0, 0, 0, 0.06);\n}\n\n.form-header {\n  background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);\n  border-bottom: 1px solid rgba(0, 0, 0, 0.06);\n\n  .header-icon {\n    background: linear-gradient(135deg, #4f46e5, #06b6d4);\n    box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);\n  }\n\n  .header-text .text-muted {\n    color: #64748b;\n    line-height: 1.6;\n  }\n}\n\n/* Proposal Details Card */\n.proposal-details-card {\n  background: #ffffff;\n  border: 1px solid #e2e8f0;\n  border-radius: 12px;\n  padding: 24px;\n  margin-top: 16px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);\n}\n\n.details-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24px;\n  padding-bottom: 16px;\n  border-bottom: 2px solid #f1f5f9;\n}\n\n.details-title {\n  font-size: 20px;\n  font-weight: 600;\n  color: #1e293b;\n  margin: 0;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.status-badge {\n  padding: 6px 14px;\n  border-radius: 20px;\n  font-size: 12px;\n  font-weight: 600;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n\n  &.status-completed {\n    background: #d1fae5;\n    color: #065f46;\n  }\n\n  &.status-confirmed {\n    background: #dbeafe;\n    color: #1e40af;\n  }\n\n  &.status-pending {\n    background: #fef3c7;\n    color: #92400e;\n  }\n\n  &.status-default {\n    background: #f1f5f9;\n    color: #475569;\n  }\n}\n\n.details-content {\n  display: flex;\n  flex-direction: column;\n  gap: 24px;\n}\n\n.info-section {\n  background: #f8fafc;\n  border-radius: 10px;\n  padding: 20px;\n  border: 1px solid #e2e8f0;\n}\n\n.section-title {\n  font-size: 16px;\n  font-weight: 600;\n  color: #334155;\n  margin: 0 0 16px 0;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.section-icon {\n  color: #4f46e5;\n  flex-shrink: 0;\n}\n\n.info-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n  gap: 16px;\n}\n\n.info-item {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n\n  &.pricing-highlight {\n    grid-column: 1 / -1;\n    background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);\n    padding: 16px;\n    border-radius: 8px;\n    border: 1px solid #bae6fd;\n  }\n}\n\n.info-label {\n  font-size: 13px;\n  font-weight: 500;\n  color: #64748b;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n\n.info-value {\n  font-size: 15px;\n  font-weight: 500;\n  color: #1e293b;\n\n  &.price-value {\n    font-size: 20px;\n    font-weight: 700;\n    color: #059669;\n  }\n}\n\n.species-tags {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 8px;\n  margin-top: 4px;\n}\n\n.species-tag {\n  background: linear-gradient(135deg, #ede9fe 0%, #ddd6fe 100%);\n  color: #5b21b6;\n  padding: 6px 12px;\n  border-radius: 6px;\n  font-size: 13px;\n  font-weight: 500;\n  border: 1px solid #c4b5fd;\n}\n\n/* Description Section */\n.description-section {\n  margin-top: 32px;\n  padding-top: 24px;\n  border-top: 2px solid #f1f5f9;\n}\n\n.description-input-area {\n  background: #f8fafc;\n  border: 1px solid #e2e8f0;\n  border-radius: 12px;\n  padding: 20px;\n  transition: all 0.3s ease;\n\n  &:hover {\n    border-color: #cbd5e1;\n    background: #ffffff;\n  }\n}\n\n.description-textarea {\n  width: 100%;\n\n  :deep(.va-textarea__textarea) {\n    font-size: 14px;\n    line-height: 1.6;\n    color: #1e293b;\n  }\n}\n\n/* Document Section */\n.document-section {\n  margin-top: 32px;\n  padding-top: 24px;\n  border-top: 2px solid #f1f5f9;\n}\n\n.section-header {\n  margin-bottom: 20px;\n}\n\n.section-title-large {\n  font-size: 18px;\n  font-weight: 600;\n  color: #1e293b;\n  margin: 0 0 8px 0;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n}\n\n.section-icon-large {\n  color: #4f46e5;\n}\n\n.required-badge {\n  background: #fee2e2;\n  color: #991b1b;\n  padding: 4px 10px;\n  border-radius: 12px;\n  font-size: 11px;\n  font-weight: 600;\n  margin-left: auto;\n}\n\n.section-description {\n  color: #64748b;\n  font-size: 14px;\n  margin: 0;\n  line-height: 1.6;\n}\n\n.document-upload-area {\n  background: #f8fafc;\n  border: 2px dashed #cbd5e1;\n  border-radius: 12px;\n  padding: 24px;\n  margin-bottom: 20px;\n  transition: all 0.3s ease;\n\n  &:hover {\n    border-color: #94a3b8;\n    background: #f1f5f9;\n  }\n}\n\n.add-doc-button {\n  margin-top: 8px;\n}\n\n.documents-list {\n  margin-top: 24px;\n}\n\n.documents-list-title {\n  font-size: 16px;\n  font-weight: 600;\n  color: #1e293b;\n  margin: 0 0 16px 0;\n}\n\n.documents-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));\n  gap: 12px;\n}\n\n.document-item {\n  background: #ffffff;\n  border: 1px solid #e2e8f0;\n  border-radius: 10px;\n  padding: 16px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  transition: all 0.2s ease;\n\n  &:hover {\n    border-color: #cbd5e1;\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\n  }\n}\n\n.document-item-content {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  flex: 1;\n  min-width: 0;\n}\n\n.document-icon {\n  color: #6366f1;\n  flex-shrink: 0;\n}\n\n.document-info {\n  flex: 1;\n  min-width: 0;\n}\n\n.document-type {\n  font-size: 14px;\n  font-weight: 600;\n  color: #1e293b;\n  margin-bottom: 4px;\n}\n\n.document-name {\n  font-size: 13px;\n  color: #475569;\n  margin-bottom: 2px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.document-size {\n  font-size: 12px;\n  color: #94a3b8;\n}\n\n.remove-doc-button {\n  flex-shrink: 0;\n  margin-left: 12px;\n}\n\n.documents-warning {\n  background: #fef3c7;\n  border: 1px solid #fcd34d;\n  border-radius: 10px;\n  padding: 16px;\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  color: #92400e;\n  font-size: 14px;\n  font-weight: 500;\n\n  svg {\n    flex-shrink: 0;\n    color: #f59e0b;\n  }\n}\n\n/* Form Actions */\n.form-actions {\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n  gap: 12px;\n  margin-top: 32px;\n  padding-top: 24px;\n  border-top: 2px solid #f1f5f9;\n}\n\n.action-button {\n  min-width: 120px;\n\n  &.primary-action {\n    background: linear-gradient(135deg, #4f46e5, #06b6d4);\n    border: none;\n    box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);\n    transition: all 0.3s ease;\n\n    &:hover:not(:disabled) {\n      transform: translateY(-2px);\n      box-shadow: 0 6px 16px rgba(79, 70, 229, 0.4);\n    }\n\n    &:disabled {\n      opacity: 0.6;\n      cursor: not-allowed;\n    }\n  }\n}\n\n/* Responsive adjustments */\n@media (max-width: 768px) {\n  .info-grid {\n    grid-template-columns: 1fr;\n  }\n\n  .documents-grid {\n    grid-template-columns: 1fr;\n  }\n\n  .form-actions {\n    flex-direction: column-reverse;\n\n    .action-button {\n      width: 100%;\n    }\n  }\n\n  .details-header {\n    flex-direction: column;\n    align-items: flex-start;\n    gap: 12px;\n  }\n}\n</style>\n","<template>\n  <VaInnerLoading :loading=\"loadingSales\">\n    <VaCard square outlined class=\"contract-form-card\">\n      <div class=\"form-header flex items-start gap-4 p-4\">\n        <div\n          class=\"header-icon bg-primary-500 text-white rounded-full w-12 h-12 flex items-center justify-center shadow-md\"\n        >\n          <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n            <path d=\"M12 2L15 8H21L16.5 12L18.5 18L12 14L5.5 18L7.5 12L3 8H9L12 2Z\" fill=\"currentColor\" />\n          </svg>\n        </div>\n        <div class=\"header-text\">\n          <div class=\"text-2xl font-semibold\">Create Contract</div>\n          <div class=\"text-sm text-muted\">\n            Create a contract for a completed sales confirmation. Upload required documents below.\n          </div>\n        </div>\n      </div>\n      <VaCardContent class=\"p-6\">\n        <VaForm ref=\"iformRef\" class=\"space-y-6\">\n          <!-- Sales Confirmation Selection -->\n          <div class=\"mb-6\">\n            <VaSelect\n              v-model=\"form.proposal\"\n              :options=\"proposalOptions\"\n              :rules=\"[(value: any) => value || 'Sales confirmation is required']\"\n              placeholder=\"Select sales confirmation\"\n              label=\"Sales Confirmation\"\n              class=\"mb-4\"\n              @update:modelValue=\"onValueChange\"\n            />\n\n            <!-- Enhanced Proposal Details Card -->\n            <div v-if=\"salesItem\" class=\"proposal-details-card mt-4\">\n              <div class=\"details-header\">\n                <h3 class=\"details-title\">Sales Confirmation Details</h3>\n                <div class=\"status-badge\" :class=\"getStatusClass(salesItem)\">\n                  {{ getStatusText(salesItem) }}\n                </div>\n              </div>\n\n              <div class=\"details-content\">\n                <!-- Client Information Section -->\n                <div class=\"info-section\">\n                  <h4 class=\"section-title\">\n                    <svg\n                      class=\"section-icon\"\n                      width=\"18\"\n                      height=\"18\"\n                      viewBox=\"0 0 24 24\"\n                      fill=\"none\"\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                    >\n                      <path\n                        d=\"M12 12C14.21 12 16 10.21 16 8C16 5.79 14.21 4 12 4C9.79 4 8 5.79 8 8C8 10.21 9.79 12 12 12ZM12 14C9.33 14 4 15.34 4 18V20H20V18C20 15.34 14.67 14 12 14Z\"\n                        fill=\"currentColor\"\n                      />\n                    </svg>\n                    Client Information\n                  </h4>\n                  <div class=\"info-grid\">\n                    <div class=\"info-item\">\n                      <span class=\"info-label\">Full Name:</span>\n                      <span class=\"info-value\">{{ salesItem.client?.full_name || '-' }}</span>\n                    </div>\n                    <div v-if=\"salesItem.client?.email\" class=\"info-item\">\n                      <span class=\"info-label\">Email:</span>\n                      <span class=\"info-value\">{{ salesItem.client.email }}</span>\n                    </div>\n                    <div v-if=\"salesItem.client?.country\" class=\"info-item\">\n                      <span class=\"info-label\">Country:</span>\n                      <span class=\"info-value\">{{ salesItem.client.country }}</span>\n                    </div>\n                    <div v-if=\"salesItem.client?.nationality\" class=\"info-item\">\n                      <span class=\"info-label\">Nationality:</span>\n                      <span class=\"info-value\">{{ salesItem.client.nationality }}</span>\n                    </div>\n                    <div v-if=\"salesItem.client?.cell\" class=\"info-item\">\n                      <span class=\"info-label\">Phone:</span>\n                      <span class=\"info-value\">{{ salesItem.client.cell }}</span>\n                    </div>\n                  </div>\n                </div>\n\n                <!-- Hunting Trip Information Section -->\n                <div class=\"info-section\">\n                  <h4 class=\"section-title\">\n                    <svg\n                      class=\"section-icon\"\n                      width=\"18\"\n                      height=\"18\"\n                      viewBox=\"0 0 24 24\"\n                      fill=\"none\"\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                    >\n                      <path\n                        d=\"M12 2C8.13 2 5 5.13 5 9C5 14.25 12 22 12 22C12 22 19 14.25 19 9C19 5.13 15.87 2 12 2ZM12 11.5C10.62 11.5 9.5 10.38 9.5 9C9.5 7.62 10.62 6.5 12 6.5C13.38 6.5 14.5 7.62 14.5 9C14.5 10.38 13.38 11.5 12 11.5Z\"\n                        fill=\"currentColor\"\n                      />\n                    </svg>\n                    Hunting Trip Details\n                  </h4>\n                  <div class=\"info-grid\">\n                    <div class=\"info-item\">\n                      <span class=\"info-label\">Hunting Area:</span>\n                      <span class=\"info-value\">{{ salesItem.hunting_trip?.hunting_area || '-' }}</span>\n                    </div>\n                    <div v-if=\"salesItem.hunting_trip?.type\" class=\"info-item\">\n                      <span class=\"info-label\">Safari Type:</span>\n                      <span class=\"info-value\">{{ salesItem.hunting_trip.type }}</span>\n                    </div>\n                    <div v-if=\"salesItem.hunting_trip?.outfitter\" class=\"info-item\">\n                      <span class=\"info-label\">Outfitter:</span>\n                      <span class=\"info-value\">{{ salesItem.hunting_trip.outfitter }}</span>\n                    </div>\n                    <div class=\"info-item\">\n                      <span class=\"info-label\">Dates:</span>\n                      <span class=\"info-value\">{{\n                        salesItem.hunting_trip?.dates || salesItem.confirmation_date_formatted || '-'\n                      }}</span>\n                    </div>\n                    <div\n                      v-if=\"salesItem.hunting_trip?.start_date && salesItem.hunting_trip?.end_date\"\n                      class=\"info-item\"\n                    >\n                      <span class=\"info-label\">Start Date:</span>\n                      <span class=\"info-value\">{{ formatDate(salesItem.hunting_trip.start_date) }}</span>\n                    </div>\n                    <div v-if=\"salesItem.hunting_trip?.end_date\" class=\"info-item\">\n                      <span class=\"info-label\">End Date:</span>\n                      <span class=\"info-value\">{{ formatDate(salesItem.hunting_trip.end_date) }}</span>\n                    </div>\n                    <div v-if=\"salesItem.hunting_trip?.no_of_days\" class=\"info-item\">\n                      <span class=\"info-label\">Duration:</span>\n                      <span class=\"info-value\">{{ salesItem.hunting_trip.no_of_days }} days</span>\n                    </div>\n                  </div>\n                </div>\n\n                <!-- Species & Participants Section -->\n                <div class=\"info-section\">\n                  <h4 class=\"section-title\">\n                    <svg\n                      class=\"section-icon\"\n                      width=\"18\"\n                      height=\"18\"\n                      viewBox=\"0 0 24 24\"\n                      fill=\"none\"\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                    >\n                      <path d=\"M12 2L2 7L12 12L22 7L12 2Z\" fill=\"currentColor\" />\n                      <path d=\"M2 17L12 22L22 17V12L12 17L2 12V17Z\" fill=\"currentColor\" />\n                    </svg>\n                    Species & Participants\n                  </h4>\n                  <div class=\"info-grid\">\n                    <div v-if=\"getSpeciesList().length > 0\" class=\"info-item\">\n                      <span class=\"info-label\">Species:</span>\n                      <div class=\"species-tags\">\n                        <span v-for=\"(species, idx) in getSpeciesList()\" :key=\"idx\" class=\"species-tag\">\n                          {{ species }}\n                        </span>\n                      </div>\n                    </div>\n                    <div class=\"info-item\">\n                      <span class=\"info-label\">Hunters:</span>\n                      <span class=\"info-value\">{{ salesItem.trip_details?.no_of_hunters || '-' }}</span>\n                    </div>\n                    <div\n                      v-if=\"salesItem.companion_observer?.no_of_companions || salesItem.trip_details?.no_of_companions\"\n                      class=\"info-item\"\n                    >\n                      <span class=\"info-label\">Companions:</span>\n                      <span class=\"info-value\">{{\n                        salesItem.companion_observer?.no_of_companions ||\n                        salesItem.trip_details?.no_of_companions ||\n                        '-'\n                      }}</span>\n                    </div>\n                    <div\n                      v-if=\"salesItem.companion_observer?.no_of_observers || salesItem.trip_details?.no_of_observers\"\n                      class=\"info-item\"\n                    >\n                      <span class=\"info-label\">Observers:</span>\n                      <span class=\"info-value\">{{\n                        salesItem.companion_observer?.no_of_observers || salesItem.trip_details?.no_of_observers || '-'\n                      }}</span>\n                    </div>\n                  </div>\n                </div>\n\n                <!-- Pricing Information Section -->\n                <div v-if=\"salesItem.pricing\" class=\"info-section\">\n                  <h4 class=\"section-title\">\n                    <svg\n                      class=\"section-icon\"\n                      width=\"18\"\n                      height=\"18\"\n                      viewBox=\"0 0 24 24\"\n                      fill=\"none\"\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                    >\n                      <path\n                        d=\"M11.8 10.9C9.53 10.31 8.8 9.7 8.8 8.75C8.8 7.66 9.81 6.9 11.5 6.9C13.28 6.9 13.94 7.75 14 9H16.21C16.14 7.28 15.09 5.7 13 5.19V3H10V5.16C8.06 5.58 6.5 6.84 6.5 8.77C6.5 10.65 8.2 11.96 11 12.58C13.5 13.11 14.2 13.85 14.2 14.9C14.2 15.91 13.36 16.75 11.5 16.75C9.45 16.75 8.7 15.81 8.6 14.5H6.39C6.5 16.47 7.88 17.9 10 18.29V21H13V18.33C14.95 17.9 16.5 16.66 16.5 14.7C16.5 12.36 14.47 11.1 11.8 10.9Z\"\n                        fill=\"currentColor\"\n                      />\n                    </svg>\n                    Pricing Information\n                  </h4>\n                  <div class=\"info-grid\">\n                    <div class=\"info-item pricing-highlight\">\n                      <span class=\"info-label\">Total Amount:</span>\n                      <span class=\"info-value price-value\">\n                        {{ salesItem.pricing.currency || '' }} {{ formatNumber(salesItem.pricing.total_amount) }}\n                      </span>\n                    </div>\n                    <div\n                      v-if=\"salesItem.pricing.installments && salesItem.pricing.installments.length > 0\"\n                      class=\"info-item\"\n                    >\n                      <span class=\"info-label\">Installments:</span>\n                      <span class=\"info-value\">{{ salesItem.pricing.installments.length }} payment(s)</span>\n                    </div>\n                  </div>\n                </div>\n\n                <!-- Additional Information -->\n                <div\n                  v-if=\"salesItem.sales_inquiry || salesItem.confirmation_date_formatted || salesItem.hunting_license\"\n                  class=\"info-section\"\n                >\n                  <h4 class=\"section-title\">\n                    <svg\n                      class=\"section-icon\"\n                      width=\"18\"\n                      height=\"18\"\n                      viewBox=\"0 0 24 24\"\n                      fill=\"none\"\n                      xmlns=\"http://www.w3.org/2000/svg\"\n                    >\n                      <path\n                        d=\"M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19ZM7 10H9V17H7V10ZM11 7H13V17H11V7ZM15 13H17V17H15V13Z\"\n                        fill=\"currentColor\"\n                      />\n                    </svg>\n                    Additional Information\n                  </h4>\n                  <div class=\"info-grid\">\n                    <div v-if=\"salesItem.sales_inquiry?.code\" class=\"info-item\">\n                      <span class=\"info-label\">Sales Inquiry Code:</span>\n                      <span class=\"info-value\">{{ salesItem.sales_inquiry.code }}</span>\n                    </div>\n                    <div v-if=\"salesItem.sales_inquiry?.season\" class=\"info-item\">\n                      <span class=\"info-label\">Season:</span>\n                      <span class=\"info-value\">{{ salesItem.sales_inquiry.season }}</span>\n                    </div>\n                    <div v-if=\"salesItem.confirmation_date_formatted\" class=\"info-item\">\n                      <span class=\"info-label\">Confirmation Date:</span>\n                      <span class=\"info-value\">{{ salesItem.confirmation_date_formatted }}</span>\n                    </div>\n                    <div v-if=\"salesItem.hunting_license\" class=\"info-item\">\n                      <span class=\"info-label\">Hunting License:</span>\n                      <span class=\"info-value\">{{ salesItem.hunting_license }}</span>\n                    </div>\n                    <div v-if=\"salesItem.remarks\" class=\"info-item\">\n                      <span class=\"info-label\">Remarks:</span>\n                      <span class=\"info-value\">{{ salesItem.remarks }}</span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          <!-- Contract Description Section -->\n          <div class=\"description-section\">\n            <div class=\"section-header\">\n              <h3 class=\"section-title-large\">\n                <svg\n                  class=\"section-icon-large\"\n                  width=\"20\"\n                  height=\"20\"\n                  viewBox=\"0 0 24 24\"\n                  fill=\"none\"\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                >\n                  <path\n                    d=\"M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.89 22 5.99 22H18C19.1 22 20 21.1 20 20V8L14 2ZM18 20H6V4H13V9H18V20Z\"\n                    fill=\"currentColor\"\n                  />\n                </svg>\n                Contract Description\n              </h3>\n              <p class=\"section-description\">\n                Provide a detailed description for this contract. This will be pre-filled with sales confirmation\n                details, but you can edit it as needed.\n              </p>\n            </div>\n\n            <div class=\"description-input-area\">\n              <VaTextarea\n                v-model=\"form.description\"\n                label=\"Description\"\n                placeholder=\"Enter contract description...\"\n                :min-rows=\"6\"\n                :max-rows=\"12\"\n                counter\n                autosize\n                required-mark\n                :rules=\"[(v: any) => (v && v.length > 0) || 'Description is required']\"\n                class=\"description-textarea\"\n              />\n            </div>\n          </div>\n\n          <!-- Document Upload Section - COMMENTED OUT FOR NOW -->\n          <!--\n            <div class=\"document-section\">\n              <div class=\"section-header\">\n                <h3 class=\"section-title-large\">\n                  <svg class=\"section-icon-large\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                    <path d=\"M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.89 22 5.99 22H18C19.1 22 20 21.1 20 20V8L14 2ZM18 20H6V4H13V9H18V20Z\" fill=\"currentColor\"/>\n                  </svg>\n                  Supporting Documents\n                  <span class=\"required-badge\">Required</span>\n              </h3>\n                <p class=\"section-description\">Upload required documents for contract creation. At least one document must be provided.</p>\n              </div>\n              \n              <div class=\"document-upload-area\">\n              <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4\">\n                <VaSelect\n                  v-model=\"form.doc_type\"\n                  :options=\"documentTypes\"\n                  placeholder=\"Select document type\"\n                  label=\"Document Type\"\n                  searchable\n                  highlight-matched-text\n                  :rules=\"[]\"\n                />\n                <VaFileUpload\n                  v-model=\"form.documents\"\n                    upload-button-text=\"Choose File\"\n                  color=\"secondary\"\n                  label=\"Upload Document\"\n                  dropzone\n                  undo\n                  size=\"50mb\"\n                  file-types=\"image/jpeg, image/png, image/pdf, application/pdf, application/msword, application/vnd.openxmlformats-officedocument.wordprocessingml.document, application/vnd.ms-excel, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"\n                  undo-duration=\"500\"\n                  :max-files=\"1\"\n                />\n              </div>\n              <VaButton\n                icon=\"add\"\n                  size=\"medium\"\n                color=\"secondary\"\n                :disabled=\"!form.doc_type || form.documents.length === 0\"\n                @click=\"addDocument\"\n                  class=\"add-doc-button\"\n              >\n                Add Document\n              </VaButton>\n              </div>\n\n              <div v-if=\"form.uploadedDocuments.length > 0\" class=\"documents-list\">\n                <h4 class=\"documents-list-title\">Added Documents ({{ form.uploadedDocuments.length }})</h4>\n                <div class=\"documents-grid\">\n                  <div\n                    v-for=\"(doc, index) in form.uploadedDocuments\"\n                    :key=\"index\"\n                    class=\"document-item\"\n                  >\n                    <div class=\"document-item-content\">\n                      <svg class=\"document-icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                        <path d=\"M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.89 22 5.99 22H18C19.1 22 20 21.1 20 20V8L14 2ZM18 20H6V4H13V9H18V20Z\" fill=\"currentColor\"/>\n                      </svg>\n                      <div class=\"document-info\">\n                        <div class=\"document-type\">{{ doc.type }}</div>\n                        <div class=\"document-name\">{{ doc.file.name }}</div>\n                        <div class=\"document-size\">{{ formatFileSize(doc.file.size) }}</div>\n                  </div>\n                </div>\n                    <VaButton \n                      preset=\"plain\" \n                      icon=\"delete\" \n                      size=\"small\" \n                      color=\"danger\" \n                      @click=\"removeDocument(index)\"\n                      class=\"remove-doc-button\"\n                    />\n              </div>\n              </div>\n            </div>\n              <div v-else class=\"documents-warning\">\n                <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                  <path d=\"M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM13 17H11V15H13V17ZM13 13H11V7H13V13Z\" fill=\"currentColor\"/>\n                </svg>\n                <span>At least one document is required to create the contract</span>\n              </div>\n            </div>\n            -->\n\n          <div class=\"form-actions\">\n            <VaButton preset=\"outline\" color=\"danger\" size=\"medium\" class=\"action-button\" @click=\"handleReset\">\n              Cancel\n            </VaButton>\n            <VaButton\n              color=\"primary\"\n              size=\"large\"\n              :disabled=\"!isValidForm\"\n              class=\"action-button primary-action\"\n              @click=\"validateForm() && onSubmit()\"\n            >\n              <svg\n                width=\"18\"\n                height=\"18\"\n                viewBox=\"0 0 24 24\"\n                fill=\"none\"\n                xmlns=\"http://www.w3.org/2000/svg\"\n                style=\"margin-right: 8px\"\n              >\n                <path d=\"M9 16.17L4.83 12L3.41 13.41L9 19L21 7L19.59 5.59L9 16.17Z\" fill=\"currentColor\" />\n              </svg>\n              Create Contract\n            </VaButton>\n          </div>\n        </VaForm>\n      </VaCardContent>\n    </VaCard>\n  </VaInnerLoading>\n</template>\n\n<script lang=\"ts\">\nimport { useForm, useToast } from 'vuestic-ui'\nimport { defineComponent, ref, reactive } from 'vue'\nimport { useSalesInquiriesStore } from '../../../../stores/sales-store'\nimport { mapActions, mapState } from 'pinia'\nimport { useContractsStore } from '../../../../stores/contracts-store'\nimport handleErrors from '../../../../utils/errorHandler'\n\nexport default defineComponent({\n  setup() {\n    const { init } = useToast()\n\n    const iformRef = ref(null as any)\n    const {\n      isValid: isValidForm,\n      validate: validateForm,\n      resetValidation: resetValidationForm,\n      reset: resetForm,\n    } = useForm(iformRef)\n\n    const isNotUpBookingSelected = ref(true)\n\n    const onInputChange = (event: any) => {\n      console.log(event)\n      if (event.value == 'prior' || event.value == 'after') {\n        isNotUpBookingSelected.value = false\n      }\n    }\n\n    const form = reactive({\n      proposal: null as any,\n      enity_id: null as any,\n      description: '',\n      doc_type: null as any,\n      documents: [] as any,\n      uploadedDocuments: [] as any,\n    })\n\n    return {\n      iformRef,\n      isValidForm,\n      validateForm,\n      resetValidationForm,\n      resetForm,\n      form,\n      init,\n      onInputChange,\n      isNotUpBookingSelected,\n    }\n  },\n\n  data() {\n    // Tabs removed - unified contract creation per sales confirmation\n    const packages = [] as any\n    const documentTypes = [\n      {\n        text: 'Travel Packet (Passport Copy)',\n        value: 'Passport_Copy',\n      },\n      {\n        text: 'Travel Packet (Passport Photo)',\n        value: 'Passport_Photo',\n      },\n      {\n        text: 'Visa',\n        value: 'Visa',\n      },\n      {\n        text: 'Gun Permits',\n        value: 'Gun_Permits',\n      },\n      {\n        text: 'CITES Documentation',\n        value: 'CITES_Documentation',\n      },\n      {\n        text: 'Sales Invoice',\n        value: 'sales_invoice',\n      },\n      {\n        text: 'Receipt',\n        value: 'receipt',\n      },\n    ]\n    return {\n      packages,\n      installments: [] as any,\n      regulatoryPackages: [] as any,\n      proposalOptions: [] as any,\n      documentTypes,\n      loadingSales: false,\n      salesItem: null as any,\n      // no tabs or value needed\n    }\n  },\n  computed: {\n    ...mapState(useSalesInquiriesStore, ['companions']),\n  },\n\n  mounted() {\n    this.getSalesProposalOptions()\n  },\n\n  methods: {\n    ...mapActions(useContractsStore, ['createContract']),\n    ...mapActions(useSalesInquiriesStore, ['getallSalesConfirmation', 'getSalesConfirmationProposals']),\n\n    ...mapActions(useSalesInquiriesStore, ['getCompanions']),\n    onValueChange(value: any) {\n      if (!value) return\n\n      // The VaSelect may return either the option object or just the value (id).\n      // Normalize to an option object so we can read the underlying proposal (`selfitem`).\n      let selectedOption: any = null\n      // If the select gives us the full option object\n      if (typeof value === 'object' && (value.selfitem || value.value)) {\n        selectedOption = value\n      } else if (typeof value === 'number' || typeof value === 'string') {\n        // Find the matching option by value\n        selectedOption = this.proposalOptions.find((opt: any) => String(opt.value) === String(value)) || null\n      }\n\n      const selectedItem = selectedOption?.selfitem || selectedOption || null\n      console.log('Selected proposal full object:', selectedItem)\n      console.log('Entity ID locations - sales_inquiry.entity.id:', selectedItem?.sales_inquiry?.entity?.id)\n      console.log('Entity ID locations - entity.id:', selectedItem?.entity?.id)\n      console.log('Entity ID locations - client.id:', selectedItem?.client?.id)\n\n      // Normalize the form's proposal value to the option object for easier later use\n      if (selectedOption) {\n        this.form.proposal = selectedOption\n      }\n\n      this.salesItem = selectedItem\n\n      // Populate form with useful sales confirmation info for creating a contract\n      const clientName =\n        selectedItem?.client?.full_name ||\n        selectedItem?.sales_inquiry?.entity?.full_name ||\n        selectedItem?.entity?.full_name ||\n        selectedItem?.client_name ||\n        ''\n\n      if (clientName) {\n        this.form.description = this.buildDetailedDescription(selectedItem, clientName)\n      }\n\n      // Derive and store entity id on the form for submit\n      this.form.enity_id =\n        selectedItem?.sales_inquiry?.entity?.id || selectedItem?.entity?.id || selectedItem?.client?.id || null\n      // No companion selection in the unified form. If needed, companions can still be fetched\n      // but the form always creates a single contract tied to the sales confirmation.\n    },\n    async onSubmit() {\n      // Extract the actual ID value from the selected proposal\n      // The proposal form field contains the entire option object with { text, value, selfitem }\n      let proposalValue = null\n      let selectedProposal = null\n\n      if (this.form.proposal) {\n        // If it's an option object with value property\n        if (typeof this.form.proposal === 'object' && this.form.proposal.value) {\n          proposalValue = this.form.proposal.value\n          selectedProposal = this.form.proposal.selfitem\n        }\n        // If it's already just the ID\n        else if (typeof this.form.proposal === 'number') {\n          proposalValue = this.form.proposal\n        }\n      }\n\n      // For unified contract creation, derive entity from the sales confirmation proposal\n      const entityValue =\n        selectedProposal?.sales_inquiry?.entity?.id ||\n        selectedProposal?.entity?.id ||\n        selectedProposal?.client?.id ||\n        null\n\n      // Validate required fields\n      if (!proposalValue) {\n        this.init({ message: 'Sales confirmation is required', color: 'warning' })\n        return\n      }\n\n      if (!selectedProposal || !selectedProposal.id) {\n        this.init({\n          message: 'Invalid sales confirmation selected. Please select again from the list.',\n          color: 'warning',\n        })\n        return\n      }\n\n      // Start/end dates are taken from the sales inquiry; no local validation required\n\n      if (!entityValue) {\n        this.init({\n          message: 'Entity information is missing. Please select a valid sales confirmation.',\n          color: 'warning',\n        })\n        return\n      }\n\n      // No local date comparison needed - backend derives dates from the sales inquiry\n\n      // Document validation commented out - document upload is disabled for now\n      // if (!this.form.uploadedDocuments || this.form.uploadedDocuments.length === 0) {\n      //   this.init({\n      //     message: 'At least one document is required. Please upload a supporting document.',\n      //     color: 'warning',\n      //   })\n      //   return\n      // }\n\n      // Ensure the selected proposal is actually completed (defensive check)\n      const selStatus = selectedProposal?.status?.status || selectedProposal?.status || ''\n      if (String(selStatus).toLowerCase() !== 'completed') {\n        this.init({ message: 'Contracts can only be created for completed sales confirmations.', color: 'warning' })\n        return\n      }\n\n      // Backend automatically gets start_date and end_date from sales inquiry preferences\n      // Only need to send: sales_confirmation_proposal_id, entity_id, and description\n      const data = {\n        sales_confirmation_proposal_id: proposalValue,\n        entity_id: entityValue,\n        description: this.form.description,\n      }\n\n      console.log('Form submission data:', data)\n      console.log('Selected proposal object:', selectedProposal)\n\n      try {\n        const response: any = await this.createContract(data)\n        if (response.status === 201) {\n          // Document upload commented out - disabled for now\n          // const createdContractId = response.data?.id || response.data?.data?.id\n          // if (createdContractId && this.form.uploadedDocuments.length > 0) {\n          //   await this.uploadDocumentsForContract(createdContractId)\n          // }\n\n          this.init({ message: 'Contract created successfully', color: 'success' })\n          // Reset form after successful submission\n          this.resetForm()\n          this.resetValidationForm()\n        }\n      } catch (error: any) {\n        console.error('Contract creation error:', error)\n        console.error('Error response:', error.response)\n        console.error('Error message:', error.message)\n\n        const errorData = error.response?.data\n        const errorMessage = errorData?.error || errorData?.message || error.message || ''\n\n        // Check if it's a duplicate entry constraint error\n        if (errorMessage.includes('Duplicate entry') || errorMessage.includes('constraint')) {\n          this.init({\n            message:\n              'A contract already exists for this sales confirmation and client combination. Please select a different sales confirmation to create a new contract.',\n            color: 'danger',\n          })\n        }\n        // Check if it's a foreign key constraint error\n        else if (errorMessage.includes('FOREIGN KEY')) {\n          this.init({\n            message:\n              'The selected sales confirmation is no longer available. Please refresh and select a different one.',\n            color: 'danger',\n          })\n          // Reload proposals\n          this.getSalesProposalOptions()\n        }\n        // Handle validation errors\n        else if (error.response && error.response.data) {\n          const errors = handleErrors(error.response)\n          if (errors.length > 0) {\n            this.init({\n              message: errors.map((err, index) => `${index + 1}. ${err}`).join('\\n'),\n              color: 'danger',\n            })\n          } else {\n            this.init({\n              message: errorMessage || 'Failed to create contract. Please check the form data and try again.',\n              color: 'danger',\n            })\n          }\n        }\n        // Handle network or other errors\n        else {\n          this.init({\n            message: errorMessage || 'An unexpected error occurred while creating the contract. Please try again.',\n            color: 'danger',\n          })\n        }\n      }\n    },\n\n    // getCompanions(proposalId: any) {\n    //   // TODO: Implement this method\n    //   //\n    // },\n\n    async getSalesProposalOptions() {\n      this.loadingSales = true\n      try {\n        const response: any = await this.getSalesConfirmationProposals()\n        if (response && response.status === 200) {\n          this.loadingSales = false\n          const data = Array.isArray(response.data) ? response.data : response.data?.data || []\n          console.log('Raw proposal data:', data)\n          // Only allow proposals whose status is COMPLETED\n          const completedProposals = data.filter((item: any) => {\n            const status = item?.status?.status || item?.status || ''\n            return String(status).toLowerCase() === 'completed'\n          })\n\n          this.proposalOptions = completedProposals\n            .filter((item: any) => item && item.id)\n            .map((item: any) => {\n              console.log('Processing item:', item)\n              // The API returns client info in item.client.full_name\n              let clientName = ''\n\n              if (item.client?.full_name) {\n                clientName = item.client.full_name\n              } else if (item.sales_inquiry?.entity?.full_name) {\n                clientName = item.sales_inquiry.entity.full_name\n              } else if (item.entity?.full_name) {\n                clientName = item.entity.full_name\n              } else if (typeof item.client_name === 'string') {\n                clientName = item.client_name\n              } else {\n                clientName = 'Proposal'\n              }\n\n              const proposalId = item.id\n              // Only show client name in the select to keep it simple (remove '#ID -')\n              const optionText = clientName || `Proposal ${proposalId}`\n              console.log('Option text:', optionText)\n\n              return {\n                text: optionText,\n                value: item.id,\n                selfitem: item,\n              }\n            })\n          console.log('Final proposalOptions:', this.proposalOptions)\n        } else {\n          this.loadingSales = false\n        }\n      } catch (error) {\n        console.error('Error loading sales proposals:', error)\n        this.loadingSales = false\n      }\n    },\n\n    buildDetailedDescription(item: any, clientName = '') {\n      if (!item) return clientName || ''\n\n      // Prefer fields actually present on the proposal object\n      const huntingTrip = item.hunting_trip || {}\n      const pricing = item.pricing || {}\n      const huntCombination = Array.isArray(item.hunt_combination) ? item.hunt_combination : []\n      const tripDetails = item.trip_details || {}\n      const companionObserver = item.companion_observer || {}\n\n      const title = huntCombination[0]?.title || huntCombination[0]?.name || huntingTrip?.type || ''\n      const area = huntingTrip?.hunting_area || (huntingTrip?.hunting_areas && huntingTrip.hunting_areas[0]) || ''\n      const safariModel = huntingTrip?.type || ''\n      const cost = pricing?.total_amount ? `${pricing.currency || ''} ${pricing.total_amount}`.trim() : ''\n      const dates = huntingTrip?.dates || item.confirmation_date_formatted || ''\n      const speciesList = huntCombination.map((hc: any) => hc.species || hc.name || hc.title).filter(Boolean)\n      const numberToHunt = tripDetails?.no_of_hunters || tripDetails?.no_of_hunters || ''\n      const companionCount = companionObserver?.no_of_companions || tripDetails?.no_of_companions || ''\n      const observerCount = companionObserver?.no_of_observers || tripDetails?.no_of_observers || ''\n\n      // Try to pick companion/observer costs from pricing breakdown if present\n      const companionCost = item.companion_hunter_cost || pricing?.companion_hunter_cost || ''\n      const observerFee = item.observer_fee || pricing?.observer_fee || ''\n\n      // Extras and trophy fees may be on huntingTrip or pricing\n      const extras = huntingTrip?.extras || item.extras || pricing?.extras || []\n      const trophyFees = item.trophy_fees || pricing?.trophy_fees || []\n\n      const lines: string[] = []\n      if (title) lines.push(`${title}`)\n      if (area) lines.push(`Area: ${area}`)\n      if (safariModel) lines.push(`Safari Model: ${safariModel}`)\n      if (cost) lines.push(`Cost: ${cost}`)\n      if (dates) lines.push(`Dates: ${dates}`)\n      if (speciesList.length) lines.push(`Species: ${speciesList.join(', ')}`)\n      if (numberToHunt) lines.push(`Number SP to be hunted: ${numberToHunt}`)\n      if (companionCount) lines.push(`Companion(s): ${companionCount}`)\n      if (companionCost) lines.push(`Companion Hunter Cost: ${companionCost}`)\n      if (observerCount) lines.push(`Observers: ${observerCount}`)\n      if (observerFee) lines.push(`Observer Fee: ${observerFee}`)\n\n      if (Array.isArray(extras) && extras.length > 0) {\n        lines.push('Safari Extras:')\n        extras.forEach((ex: any) => {\n          const label = ex.label || ex.name || ex.type || JSON.stringify(ex)\n          const amount = ex.amount || ex.price || ex.fee || ''\n          lines.push(`  - ${label}${amount ? `: ${amount}` : ''}`)\n        })\n      }\n\n      if (Array.isArray(trophyFees) && trophyFees.length > 0) {\n        lines.push('Trophy Fees:')\n        trophyFees.forEach((tf: any) => {\n          const tlabel = tf.label || tf.name || tf.trophy || ''\n          const tamount = tf.amount || tf.price || tf.fee || ''\n          lines.push(`  - ${tlabel}${tamount ? `: ${tamount}` : ''}`)\n        })\n      }\n\n      if (lines.length === 0 && clientName) return clientName\n      return lines.join('\\n')\n    },\n\n    getSpeciesList() {\n      if (!this.salesItem || !this.salesItem.hunt_combination) return []\n      return this.salesItem.hunt_combination\n        .map((h: any) => h.species_name || h.species || h.name || h.title)\n        .filter(Boolean)\n    },\n\n    getStatusClass(item: any) {\n      const status = item?.status?.status || item?.status || ''\n      const statusLower = String(status).toLowerCase()\n      if (statusLower === 'completed') return 'status-completed'\n      if (statusLower === 'confirmed') return 'status-confirmed'\n      if (statusLower === 'pending') return 'status-pending'\n      return 'status-default'\n    },\n\n    getStatusText(item: any) {\n      const status = item?.status?.status || item?.status || ''\n      return String(status).charAt(0).toUpperCase() + String(status).slice(1).toLowerCase()\n    },\n\n    formatDate(dateString: string) {\n      if (!dateString) return '-'\n      try {\n        const date = new Date(dateString)\n        return date.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' })\n      } catch {\n        return dateString\n      }\n    },\n\n    formatNumber(num: number) {\n      if (!num && num !== 0) return '-'\n      return new Intl.NumberFormat('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(num)\n    },\n\n    formatFileSize(bytes: number) {\n      if (!bytes) return '0 Bytes'\n      const k = 1024\n      const sizes = ['Bytes', 'KB', 'MB', 'GB']\n      const i = Math.floor(Math.log(bytes) / Math.log(k))\n      return Math.round((bytes / Math.pow(k, i)) * 100) / 100 + ' ' + sizes[i]\n    },\n\n    addDocument() {\n      if (!this.form.doc_type) {\n        this.init({ message: 'Please select a document type', color: 'warning' })\n        return\n      }\n\n      if (!this.form.documents || this.form.documents.length === 0) {\n        this.init({ message: 'Please upload a file', color: 'warning' })\n        return\n      }\n\n      const docType = this.form.doc_type.text || this.form.doc_type\n      this.form.uploadedDocuments.push({\n        type: docType,\n        file: this.form.documents[0],\n      })\n      // Reset the upload fields\n      this.form.doc_type = null\n      this.form.documents = []\n      this.init({ message: 'Document added successfully', color: 'success' })\n    },\n\n    removeDocument(index: number) {\n      this.form.uploadedDocuments.splice(index, 1)\n      this.init({ message: 'Document removed', color: 'info' })\n    },\n\n    async uploadDocumentsForContract(contractId: number) {\n      try {\n        const baseUrl = import.meta.env.VITE_APP_BASE_URL\n        const endpoint = `sales-confirmation/contracts/${contractId}/documents`\n\n        // Prepare FormData with documents\n        const formData = new FormData()\n\n        this.form.uploadedDocuments.forEach((item: any, index: number) => {\n          formData.append('documents[]', item.file)\n          formData.append(`doc_types[${index}]`, item.type)\n        })\n\n        console.log('Uploading documents for contract:', contractId)\n\n        const response = await fetch(`${baseUrl}${endpoint}`, {\n          method: 'POST',\n          body: formData,\n        })\n\n        const responseData = await response.json().catch(() => ({}))\n\n        if (response.ok || response.status === 201) {\n          console.log('Documents uploaded successfully:', responseData)\n          this.init({\n            message: `‚úì ${this.form.uploadedDocuments.length} document(s) uploaded successfully!`,\n            color: 'success',\n          })\n        } else {\n          console.error('Document upload failed:', responseData)\n          this.init({\n            message: `Warning: Contract created but document upload failed. Please upload documents manually.`,\n            color: 'warning',\n          })\n        }\n      } catch (error: any) {\n        console.error('Document upload error:', error)\n        this.init({\n          message: `Warning: Contract created but document upload encountered an error. Please upload documents manually.`,\n          color: 'warning',\n        })\n      }\n    },\n\n    handleReset() {\n      this.resetForm()\n      this.resetValidationForm()\n    },\n  },\n})\n</script>\n\n<style lang=\"scss\" scoped>\n.sales-inquiry {\n  margin: 20px;\n}\n\n.split-demo {\n  & .custom-grabber {\n    height: 100%;\n    width: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background-color: var(--va-background-element);\n  }\n}\n\n/* Contract form visual improvements */\n.contract-form-card {\n  border-radius: 16px;\n  box-shadow: 0 8px 24px rgba(15, 23, 42, 0.08);\n  overflow: hidden;\n  border: 1px solid rgba(0, 0, 0, 0.06);\n}\n\n.form-header {\n  background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);\n  border-bottom: 1px solid rgba(0, 0, 0, 0.06);\n\n  .header-icon {\n    background: linear-gradient(135deg, #4f46e5, #06b6d4);\n    box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);\n  }\n\n  .header-text .text-muted {\n    color: #64748b;\n    line-height: 1.6;\n  }\n}\n\n/* Proposal Details Card */\n.proposal-details-card {\n  background: #ffffff;\n  border: 1px solid #e2e8f0;\n  border-radius: 12px;\n  padding: 24px;\n  margin-top: 16px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);\n}\n\n.details-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24px;\n  padding-bottom: 16px;\n  border-bottom: 2px solid #f1f5f9;\n}\n\n.details-title {\n  font-size: 20px;\n  font-weight: 600;\n  color: #1e293b;\n  margin: 0;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.status-badge {\n  padding: 6px 14px;\n  border-radius: 20px;\n  font-size: 12px;\n  font-weight: 600;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n\n  &.status-completed {\n    background: #d1fae5;\n    color: #065f46;\n  }\n\n  &.status-confirmed {\n    background: #dbeafe;\n    color: #1e40af;\n  }\n\n  &.status-pending {\n    background: #fef3c7;\n    color: #92400e;\n  }\n\n  &.status-default {\n    background: #f1f5f9;\n    color: #475569;\n  }\n}\n\n.details-content {\n  display: flex;\n  flex-direction: column;\n  gap: 24px;\n}\n\n.info-section {\n  background: #f8fafc;\n  border-radius: 10px;\n  padding: 20px;\n  border: 1px solid #e2e8f0;\n}\n\n.section-title {\n  font-size: 16px;\n  font-weight: 600;\n  color: #334155;\n  margin: 0 0 16px 0;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.section-icon {\n  color: #4f46e5;\n  flex-shrink: 0;\n}\n\n.info-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n  gap: 16px;\n}\n\n.info-item {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n\n  &.pricing-highlight {\n    grid-column: 1 / -1;\n    background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);\n    padding: 16px;\n    border-radius: 8px;\n    border: 1px solid #bae6fd;\n  }\n}\n\n.info-label {\n  font-size: 13px;\n  font-weight: 500;\n  color: #64748b;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n\n.info-value {\n  font-size: 15px;\n  font-weight: 500;\n  color: #1e293b;\n\n  &.price-value {\n    font-size: 20px;\n    font-weight: 700;\n    color: #059669;\n  }\n}\n\n.species-tags {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 8px;\n  margin-top: 4px;\n}\n\n.species-tag {\n  background: linear-gradient(135deg, #ede9fe 0%, #ddd6fe 100%);\n  color: #5b21b6;\n  padding: 6px 12px;\n  border-radius: 6px;\n  font-size: 13px;\n  font-weight: 500;\n  border: 1px solid #c4b5fd;\n}\n\n/* Description Section */\n.description-section {\n  margin-top: 32px;\n  padding-top: 24px;\n  border-top: 2px solid #f1f5f9;\n}\n\n.description-input-area {\n  background: #f8fafc;\n  border: 1px solid #e2e8f0;\n  border-radius: 12px;\n  padding: 20px;\n  transition: all 0.3s ease;\n\n  &:hover {\n    border-color: #cbd5e1;\n    background: #ffffff;\n  }\n}\n\n.description-textarea {\n  width: 100%;\n\n  :deep(.va-textarea__textarea) {\n    font-size: 14px;\n    line-height: 1.6;\n    color: #1e293b;\n  }\n}\n\n/* Document Section */\n.document-section {\n  margin-top: 32px;\n  padding-top: 24px;\n  border-top: 2px solid #f1f5f9;\n}\n\n.section-header {\n  margin-bottom: 20px;\n}\n\n.section-title-large {\n  font-size: 18px;\n  font-weight: 600;\n  color: #1e293b;\n  margin: 0 0 8px 0;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n}\n\n.section-icon-large {\n  color: #4f46e5;\n}\n\n.required-badge {\n  background: #fee2e2;\n  color: #991b1b;\n  padding: 4px 10px;\n  border-radius: 12px;\n  font-size: 11px;\n  font-weight: 600;\n  margin-left: auto;\n}\n\n.section-description {\n  color: #64748b;\n  font-size: 14px;\n  margin: 0;\n  line-height: 1.6;\n}\n\n.document-upload-area {\n  background: #f8fafc;\n  border: 2px dashed #cbd5e1;\n  border-radius: 12px;\n  padding: 24px;\n  margin-bottom: 20px;\n  transition: all 0.3s ease;\n\n  &:hover {\n    border-color: #94a3b8;\n    background: #f1f5f9;\n  }\n}\n\n.add-doc-button {\n  margin-top: 8px;\n}\n\n.documents-list {\n  margin-top: 24px;\n}\n\n.documents-list-title {\n  font-size: 16px;\n  font-weight: 600;\n  color: #1e293b;\n  margin: 0 0 16px 0;\n}\n\n.documents-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));\n  gap: 12px;\n}\n\n.document-item {\n  background: #ffffff;\n  border: 1px solid #e2e8f0;\n  border-radius: 10px;\n  padding: 16px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  transition: all 0.2s ease;\n\n  &:hover {\n    border-color: #cbd5e1;\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\n  }\n}\n\n.document-item-content {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  flex: 1;\n  min-width: 0;\n}\n\n.document-icon {\n  color: #6366f1;\n  flex-shrink: 0;\n}\n\n.document-info {\n  flex: 1;\n  min-width: 0;\n}\n\n.document-type {\n  font-size: 14px;\n  font-weight: 600;\n  color: #1e293b;\n  margin-bottom: 4px;\n}\n\n.document-name {\n  font-size: 13px;\n  color: #475569;\n  margin-bottom: 2px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.document-size {\n  font-size: 12px;\n  color: #94a3b8;\n}\n\n.remove-doc-button {\n  flex-shrink: 0;\n  margin-left: 12px;\n}\n\n.documents-warning {\n  background: #fef3c7;\n  border: 1px solid #fcd34d;\n  border-radius: 10px;\n  padding: 16px;\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  color: #92400e;\n  font-size: 14px;\n  font-weight: 500;\n\n  svg {\n    flex-shrink: 0;\n    color: #f59e0b;\n  }\n}\n\n/* Form Actions */\n.form-actions {\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n  gap: 12px;\n  margin-top: 32px;\n  padding-top: 24px;\n  border-top: 2px solid #f1f5f9;\n}\n\n.action-button {\n  min-width: 120px;\n\n  &.primary-action {\n    background: linear-gradient(135deg, #4f46e5, #06b6d4);\n    border: none;\n    box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);\n    transition: all 0.3s ease;\n\n    &:hover:not(:disabled) {\n      transform: translateY(-2px);\n      box-shadow: 0 6px 16px rgba(79, 70, 229, 0.4);\n    }\n\n    &:disabled {\n      opacity: 0.6;\n      cursor: not-allowed;\n    }\n  }\n}\n\n/* Responsive adjustments */\n@media (max-width: 768px) {\n  .info-grid {\n    grid-template-columns: 1fr;\n  }\n\n  .documents-grid {\n    grid-template-columns: 1fr;\n  }\n\n  .form-actions {\n    flex-direction: column-reverse;\n\n    .action-button {\n      width: 100%;\n    }\n  }\n\n  .details-header {\n    flex-direction: column;\n    align-items: flex-start;\n    gap: 12px;\n  }\n}\n</style>\n","<template>\n  <div class=\"contracts-page\">\n    <!-- Page Header -->\n    <div class=\"d-flex justify-content-between align-items-center mb-4\">\n      <div class=\"d-flex align-items-center gap-3\">\n        <button v-if=\"showDetails || showAddContractForm\" class=\"btn btn-outline-secondary btn-sm\" @click=\"gotBack()\">\n          <i class=\"material-icons mr-1\" style=\"font-size: 18px\">arrow_back</i>\n          Go Back\n        </button>\n      </div>\n      <div v-if=\"!showAddContractForm && !showDetails\">\n        <button class=\"btn btn-primary\" @click=\"toggleAddSalesInquiriesForm()\">\n          <i class=\"material-icons mr-1\" style=\"font-size: 18px\">add</i>\n          Create Contract\n        </button>\n      </div>\n    </div>\n\n    <template v-if=\"!showDetails\">\n      <template v-if=\"!showAddContractForm\">\n        <!-- Contracts List Card -->\n        <div class=\"card shadow-sm contracts-list-card\">\n          <div class=\"card-header bg-white border-bottom\">\n            <div class=\"d-flex align-items-center\">\n              <i class=\"material-icons mr-2 text-muted\">feed</i>\n              <div>\n                <h5 class=\"mb-0 font-weight-bold\">Contracts</h5>\n                <small class=\"text-muted\">All Available contracts</small>\n              </div>\n            </div>\n          </div>\n          <div class=\"card-body p-0\">\n            <div class=\"table-responsive\">\n              <table class=\"table table-hover table-striped mb-0\">\n                <thead class=\"thead-light\">\n                  <tr>\n                    <th v-for=\"column in columns\" :key=\"column.key\" scope=\"col\" class=\"text-nowrap\">\n                      {{ column.label || formatColumnName(column.key) }}\n                    </th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <template v-if=\"loadingContracts\">\n                    <tr>\n                      <td :colspan=\"columns.length\" class=\"text-center py-5\">\n                        <div class=\"spinner-border text-primary\" role=\"status\">\n                          <span class=\"sr-only\">Loading...</span>\n                        </div>\n                        <p class=\"mt-2 text-muted\">Loading contracts...</p>\n                      </td>\n                    </tr>\n                  </template>\n                  <template v-else-if=\"contracts.length === 0\">\n                    <tr>\n                      <td :colspan=\"columns.length\" class=\"text-center py-5\">\n                        <i class=\"material-icons text-muted\" style=\"font-size: 48px\">description</i>\n                        <p class=\"mt-2 text-muted\">No contracts found</p>\n                      </td>\n                    </tr>\n                  </template>\n                  <template v-else>\n                    <tr v-for=\"(contract, index) in contracts\" :key=\"index\">\n                      <td>{{ contract.contract_number || 'N/A' }}</td>\n                      <td>{{ contract.client_name || 'N/A' }}</td>\n                      <td>{{ formatDate(contract.start_date) }}</td>\n                      <td>{{ formatDate(contract.end_date) }}</td>\n                      <td>{{ formatDate(contract.created_at) }}</td>\n                      <td>\n                        <div class=\"btn-group\" role=\"group\">\n                          <button\n                            class=\"btn btn-sm btn-outline-primary\"\n                            :disabled=\"!contract.pdf\"\n                            :title=\"contract.pdf ? 'Download PDF' : 'PDF not available'\"\n                            @click=\"downloadPdf(contract.pdf)\"\n                          >\n                            <i class=\"material-icons\" style=\"font-size: 18px\">download</i>\n                          </button>\n                          <button\n                            class=\"btn btn-sm btn-outline-info\"\n                            title=\"View Contract\"\n                            @click=\"viewContract(contract.selfitem)\"\n                          >\n                            <i class=\"material-icons\" style=\"font-size: 18px\">visibility</i>\n                          </button>\n                          <button\n                            class=\"btn btn-sm btn-outline-danger\"\n                            title=\"Delete Contract\"\n                            @click=\"deleteContract(contract.selfitem)\"\n                          >\n                            <i class=\"material-icons\" style=\"font-size: 18px\">delete</i>\n                          </button>\n                        </div>\n                      </td>\n                    </tr>\n                  </template>\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </div>\n      </template>\n      <template v-else>\n        <ContractForm></ContractForm>\n      </template>\n    </template>\n    <template v-else>\n      <ContractDetails :contract-item=\"item\" :is-edit-mode=\"isEditMode\"></ContractDetails>\n    </template>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { mapActions, mapState } from 'pinia'\nimport { defineComponent } from 'vue'\nimport { useContractsStore } from '../../../stores/contracts-store'\nimport downloadPdf from '../../../utils/pdfDownloader'\nimport ContractDetails from './components/ContractDetails.vue'\nimport ContractForm from './components/ContractForm.vue'\n\nexport default defineComponent({\n  components: {\n    ContractDetails,\n    ContractForm,\n  },\n  data() {\n    // Single unified contracts view\n    const columns = [\n      { key: 'contract_number', sortable: true },\n      { key: 'client_name', sortable: true },\n      { key: 'start_date', sortable: true },\n      { key: 'end_date', sortable: true },\n      { key: 'created_at', sortable: true },\n      { key: 'actions', label: 'Actions' },\n    ]\n\n    return {\n      columns,\n      item: null as any,\n      showDetails: false,\n      showAddContractForm: false,\n      isEditMode: false,\n    }\n  },\n  computed: {\n    ...mapState(useContractsStore, ['contracts', 'loadingContracts']),\n  },\n  watch: {\n    // no tab watch needed for unified contracts view\n  },\n  mounted() {\n    this.getContracts()\n  },\n  methods: {\n    ...mapActions(useContractsStore, ['getContracts']),\n\n    formatColumnName(key: string): string {\n      return key\n        .split('_')\n        .map((word) => word.charAt(0).toUpperCase() + word.slice(1))\n        .join(' ')\n    },\n\n    formatDate(date: string | null | undefined): string {\n      if (!date) return 'N/A'\n      try {\n        return new Date(date).toLocaleDateString()\n      } catch {\n        return 'N/A'\n      }\n    },\n\n    async deleteContract(contract: any) {\n      if (!contract?.id) {\n        alert('Contract ID is missing')\n        return\n      }\n\n      const contractNumber = contract.contract_number || `Contract #${contract.id}`\n      if (!confirm(`Are you sure you want to delete ${contractNumber}? This action cannot be undone.`)) {\n        return\n      }\n\n      try {\n        const contractsStore = useContractsStore()\n        const response = await contractsStore.deleteContractById(contract.id)\n        if (response.status === 200 || response.status === 204) {\n          alert('Contract deleted successfully')\n          this.getContracts()\n        }\n      } catch (error: any) {\n        console.error('Full delete error:', error)\n        let errorMsg = 'Failed to delete contract'\n\n        if (error.response?.status === 500) {\n          errorMsg = 'Server error (500). Please check the backend logs for details.'\n        } else if (error.response?.data?.message) {\n          errorMsg = error.response.data.message\n        } else if (error.response?.data?.error) {\n          errorMsg = error.response.data.error\n        } else if (error.message) {\n          errorMsg = error.message\n        }\n\n        alert(`Error: ${errorMsg}`)\n      }\n    },\n\n    async downloadPdf(pdfUrl: string) {\n      if (!pdfUrl) {\n        alert('PDF is not available for this contract yet.')\n        return\n      }\n      try {\n        await downloadPdf(pdfUrl, 'contract.pdf')\n      } catch (error: any) {\n        console.error('PDF download error:', error)\n        const message = error?.message || 'Unknown error'\n\n        if (message.includes('500')) {\n          alert(\n            'The PDF generation service is temporarily unavailable.\\n\\nPlease try again in a few moments. If the problem persists, contact support.',\n          )\n        } else if (message.includes('404')) {\n          alert('The PDF file was not found on the server. The contract may not have been processed yet.')\n        } else {\n          alert('Failed to download PDF. Please try again or contact support.\\n\\nError: ' + message)\n        }\n      }\n    },\n\n    viewContract(contract: any) {\n      this.item = contract\n      this.showDetails = true\n      this.isEditMode = false\n      this.showAddContractForm = false\n    },\n\n    gotBack() {\n      // Refresh contracts list\n      this.getContracts()\n\n      this.showDetails = false\n      this.showAddContractForm = false\n      this.isEditMode = false\n    },\n\n    toggleAddSalesInquiriesForm() {\n      this.showDetails = false\n      this.showAddContractForm = !this.showAddContractForm\n    },\n  },\n})\n</script>\n\n<style scoped>\n.contracts-list-card {\n  border-radius: 12px;\n  box-shadow: 0 8px 30px rgba(15, 23, 42, 0.04);\n  border: none;\n}\n\n.contracts-list-card .card-header {\n  border-radius: 12px 12px 0 0;\n  padding: 1.25rem;\n}\n\n.contracts-list-card .table {\n  margin-bottom: 0;\n}\n\n.contracts-list-card .table thead th {\n  border-top: none;\n  font-weight: 600;\n  font-size: 0.875rem;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n  color: #6b7280;\n  padding: 1rem;\n}\n\n.contracts-list-card .table tbody td {\n  padding: 1rem;\n  vertical-align: middle;\n}\n\n.contracts-list-card .table tbody tr:hover {\n  background-color: #f8f9fa;\n}\n\n.btn-group .btn {\n  border-radius: 4px;\n  margin: 0 2px;\n}\n\n.material-icons {\n  vertical-align: middle;\n}\n</style>\n","<template>\n  <div class=\"contracts-page\">\n    <!-- Page Header -->\n    <div class=\"d-flex justify-content-between align-items-center mb-4\">\n      <div class=\"d-flex align-items-center gap-3\">\n        <button v-if=\"showDetails || showAddContractForm\" class=\"btn btn-outline-secondary btn-sm\" @click=\"gotBack()\">\n          <i class=\"material-icons mr-1\" style=\"font-size: 18px\">arrow_back</i>\n          Go Back\n        </button>\n      </div>\n      <div v-if=\"!showAddContractForm && !showDetails\">\n        <button class=\"btn btn-primary\" @click=\"toggleAddSalesInquiriesForm()\">\n          <i class=\"material-icons mr-1\" style=\"font-size: 18px\">add</i>\n          Create Contract\n        </button>\n      </div>\n    </div>\n\n    <template v-if=\"!showDetails\">\n      <template v-if=\"!showAddContractForm\">\n        <!-- Contracts List Card -->\n        <div class=\"card shadow-sm contracts-list-card\">\n          <div class=\"card-header bg-white border-bottom\">\n            <div class=\"d-flex align-items-center\">\n              <i class=\"material-icons mr-2 text-muted\">feed</i>\n              <div>\n                <h5 class=\"mb-0 font-weight-bold\">Contracts</h5>\n                <small class=\"text-muted\">All Available contracts</small>\n              </div>\n            </div>\n          </div>\n          <div class=\"card-body p-0\">\n            <div class=\"table-responsive\">\n              <table class=\"table table-hover table-striped mb-0\">\n                <thead class=\"thead-light\">\n                  <tr>\n                    <th v-for=\"column in columns\" :key=\"column.key\" scope=\"col\" class=\"text-nowrap\">\n                      {{ column.label || formatColumnName(column.key) }}\n                    </th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <template v-if=\"loadingContracts\">\n                    <tr>\n                      <td :colspan=\"columns.length\" class=\"text-center py-5\">\n                        <div class=\"spinner-border text-primary\" role=\"status\">\n                          <span class=\"sr-only\">Loading...</span>\n                        </div>\n                        <p class=\"mt-2 text-muted\">Loading contracts...</p>\n                      </td>\n                    </tr>\n                  </template>\n                  <template v-else-if=\"contracts.length === 0\">\n                    <tr>\n                      <td :colspan=\"columns.length\" class=\"text-center py-5\">\n                        <i class=\"material-icons text-muted\" style=\"font-size: 48px\">description</i>\n                        <p class=\"mt-2 text-muted\">No contracts found</p>\n                      </td>\n                    </tr>\n                  </template>\n                  <template v-else>\n                    <tr v-for=\"(contract, index) in contracts\" :key=\"index\">\n                      <td>{{ contract.contract_number || 'N/A' }}</td>\n                      <td>{{ contract.client_name || 'N/A' }}</td>\n                      <td>{{ formatDate(contract.start_date) }}</td>\n                      <td>{{ formatDate(contract.end_date) }}</td>\n                      <td>{{ formatDate(contract.created_at) }}</td>\n                      <td>\n                        <div class=\"btn-group\" role=\"group\">\n                          <button\n                            class=\"btn btn-sm btn-outline-primary\"\n                            :disabled=\"!contract.pdf\"\n                            :title=\"contract.pdf ? 'Download PDF' : 'PDF not available'\"\n                            @click=\"downloadPdf(contract.pdf)\"\n                          >\n                            <i class=\"material-icons\" style=\"font-size: 18px\">download</i>\n                          </button>\n                          <button\n                            class=\"btn btn-sm btn-outline-info\"\n                            title=\"View Contract\"\n                            @click=\"viewContract(contract.selfitem)\"\n                          >\n                            <i class=\"material-icons\" style=\"font-size: 18px\">visibility</i>\n                          </button>\n                          <button\n                            class=\"btn btn-sm btn-outline-danger\"\n                            title=\"Delete Contract\"\n                            @click=\"deleteContract(contract.selfitem)\"\n                          >\n                            <i class=\"material-icons\" style=\"font-size: 18px\">delete</i>\n                          </button>\n                        </div>\n                      </td>\n                    </tr>\n                  </template>\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </div>\n      </template>\n      <template v-else>\n        <ContractForm></ContractForm>\n      </template>\n    </template>\n    <template v-else>\n      <ContractDetails :contract-item=\"item\" :is-edit-mode=\"isEditMode\"></ContractDetails>\n    </template>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { mapActions, mapState } from 'pinia'\nimport { defineComponent } from 'vue'\nimport { useContractsStore } from '../../../stores/contracts-store'\nimport downloadPdf from '../../../utils/pdfDownloader'\nimport ContractDetails from './components/ContractDetails.vue'\nimport ContractForm from './components/ContractForm.vue'\n\nexport default defineComponent({\n  components: {\n    ContractDetails,\n    ContractForm,\n  },\n  data() {\n    // Single unified contracts view\n    const columns = [\n      { key: 'contract_number', sortable: true },\n      { key: 'client_name', sortable: true },\n      { key: 'start_date', sortable: true },\n      { key: 'end_date', sortable: true },\n      { key: 'created_at', sortable: true },\n      { key: 'actions', label: 'Actions' },\n    ]\n\n    return {\n      columns,\n      item: null as any,\n      showDetails: false,\n      showAddContractForm: false,\n      isEditMode: false,\n    }\n  },\n  computed: {\n    ...mapState(useContractsStore, ['contracts', 'loadingContracts']),\n  },\n  watch: {\n    // no tab watch needed for unified contracts view\n  },\n  mounted() {\n    this.getContracts()\n  },\n  methods: {\n    ...mapActions(useContractsStore, ['getContracts']),\n\n    formatColumnName(key: string): string {\n      return key\n        .split('_')\n        .map((word) => word.charAt(0).toUpperCase() + word.slice(1))\n        .join(' ')\n    },\n\n    formatDate(date: string | null | undefined): string {\n      if (!date) return 'N/A'\n      try {\n        return new Date(date).toLocaleDateString()\n      } catch {\n        return 'N/A'\n      }\n    },\n\n    async deleteContract(contract: any) {\n      if (!contract?.id) {\n        alert('Contract ID is missing')\n        return\n      }\n\n      const contractNumber = contract.contract_number || `Contract #${contract.id}`\n      if (!confirm(`Are you sure you want to delete ${contractNumber}? This action cannot be undone.`)) {\n        return\n      }\n\n      try {\n        const contractsStore = useContractsStore()\n        const response = await contractsStore.deleteContractById(contract.id)\n        if (response.status === 200 || response.status === 204) {\n          alert('Contract deleted successfully')\n          this.getContracts()\n        }\n      } catch (error: any) {\n        console.error('Full delete error:', error)\n        let errorMsg = 'Failed to delete contract'\n\n        if (error.response?.status === 500) {\n          errorMsg = 'Server error (500). Please check the backend logs for details.'\n        } else if (error.response?.data?.message) {\n          errorMsg = error.response.data.message\n        } else if (error.response?.data?.error) {\n          errorMsg = error.response.data.error\n        } else if (error.message) {\n          errorMsg = error.message\n        }\n\n        alert(`Error: ${errorMsg}`)\n      }\n    },\n\n    async downloadPdf(pdfUrl: string) {\n      if (!pdfUrl) {\n        alert('PDF is not available for this contract yet.')\n        return\n      }\n      try {\n        await downloadPdf(pdfUrl, 'contract.pdf')\n      } catch (error: any) {\n        console.error('PDF download error:', error)\n        const message = error?.message || 'Unknown error'\n\n        if (message.includes('500')) {\n          alert(\n            'The PDF generation service is temporarily unavailable.\\n\\nPlease try again in a few moments. If the problem persists, contact support.',\n          )\n        } else if (message.includes('404')) {\n          alert('The PDF file was not found on the server. The contract may not have been processed yet.')\n        } else {\n          alert('Failed to download PDF. Please try again or contact support.\\n\\nError: ' + message)\n        }\n      }\n    },\n\n    viewContract(contract: any) {\n      this.item = contract\n      this.showDetails = true\n      this.isEditMode = false\n      this.showAddContractForm = false\n    },\n\n    gotBack() {\n      // Refresh contracts list\n      this.getContracts()\n\n      this.showDetails = false\n      this.showAddContractForm = false\n      this.isEditMode = false\n    },\n\n    toggleAddSalesInquiriesForm() {\n      this.showDetails = false\n      this.showAddContractForm = !this.showAddContractForm\n    },\n  },\n})\n</script>\n\n<style scoped>\n.contracts-list-card {\n  border-radius: 12px;\n  box-shadow: 0 8px 30px rgba(15, 23, 42, 0.04);\n  border: none;\n}\n\n.contracts-list-card .card-header {\n  border-radius: 12px 12px 0 0;\n  padding: 1.25rem;\n}\n\n.contracts-list-card .table {\n  margin-bottom: 0;\n}\n\n.contracts-list-card .table thead th {\n  border-top: none;\n  font-weight: 600;\n  font-size: 0.875rem;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n  color: #6b7280;\n  padding: 1rem;\n}\n\n.contracts-list-card .table tbody td {\n  padding: 1rem;\n  vertical-align: middle;\n}\n\n.contracts-list-card .table tbody tr:hover {\n  background-color: #f8f9fa;\n}\n\n.btn-group .btn {\n  border-radius: 4px;\n  margin: 0 2px;\n}\n\n.material-icons {\n  vertical-align: middle;\n}\n</style>\n"],"names":["_sfc_main$2","defineComponent","init","useToast","formatDateTime","_a","newVal","type","_b","start","end","diffTime","diffDays","baseUrl","contractId","endpoint","pdfUrl","filename","downloadPdf","error","message","docId","response","responseData","doc","errorMsg","fetchedDocuments","event","file","index","formData","item","count","field","errors","errorText","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_29","_hoisted_31","_hoisted_33","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","_hoisted_40","_hoisted_42","_hoisted_44","_hoisted_46","_hoisted_47","_hoisted_48","_hoisted_49","_hoisted_51","_hoisted_53","_hoisted_54","_hoisted_55","_hoisted_58","_hoisted_59","_hoisted_60","_hoisted_63","_hoisted_64","_hoisted_65","_hoisted_66","_hoisted_67","_hoisted_68","_hoisted_69","_hoisted_70","_hoisted_71","_hoisted_72","_hoisted_74","_hoisted_76","_hoisted_77","_hoisted_78","_hoisted_79","_hoisted_80","_hoisted_81","_hoisted_82","_hoisted_83","_hoisted_84","_hoisted_85","_hoisted_87","_hoisted_88","_openBlock","_createElementBlock","_createElementVNode","_cache","_toDisplayString","_ctx","_normalizeClass","_createCommentVNode","_createBlock","_component_VaButton","_withCtx","_createTextVNode","_c","_d","_e","_f","_g","_h","_hoisted_23","_hoisted_28","_i","_hoisted_30","_j","_k","_hoisted_32","_l","_m","_hoisted_34","_hoisted_39","_hoisted_41","_hoisted_43","_hoisted_45","_hoisted_50","_hoisted_52","_Fragment","_renderList","_hoisted_56","_hoisted_57","$event","_hoisted_61","_hoisted_62","_withDirectives","_createStaticVNode","_vModelSelect","args","_hoisted_73","_normalizeStyle","_hoisted_75","_hoisted_86","_sfc_main$1","iformRef","ref","isValidForm","validateForm","resetValidationForm","resetForm","useForm","isNotUpBookingSelected","onInputChange","form","reactive","mapState","useSalesInquiriesStore","mapActions","useContractsStore","value","selectedOption","opt","selectedItem","clientName","proposalValue","selectedProposal","entityValue","selStatus","data","errorData","errorMessage","handleErrors","err","completedProposals","status","proposalId","optionText","huntingTrip","pricing","huntCombination","tripDetails","companionObserver","title","area","safariModel","cost","dates","speciesList","hc","numberToHunt","companionCount","observerCount","companionCost","observerFee","extras","trophyFees","lines","ex","label","amount","tf","tlabel","tamount","h","statusLower","dateString","num","bytes","k","sizes","i","docType","_component_VaInnerLoading","_createVNode","_component_VaCard","_component_VaCardContent","_component_VaForm","_component_VaSelect","species","idx","_n","_o","_p","_q","_r","_s","_t","_u","_v","_w","_x","_component_VaTextarea","v","_sfc_main","ContractDetails","ContractForm","key","word","date","contract","contractNumber","_component_ContractDetails","_component_ContractForm","column"],"mappings":"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"}