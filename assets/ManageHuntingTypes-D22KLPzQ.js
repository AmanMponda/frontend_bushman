import{u as M}from"./settings-store-BSKbfzXp.js";import{d as H,m as I,B,s as $,_ as N,a as f,w as i,e as o,g as L,b as n,v as y,i as l,h as r,t as g,o as p}from"./index-D35lDKvM.js";import{u as A}from"./useForm-BgfHwkqf.js";import{u as j}from"./useToast-CJAf_JXJ.js";import{h as V}from"./errorHandler-DijQ3xmc.js";const E=H({name:"ManageHuntingTypes",setup(){const e=$(null),{isValid:t,validate:m,resetValidation:u}=A(e);return{isValidForm:t,validateForm:m,resetValidationForm:u,formRef:e}},data(){return{items:[],columns:[{key:"id",label:"ID",sortable:!0},{key:"name",label:"Name",sortable:!0},{key:"description",label:"Description",sortable:!0},{key:"actions",label:"Actions",sortable:!1}],loading:!1,saving:!1,deleting:!1,showList:!0,editMode:!1,showDeleteModal:!1,itemToDelete:null,toast:j(),form:B({id:null,name:"",description:""})}},mounted(){this.loadItems()},methods:{...I(M,["getHuntingsTypes","createHuntingType","updateHuntingType","deleteHuntingType"]),async loadItems(){this.loading=!0;try{const e=await this.getHuntingsTypes();e.status===200&&(this.items=e.data)}catch(e){console.error("Failed to load hunting types",e),this.toast.init({message:"Failed to load hunting types",color:"danger"})}finally{this.loading=!1}},showCreateForm(){this.editMode=!1,this.resetForm(),this.showList=!1},editItem(e){this.editMode=!0,this.form.id=e.id,this.form.name=e.name,this.form.description=e.description||"",this.showList=!1},goBack(){this.resetForm(),this.showList=!0,this.loadItems()},resetForm(){this.form.id=null,this.form.name="",this.form.description="",this.editMode=!1,this.resetValidationForm()},async createItem(){this.saving=!0;try{const e=await this.createHuntingType({name:this.form.name,description:this.form.description});(e.status===201||e.status===200)&&(this.toast.init({message:"Hunting Type created successfully",color:"success"}),this.goBack())}catch(e){const t=V(e);this.toast.init({message:t.length>0?t.join(", "):"Failed to create hunting type",color:"danger"})}finally{this.saving=!1}},async updateItem(){if(this.form.id){this.saving=!0;try{(await this.updateHuntingType(this.form.id,{name:this.form.name,description:this.form.description})).status===200&&(this.toast.init({message:"Hunting Type updated successfully",color:"success"}),this.goBack())}catch(e){const t=V(e);this.toast.init({message:t.length>0?t.join(", "):"Failed to update hunting type",color:"danger"})}finally{this.saving=!1}}},confirmDelete(e){this.itemToDelete=e,this.showDeleteModal=!0},async deleteItemConfirmed(){var e,t,m,u;if(this.itemToDelete){this.deleting=!0;try{const a=await this.deleteHuntingType(this.itemToDelete.id,!0);(a.status===204||a.status===200)&&(this.toast.init({message:"Hunting Type deleted successfully",color:"success"}),this.showDeleteModal=!1,this.itemToDelete=null,this.loadItems())}catch(a){const c=((t=(e=a==null?void 0:a.response)==null?void 0:e.data)==null?void 0:t.detail)||((u=(m=a==null?void 0:a.response)==null?void 0:m.data)==null?void 0:u.message);this.toast.init({message:c||"Failed to delete hunting type",color:"danger"})}finally{this.deleting=!1}}}}}),S={class:"flex flex-col md:flex-row gap-2 mb-4 justify-between"},U={class:"flex flex-col md:flex-row gap-2 justify-start"},G={class:"flex gap-2"},q={key:1,class:"p-2"},z={class:"font-bold text-lg mb-4"},P={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},R={class:"mb-6 flex gap-2"},W={class:"p-4"},J={class:"mb-4"},K={class:"flex gap-2 justify-end"};function O(e,t,m,u,a,c){const d=l("VaButton"),v=l("VaButtonGroup"),b=l("VaDataTable"),h=l("VaInput"),T=l("VaForm"),k=l("VaIcon"),w=l("VaAlert"),C=l("VaModal"),F=l("VaCard");return p(),f(F,{class:"p-6"},{default:i(()=>[o("div",S,[o("div",U,[e.showList?y("",!0):(p(),f(d,{key:0,class:"px-2 py-2",icon:"arrow_back",size:"small",onClick:t[0]||(t[0]=s=>e.goBack())},{default:i(()=>t[9]||(t[9]=[r(" Go Back ")])),_:1}))]),e.showList?(p(),f(v,{key:0},{default:i(()=>[n(d,{class:"px-2 py-2",color:"primary",icon:"add",size:"small",onClick:t[1]||(t[1]=s=>e.showCreateForm())},{default:i(()=>t[10]||(t[10]=[r(" Add a New Hunting Type ")])),_:1})]),_:1})):y("",!0)]),e.showList?(p(),f(b,{key:0,items:e.items,columns:e.columns,loading:e.loading,hoverable:"",striped:""},{"cell(actions)":i(({rowData:s})=>[o("div",G,[n(d,{preset:"plain",icon:"edit",color:"primary",onClick:D=>e.editItem(s)},null,8,["onClick"]),n(d,{preset:"plain",icon:"delete",color:"danger",onClick:D=>e.confirmDelete(s)},null,8,["onClick"])])]),_:1},8,["items","columns","loading"])):(p(),L("div",q,[n(T,{ref:"formRef",class:"mb-6"},{default:i(()=>[o("h3",z,g(e.editMode?"Edit Hunting Type":"New Hunting Type"),1),o("div",P,[n(h,{modelValue:e.form.name,"onUpdate:modelValue":t[2]||(t[2]=s=>e.form.name=s),label:"Name",placeholder:"Enter Hunting Type Name (e.g., 1x1, 2x1)",rules:[s=>!!s||"Name is required"],required:""},null,8,["modelValue","rules"]),n(h,{modelValue:e.form.description,"onUpdate:modelValue":t[3]||(t[3]=s=>e.form.description=s),type:"textarea",label:"Description",placeholder:"Enter Description"},null,8,["modelValue"])])]),_:1},512),o("div",R,[n(d,{disabled:!e.isValidForm,color:"primary",icon:e.editMode?"save":"add",loading:e.saving,onClick:t[4]||(t[4]=s=>e.validateForm()&&(e.editMode?e.updateItem():e.createItem()))},{default:i(()=>[r(g(e.editMode?"Update":"Save"),1)]),_:1},8,["disabled","icon","loading"]),n(d,{preset:"secondary",onClick:t[5]||(t[5]=s=>e.goBack())},{default:i(()=>t[11]||(t[11]=[r(" Cancel ")])),_:1})])])),n(C,{modelValue:e.showDeleteModal,"onUpdate:modelValue":t[8]||(t[8]=s=>e.showDeleteModal=s),"hide-default-actions":""},{header:i(()=>t[12]||(t[12]=[o("h3",{class:"va-h6"},"Confirm Delete",-1)])),footer:i(()=>[o("div",K,[n(d,{preset:"secondary",onClick:t[6]||(t[6]=s=>e.showDeleteModal=!1)},{default:i(()=>t[19]||(t[19]=[r("Cancel")])),_:1}),n(d,{color:"danger",loading:e.deleting,onClick:t[7]||(t[7]=s=>e.deleteItemConfirmed())},{default:i(()=>t[20]||(t[20]=[r(" Force Delete ")])),_:1},8,["loading"])])]),default:i(()=>{var s;return[o("div",W,[o("p",J,[t[13]||(t[13]=r(" Are you sure you want to delete the hunting type ")),o("strong",null,g((s=e.itemToDelete)==null?void 0:s.name),1),t[14]||(t[14]=r("? "))]),n(w,{color:"danger",class:"mb-4"},{icon:i(()=>[n(k,{name:"warning"})]),default:i(()=>[t[15]||(t[15]=o("strong",null,"Warning:",-1)),t[16]||(t[16]=r(" This hunting type may be referenced by: ")),t[17]||(t[17]=o("ul",{class:"list-disc ml-6 mt-2"},[o("li",null,"Price Lists"),o("li",null,"Sales Packages"),o("li",null,"Trophy Fees")],-1)),t[18]||(t[18]=o("p",{class:"mt-2 font-bold"},"This action cannot be undone!",-1))]),_:1})])]}),_:1},8,["modelValue"])]),_:1})}const _=N(E,[["render",O]]);export{_ as default};
//# sourceMappingURL=ManageHuntingTypes-D22KLPzQ.js.map
