import{u as I}from"./sales-store-CArtnMbj.js";import{d as ne,m as w,l as Y,x as $s,y as Ps,z as Bs,A as Us,s as C,B as te,c as Ms,C as Rs,k as R,_ as le,a as q,w as y,b as o,i as d,e as s,v as F,h as i,o as b,E as ee,g as A,F as Z,t as l,q as Os}from"./index-CfFSTcA4.js";import{u as j}from"./settings-store-BM0E0G-d.js";import{h as se}from"./errorHandler-DijQ3xmc.js";import{u as re}from"./account-store-BJZ4aYhz.js";import{d as ie}from"./pdfDownloader-DiRJnS-k.js";import{u as ae}from"./useForm-uHGFwDD4.js";import{u as de}from"./useToast-CtGmr2K3.js";import{v as js}from"./utils-BWc0LXoO.js";import{u as X}from"./quota-store-BGCfYSQG.js";import{u as Ls}from"./regulatrory-store-CbyYumak.js";import{f as oe}from"./format-Cn4G_mmc.js";import{S as zs}from"./SafariExtrasForm-D7qn_4lm.js";const Hs=e=>({pending:"secondary",provision_sales:"warning",confirmed:"success",declined:"danger",cancelled:"danger",completed:"primary"})[e]||"default",Qs=ne({components:{VaForm:Us,VaInput:Bs,VaSelect:Ps,VaButton:$s},props:{salesInquiryId:{type:String,required:!0}},setup(){const e=C(),t=C(),n=C(!1),h=C("add"),{isValid:u,validate:m,resetValidation:r,reset:S}=ae(e),{isValid:D,validate:k,resetValidation:T,reset:_}=ae(t),{init:a}=de(),V=C(!1),L=te({id:null,full_name:"",country:null,nationality:null,email:"",phone:"",address:"",arrival_airport:"",charter_in:null,charter_out:null,regulatory_package_id:null,id_number:""}),N=te({id:null,client_id:null,contact:"",contact_type:null,contactable:!1}),O=()=>{n.value=!0},W=()=>{n.value=!1,V.value=!1},E=C([]),z=C([]),H=C([]),Q=C([]),x=C([]),G=C(0),$=async()=>{const v={method:"get",maxBodyLength:1/0,url:"https://backend-bushman-master-kxhmlj.laravel.cloud/api/v1.0/settings/countries",headers:{"Content-Type":"application/json"}},c=await R.request(v);c.status===200&&E.value.push(...c.data.map(f=>({value:f.id,text:f.name})))},K=async()=>{const v={method:"get",maxBodyLength:1/0,url:"https://backend-bushman-master-kxhmlj.laravel.cloud/api/v1.0/settings/entity-categories-vset/"},c=await R.request(v);c.status===200&&H.value.push(...c.data.map(f=>({value:f.id,text:f.name})))},P=async()=>{const v={method:"get",maxBodyLength:1/0,url:"https://backend-bushman-master-kxhmlj.laravel.cloud/api/v1.0/settings/nationalities",headers:{"Content-Type":"application/json"}},c=await R.request(v);c.status===200&&z.value.push(...c.data.map(f=>({value:f.id,text:f.name})))},B=async()=>{const v={method:"get",maxBodyLength:1/0,url:"https://backend-bushman-master-kxhmlj.laravel.cloud/api/v1.0/settings/contact-types/",headers:{"Content-Type":"application/json"}},c=await R.request(v);c.status===200&&Q.value.push(...c.data.map(f=>({value:f.id,text:f.name})))},J=Ms(()=>{var f;let v="";const c=(f=N.contact_type)==null?void 0:f.value;return c==="email"?v="email":c==="phone_number"?v="phone":v="",v});return Rs(()=>{$(),P(),B()}),{formRef:e,contactFormRef:t,showAddSalesInquiriesForm:n,btnIcon:h,form:L,contactForm:N,showDetailsPage:V,countries:E,nationality:z,categoryOptions:H,contactsTypes:Q,clients:x,step:G,init:a,toggleAddSalesInquiriesForm:O,isValidForm:u,validateForm:m,resetValidationForm:r,resetForm:S,isValidContactForm:D,validateContactForm:k,resetValidationContactForm:T,resetContactForm:_,validators:js,getCountries:$,getCategories:K,getNationalities:P,getContactTypes:B,contactFieldType:J,gotBack:W}},data(){return{preferred_species:[],speciesOptions:[],speciesObjects:[],areasOptions:[],seasonsOptions:[],selectedInquiryItem:null,downloadPdf:ie,saving:!1,regulatoryPackages:[]}},computed:{...Y(j,["logo"])},mounted(){this.getAreas(),this.getSeasonList(),this.getLicencePackages()},methods:{...w(X,["getSpeciesList"]),...w(X,["getAreaList"]),...w(X,["getAllSpeciesPerQuotaPerArea"]),...w(I,["createSalesInquiry","createSalesConfirmationProposalObservers","createSalesConfirmationCompanion","getCompanions"]),...w(j,["getSeasons"]),...w(Ls,["getRegulatoryPackages"]),async submit(){this.saving=!0;const e=[{contact_type:"email",contact:this.form.email},{contact_type:"phone",contact:this.form.phone},{contact_type:"address",contact:this.form.address}],t={fullName:this.form.full_name,contacts:e,nationalityId:this.form.nationality.value,countryId:this.form.country.value,salesInquiryId:this.salesInquiryId,regulatoryPackageId:this.form.regulatory_package_id.value,identityNumber:this.form.id_number,arrival_airport:this.form.arrival_airport,charter_in:oe(this.form.charter_in,"yyyy-MM-dd HH:mm:ss"),charter_out:oe(this.form.charter_in,"yyyy-MM-dd HH:mm:ss")};try{const n=await this.createSalesConfirmationCompanion(t);n.status===201&&(this.saving=!1,this.init({message:n.data.message,color:"success"}),this.resetForm(),this.resetValidationContactForm(),this.speciesObjects=[],this.getCompanions(this.salesInquiryId))}catch(n){this.saving=!1;const h=se(n.response);console.log(n),this.init({message:`
`+h.map((u,m)=>`${m+1}. ${u}`).join(`
`),color:"danger"})}},viewInquiries(e){this.showDetailsPage=!0,this.selectedInquiryItem=e.selfitem},deleteFromStorage(e){this.speciesObjects.splice(e,1),console.log("Species item deleted:",e)},async getLicencePackages(){try{const e=await this.getRegulatoryPackages();if(e.status===200){const t=e.data;this.regulatoryPackages=t.map(n=>({value:n.id,text:n.name}))}}catch(e){console.log(e)}},async getAreas(){try{const e=await this.getAreaList();this.areasOptions=e.data.map(t=>({value:t.id,text:t.name}))}catch(e){console.log(e)}},async getSeasonList(){try{const e=await this.getSeasons();this.seasonsOptions=e.data.map(t=>({value:t.id,text:t.name}))}catch(e){console.log(e)}}}}),Ws={class:"p-1"},xs={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4"},Gs={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},Ks={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4 mt-6"},Js={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},Xs={class:"mt-4 d-flex p-2 flex justify-end"};function Ys(e,t,n,h,u,m){const r=d("VaInput"),S=d("VaSelect"),D=d("VaButton"),k=d("VaForm"),T=d("VaCardContent"),_=d("VaCard");return b(),q(_,{class:"w-full"},{default:y(()=>[o(T,null,{default:y(()=>[o(k,{ref:"formRef"},{default:y(()=>[s("div",Ws,[t[12]||(t[12]=s("h3",{class:"font-bold text-lg mb-2"},"Companion Basic Information",-1)),s("div",xs,[o(r,{modelValue:e.form.full_name,"onUpdate:modelValue":t[0]||(t[0]=a=>e.form.full_name=a),type:"text",placeholder:"Enter your Full name",rules:[a=>a&&a.length>0||"Full name is required"],label:"Full name"},null,8,["modelValue","rules"]),o(S,{modelValue:e.form.country,"onUpdate:modelValue":t[1]||(t[1]=a=>e.form.country=a),placeholder:"Select Country",label:"Country",rules:[a=>a||"Country is required"],options:e.countries,searchable:"","highlight-matched-text":""},null,8,["modelValue","rules","options"]),o(S,{modelValue:e.form.nationality,"onUpdate:modelValue":t[2]||(t[2]=a=>e.form.nationality=a),placeholder:"Select Client nationality",label:"Client Nationality",rules:[a=>a||"Nationality is required"],options:e.nationality,searchable:"","highlight-matched-text":""},null,8,["modelValue","rules","options"]),o(r,{modelValue:e.form.id_number,"onUpdate:modelValue":t[3]||(t[3]=a=>e.form.id_number=a),type:"text",placeholder:"passport/ID number",rules:[a=>a&&a.length>0||"passport number/id number is required"],label:"passport/ID number"},null,8,["modelValue","rules"])]),t[13]||(t[13]=s("h3",{class:"font-bold text-lg mb-2"},"Contacts",-1)),s("div",Gs,[o(r,{modelValue:e.form.email,"onUpdate:modelValue":t[4]||(t[4]=a=>e.form.email=a),type:"email",placeholder:"Enter your email",rules:[e.validators.required,e.validators.email],label:"Email"},null,8,["modelValue","rules"]),o(r,{modelValue:e.form.phone,"onUpdate:modelValue":t[5]||(t[5]=a=>e.form.phone=a),type:"tell",placeholder:"eg: +971501234567",rules:[e.validators.required,e.validators.tell],label:"Phone"},null,8,["modelValue","rules"]),o(r,{modelValue:e.form.address,"onUpdate:modelValue":t[6]||(t[6]=a=>e.form.address=a),type:"text","max-length":30,placeholder:"Enter your address",rules:[a=>a&&a.length>0||"Address is required"],label:"Address"},null,8,["modelValue","rules"])]),t[14]||(t[14]=s("h3",{class:"font-bold text-lg mb-2"},"Charters",-1)),s("div",Ks,[o(r,{modelValue:e.form.charter_in,"onUpdate:modelValue":t[7]||(t[7]=a=>e.form.charter_in=a),placeholder:"Charter in",type:"datetime-local",rules:[a=>!!a||"This field is required"],label:"Charter in"},null,8,["modelValue","rules"]),o(r,{modelValue:e.form.charter_out,"onUpdate:modelValue":t[8]||(t[8]=a=>e.form.charter_out=a),type:"datetime-local",placeholder:"Charter out",rules:[a=>!!a||"This field is required",a=>new Date(a)>new Date(e.form.charter_in)||"Check out date must be after check-in date"],label:"Charter out"},null,8,["modelValue","rules"]),o(r,{modelValue:e.form.arrival_airport,"onUpdate:modelValue":t[9]||(t[9]=a=>e.form.arrival_airport=a),type:"text",placeholder:"Arrival airport",rules:[a=>!!a||"This field is required"],label:"Arrival airport"},null,8,["modelValue","rules"])]),t[15]||(t[15]=s("h3",{class:"font-bold text-lg mb-2"},"Licence",-1)),s("div",Js,[o(S,{modelValue:e.form.regulatory_package_id,"onUpdate:modelValue":t[10]||(t[10]=a=>e.form.regulatory_package_id=a),options:e.regulatoryPackages,rules:[a=>a||"Licence is required"],placeholder:"Select Licence",label:"Licence"},null,8,["modelValue","options","rules"])])]),s("div",Xs,[e.showDetailsPage?F("",!0):(b(),q(D,{key:0,loading:e.saving,icon:"save",class:"mr-3 mb-2",disabled:!e.isValidForm,onClick:t[11]||(t[11]=a=>e.validateForm()&&e.submit())},{default:y(()=>t[16]||(t[16]=[i(" Save ")])),_:1},8,["loading","disabled"]))])]),_:1},512)]),_:1})]),_:1})}const Zs=le(Qs,[["render",Ys]]),ea=ne({components:{VaForm:Us,VaInput:Bs,VaSelect:Ps,VaButton:$s},props:{salesInquiryId:{type:String,required:!0}},setup(){const e=C(),t=C(),n=C(!1),h=C("add"),{isValid:u,validate:m,resetValidation:r,reset:S}=ae(e),{isValid:D,validate:k,resetValidation:T,reset:_}=ae(t),{init:a}=de(),V=C(!1),L=te({id:null,full_name:"",country:null,nationality:null,email:"",phone:"",address:"",arrival_airport:"",charter_in:null,charter_out:null,id_number:""}),N=te({id:null,client_id:null,contact:"",contact_type:null,contactable:!1}),O=()=>{n.value=!0},W=()=>{n.value=!1,V.value=!1},E=C([]),z=C([]),H=C([]),Q=C([]),x=C([]),G=C(0),$=async()=>{const v={method:"get",maxBodyLength:1/0,url:"https://backend-bushman-master-kxhmlj.laravel.cloud/api/v1.0/settings/countries",headers:{"Content-Type":"application/json"}},c=await R.request(v);c.status===200&&E.value.push(...c.data.map(f=>({value:f.id,text:f.name})))},K=async()=>{const v={method:"get",maxBodyLength:1/0,url:"https://backend-bushman-master-kxhmlj.laravel.cloud/api/v1.0/settings/entity-categories-vset/"},c=await R.request(v);c.status===200&&H.value.push(...c.data.map(f=>({value:f.id,text:f.name})))},P=async()=>{const v={method:"get",maxBodyLength:1/0,url:"https://backend-bushman-master-kxhmlj.laravel.cloud/api/v1.0/settings/nationalities",headers:{"Content-Type":"application/json"}},c=await R.request(v);c.status===200&&z.value.push(...c.data.map(f=>({value:f.id,text:f.name})))},B=async()=>{const v={method:"get",maxBodyLength:1/0,url:"https://backend-bushman-master-kxhmlj.laravel.cloud/api/v1.0/settings/contact-types/",headers:{"Content-Type":"application/json"}},c=await R.request(v);c.status===200&&Q.value.push(...c.data.map(f=>({value:f.id,text:f.name})))},J=Ms(()=>{var f;let v="";const c=(f=N.contact_type)==null?void 0:f.value;return c==="email"?v="email":c==="phone_number"?v="phone":v="",v});return Rs(()=>{$(),P(),B()}),{formRef:e,contactFormRef:t,showAddSalesInquiriesForm:n,btnIcon:h,form:L,contactForm:N,showDetailsPage:V,countries:E,nationality:z,categoryOptions:H,contactsTypes:Q,clients:x,step:G,init:a,toggleAddSalesInquiriesForm:O,isValidForm:u,validateForm:m,resetValidationForm:r,resetForm:S,isValidContactForm:D,validateContactForm:k,resetValidationContactForm:T,resetContactForm:_,validators:js,getCountries:$,getCategories:K,getNationalities:P,getContactTypes:B,contactFieldType:J,gotBack:W}},data(){return{preferred_species:[],speciesOptions:[],speciesObjects:[],areasOptions:[],seasonsOptions:[],selectedInquiryItem:null,downloadPdf:ie,saving:!1}},computed:{...Y(j,["logo"])},mounted(){this.getAreas(),this.getSeasonList()},methods:{...w(X,["getSpeciesList"]),...w(X,["getAreaList"]),...w(X,["getAllSpeciesPerQuotaPerArea"]),...w(I,["createSalesInquiry","createSalesConfirmationProposalObservers","getObservers"]),...w(j,["getSeasons"]),async submit(){this.saving=!0;const e=[{contact_type:"email",contact:this.form.email},{contact_type:"phone",contact:this.form.phone},{contact_type:"address",contact:this.form.address}],t={fullName:this.form.full_name,contacts:e,nationalityId:this.form.nationality.value,countryId:this.form.country.value,salesInquiryId:this.salesInquiryId,arrival_airport:this.form.arrival_airport,charter_in:oe(this.form.charter_in,"yyyy-MM-dd HH:mm:ss"),charter_out:oe(this.form.charter_in,"yyyy-MM-dd HH:mm:ss"),identityNumber:this.form.id_number};try{const n=await this.createSalesConfirmationProposalObservers(t);n.status===201&&(this.saving=!1,this.init({message:n.data.message,color:"success"}),this.resetForm(),this.resetValidationContactForm(),this.speciesObjects=[],this.getObservers(this.salesInquiryId))}catch(n){this.saving=!1;const h=se(n.response);console.log(h),this.init({message:`
`+h.map((u,m)=>`${m+1}. ${u}`).join(`
`),color:"danger"})}},viewInquiries(e){this.showDetailsPage=!0,this.selectedInquiryItem=e.selfitem},deleteFromStorage(e){this.speciesObjects.splice(e,1),console.log("Species item deleted:",e)},async getAreas(){try{const e=await this.getAreaList();this.areasOptions=e.data.map(t=>({value:t.id,text:t.name}))}catch(e){console.log(e)}},async getSeasonList(){try{const e=await this.getSeasons();this.seasonsOptions=e.data.map(t=>({value:t.id,text:t.name}))}catch(e){console.log(e)}}}}),ta={class:"p-1"},sa={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4"},aa={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},oa={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4 mt-6"},la={class:"mt-4 d-flex p-2 flex justify-end"};function na(e,t,n,h,u,m){const r=d("VaInput"),S=d("VaSelect"),D=d("VaButton"),k=d("VaForm"),T=d("VaCardContent"),_=d("VaCard");return b(),q(_,{class:"w-full"},{default:y(()=>[o(T,null,{default:y(()=>[o(k,{ref:"formRef"},{default:y(()=>[s("div",ta,[t[11]||(t[11]=s("h3",{class:"font-bold text-lg mb-2"},"Observers Basic Information",-1)),s("div",sa,[o(r,{modelValue:e.form.full_name,"onUpdate:modelValue":t[0]||(t[0]=a=>e.form.full_name=a),type:"text",placeholder:"Enter your Full name",rules:[a=>a&&a.length>0||"Full name is required"],label:"Full name"},null,8,["modelValue","rules"]),o(S,{modelValue:e.form.country,"onUpdate:modelValue":t[1]||(t[1]=a=>e.form.country=a),placeholder:"Select Country",label:"Country",rules:[a=>a||"Country is required"],options:e.countries,searchable:"","highlight-matched-text":""},null,8,["modelValue","rules","options"]),o(S,{modelValue:e.form.nationality,"onUpdate:modelValue":t[2]||(t[2]=a=>e.form.nationality=a),placeholder:"Select Client nationality",label:"Client Nationality",rules:[a=>a||"Nationality is required"],options:e.nationality,searchable:"","highlight-matched-text":""},null,8,["modelValue","rules","options"]),o(r,{modelValue:e.form.id_number,"onUpdate:modelValue":t[3]||(t[3]=a=>e.form.id_number=a),type:"text",placeholder:"passport/ID number",rules:[a=>a&&a.length>0||"passport number/id number is required"],label:"passport/ID number"},null,8,["modelValue","rules"])]),t[12]||(t[12]=s("h3",{class:"font-bold text-lg mb-2"},"Contacts",-1)),s("div",aa,[o(r,{modelValue:e.form.email,"onUpdate:modelValue":t[4]||(t[4]=a=>e.form.email=a),type:"email",placeholder:"Enter your email",rules:[e.validators.required,e.validators.email],label:"Email"},null,8,["modelValue","rules"]),o(r,{modelValue:e.form.phone,"onUpdate:modelValue":t[5]||(t[5]=a=>e.form.phone=a),type:"tell",placeholder:"eg: +971501234567",rules:[e.validators.required,e.validators.tell],label:"Phone"},null,8,["modelValue","rules"]),o(r,{modelValue:e.form.address,"onUpdate:modelValue":t[6]||(t[6]=a=>e.form.address=a),type:"text","max-length":30,placeholder:"Enter your address",rules:[a=>!!a||"This field is required"],label:"Address"},null,8,["modelValue","rules"])]),t[13]||(t[13]=s("h3",{class:"font-bold text-lg mb-2"},"Charters",-1)),s("div",oa,[o(r,{modelValue:e.form.charter_in,"onUpdate:modelValue":t[7]||(t[7]=a=>e.form.charter_in=a),placeholder:"Charter in",type:"datetime-local",rules:[a=>!!a||"This field is required"],label:"Charter in"},null,8,["modelValue","rules"]),o(r,{modelValue:e.form.charter_out,"onUpdate:modelValue":t[8]||(t[8]=a=>e.form.charter_out=a),type:"datetime-local",placeholder:"Charter out",rules:[a=>!!a||"This field is required",a=>new Date(a)>new Date(e.form.charter_in)||"Check out date must be after check-in date"],label:"Charter out"},null,8,["modelValue","rules"]),o(r,{modelValue:e.form.arrival_airport,"onUpdate:modelValue":t[9]||(t[9]=a=>e.form.arrival_airport=a),type:"text",placeholder:"Arrival airport",rules:[a=>!!a||"This field is required"],label:"Arrival airport"},null,8,["modelValue","rules"])])]),s("div",la,[e.showDetailsPage?F("",!0):(b(),q(D,{key:0,loading:e.saving,icon:"save",class:"mr-3 mb-2",disabled:!e.isValidForm,onClick:t[10]||(t[10]=a=>e.validateForm()&&e.submit())},{default:y(()=>t[14]||(t[14]=[i(" Save ")])),_:1},8,["loading","disabled"]))])]),_:1},512)]),_:1})]),_:1})}const ia=le(ea,[["render",na]]),ra=ne({name:"SalesClientSafariExtrasForm",components:{SafariExtrasForm:zs},props:{tableSelectable:{type:Boolean,required:!1,default:!1},item:{type:Object,required:!0}},emits:["submitSelectedItemsEvent"],setup(){const{init:e}=de(),t=C(null),{isValid:n,validate:h,resetValidation:u,reset:m}=ae(t),r=te({extra_id:null,account_id:null});return{formRef:t,isValidForm:n,validateForm:h,resetValidationForm:u,resetForm:m,form:r,init:e}},data(){return{selectedItems:[],columns:[{key:"safari_text",label:"Service",sortable:!0},{key:"account_name",label:"Account",sortable:!0},{key:"actions",label:"Actions",sortable:!1}]}},computed:{...Y(j,["safariExtras"]),...Y(re,["companyAccounts"]),...ee(I,{_savingSafariExtras:"savingSafariExtras"}),...ee(j,{_showCreateSafariExtraModal:"showCreateSafariExtraModal"})},mounted(){this.getSafariExtras(!0),this.getCompanyAccounts()},methods:{...w(j,["getSafariExtras"]),...w(re,["getCompanyAccounts"]),...w(I,["createsafariExtras","getClienSafariExtras"]),_showModal(){this._showCreateSafariExtraModal=!0},addExtraServiceInTempTable(){if(!this.form.extra_id.value){this.init({message:"Please select extra service ",color:"warning"});return}if(!this.form.account_id.value){this.init({message:"Please select account ",color:"warning"});return}const e={safari_extras_id:this.form.extra_id.value,safari_text:this.form.extra_id.text,sales_inquiry_id:this.item.id,account_id:this.form.account_id.value,account_name:this.form.account_id.text};this.selectedItems.findIndex(n=>n.safari_extras_id===e.safari_extras_id)===-1?this.selectedItems.push(e):this.init({message:"This service already added",color:"warning"}),this.resetForm()},deleteTempSubItemList(e){this.selectedItems.splice(e,1)},async submitSelectedItems(){console.log("submitSelectedItems"),console.log(this.item.id);const e=this.selectedItems.map(t=>({safari_extras_id:t.safari_extras_id,account_id:t.account_id,sales_inquiry_id:this.item.id}));try{const t=await this.createsafariExtras(e);t.status===201&&(this.init({message:t.data.message,color:"success"}),this.getClienSafariExtras(this.item.id))}catch(t){console.error(t);const n=se(t.response);this.init({message:`
`+n.map((h,u)=>`${u+1}. ${h}`).join(`
`),color:"danger"}),this._savingSafariExtras=!1}}}}),da={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"};function ua(e,t,n,h,u,m){const r=d("VaIcon"),S=d("VaSelect"),D=d("VaButton"),k=d("VaForm"),T=d("VaDataTable"),_=d("SafariExtrasForm"),a=d("VaModal");return b(),A(Z,null,[o(k,{ref:"formRef"},{default:y(()=>[s("div",da,[o(S,{modelValue:e.form.extra_id,"onUpdate:modelValue":t[1]||(t[1]=V=>e.form.extra_id=V),type:"text",placeholder:"Extra service",rules:[V=>!!V||"This field is required"],options:e.safariExtras,label:"Service"},{append:y(()=>[o(r,{name:"add",class:"ml-2",onClick:t[0]||(t[0]=V=>e._showModal())})]),_:1},8,["modelValue","rules","options"]),o(S,{modelValue:e.form.account_id,"onUpdate:modelValue":t[2]||(t[2]=V=>e.form.account_id=V),rules:[V=>!!V||"This field is required"],options:e.companyAccounts,label:"Account"},null,8,["modelValue","rules","options"]),o(D,{type:"submit",preset:"plain",icon:"add",rounded:"",disabled:!e.isValidForm,onClick:e.addExtraServiceInTempTable},{default:y(()=>t[5]||(t[5]=[i(" Add ")])),_:1},8,["disabled","onClick"])])]),_:1},512),o(T,{disabled:!e.selectedItems.length||e._savingSafariExtras,items:e.selectedItems,columns:e.columns},{"cell(actions)":y(({rowData:V})=>[o(D,{disabled:e._savingSafariExtras,preset:"plain",icon:"delete",onClick:L=>e.deleteTempSubItemList(V.index)},null,8,["disabled","onClick"])]),_:1},8,["disabled","items","columns"]),o(D,{loading:e._savingSafariExtras,icon:"save",disabled:!e.selectedItems.length,onClick:t[3]||(t[3]=V=>e.submitSelectedItems())},{default:y(()=>t[6]||(t[6]=[i(" Save ")])),_:1},8,["loading","disabled"]),o(a,{modelValue:e._showCreateSafariExtraModal,"onUpdate:modelValue":t[4]||(t[4]=V=>e._showCreateSafariExtraModal=V),size:"small",title:"Add Extra Service","close-on-click-outside":!1},{default:y(()=>[o(_)]),_:1},8,["modelValue"])],64)}const ma=le(ra,[["render",ua]]),pa=ne({components:{CompanionForm:Zs,ObserversForm:ia,SafariExtrasList:ma},props:{salesData:{type:Object,required:!0}},emits:["download-confirmation"],data(){var t,n,h;return{columns:[{key:"narration",label:"Description"},{key:"amount_due",label:"Amount Due (USD)"},{key:"due_days",label:"Days"},{key:"amount_due_type",label:"Due Type"},{key:"due_days_type",label:"Due Type"}],isOpened:!1,file:[],payfile:[],docType:null,docTypes:[],confirmText:"Confirm",disabledConfirmButton:!1,selection:["provision_sales"],paymentForm:{currency_id:null,date:null,accountType:null,reference_number:null,amount:(h=(n=(t=this.salesData)==null?void 0:t.price_break_down)==null?void 0:n.total_amount)==null?void 0:h.amount,narration:""},buttonColor:"primary",createDRTransaction:!1,createCRTransaction:!1,completingSales:!1,downloadPdf:ie,statusOptions:[{value:"provision_sales",text:"Confirmed, but no disposit yet"},{value:"confirmed",text:"Confirmed, With a disposit"},{value:"declined",text:"Declined"},{value:"cancelled",text:"Cancelled"},{value:"completed",text:"Completed"}],getStatusColor:Hs,files:[],status:"",loading:!1,transaction_type:"",accountsOption:[{value:"CASH_IN_HAND",text:"Cash in Hand"},{value:"BANK",text:"Bank trasfer"}],currencyOptions:[{value:1,text:"USD"},{value:2,text:"Tsh"}]}},computed:{...Y(I,["observers","companions","clientSafariExtras"]),...ee(I,{_shM:"showSafariExtrasModal"}),...ee(I,{_shOMd:"showObserversModal"}),...ee(I,{_shCMd:"showCompanionsModal"})},mounted(){this.showConfirmButtonTextByStatus(),this.getObservers(this.salesData.sales_inquiry.id),this.getCompanions(this.salesData.sales_inquiry.id),this.getClienSafariExtras(this.salesData.sales_inquiry.id)},methods:{...w(j,["getDocTypes"]),...w(I,["updatesalesConfirmationStatus"]),...w(re,["createCRDRTransaction","createDRCRTransaction"]),...w(I,["getObservers","getCompanions"]),...w(I,["createsafariExtras","getClienSafariExtras"]),getContactByType(e){return this.salesData.sales_inquiry.entity.contacts.find(t=>t.contact_type===e)},formatDate(e){const t={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString(void 0,t)},_showSafariExtrasModal(){this._shM=!0},downloadConfirmation(){this.$emit("download-confirmation",this.salesData)},async complete(){this.status="completed",this.completingSales=!0,await this.completeOrCancel("Sales Confirmation Completed.")},async completeOrCancel(e){var n,h,u,m;const t={entityId:this.salesData.sales_inquiry.entity.id,contractDoc:this.file[0],paymentDoc:this.payfile[0],salesConfirmationProposalId:this.salesData.id,statusId:this.status,quotaId:(m=(u=(h=(n=this.salesData)==null?void 0:n.proposed_package)==null?void 0:h.sales_package)==null?void 0:u.sales_quota)==null?void 0:m.id,areaId:this.salesData.sales_inquiry.area[0].area.id};try{(await this.updatesalesConfirmationStatus(t)).status===200?(this.isOpened=!1,this.loading=!1,this.$vaToast.init({message:e,color:"success"}),this.completingSales=!1):this.$vaToast.init({message:"Failed to process the request",color:"danger"})}catch(r){const S=se(r.response);S.length>0&&(this.loading=!1,this.completingSales=!0,this.$vaToast.init({message:`
`+S.map((D,k)=>`${k+1}. ${D}`).join(`
`),color:"danger"}))}},async cancel(){await this.$vaModal.confirm("Are you sure you want to cancel this sales?")&&(this.status="cancelled",await this.completeOrCancel("Sales Confirmation Cancelled."))},handleTransactionTypeStatus(e,t,n){this.loading=!0;const h=u=>this.files.some(m=>m.file===u);if(this.salesData.status.status==="pending"){if(e.includes("provision_sales")&&e.includes("confirm")&&e.length===2){if(this.status="confirmed",this.transaction_type="RECEIPT",this.createCRTransaction=!0,t[0]===void 0&&n[0]===void 0)throw this.$vaToast.init({message:"Please upload both Signed Contract and Payment Document",color:"danger"}),this.loading=!1,new Error("Please upload both Signed Contract and Payment Document")}else if(e.includes("provision_sales")&&e.length===1){if(this.status="provision_sales",this.transaction_type="SALES_INVOICE",this.createDRTransaction=!0,console.log("File:",t[0]),console.log("Payfile:",n[0]),t[0]===void 0)throw this.$vaToast.init({message:"Please upload Signed Contract",color:"danger"}),this.loading=!1,new Error("Please upload Signed Contract")}else if(e.includes("confirm")&&e.length===1&&(this.status="confirmed",this.transaction_type="RECEIPT",this.createCRTransaction=!0,n[0]===void 0))throw this.$vaToast.init({message:"Please upload Payment Document",color:"danger"}),this.loading=!1,new Error("Please upload Payment Document")}else if(this.salesData.status.status==="provision_sales"&&!h(n[0])&&(this.status="confirmed",this.transaction_type="RECEIPT",this.createCRTransaction=!0,n[0]===void 0))throw this.$vaToast.init({message:"Please upload Payment Document",color:"danger"}),this.loading=!1,new Error("Please upload Payment Document")},async submit(){var n,h;try{this.handleTransactionTypeStatus(this.selection,this.file,this.payfile)}catch(u){console.error("Error:",u),this.loading=!1;return}const e={date:oe(this.paymentForm.date,"yyyy-MM-dd")??null,account_type:((h=(n=this.paymentForm)==null?void 0:n.accountType)==null?void 0:h.value)??"SALES_ACCOUNT",reference_number:this.paymentForm.reference_number??null,currency_id:this.paymentForm.currency_id.value,transaction_type:this.transaction_type,amount:this.paymentForm.amount,narration:this.paymentForm.narration,accountable_id:this.salesData.sales_inquiry.entity.id,accountable_type_id:this.salesData.sales_inquiry.entity.category.id,sales_confirmation_id:this.salesData.id},t={entityId:this.salesData.sales_inquiry.entity.id,contractDoc:this.file[0],paymentDoc:this.payfile[0],salesConfirmationProposalId:this.salesData.id,statusId:this.status,areaId:this.salesData.sales_inquiry.area[0].area.id};try{if(this.createCRTransaction)if((await this.updatesalesConfirmationStatus(t)).status===200){const m=await this.createCRDRTransaction(e);m.status===201?(this.isOpened=!1,this.loading=!1,this.$vaToast.init({message:m.data.message,color:"success"})):this.$vaToast.init({message:"Failed to create transaction",color:"danger"})}else this.$vaToast.init({message:"Failed to update Sales",color:"danger"});else if(this.createDRTransaction)if((await this.updatesalesConfirmationStatus(t)).status===200){const m=await this.createDRCRTransaction(e);await this.delay(1e3),m.status===201?(this.isOpened=!1,this.loading=!1,this.$vaToast.init({message:m.data.message,color:"success"})):this.$vaToast.init({message:"Failed to create transaction",color:"danger"})}else this.$vaToast.init({message:"Failed to update Sales",color:"danger"})}catch(u){const m=se(u.response);this.loading=!1,m.length>0?this.$vaToast.init({message:`
`+m.map((r,S)=>`${S+1}. ${r}`).join(`
`),color:"danger"}):u.message&&this.$vaToast.init({message:u.message,color:"danger"})}},delay(e){return new Promise(t=>setTimeout(t,e))},showConfirmButtonTextByStatus(){switch(this.salesData.status.status){case"confirmed":this.confirmText="Cancel Now",this.disabledConfirmButton=!1,this.buttonColor="danger";break;case"completed":this.confirmText="Sales Done",this.disabledConfirmButton=!0;break;case"declined":this.confirmText="Confirm and Decline",this.disabledConfirmButton=!1;break;case"cancelled":this.confirmText="Confirm and Cancel",this.disabledConfirmButton=!1;break;case"provision_sales":this.confirmText="Confirm a Provision Sales",this.disabledConfirmButton=!1;break;default:this.confirmText="Confirm";break}},async getDocTypeOptions(){try{const e=await this.getDocTypes();if(console.log("Response from getDocTypes:",e),e.status===200){const t=e.data.map(n=>({value:n.id,text:n.name}));console.log("Mapped docTypes:",t),this.docTypes=t}else console.error("Failed to fetch document types: ",e)}catch(e){console.error("Error fetching document types: ",e)}},showModal(){this.isOpened=!0}}}),ca={class:"sales-confirmation"},fa={class:"action-buttons"},ya={class:"section"},ga={class:"details-grid"},ha={class:"section"},va={class:"details-grid"},ba={class:"section"},Va={class:"details-grid"},Ca={class:"section"},Sa={class:"details-grid"},Da={class:"section"},wa={class:"va-table-responsive"},ka={class:"va-table"},_a={class:"section"},Ta={class:"details-grid"},Aa={class:"section"},Ia={class:"details-grid"},Fa={class:"section"},qa={class:"section"},Na={class:"details-grid"},Ea={class:"species-list"},Oa={class:"section"},$a={class:"flex flex-col md:flex-row gap-2 mb-2 justify-between px-4 py-2"},Pa={class:"flex flex-col md:flex-row gap-2 mb-2 justify-between px-4 py-2"},Ba={class:"flex flex-col md:flex-row gap-2 justify-start"},Ua={class:"flex flex-col md:flex-row gap-2 mb-2 justify-between px-4 py-2"},Ma={class:"flex flex-col md:flex-row gap-2 mb-2 justify-between px-4 py-2"},Ra={class:"flex flex-row"},ja={class:"flex flex-col"},La={class:"flex flex-row mb-4"},za={key:0,class:"flex-1"},Ha={key:1,class:"flex-1"},Qa={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Wa={key:0,class:"mb-2"},xa={key:1,class:"mb-2"},Ga={key:2,class:"mb-2"},Ka={class:"mb-3"},Ja={class:"mb-2"},Xa={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},Ya={class:"mb-2"},Za={class:"mb-3"},eo={class:"mb-2"},to={class:"mb-2"},so={class:"mb-2"};function ao(e,t,n,h,u,m){var x,G,$,K,P,B,J,v,c,f,ue,me,pe,ce,fe,ye,ge,he,ve,be,Ve,Ce,Se,De,we,ke,_e,Te,Ae,Ie,Fe,qe,Ne,Ee,Oe,$e,Pe,Be,Ue,Me,Re,je,Le,ze,He,Qe,We,xe,Ge,Ke,Je,Xe,Ye,Ze,et,tt,st,at,ot,lt,nt,it,rt,dt,ut,mt,pt,ct,ft,yt,gt,ht,vt,bt,Vt,Ct,St,Dt,wt,kt,_t,Tt,At,It,Ft,qt,Nt,Et,Ot,$t,Pt,Bt,Ut,Mt,Rt,jt,Lt,zt,Ht,Qt,Wt,xt,Gt,Kt,Jt,Xt,Yt,Zt,es,ts,ss,as,os,ls,ns,is,rs,ds,us,ms,ps,cs,fs,ys,gs,hs,vs,bs,Vs,Cs,Ss,Ds,ws,ks,_s,Ts,As,Is,Fs,qs,Ns;const r=d("VaButton"),S=d("VaBadge"),D=d("VaDataTable"),k=d("VaDivider"),T=d("VaTitle"),_=d("VaProgressBar"),a=d("VaCheckbox"),V=d("VaFileUpload"),L=d("VaDateInput"),N=d("VaSelect"),O=d("VaInput"),W=d("VaTextarea"),E=d("VaModal"),z=d("CompanionForm"),H=d("ObserversForm"),Q=d("SafariExtrasList");return b(),A("div",ca,[t[82]||(t[82]=s("h1",{class:"header text-center text-lg font-bold"},"SALES CONFIRMATION",-1)),s("div",fa,[o(r,{roud:"",preset:"secondary",class:"px-2 py-2 px-md-4 py-md-4 mr-2",icon:"file_download",size:"small","border-color":"primary",onClick:t[0]||(t[0]=g=>e.downloadPdf(e.salesData.pdf))},{default:y(()=>t[26]||(t[26]=[i("Download")])),_:1}),((G=(x=e.salesData)==null?void 0:x.status)==null?void 0:G.status)==="pending"||((K=($=e.salesData)==null?void 0:$.status)==null?void 0:K.status)==="provision_sales"?(b(),q(r,{key:0,roud:"",preset:"secondary","border-color":"primary",class:"px-2 py-2",icon:"check_circle",disabled:e.disabledConfirmButton,size:"small",onClick:e.showModal},{default:y(()=>[i(l(e.confirmText),1)]),_:1},8,["disabled","onClick"])):((B=(P=e.salesData)==null?void 0:P.status)==null?void 0:B.status)==="confirmed"?(b(),q(r,{key:1,roud:"",color:e.buttonColor,class:"px-2 py-2 mr-2",disabled:e.disabledConfirmButton,size:"small",onClick:t[1]||(t[1]=g=>e.cancel())},{default:y(()=>[i(l(e.confirmText),1)]),_:1},8,["color","disabled"])):F("",!0)]),s("section",ya,[t[31]||(t[31]=s("h2",null,"Sales Inquiry",-1)),s("div",ga,[s("div",null,[t[27]||(t[27]=s("strong",null,"ID:",-1)),i(" "+l(((J=e.salesData)==null?void 0:J.id)??"N/A"),1)]),s("div",null,[t[28]||(t[28]=s("strong",null,"Code:",-1)),i(" "+l(((c=(v=e.salesData)==null?void 0:v.sales_inquiry)==null?void 0:c.code)??"N/A"),1)]),s("div",null,[t[29]||(t[29]=s("strong",null,"Created Date:",-1)),i(" "+l(e.formatDate((f=e.salesData)==null?void 0:f.created_date)??"N/A"),1)]),s("div",null,[t[30]||(t[30]=s("strong",null,"Remarks:",-1)),i(" "+l(((me=(ue=e.salesData)==null?void 0:ue.sales_inquiry)==null?void 0:me.remarks)??"None"),1)])])]),s("section",ha,[t[36]||(t[36]=s("h2",null,"Status Information",-1)),s("div",va,[s("div",null,[t[32]||(t[32]=s("strong",null,"Status ID:",-1)),i(" "+l(((ce=(pe=e.salesData)==null?void 0:pe.status)==null?void 0:ce.id)??"N/A"),1)]),s("div",null,[t[33]||(t[33]=s("strong",null,"Status:",-1)),o(S,{text:((ye=(fe=e.salesData)==null?void 0:fe.status)==null?void 0:ye.status)??"N/A",color:e.getStatusColor((he=(ge=e.salesData)==null?void 0:ge.status)==null?void 0:he.status),class:"mr-2"},null,8,["text","color"])]),s("div",null,[t[34]||(t[34]=s("strong",null,"Created At:",-1)),i(" "+l(e.formatDate((be=(ve=e.salesData)==null?void 0:ve.status)==null?void 0:be.created_at)??"N/A"),1)]),s("div",null,[t[35]||(t[35]=s("strong",null,"Updated At:",-1)),i(" "+l(e.formatDate((Ce=(Ve=e.salesData)==null?void 0:Ve.status)==null?void 0:Ce.updated_at)??"N/A"),1)])])]),s("section",ba,[t[43]||(t[43]=s("h2",null,"Client Information",-1)),s("div",Va,[s("div",null,[t[37]||(t[37]=s("strong",null,"Full Name:",-1)),i(" "+l(((we=(De=(Se=e.salesData)==null?void 0:Se.sales_inquiry)==null?void 0:De.entity)==null?void 0:we.full_name)??"N/A"),1)]),s("div",null,[t[38]||(t[38]=s("strong",null,"Email:",-1)),i(" "+l(((ke=e.getContactByType(1))==null?void 0:ke.contact)??"N/A"),1)]),s("div",null,[t[39]||(t[39]=s("strong",null,"Phone:",-1)),i(" "+l(((_e=e.getContactByType(4))==null?void 0:_e.contact)??"N/A"),1)]),s("div",null,[t[40]||(t[40]=s("strong",null,"Address:",-1)),i(" "+l(((Te=e.getContactByType(3))==null?void 0:Te.contact)??"N/A"),1)]),s("div",null,[t[41]||(t[41]=s("strong",null,"Nationality:",-1)),i(" "+l(((qe=(Fe=(Ie=(Ae=e.salesData)==null?void 0:Ae.sales_inquiry)==null?void 0:Ie.entity)==null?void 0:Fe.nationality)==null?void 0:qe.name)??"N/A"),1)]),s("div",null,[t[42]||(t[42]=s("strong",null,"Country:",-1)),i(" "+l((($e=(Oe=(Ee=(Ne=e.salesData)==null?void 0:Ne.sales_inquiry)==null?void 0:Ee.entity)==null?void 0:Oe.country)==null?void 0:$e.name)??"N/A"),1)])])]),s("section",Ca,[t[50]||(t[50]=s("h2",null,"Client Preferences",-1)),s("div",Sa,[s("div",null,[t[44]||(t[44]=s("strong",null,"No. of Hunters:",-1)),i(" "+l(((Ue=(Be=(Pe=e.salesData)==null?void 0:Pe.sales_inquiry)==null?void 0:Be.preference)==null?void 0:Ue.no_of_hunters)??"N/A"),1)]),s("div",null,[t[45]||(t[45]=s("strong",null,"No. of Observers:",-1)),i(" "+l(((je=(Re=(Me=e.salesData)==null?void 0:Me.sales_inquiry)==null?void 0:Re.preference)==null?void 0:je.no_of_observers)??"N/A"),1)]),s("div",null,[t[46]||(t[46]=s("strong",null,"No. of Days:",-1)),i(" "+l(((He=(ze=(Le=e.salesData)==null?void 0:Le.sales_inquiry)==null?void 0:ze.preference)==null?void 0:He.no_of_days)??"N/A"),1)]),s("div",null,[t[47]||(t[47]=s("strong",null,"No. of Companions:",-1)),i(" "+l(((xe=(We=(Qe=e.salesData)==null?void 0:Qe.sales_inquiry)==null?void 0:We.preference)==null?void 0:xe.no_of_companions)??"N/A"),1)]),s("div",null,[t[48]||(t[48]=s("strong",null,"Preferred Date:",-1)),i(" "+l(e.formatDate((Je=(Ke=(Ge=e.salesData)==null?void 0:Ge.sales_inquiry)==null?void 0:Ke.preference)==null?void 0:Je.preferred_date)??"N/A"),1)]),s("div",null,[t[49]||(t[49]=s("strong",null,"Special Requests:",-1)),i(" "+l(((Ze=(Ye=(Xe=e.salesData)==null?void 0:Xe.sales_inquiry)==null?void 0:Ye.preference)==null?void 0:Ze.special_requests)??"None"),1)])])]),s("section",Da,[t[52]||(t[52]=s("h2",null,"Preferred Species",-1)),s("div",wa,[s("table",ka,[t[51]||(t[51]=s("thead",null,[s("tr",null,[s("th",null,"Name"),s("th",null,"Scientific Name"),s("th",null,"Quantity")])],-1)),s("tbody",null,[(b(!0),A(Z,null,Os(((tt=(et=e.salesData)==null?void 0:et.sales_inquiry)==null?void 0:tt.preferred_species)??[],g=>{var U,M;return b(),A("tr",{key:g.id},[s("td",null,l(((U=g.species)==null?void 0:U.name)??"N/A"),1),s("td",null,l(((M=g.species)==null?void 0:M.scientific_name)??"N/A"),1),s("td",null,l(g.quantity??"N/A"),1)])}),128))])])])]),s("section",_a,[t[55]||(t[55]=s("h2",null,"Area Information",-1)),s("div",Ta,[s("div",null,[t[53]||(t[53]=s("strong",null,"Area Name:",-1)),i(" "+l(((lt=(ot=(at=(st=e.salesData)==null?void 0:st.sales_inquiry)==null?void 0:at.area[0])==null?void 0:ot.area)==null?void 0:lt.name)??"N/A"),1)]),s("div",null,[t[54]||(t[54]=s("strong",null,"Description:",-1)),i(" "+l(((dt=(rt=(it=(nt=e.salesData)==null?void 0:nt.sales_inquiry)==null?void 0:it.area[0])==null?void 0:rt.area)==null?void 0:dt.description)??"N/A"),1)])])]),s("section",Aa,[t[60]||(t[60]=s("h2",null,"Itinerary",-1)),s("div",Ia,[s("div",null,[t[56]||(t[56]=s("strong",null,"Airport Name:",-1)),i(" "+l(((mt=(ut=e.salesData)==null?void 0:ut.itinerary)==null?void 0:mt.airport_name)??"N/A"),1)]),s("div",null,[t[57]||(t[57]=s("strong",null,"Arrival:",-1)),i(" "+l(e.formatDate((ct=(pt=e.salesData)==null?void 0:pt.itinerary)==null?void 0:ct.arrival)??"N/A"),1)]),s("div",null,[t[58]||(t[58]=s("strong",null,"Charter In:",-1)),i(" "+l(e.formatDate((yt=(ft=e.salesData)==null?void 0:ft.itinerary)==null?void 0:yt.charter_in)??"N/A"),1)]),s("div",null,[t[59]||(t[59]=s("strong",null,"Charter Out:",-1)),i(" "+l(e.formatDate((ht=(gt=e.salesData)==null?void 0:gt.itinerary)==null?void 0:ht.charter_out)??"N/A"),1)])])]),s("section",Fa,[t[61]||(t[61]=s("h2",null,"Installments",-1)),o(D,{items:((vt=e.salesData)==null?void 0:vt.installments)??[],columns:e.columns},null,8,["items","columns"])]),s("section",qa,[t[67]||(t[67]=s("h2",null,"Proposed Package",-1)),s("div",Na,[s("div",null,[t[62]||(t[62]=s("strong",null,"Name:",-1)),i(" "+l(((Ct=(Vt=(bt=e.salesData)==null?void 0:bt.proposed_package)==null?void 0:Vt.sales_package)==null?void 0:Ct.name)??"N/A"),1)]),s("div",null,[t[63]||(t[63]=s("strong",null,"Description:",-1)),i(" "+l(((wt=(Dt=(St=e.salesData)==null?void 0:St.proposed_package)==null?void 0:Dt.sales_package)==null?void 0:wt.description)??"N/A"),1)]),s("div",null,[t[64]||(t[64]=s("strong",null,"Amount:",-1)),i(" "+l(((Tt=(_t=(kt=e.salesData)==null?void 0:kt.proposed_package)==null?void 0:_t.price_list_type)==null?void 0:Tt.amount)??"N/A"),1)]),s("div",null,[t[65]||(t[65]=s("strong",null,"Duration (days):",-1)),i(" "+l(((Ft=(It=(At=e.salesData)==null?void 0:At.proposed_package)==null?void 0:It.price_list_type)==null?void 0:Ft.duration)??"N/A"),1)]),s("div",null,[t[66]||(t[66]=s("strong",null,"Hunting Type:",-1)),i(" "+l(((Ot=(Et=(Nt=(qt=e.salesData)==null?void 0:qt.proposed_package)==null?void 0:Nt.price_list_type)==null?void 0:Et.hunting_type)==null?void 0:Ot.name)??"N/A"),1)])]),t[68]||(t[68]=s("h3",null,"Species Included",-1)),s("ul",Ea,[(b(!0),A(Z,null,Os(((Bt=(Pt=($t=e.salesData)==null?void 0:$t.proposed_package)==null?void 0:Pt.sales_package)==null?void 0:Bt.species)??[],g=>{var U,M;return b(),A("li",{key:g.id},[i(l(((U=g.species)==null?void 0:U.name)??"N/A")+" ("+l(((M=g.species)==null?void 0:M.scientific_name)??"N/A")+"): ",1),s("strong",null,l(g.amount??"N/A"),1)])}),128))])]),s("section",Oa,[t[78]||(t[78]=s("h2",null,"Price Breakdown",-1)),s("div",$a,[s("div",null,[t[69]||(t[69]=s("strong",null,"Total Amount:",-1)),i(" "+l(((jt=(Rt=(Mt=(Ut=e.salesData)==null?void 0:Ut.price_break_down)==null?void 0:Mt.total_amount)==null?void 0:Rt.currency)==null?void 0:jt.symbol)??"N/A")+" "+l(((Ht=(zt=(Lt=e.salesData)==null?void 0:Lt.price_break_down)==null?void 0:zt.total_amount)==null?void 0:Ht.amount)??"N/A"),1)]),s("div",null,[t[70]||(t[70]=s("strong",null,"Companion Cost:",-1)),s("div",null," Number of Companions: "+l(((xt=(Wt=(Qt=e.salesData)==null?void 0:Qt.price_break_down)==null?void 0:Wt.companion_cost_details)==null?void 0:xt.number_of_companions)??"N/A"),1),s("div",null," Cost per Companion: "+l(((Yt=(Xt=(Jt=(Kt=(Gt=e.salesData)==null?void 0:Gt.price_break_down)==null?void 0:Kt.companion_cost_details)==null?void 0:Jt.cost_per_companion)==null?void 0:Xt.currency)==null?void 0:Yt.symbol)??"N/A")+" "+l(((ss=(ts=(es=(Zt=e.salesData)==null?void 0:Zt.price_break_down)==null?void 0:es.companion_cost_details)==null?void 0:ts.cost_per_companion)==null?void 0:ss.amount)??"N/A"),1),s("div",null," Total Companion Cost: "+l(((is=(ns=(ls=(os=(as=e.salesData)==null?void 0:as.price_break_down)==null?void 0:os.companion_cost_details)==null?void 0:ls.total_companion_cost)==null?void 0:ns.currency)==null?void 0:is.symbol)??"N/A")+" "+l(((ms=(us=(ds=(rs=e.salesData)==null?void 0:rs.price_break_down)==null?void 0:ds.companion_cost_details)==null?void 0:us.total_companion_cost)==null?void 0:ms.amount)??"N/A"),1)]),s("div",null,[t[71]||(t[71]=s("strong",null,"Observer Cost:",-1)),s("div",null," Number of Observers: "+l(((fs=(cs=(ps=e.salesData)==null?void 0:ps.price_break_down)==null?void 0:cs.observer_cost_details)==null?void 0:fs.number_of_observers)??"N/A"),1),s("div",null," Cost per Observer: "+l(((bs=(vs=(hs=(gs=(ys=e.salesData)==null?void 0:ys.price_break_down)==null?void 0:gs.observer_cost_details)==null?void 0:hs.cost_per_observer)==null?void 0:vs.currency)==null?void 0:bs.symbol)??"N/A")+" "+l(((Ds=(Ss=(Cs=(Vs=e.salesData)==null?void 0:Vs.price_break_down)==null?void 0:Cs.observer_cost_details)==null?void 0:Ss.cost_per_observer)==null?void 0:Ds.amount)??"N/A"),1),s("div",null," Total Observer Cost: "+l(((As=(Ts=(_s=(ks=(ws=e.salesData)==null?void 0:ws.price_break_down)==null?void 0:ks.observer_cost_details)==null?void 0:_s.total_observer_cost)==null?void 0:Ts.currency)==null?void 0:As.symbol)??"N/A")+" "+l(((Ns=(qs=(Fs=(Is=e.salesData)==null?void 0:Is.price_break_down)==null?void 0:Fs.observer_cost_details)==null?void 0:qs.total_observer_cost)==null?void 0:Ns.amount)??"N/A"),1)])]),o(k,{class:"my-4"}),t[79]||(t[79]=s("h2",{class:"text-center text-lg font-bold"},"MORE INFORMATION",-1)),o(k,{class:"my-4"}),s("div",Pa,[s("div",Ba,[o(T,{class:"font-bold"},{default:y(()=>t[72]||(t[72]=[i("Companions")])),_:1})]),o(r,{size:"small",preset:"secondary",round:"","border-color":"primary",onClick:t[2]||(t[2]=g=>e._shCMd=!e._shCMd)},{default:y(()=>t[73]||(t[73]=[i(" Add companions ")])),_:1})]),o(D,{items:e.companions},null,8,["items"]),o(k,{class:"my-4"}),t[80]||(t[80]=s("h2",{class:"text-center text-lg font-bold"},"Safari Extras",-1)),o(k,{class:"my-4 va-divider--dashed"}),s("div",Ua,[t[75]||(t[75]=s("div",{class:"flex flex-col md:flex-row gap-2 justify-start"},[s("p",null,[s("strong",null,"Observers")])],-1)),o(r,{size:"small",round:"",preset:"secondary","border-color":"primary",onClick:t[3]||(t[3]=g=>e._shOMd=!e._shOMd)},{default:y(()=>t[74]||(t[74]=[i(" Add observers ")])),_:1})]),o(D,{items:e.observers},null,8,["items"]),o(k,{class:"my-4"}),s("div",Ma,[t[77]||(t[77]=s("div",{class:"flex flex-col md:flex-row gap-2 justify-start"},[s("p",null,[s("strong",null,"Safari Extras services")])],-1)),o(r,{preset:"primary",class:"mr-2 mb-2","border-color":"primary",round:"",icon:"add",size:"small",onClick:t[4]||(t[4]=g=>e._showSafariExtrasModal())},{default:y(()=>t[76]||(t[76]=[i(" Add Extras ")])),_:1})]),o(D,{items:e.clientSafariExtras},null,8,["items"])]),o(E,{modelValue:e.isOpened,"onUpdate:modelValue":t[22]||(t[22]=g=>e.isOpened=g),overlay:!0,size:"large","no-outside-dismiss":"","hide-default-actions":!0,"close-button":!0},{default:y(()=>{var g,U,M,Es;return[e.loading?(b(),q(_,{key:0,indeterminate:e.loading,class:"mb-4 mt-6"},null,8,["indeterminate"])):F("",!0),((U=(g=e.salesData)==null?void 0:g.status)==null?void 0:U.status)=="pending"?(b(),A(Z,{key:1},[s("div",Ra,[o(a,{modelValue:e.selection,"onUpdate:modelValue":t[5]||(t[5]=p=>e.selection=p),disabled:!0,"array-value":"provision_sales",label:"Signed Contract",class:"mb-6"},null,8,["modelValue"]),o(a,{modelValue:e.selection,"onUpdate:modelValue":t[6]||(t[6]=p=>e.selection=p),"array-value":"confirm",label:"Payment Document",class:"mb-6"},null,8,["modelValue"])]),s("div",ja,[s("div",La,[e.selection.includes("provision_sales")?(b(),A("div",za,[o(V,{modelValue:e.file,"onUpdate:modelValue":t[7]||(t[7]=p=>e.file=p),dropzone:"","upload-button-text":"Upload Signed Contract","drop-zone-text":"",color:"secondary","file-types":"application/pdf","max-size":1e6,"max-files":1},null,8,["modelValue"])])):F("",!0),e.selection.includes("confirm")?(b(),A("div",Ha,[o(V,{modelValue:e.payfile,"onUpdate:modelValue":t[8]||(t[8]=p=>e.payfile=p),"upload-button-text":"Upload Payment Document",dropzone:"",color:"secondary","drop-zone-text":"","file-types":"application/pdf","max-size":1e6,"max-files":1},null,8,["modelValue"])])):F("",!0)]),s("div",Qa,[e.selection.includes("confirm")?(b(),A("div",Wa,[o(L,{modelValue:e.paymentForm.date,"onUpdate:modelValue":t[9]||(t[9]=p=>e.paymentForm.date=p),label:"Transaction Date",placeholder:"Enter Transaction Date"},null,8,["modelValue"])])):F("",!0),e.selection.includes("confirm")?(b(),A("div",xa,[o(N,{modelValue:e.paymentForm.accountType,"onUpdate:modelValue":t[10]||(t[10]=p=>e.paymentForm.accountType=p),options:e.accountsOption,label:"Account",placeholder:"Select Account"},null,8,["modelValue","options"])])):F("",!0),e.selection.includes("confirm")?(b(),A("div",Ga,[o(O,{modelValue:e.paymentForm.reference_number,"onUpdate:modelValue":t[11]||(t[11]=p=>e.paymentForm.reference_number=p),label:"Reference Number",type:"text",placeholder:"Enter Reference Number"},null,8,["modelValue"])])):F("",!0),s("div",Ka,[o(O,{modelValue:e.paymentForm.amount,"onUpdate:modelValue":t[12]||(t[12]=p=>e.paymentForm.amount=p),label:"Amount",type:"text",placeholder:"Enter Amount"},null,8,["modelValue"])]),s("div",Ja,[o(N,{modelValue:e.paymentForm.currency_id,"onUpdate:modelValue":t[13]||(t[13]=p=>e.paymentForm.currency_id=p),options:e.currencyOptions,label:"Currency",placeholder:"Select Currency"},null,8,["modelValue","options"])])]),o(W,{modelValue:e.paymentForm.narration,"onUpdate:modelValue":t[14]||(t[14]=p=>e.paymentForm.narration=p),label:"Narration",type:"text",placeholder:"Enter Narration",class:"w-full h-full"},null,8,["modelValue"])])],64)):((Es=(M=e.salesData)==null?void 0:M.status)==null?void 0:Es.status)=="provision_sales"?(b(),A(Z,{key:2},[o(V,{modelValue:e.payfile,"onUpdate:modelValue":t[15]||(t[15]=p=>e.payfile=p),"upload-button-text":"Upload Payment Document",dropzone:"",color:"secondary","drop-zone-text":"","file-types":"application/pdf","max-size":1e6,"max-files":1},null,8,["modelValue"]),s("div",Xa,[s("div",Ya,[o(N,{modelValue:e.paymentForm.accountType,"onUpdate:modelValue":t[16]||(t[16]=p=>e.paymentForm.accountType=p),options:e.accountsOption,label:"Account",placeholder:"Select Account"},null,8,["modelValue","options"])]),s("div",Za,[o(O,{modelValue:e.paymentForm.amount,"onUpdate:modelValue":t[17]||(t[17]=p=>e.paymentForm.amount=p),label:"Amount",type:"text",placeholder:"Enter Amount"},null,8,["modelValue"])]),s("div",eo,[o(N,{modelValue:e.paymentForm.currency_id,"onUpdate:modelValue":t[18]||(t[18]=p=>e.paymentForm.currency_id=p),options:e.currencyOptions,label:"Currency",placeholder:"Select Currency"},null,8,["modelValue","options"])]),s("div",to,[o(L,{modelValue:e.paymentForm.date,"onUpdate:modelValue":t[19]||(t[19]=p=>e.paymentForm.date=p),label:"Transaction Date",placeholder:"Enter Transaction Date"},null,8,["modelValue"])]),s("div",so,[o(O,{modelValue:e.paymentForm.reference_number,"onUpdate:modelValue":t[20]||(t[20]=p=>e.paymentForm.reference_number=p),label:"Reference Number",type:"text",placeholder:"Enter Reference Number"},null,8,["modelValue"])]),o(W,{modelValue:e.paymentForm.narration,"onUpdate:modelValue":t[21]||(t[21]=p=>e.paymentForm.narration=p),label:"Narration",type:"text",placeholder:"Enter Narration",class:"w-full h-full"},null,8,["modelValue"])])],64)):F("",!0),s("div",null,[o(r,{disabled:e.loading,class:"mt-2",onClick:e.submit},{default:y(()=>t[81]||(t[81]=[i("Save")])),_:1},8,["disabled","onClick"])])]}),_:1},8,["modelValue"]),o(E,{modelValue:e._shCMd,"onUpdate:modelValue":t[23]||(t[23]=g=>e._shCMd=g),"close-button":!0,"hide-default-actions":!0},{default:y(()=>{var g;return[o(z,{"sales-inquiry-id":(g=e.salesData)==null?void 0:g.sales_inquiry.id},null,8,["sales-inquiry-id"])]}),_:1},8,["modelValue"]),o(E,{modelValue:e._shOMd,"onUpdate:modelValue":t[24]||(t[24]=g=>e._shOMd=g),"close-button":!0,"hide-default-actions":!0},{default:y(()=>{var g;return[o(H,{"sales-inquiry-id":(g=e.salesData)==null?void 0:g.sales_inquiry.id},null,8,["sales-inquiry-id"])]}),_:1},8,["modelValue"]),o(E,{modelValue:e._shM,"onUpdate:modelValue":t[25]||(t[25]=g=>e._shM=g),width:"60%",height:"80%","hide-default-actions":!0},{default:y(()=>[o(Q,{"table-selectable":!0,item:e.salesData.sales_inquiry},null,8,["item"])]),_:1},8,["modelValue"])])}const oo=le(pa,[["render",ao],["__scopeId","data-v-5323b135"]]),lo={components:{SalesConfirmationClientDetails:oo},data(){return{items:[],searchText:null,columns:[{key:"name",label:"Client",width:120},{key:"area",label:"Area",width:120},{key:"airport_name",label:"Airport",width:50},{key:"arrival",label:"Arrival",width:120},{key:"charter_in",label:"Charter In",width:120},{key:"charter_out",label:"Charter Out",width:80},{key:"status",label:"Status",width:120},{key:"actions",width:80}],viewDetails:!1,item:null,buttondisables:!0,downloadPdf:ie}},computed:{...Y(I,["results","loadingresults"])},mounted(){this.getSalesConfirmations()},methods:{...w(I,["getallSalesConfirmation"]),async getSalesConfirmations(){await this.getallSalesConfirmation()},onRowClick(e){this.item=e.selfitem,this.viewDetails=!0},gotBack(){this.viewDetails=!1,this.getSalesConfirmations()},getStatusColorForModal(e){switch(e){case"pending":return"warning";case"provision_sales":return"warning";case"confirmed":return"success";case"declined":return"danger";case"cancelled":return"danger";case"completed":return"primary";default:return"default"}},getbuttonTextBasedOnStatus(e){switch(e){case"pending":return"confirm";case"provision_sales":return"confirm";case"confirmed":return"view";case"declined":return this.buttondisables=!0,"View";case"cancelled":return"view";case"completed":return"View";default:return"default"}}}},no={class:"flex flex-col md:flex-row gap-2 mb-2 justify-between px-4 py-2"},io={class:"flex flex-col md:flex-row gap-2 justify-start"},ro={class:"flex justify-center items-center"};function uo(e,t,n,h,u,m){const r=d("VaButton"),S=d("SalesConfirmationClientDetails"),D=d("VaChip"),k=d("VaDataTable"),T=d("VaCard");return b(),q(T,null,{default:y(()=>[s("div",no,[s("div",io,[u.viewDetails?(b(),q(r,{key:0,class:"px-2 py-2",icon:"arrow_back",size:"small",onClick:t[0]||(t[0]=_=>m.gotBack())},{default:y(()=>t[1]||(t[1]=[i(" Go Back ")])),_:1})):F("",!0)])]),u.viewDetails?(b(),q(S,{key:0,"sales-data":u.item},null,8,["sales-data"])):(b(),q(k,{key:1,items:e.results,columns:u.columns,loading:e.loadingresults,onOnView:m.onRowClick},{"cell(status)":y(({value:_})=>[o(D,{color:m.getStatusColorForModal(_),size:"small"},{default:y(()=>[i(l(_),1)]),_:2},1032,["color"])]),"cell(actions)":y(({rowData:_})=>[s("div",ro,[o(r,{plain:"",color:"primary",class:"mr-2",onClick:a=>m.onRowClick(_)},{default:y(()=>[i(l(m.getbuttonTextBasedOnStatus(_.status)),1)]),_:2},1032,["onClick"]),o(r,{plain:"",icon:"download",onClick:a=>u.downloadPdf(_.selfitem.pdf)},null,8,["onClick"])])]),_:1},8,["items","columns","loading","onOnView"]))]),_:1})}const wo=le(lo,[["render",uo],["__scopeId","data-v-aa9bae9c"]]);export{wo as default};
//# sourceMappingURL=SalesConfirmation-C0tiWpPW.js.map
