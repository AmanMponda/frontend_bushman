{"version":3,"file":"price-list-store-kXDfM-Ev.js","sources":["../../src/stores/price-list-store.ts"],"sourcesContent":["import { defineStore } from 'pinia'\nimport axios from 'axios'\n// import { format } from 'date-fns'\n\nexport const usePriceListStore = defineStore('price-list', {\n  state: () => {\n    return {\n      itemsByHuntingType: [] as any,\n      priceList: [] as any,\n      salesPackages: [] as any,\n      packageOptions: [] as any,\n      latestPackage: null as any,\n      showModal: false,\n      loadingpackages: false,\n    }\n  },\n\n  actions: {\n    async getPriceList(\n      hunting_type_id: any = '',\n      area_id: any = '',\n      season_id: any = '',\n      min_amount: any = '',\n      max_amount: any = '',\n    ) {\n      const url = import.meta.env.VITE_APP_BASE_URL + import.meta.env.VITE_APP_PRICE_LIST\n\n      const params: any = {}\n      if (hunting_type_id !== '' && hunting_type_id !== null && hunting_type_id !== undefined)\n        params.hunting_type_id = hunting_type_id\n      if (area_id !== '' && area_id !== null && area_id !== undefined) params.area_id = area_id\n      if (season_id !== '' && season_id !== null && season_id !== undefined) params.season_id = season_id\n      if (min_amount !== '' && min_amount !== null && min_amount !== undefined) params.min_amount = min_amount\n      if (max_amount !== '' && max_amount !== null && max_amount !== undefined) params.max_amount = max_amount\n\n      console.log('API URL:', url, 'params:', params)\n\n      const config = {\n        method: 'get',\n        maxBodyLength: Infinity,\n        url: url,\n        params,\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      }\n\n      const response = await axios.request(config)\n      console.log('API response data:', response.data)\n\n      // Normalize response to always set an array on the store\n      const raw = response.data\n      const items = Array.isArray(raw) ? raw : raw?.data ?? []\n      if (Array.isArray(items) && items.length > 0) {\n        this.priceList = items\n      } else {\n        this.priceList = []\n      }\n\n      return response\n    },\n    async getPriceListByHuntingType(hunting_type_id: any = '', area_id: any = '', season_id: any = '') {\n      const url = import.meta.env.VITE_APP_BASE_URL + import.meta.env.VITE_APP_PRICE_LIST\n\n      const params: any = {}\n      if (hunting_type_id !== '' && hunting_type_id !== null && hunting_type_id !== undefined)\n        params.hunting_type_id = hunting_type_id\n      if (area_id !== '' && area_id !== null && area_id !== undefined) params.area_id = area_id\n      if (season_id !== '' && season_id !== null && season_id !== undefined) params.season_id = season_id\n\n      const config = {\n        method: 'get',\n        maxBodyLength: Infinity,\n        url: url,\n        params,\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      }\n      const response = await axios.request(config)\n\n      const raw = response.data\n      const items = Array.isArray(raw) ? raw : raw?.data ?? []\n      this.itemsByHuntingType = items\n      return response\n    },\n\n    async getPriceListById(id: any) {\n      const url = `${import.meta.env.VITE_APP_BASE_URL}${import.meta.env.VITE_APP_PRICE_LIST}${id}/`\n\n      console.log('Fetching price list detail, URL:', url)\n\n      const config = {\n        method: 'get',\n        maxBodyLength: Infinity,\n        url: url,\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      }\n\n      const response = await axios.request(config)\n      console.log('Price list detail response:', response.data)\n\n      return response\n    },\n\n    async updatePriceList(id: number, payload: any) {\n      const requestBody: any = {\n        area: payload.area,\n        hunting_type_id: payload.huntingTypeId,\n        sales_package_ids: payload.sales_package_ids,\n        description: payload.description,\n        sales_quota_id: payload.salesQuotaId,\n        amount: payload.amount,\n        currency: payload.currency,\n        duration: payload.duration,\n        companion_days: payload.companionDays,\n        companion_amount: payload.companionAmount,\n        observer_days: payload.observerDays,\n        observer_amount: payload.observerAmount,\n        season_id: payload.season_id,\n        start_date: payload.start_at,\n        end_date: payload.end_at,\n        is_active: payload.is_active,\n        area_id: payload.area_id,\n        user_id: payload.user_id,\n        species_object_list: payload.speciesObjectList,\n      }\n\n      // Add upgrade_fees only if provided\n      if (payload.upgrade_fees && payload.upgrade_fees.length > 0) {\n        requestBody.upgrade_fees = payload.upgrade_fees\n      }\n\n      const data = JSON.stringify(requestBody)\n\n      const config = {\n        method: 'put',\n        maxBodyLength: Infinity,\n        url: `${import.meta.env.VITE_APP_BASE_URL}${import.meta.env.VITE_APP_PRICE_LIST}${id}/`,\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        data: data,\n      }\n\n      const response = await axios.request(config)\n      return response\n    },\n\n    async deletePriceList(id: number, force: boolean = false) {\n      const url = `${import.meta.env.VITE_APP_BASE_URL}${import.meta.env.VITE_APP_PRICE_LIST}${id}/${\n        force ? '?force=true' : ''\n      }`\n\n      const config = {\n        method: 'delete',\n        maxBodyLength: Infinity,\n        url: url,\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      }\n\n      const response = await axios.request(config)\n      return response\n    },\n\n    async getSalesPackageList(usedAsOptions: boolean = false) {\n      this.loadingpackages = true\n      const config = {\n        method: 'get',\n        maxBodyLength: Infinity,\n        url: import.meta.env.VITE_APP_BASE_URL + import.meta.env.VITE_APP_SALES_PACKAGE_VSET_URL,\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      }\n\n      const response = await axios.request(config)\n      if (response.status === 200) {\n        this.loadingpackages = false\n        if (!usedAsOptions) {\n          this.salesPackages = response.data.map((item: any) => {\n            return {\n              id: item.id,\n              name: item.name,\n              area_name: item?.area?.name ?? 'N/A',\n              regulatory_package_name: item?.regulatory_package?.name ?? 'N/A',\n              selfItem: item,\n            }\n          })\n        } else {\n          this.latestPackage = {\n            value: response.data[0].id,\n            text: response.data[0].name,\n          }\n\n          this.packageOptions = response.data.map((item: { id: any; name: any }) => {\n            return {\n              value: item.id,\n              text: item.name,\n            }\n          })\n        }\n      }\n      return response\n    },\n\n    async createSalesPackage(payload: any) {\n      const data = JSON.stringify({\n        name: payload.name,\n        area_id: payload.areaId,\n        regulatory_package_id: payload.licenceId,\n        description: payload.description,\n        species_object_list: payload.speciesObjectList,\n      })\n\n      const config = {\n        method: 'post',\n        maxBodyLength: Infinity,\n        url: import.meta.env.VITE_APP_BASE_URL + import.meta.env.VITE_APP_SALES_PACKAGE_VSET_URL,\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        data: data,\n      }\n\n      const response = await axios.request(config)\n      if (response.status === 201) {\n        this.showModal = false\n        this.getSalesPackageList()\n      }\n      return response\n    },\n\n    async updateSalesPackage(id: number, payload: any) {\n      const data = JSON.stringify({\n        name: payload.name,\n        area_id: payload.areaId,\n        regulatory_package_id: payload.licenceId,\n        description: payload.description,\n        species_object_list: payload.speciesObjectList,\n      })\n\n      const config = {\n        method: 'put',\n        maxBodyLength: Infinity,\n        url: import.meta.env.VITE_APP_BASE_URL + import.meta.env.VITE_APP_SALES_PACKAGE_VSET_URL + id + '/',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        data: data,\n      }\n\n      const response = await axios.request(config)\n      if (response.status === 200) {\n        this.getSalesPackageList()\n      }\n      return response\n    },\n\n    async deleteSalesPackage(id: number, force: boolean = false) {\n      const url =\n        import.meta.env.VITE_APP_BASE_URL +\n        import.meta.env.VITE_APP_SALES_PACKAGE_VSET_URL +\n        id +\n        '/' +\n        (force ? '?force=true' : '')\n\n      const config = {\n        method: 'delete',\n        maxBodyLength: Infinity,\n        url: url,\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      }\n\n      const response = await axios.request(config)\n      if (response.status === 200 || response.status === 204) {\n        this.getSalesPackageList()\n      }\n      return response\n    },\n\n    async createPriceList(payload: any) {\n      // const startDate = payload?.startDate ? format(new Date(payload.startDate), 'yyyy-MM-dd') : null\n      // const endDate = payload?.endDate ? format(new Date(payload.endDate), 'yyyy-MM-dd') : null\n      const requestBody: any = {\n        area: payload.area,\n        hunting_type_id: payload.huntingTypeId,\n        sales_package_ids: payload.sales_package_ids,\n        description: payload.description,\n        sales_quota_id: payload.salesQuotaId,\n        amount: payload.amount,\n        currency: payload.currency,\n        duration: payload.duration,\n        companion_days: payload.companionDays,\n        companion_amount: payload.companionAmount,\n        observer_days: payload.observerDays,\n        observer_amount: payload.observerAmount,\n        season_id: payload.season_id,\n        start_date: payload.start_at,\n        end_date: payload.end_at,\n        is_active: payload.is_active,\n        area_id: payload.area_id,\n        user_id: payload.user_id,\n        species_object_list: payload.speciesObjectList,\n      }\n\n      // Add upgrade_fees only if provided\n      if (payload.upgrade_fees && payload.upgrade_fees.length > 0) {\n        requestBody.upgrade_fees = payload.upgrade_fees\n      }\n\n      const data = JSON.stringify(requestBody)\n\n      const config = {\n        method: 'post',\n        maxBodyLength: Infinity,\n        url: import.meta.env.VITE_APP_BASE_URL + import.meta.env.VITE_APP_CREATE_PRICE_LIST,\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        data: data,\n      }\n\n      const response = await axios.request(config)\n      return response\n    },\n\n    async getCompletePriceListPdf(\n      hunting_type_id: any = '',\n      area_id: any = '',\n      season_id: any = '',\n      min_amount: any = '',\n      max_amount: any = '',\n    ) {\n      const url = import.meta.env.VITE_APP_BASE_URL + import.meta.env.VITE_APP_PRICE_LIST\n\n      const params: any = {}\n      if (hunting_type_id !== '' && hunting_type_id !== null && hunting_type_id !== undefined)\n        params.hunting_type_id = hunting_type_id\n      if (area_id !== '' && area_id !== null && area_id !== undefined) params.area_id = area_id\n      if (season_id !== '' && season_id !== null && season_id !== undefined) params.season_id = season_id\n      if (min_amount !== '' && min_amount !== null && min_amount !== undefined) params.min_amount = min_amount\n      if (max_amount !== '' && max_amount !== null && max_amount !== undefined) params.max_amount = max_amount\n\n      const config = {\n        method: 'get',\n        maxBodyLength: Infinity,\n        url: url,\n        params,\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      }\n\n      const response = await axios.request(config)\n      return response\n    },\n  },\n})\n"],"names":["usePriceListStore","defineStore","hunting_type_id","area_id","season_id","min_amount","max_amount","url","params","config","response","axios","raw","items","id","payload","requestBody","data","force","usedAsOptions","item","_a","_b"],"mappings":"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"}