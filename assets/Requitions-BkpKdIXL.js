import{j as z,k as C,d as E,m as b,l as k,s as D,v as M,_ as $,g as q,b as o,w as m,e as f,i as a,h as V,o as c,a as v,x as S,F as w,q as Q,t as L,H,I as J,A as W,B as Y,D as K,y as X}from"./index-BOLhL9Zf.js";import{f as T}from"./format-Cn4G_mmc.js";import{u as U}from"./useForm-8rV_bshE.js";import{u as N}from"./useToast-DQfdZK_y.js";import{u as j}from"./settings-store-CEOCrJYv.js";import{u as P}from"./account-store-Ckp9NqQu.js";import{h as O}from"./errorHandler-BXe9Gc4p.js";import{u as B}from"./approval-store-CMSAWsZ6.js";const Z=e=>{var t,n,i,r,y,l,d,h;if(e.current_level_status){const g=e.current_level_status;if(g.status==="PENDING")return`Waiting to be ${(n=(t=g.level)==null?void 0:t.approval_chain_role)==null?void 0:n.past} by ${(r=(i=g.level)==null?void 0:i.approval_chain_role)==null?void 0:r.name}`;if(g.status==="IN_PROGRESS")return`Waiting to be ${(l=(y=e.next_level)==null?void 0:y.approval_chain_role)==null?void 0:l.past} by ${(h=(d=e.next_level)==null?void 0:d.approval_chain_role)==null?void 0:h.name}`}return e.status},F=z("requisition-store",{state:()=>({requisitions:[],requistionItems:[],loadingRequisitions:!1,loadingRequistionItems:!1,showApprovalModal:!1}),actions:{async getRequisitions(){this.loadingRequisitions=!0;const t={method:"get",maxBodyLength:1/0,url:"https://backend-bushman-master-kxhmlj.laravel.cloud/api/v1.0/requisition/requisition-vset/",headers:{"Content-Type":"application/json"}},n=await C.request(t);return n.status===200&&(this.loadingRequisitions=!1,this.requisitions=n.data.map(i=>({status:Z(i),requested_at:T(i.date,"MMM dd yyyy"),required_date:T(i.required_date,"MMM dd yyyy"),requested_by:i.requested_by.first_name===""&&i.requested_by.last_name===""?i.requested_by.username:i.requested_by.first_name+""+i.requested_by.last_name,type:i.type,selfItem:i,main_status:i.status}))),n},async getRequistionItems(e){this.loadingRequistionItems=!0;const n={method:"get",maxBodyLength:1/0,url:`https://backend-bushman-master-kxhmlj.laravel.cloud/api/v1.0/requisition/requisition-item-vset/?requisition_id=${e}`,headers:{"Content-Type":"application/json"}},i=await C.request(n);return i.status===200&&(this.loadingRequistionItems=!1,this.requistionItems=i.data.map(r=>({item_name:r.name,accounts:r.accounts,items:r.items}))),i.data},async createRequisition(e){const t="https://backend-bushman-master-kxhmlj.laravel.cloud/api/v1.0/requisition/requisition-vset/",n=JSON.stringify({approval_chain_module_id:e.approval_chain_module_id,type:e.type,level_id:e.level_id,date:T(new Date,"yyyy-MM-dd"),required_date:T(new Date,"yyyy-MM-dd"),remarks:e.remarks}),i={method:"post",maxBodyLength:1/0,url:t,headers:{"Content-Type":"application/json"},data:n};return await C.request(i)},async updateRequisitionStatus(e){const t=JSON.stringify({requisition_id:e.requisition_id,level_id:e.level_id,remarks:e.remarks,status:e.status}),i={method:"put",maxBodyLength:1/0,url:"https://backend-bushman-master-kxhmlj.laravel.cloud/api/v1.0/requisition/requisition-vset/",headers:{"Content-Type":"application/json"},data:t},r=await C.request(i);return r.status===200&&(this.showApprovalModal=!1,this.getRequisitions()),r},async createRequisitionItem(e){const t="https://backend-bushman-master-kxhmlj.laravel.cloud/api/v1.0/requisition/requisition-item-vset/",n=JSON.stringify({requisition_id:e.requisition_id,source_type:e.source_type,currency_id:e.currency_id,account_id:e.account_id,mode_of_payment_id:e.mode_of_payment_id,remarks:e.remarks,item_name:e.item_name,items:e.items,amount:e.amount}),i={method:"post",maxBodyLength:1/0,url:t,headers:{"Content-Type":"application/json"},data:n};return await C.request(i)}}}),x=E({components:{},props:{item:{type:Object,required:!0}},setup(){const{init:e}=N(),t=D(),n=D(),i=M({source_type:null,currency_id:null,account_id:null,mode_of_payment_id:null,remarks:"",item_name:"",amount:null}),r=M({name:"",exchange_rate:null,unit_of_measurement_id:null,quantity:1,currency_id:null,rate:null,descriptions:""}),{isValid:y,validate:l,resetValidation:d,reset:h}=U(n),{isValid:g,validate:p,resetValidation:u,reset:s}=U(t);return{requisitionItemForm:i,formRef:t,isValidForm:g,validateForm:p,resetValidationForm:u,sourceTypeOptions:[{value:"CASH",text:"CASH"},{value:"STORE",text:"STORE"},{value:"VENDOR",text:"VENDOR"}],paymentOptions:[{value:"CASH",text:"CASH"},{value:"TT",text:"TT"},{value:"CREDIT",text:"CREDIT"}],init:e,resetForm:s,itemsForm:r,isValidIform:y,validateIform:l,resetValidationIform:d,resetIform:h}},data(){return{addingitems:[],itemsFormColumns:[{label:"Item Name",key:"name",sortable:!0},{label:"Currency",key:"currency_id",sortable:!0},{label:"Exchange Rate",key:"exchange_rate",sortable:!0},{label:"Unit of Measurement",key:"unit_of_measurement_text",sortable:!0},{label:"Quantity",key:"quantity",sortable:!0},{label:"Rate",key:"rate",sortable:!0},{label:"Descriptions",key:"descriptions",sortable:!0},{label:"Actions",key:"actions",sortable:!1}],saving:!1,currencyOptions:[]}},computed:{...k(j,["currencies","units"]),...k(P,["companyAccounts"])},mounted(){this.getCurrencies(),this.getUnits(),this.getCompanyAccounts()},methods:{...b(j,["getCurrencies","getUnits"]),...b(P,["getCompanyAccounts"]),...b(F,["createRequisitionItem"]),async submit(){const e={requisition_id:this.item.id,currency_id:this.requisitionItemForm.currency_id.value,account_id:this.requisitionItemForm.account_id.value,source_type:this.requisitionItemForm.source_type.value,mode_of_payment_id:this.requisitionItemForm.mode_of_payment_id.value,remarks:this.requisitionItemForm.remarks,item_name:this.requisitionItemForm.item_name,items:this.addingitems,amount:this.requisitionItemForm.amount};this.saving=!0;try{(await this.createRequisitionItem(e)).status===201?(this.saving=!1,this.init({message:"Requisition Item Created",color:"success"}),this.resetForm(),this.resetIform(),this.resetValidationForm(),this.resetValidationIform(),this.addingitems=[]):(this.saving=!1,this.init({message:"Something went wrong",color:"danger"}))}catch(t){this.saving=!1,this.saving=!1;const n=O(t.response);this.init({message:`
`+n.map((i,r)=>`${r+1}. ${i}`).join(`
`),color:"danger"})}},addTempSubItemList(){this.addingitems.push({name:this.itemsForm.name,exchange_rate:this.itemsForm.exchange_rate,unit_of_measurement_id:this.itemsForm.unit_of_measurement_id.value,unit_of_measurement_text:this.itemsForm.unit_of_measurement_id.text,quantity:this.itemsForm.quantity,rate:this.itemsForm.rate,currency_id:this.itemsForm.currency_id.value,descriptions:this.itemsForm.descriptions})},deleteTempSubItemList(e){this.addingitems.splice(e,1)}}}),ee={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},te={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},se={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},oe={class:"grid grid-cols-1 md:grid-cols-1 gap-4 mb-4 bordered-items-form"},ie={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4"},ae={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},ne={class:"grid grid-cols-1 md:grid-cols-1 gap-4 mb-4"};function re(e,t,n,i,r,y){const l=a("VaInput"),d=a("VaSelect"),h=a("VaTextarea"),g=a("VaForm"),p=a("VaButton"),u=a("VaDataTable");return c(),q("div",null,[o(g,{ref:"formRef"},{default:m(()=>[f("div",ee,[o(l,{modelValue:e.requisitionItemForm.item_name,"onUpdate:modelValue":t[0]||(t[0]=s=>e.requisitionItemForm.item_name=s),label:"Main Item Name",placeholder:"Item category Name",type:"text",required:"",rules:[s=>!!s||"Item Name is required"]},null,8,["modelValue","rules"]),o(d,{modelValue:e.requisitionItemForm.source_type,"onUpdate:modelValue":t[1]||(t[1]=s=>e.requisitionItemForm.source_type=s),placeholder:"Source Type",label:"Source Type",options:e.sourceTypeOptions,required:"",rules:[s=>!!s||"Source Type is required"]},null,8,["modelValue","options","rules"])]),f("div",te,[o(d,{modelValue:e.requisitionItemForm.account_id,"onUpdate:modelValue":t[2]||(t[2]=s=>e.requisitionItemForm.account_id=s),placeholder:"Account ID",options:e.companyAccounts,label:"Account ID",type:"number",required:"",rules:[s=>!!s||"Account ID is required"]},null,8,["modelValue","options","rules"]),o(l,{modelValue:e.requisitionItemForm.amount,"onUpdate:modelValue":t[3]||(t[3]=s=>e.requisitionItemForm.amount=s),label:"Total items Amount",placeholder:"Total items Amount",type:"number",required:"",rules:[s=>!!s||"Amount is required"]},null,8,["modelValue","rules"]),o(d,{modelValue:e.requisitionItemForm.mode_of_payment_id,"onUpdate:modelValue":t[4]||(t[4]=s=>e.requisitionItemForm.mode_of_payment_id=s),label:"Mode of Payment",placeholder:"Mode of Payment",options:e.paymentOptions,required:"",rules:[s=>!!s||"Mode of Payment is required"]},null,8,["modelValue","options","rules"])]),f("div",se,[o(d,{modelValue:e.requisitionItemForm.currency_id,"onUpdate:modelValue":t[5]||(t[5]=s=>e.requisitionItemForm.currency_id=s),placeholder:"Currency",label:"Currency",options:e.currencies,required:"",rules:[s=>!!s||"Currency is required"]},null,8,["modelValue","options","rules"]),o(h,{modelValue:e.requisitionItemForm.remarks,"onUpdate:modelValue":t[6]||(t[6]=s=>e.requisitionItemForm.remarks=s),label:"Remarks",type:"textarea",rows:3,placeholder:"Remarks",required:"",rules:[s=>!!s||"Remarks is required"]},null,8,["modelValue","rules"])])]),_:1},512),o(g,{ref:"iformRef"},{default:m(()=>[f("div",oe,[f("div",ie,[o(l,{modelValue:e.itemsForm.name,"onUpdate:modelValue":t[7]||(t[7]=s=>e.itemsForm.name=s),label:"Sub Item Name",rules:[s=>!!s||"Sub Item Name is required"],placeholder:"Sub Item Name"},null,8,["modelValue","rules"]),o(l,{modelValue:e.itemsForm.exchange_rate,"onUpdate:modelValue":t[8]||(t[8]=s=>e.itemsForm.exchange_rate=s),label:"Exchange Rate",placeholder:"Exchange Rate",type:"number",required:"",rules:[s=>!!s||"Exchange Rate is required"]},null,8,["modelValue","rules"]),o(l,{modelValue:e.itemsForm.rate,"onUpdate:modelValue":t[9]||(t[9]=s=>e.itemsForm.rate=s),label:"Rate",placeholder:"Rate",type:"number",required:""},null,8,["modelValue"]),o(d,{modelValue:e.itemsForm.currency_id,"onUpdate:modelValue":t[10]||(t[10]=s=>e.itemsForm.currency_id=s),placeholder:"Currency",label:"Currency",options:e.currencies,required:"",rules:[s=>!!s||"Currency is required"]},null,8,["modelValue","options","rules"])]),f("div",ae,[o(d,{modelValue:e.itemsForm.unit_of_measurement_id,"onUpdate:modelValue":t[11]||(t[11]=s=>e.itemsForm.unit_of_measurement_id=s),label:"Unit of Measurement",options:e.units,placeholder:"Unit of Measurement",required:"",rules:[s=>!!s||"Unit of Measurement is required"]},null,8,["modelValue","options","rules"]),o(l,{modelValue:e.itemsForm.quantity,"onUpdate:modelValue":t[12]||(t[12]=s=>e.itemsForm.quantity=s),label:"Quantity",placeholder:"Quantity",type:"number",required:"",rules:[s=>!!s||"Quantity is required"]},null,8,["modelValue","rules"])]),f("div",ne,[o(h,{modelValue:e.itemsForm.descriptions,"onUpdate:modelValue":t[13]||(t[13]=s=>e.itemsForm.descriptions=s),label:"Descriptions",type:"textarea",rows:2,placeholder:"Descriptions",rules:[s=>!!s||"Descriptions is required"]},null,8,["modelValue","rules"])]),o(p,{"border-color":"primary",round:"",preset:"secondary",onClick:t[14]||(t[14]=s=>e.addTempSubItemList())},{default:m(()=>t[16]||(t[16]=[V("Add Item")])),_:1}),o(u,{items:e.addingitems,columns:e.itemsFormColumns},{"cell(actions)":m(({rowData:s})=>[o(p,{preset:"plain",icon:"delete",onClick:I=>e.deleteTempSubItemList(s.index)},null,8,["onClick"])]),_:1},8,["items","columns"])])]),_:1},512),o(p,{type:"submit",icon:"save",loading:e.saving,disabled:!e.isValidForm||e.addingitems.length===0||e.saving,onClick:t[15]||(t[15]=s=>e.validateForm()&&e.submit())},{default:m(()=>t[17]||(t[17]=[V("Save")])),_:1},8,["loading","disabled"])])}const le=$(x,[["render",re],["__scopeId","data-v-8fc54d09"]]),ue={components:{ItemsForm:le},props:{rqItem:{type:Object,required:!0}},data(){return{isStriped:!0,isHoverable:!0,columns:[{key:"name",label:"Name"},{key:"quantity"},{key:"unit_of_measurement.name",label:"Unit"},{key:"exchange_rate"},{key:"rate",label:"Price"}],showForm:!1}},computed:{...k(F,["requistionItems","loadingRequistionItems"])},beforeMount(){},methods:{gotBack(){this.showForm=!1},showCreateForm(){this.showForm=!0},setShowAddForm(e){console.log(e)}}},me={class:"flex flex-col md:flex-row gap-2 mb-2 justify-between py-2"},de={class:"flex flex-col md:flex-row gap-2 justify-start"},pe={class:"py-6 font-bold capitalize"},ce={key:1,class:"text-center"};function fe(e,t,n,i,r,y){const l=a("VaButton"),d=a("VaButtonGroup"),h=a("ItemsForm"),g=a("VaListItemLabel"),p=a("VaDataTable"),u=a("VaListItemSection"),s=a("VaIcon"),I=a("VaListItem"),A=a("VaList");return c(),q(w,null,[f("div",me,[f("div",de,[r.showForm?(c(),v(l,{key:0,class:"px-2 py-2","border-color":"danger",round:"",preset:"secondary",icon:"close",size:"small",ico:"",onClick:t[0]||(t[0]=R=>y.gotBack())},{default:m(()=>t[1]||(t[1]=[V("Cancel")])),_:1})):S("",!0)]),r.showForm?S("",!0):(c(),v(d,{key:0},{default:m(()=>[o(l,{class:"px-2 py-2",label:"Add New Quota","border-color":"primary",round:"",preset:"secondary",icon:"add",size:"small",onClick:y.showCreateForm},{default:m(()=>t[2]||(t[2]=[V("Create Item")])),_:1},8,["onClick"])]),_:1}))]),r.showForm?(c(),v(h,{key:0,item:n.rqItem},null,8,["item"])):(c(),q(w,{key:1},[e.requistionItems.length!=0?(c(),v(A,{key:0},{default:m(()=>[(c(!0),q(w,null,Q(e.requistionItems,(R,_)=>(c(),v(I,{key:_,class:"list__item"},{default:m(()=>[o(u,null,{default:m(()=>[o(g,null,{default:m(()=>[f("b",pe,L(R.item_name),1)]),_:2},1024),o(p,{items:R.items,columns:r.columns,loading:e.loadingRequistionItems},null,8,["items","columns","loading"])]),_:2},1024),o(u,{icon:""},{default:m(()=>[o(s,{name:"remove_red_eye",color:"background-element"})]),_:1})]),_:2},1024))),128))]),_:1})):(c(),q("p",ce,"No Requistion Items Found"))],64))],64)}const ye=$(ue,[["render",fe]]),ge=E({name:"RequistionsForm",components:{VaForm:K,VaSelect:Y,VaButton:W,VaTextarea:J,VaDateInput:H},setup(){const{init:e}=N(),t=D(),n=M({requested_by:null,approval_chain_module_id:null,level_id:null,type:null,date:null,required_date:null,remarks:"",chainModuleSelected:!1}),{isValid:i,validate:r,resetValidation:y,reset:l}=U(t);return{formRef:t,form:n,isValidForm:i,resetValidationForm:y,resetForm:l,init:e,validateForm:r}},data(){return{saving:!1,TYPE:[{value:"GAME_REQ",text:"Game Requisition"},{value:"GENERAL",text:"General Requisition"}]}},computed:{...k(B,["approvalChainModules","approvalChainLevels"])},mounted(){this.getRequisitionsApprovalChain(!0)},methods:{...b(B,["getRequisitionsApprovalChain","getApprovalChainLevels"]),...b(F,["createRequisition"]),onApprovalChainModuleChange(e){e.value!==void 0&&this.getApprovalChainLevels(e.value)},async submitForm(){var t;const e={approval_chain_module_id:this.form.approval_chain_module_id.value,type:this.form.type.value,date:this.form.date,level_id:(t=this.form.level_id)==null?void 0:t.value,required_date:this.form.required_date,remarks:this.form.remarks};try{this.saving=!0,(await this.createRequisition(e)).status===201?(this.resetForm(),this.saving=!1,this.init({message:"Requisition created successfully",color:"success"})):(this.saving=!1,this.init({message:"Something went wrong",color:"warning"}))}catch(n){this.saving=!1;const i=O(n.response);this.init({message:`
`+i.map((r,y)=>`${y+1}. ${r}`).join(`
`),color:"danger"})}}}}),he={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},_e={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},ve={class:"grid grid-cols-1 md:grid-cols-1 gap-4 mb-4"},Ve={class:"mt-4 flex p-2"};function qe(e,t,n,i,r,y){const l=a("VaSelect"),d=a("VaDateInput"),h=a("VaTextarea"),g=a("VaButton"),p=a("VaForm");return c(),v(p,{ref:"formRef"},{default:m(()=>[f("div",he,[o(l,{modelValue:e.form.approval_chain_module_id,"onUpdate:modelValue":[t[0]||(t[0]=u=>e.form.approval_chain_module_id=u),e.onApprovalChainModuleChange],options:e.approvalChainModules,label:"Approval Chain",rules:[u=>!!u||"Approval Chain Module is required"]},null,8,["modelValue","options","rules","onUpdate:modelValue"]),o(l,{modelValue:e.form.level_id,"onUpdate:modelValue":t[1]||(t[1]=u=>e.form.level_id=u),options:e.approvalChainLevels,placeholder:"Select Level",label:"Set an initial approval(Optional)",type:"number",disabled:!e.form.approval_chain_module_id},null,8,["modelValue","options","disabled"])]),f("div",_e,[o(l,{modelValue:e.form.type,"onUpdate:modelValue":t[2]||(t[2]=u=>e.form.type=u),options:e.TYPE,placeholder:"Select Type",label:"Type"},null,8,["modelValue","options"]),o(d,{modelValue:e.form.date,"onUpdate:modelValue":t[3]||(t[3]=u=>e.form.date=u),label:"Date",rules:[u=>!!u||"Date is required"]},null,8,["modelValue","rules"]),o(d,{modelValue:e.form.required_date,"onUpdate:modelValue":t[4]||(t[4]=u=>e.form.required_date=u),label:"Required Date",rules:[u=>!!u||"Required Date is required"]},null,8,["modelValue","rules"])]),f("div",ve,[o(h,{modelValue:e.form.remarks,"onUpdate:modelValue":t[5]||(t[5]=u=>e.form.remarks=u),label:"Remarks",type:"textarea",rules:[u=>!!u||"Remarks is required"]},null,8,["modelValue","rules"])]),f("div",Ve,[o(g,{loading:e.saving,icon:"save",class:"mr-3 mb-2",disabled:!e.isValidForm,onClick:t[6]||(t[6]=u=>e.validateForm()&&e.submitForm())},{default:m(()=>t[7]||(t[7]=[V(" Save ")])),_:1},8,["loading","disabled"])])]),_:1},512)}const be=$(ge,[["render",qe],["__scopeId","data-v-77e9110b"]]),Fe=E({components:{},props:{item:{type:Object,required:!0}},setup(){const{init:e}=N(),t=D(),n=M({remarks:"",level_id:null,status:null}),i=[{value:"APPROVED",text:"Approved"},{value:"REJECTED",text:"Rejected"},{value:"IN_PROGRESS",text:"Viewed"}],{isValid:r,validate:y,resetValidation:l,reset:d}=U(t);return{form:n,formRef:t,isValidForm:r,validateForm:y,resetForm:d,resetValidationForm:l,init:e,statusOptions:i}},data(){return{saving:!1}},computed:{...k(B,["approvalChainLevels"])},mounted(){this.getApprovalChainLevels(this.item.approval_chain_module)},methods:{...b(F,["updateRequisitionStatus","getRequisitions"]),...b(B,["getApprovalChainLevels"]),async submit(){console.log(this.form);const e={requisition_id:this.item.id,level_id:this.form.level_id.value,status:this.form.status.value,remarks:this.form.remarks};this.saving=!0;try{(await this.updateRequisitionStatus(e)).status===200?(this.saving=!1,this.init({message:"Requisition status updated successfully",color:"success"}),this.resetForm()):(this.saving=!1,this.init({message:"Something went wrong",color:"danger"}),this.getRequisitions())}catch(t){this.saving=!1,this.saving=!1;const n=O(t.response);this.init({message:`
`+n.map((i,r)=>`${r+1}. ${i}`).join(`
`),color:"danger"})}}}}),ke={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},Ie={class:"grid grid-cols-1 md:grid-cols-1 gap-4 mb-4"};function Re(e,t,n,i,r,y){const l=a("VaSelect"),d=a("VaTextarea"),h=a("VaForm"),g=a("VaButton");return c(),q("div",null,[o(h,{ref:"formRef"},{default:m(()=>[f("div",ke,[o(l,{modelValue:e.form.level_id,"onUpdate:modelValue":t[0]||(t[0]=p=>e.form.level_id=p),label:"What is your Roles?",options:e.approvalChainLevels,placeholder:"Select you role",type:"text",required:"",rules:[p=>!!p||"Role is required"]},null,8,["modelValue","options","rules"]),o(l,{modelValue:e.form.status,"onUpdate:modelValue":t[1]||(t[1]=p=>e.form.status=p),label:"Status",options:e.statusOptions,type:"text",required:""},null,8,["modelValue","options"])]),f("div",Ie,[o(d,{modelValue:e.form.remarks,"onUpdate:modelValue":t[2]||(t[2]=p=>e.form.remarks=p),label:"Remarks",type:"textarea",rows:3,placeholder:"Remarks",required:"",rules:[p=>!!p||"Remarks is required"]},null,8,["modelValue","rules"])])]),_:1},512),o(g,{type:"submit",icon:"save",loading:e.saving,disabled:!e.isValidForm||e.saving,onClick:t[3]||(t[3]=p=>e.validateForm()&&e.submit())},{default:m(()=>t[4]||(t[4]=[V("Save")])),_:1},8,["loading","disabled"])])}const Ce=$(Fe,[["render",Re],["__scopeId","data-v-4ccb0215"]]),Se=E({components:{RequistionDetails:ye,UpdateRequistionForm:Ce,RequistionsForm:be},data(){return{items:[],columns:[{key:"type",label:"Requisition Type"},{key:"requested_by"},{key:"requested_at"},{key:"required_date"},{key:"status",name:"status",label:"Status"},{key:"actions",label:"Actions",sortable:!1}],showDetails:!1,showAddForm:!1,item:{}}},computed:{...k(F,["requisitions","loadingRequisitions"]),...X(F,{shM:"showApprovalModal"})},mounted(){this.getRequisitions()},methods:{...b(F,["getRequisitions","getRequistionItems"]),statusColor(e){switch(e){case"APPROVED":return"success";case"REJECTED":return"danger";default:return"warning"}},_showDetails(e){console.log(e),this.getRequistionItems(e.selfItem.id),this.item=e.selfItem,this.showDetails=!0},setShowAddForm(e){this.showAddForm=e},_shM(e){this.item=e.selfItem,this.shM=!0},goBack(){this.showDetails=!1,this.showAddForm=!1,this.getRequisitions()}}}),we={class:"flex flex-col md:flex-row gap-2 mb-2 justify-between px-4 py-2"},$e={class:"flex flex-col md:flex-row gap-2 justify-start"};function Ae(e,t,n,i,r,y){const l=a("VaButton"),d=a("VaButtonGroup"),h=a("RequistionDetails"),g=a("VaChip"),p=a("VaDataTable"),u=a("RequistionsForm"),s=a("VaCardContent"),I=a("VaCard"),A=a("UpdateRequistionForm"),R=a("VaModal");return c(),q(w,null,[o(I,null,{default:m(()=>[o(s,null,{default:m(()=>[f("div",we,[f("div",$e,[e.showDetails||e.showAddForm?(c(),v(l,{key:0,class:"px-2 py-2",icon:"arrow_back",size:"small",onClick:t[0]||(t[0]=_=>e.goBack())},{default:m(()=>t[3]||(t[3]=[V(" Go Back to Requisitions ")])),_:1})):S("",!0)]),o(d,null,{default:m(()=>[!e.showAddForm&&!e.showDetails?(c(),v(l,{key:0,class:"px-2 py-2",color:"primary",label:"Add New Quota",round:"",present:"secondary","border-color":"primary",icon:"add",size:"small",onClick:t[1]||(t[1]=()=>e.setShowAddForm(!0))},{default:m(()=>t[4]||(t[4]=[V("Create Requisition")])),_:1})):S("",!0)]),_:1})]),e.showDetails?(c(),v(h,{key:0,"rq-item":e.item},null,8,["rq-item"])):(c(),q(w,{key:1},[e.showAddForm?(c(),v(u,{key:1})):(c(),v(p,{key:0,items:e.requisitions,columns:e.columns,loading:e.loadingRequisitions},{"cell(status)":m(({value:_})=>[o(g,{size:"small",color:e.statusColor(_)},{default:m(()=>[V(L(_),1)]),_:2},1032,["color"])]),"cell(requested_by)":m(({value:_})=>[f("strong",null,L(_),1)]),"cell(actions)":m(({rowData:_})=>[o(l,{preset:"plain",icon:"visibility",class:"px-2",onClick:G=>e._showDetails(_)},null,8,["onClick"]),_.main_status==="PENDING"?(c(),v(l,{key:0,preset:"plain",icon:"published_with_changes",onClick:G=>e._shM(_)},null,8,["onClick"])):S("",!0)]),_:1},8,["items","columns","loading"]))],64))]),_:1})]),_:1}),o(R,{modelValue:e.shM,"onUpdate:modelValue":t[2]||(t[2]=_=>e.shM=_),"ok-text":"Apply","close-button":"",size:"small","hide-default-actions":!0},{default:m(()=>[o(A,{item:e.item},null,8,["item"])]),_:1},8,["modelValue"])],64)}const Oe=$(Se,[["render",Ae]]);export{Oe as default};
//# sourceMappingURL=Requitions-BkpKdIXL.js.map
