import{d as B,m as q,s as k,_ as R,g as C,e as s,b as o,i,w as d,F as L,o as b,l as Q,v as O,a as E,x as X,q as Y,h as p,t as v,y as T,z as ot,A as at,B as lt,C as nt,D as rt,c as it,E as dt,k as le}from"./index-BOLhL9Zf.js";import{u as M}from"./useForm-8rV_bshE.js";import{u as H}from"./useToast-DQfdZK_y.js";import{h as x}from"./errorHandler-BXe9Gc4p.js";import{f as ne,v as ut}from"./utils-BWc0LXoO.js";import{u as A}from"./sales-store-CwEwawkN.js";import{u as w}from"./settings-store-CEOCrJYv.js";import{u as re}from"./quota-store-y69W85j6.js";import{u as st}from"./price-list-store-D95PlDHx.js";import{u as mt}from"./regulatrory-store-BqCYuF_K.js";import{S as pt,C as ct,O as ft}from"./SalesClientSafariExtrasForm-BQNHAJ0K.js";import{u as et}from"./account-store-Ckp9NqQu.js";import{f as tt}from"./format-Cn4G_mmc.js";import{d as gt}from"./pdfDownloader-DiRJnS-k.js";import"./SafariExtrasForm-BDedQF0T.js";const yt=B({name:"SalesInquiriesList",emits:["download-btn-pressed","view-btn-pressed"],data(){return{loading:k(!1),columns:[{key:"id",label:"ID",width:80},{key:"name"},{key:"country"},{key:"nationality"},{key:"preference.preferred_date",label:"Preferred date",width:80},{key:"preference.start_date",label:"Start date",width:80},{key:"preference.end_date",label:"End date",width:80},{key:"actions",width:80}],salesInquiryItems:[],perPage:10,currentPage:1,filter:"",filtered:[],seasonValue:null,seasonOptions:[],dateValue:null,mothValue:null}},computed:{pages(){return this.perPage&&this.perPage!==0?Math.ceil(this.filtered.length/this.perPage):this.filtered.length}},mounted(){this.getSalesInquiryList(),this.getSeasonOptions()},methods:{...q(A,["getSalesInquiries"]),...q(w,["getSeasons"]),async getSalesInquiryList(){var t;this.loading=!0;try{const e=await this.getSalesInquiries(((t=this.seasonValue)==null?void 0:t.value)??"",this.dateValue??"");e.status===200&&(this.loading=!1,this.salesInquiryItems=e.data.map(r=>{var c,h,m,y,V,S,_,g,f;const a=((c=r==null?void 0:r.preferences)==null?void 0:c[0])||{};return{id:r.id,selfitem:r,name:(h=r==null?void 0:r.entity)==null?void 0:h.full_name,country:((y=(m=r==null?void 0:r.entity)==null?void 0:m.country)==null?void 0:y.name)||"N/A",nationality:((S=(V=r==null?void 0:r.entity)==null?void 0:V.nationality)==null?void 0:S.name)||"N/A",contacts:((g=(_=r==null?void 0:r.entity)==null?void 0:_.contacts)==null?void 0:g.map(n=>({id:n.id,name:n==null?void 0:n.contact,contactable:n==null?void 0:n.contactable})))||[],preference:{no_of_hunters:(a==null?void 0:a.no_of_hunters)||0,no_of_observers:(a==null?void 0:a.no_of_observers)||0,no_of_days:(a==null?void 0:a.no_of_days)||0,no_of_companions:(a==null?void 0:a.no_of_companions)||0,special_requests:(a==null?void 0:a.special_requests)||"",start_date:a!=null&&a.start_date?ne(a.start_date):"",end_date:a!=null&&a.end_date?ne(a.end_date):"",budget_estimation:(a==null?void 0:a.budget_estimation)||"",prev_experience:(a==null?void 0:a.prev_experience)||"",preferred_date:a!=null&&a.preferred_date?ne(a.preferred_date):"",accommodation_type:(a==null?void 0:a.accommodation_type)||"",payment_method:(a==null?void 0:a.payment_method)||""},preferred_species:((f=r==null?void 0:r.preferred_species)==null?void 0:f.map(n=>{var u;return{id:n==null?void 0:n.id,name:(u=n==null?void 0:n.species)==null?void 0:u.name,quantity:n==null?void 0:n.quantity}}))||[]}}),this.filtered=this.salesInquiryItems)}catch(e){this.loading=!1,console.log(e)}},async getSeasonOptions(){const t=await this.getSeasons();t.status===200&&(this.seasonOptions=t.data.map(e=>({value:e.id,text:e.name})))},btnDownloadClicked(t){console.log(t),this.$emit("download-btn-pressed",t)},btnViewClicked(t){console.log(t),this.$emit("view-btn-pressed",t)}}}),Vt={class:"grid sm:grid-cols-3 gap-6 mb-6"},ht={colspan:"6"},bt={class:"flex justify-center mt-4"};function vt(t,e,r,a,c,h){const m=i("VaSelect"),y=i("VaDateInput"),V=i("VaInput"),S=i("VaButton"),_=i("VaPagination"),g=i("VaDataTable");return b(),C(L,null,[s("div",Vt,[o(m,{modelValue:t.seasonValue,"onUpdate:modelValue":[e[0]||(e[0]=f=>t.seasonValue=f),t.getSalesInquiryList],options:t.seasonOptions,placeholder:"Filter By Season"},null,8,["modelValue","options","onUpdate:modelValue"]),o(y,{modelValue:t.dateValue,"onUpdate:modelValue":[e[1]||(e[1]=f=>t.dateValue=f),t.getSalesInquiryList],placeholder:"Filter By Date",clearable:""},null,8,["modelValue","onUpdate:modelValue"]),o(V,{modelValue:t.filter,"onUpdate:modelValue":[e[2]||(e[2]=f=>t.filter=f),t.getSalesInquiryList],placeholder:"Search",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),o(g,{striped:"",loading:t.loading,items:t.salesInquiryItems,columns:t.columns,"per-page":t.perPage,"current-page":t.currentPage,filter:t.filter,onFiltered:e[4]||(e[4]=f=>t.filtered=f.items)},{"cell(actions)":d(({rowData:f})=>[o(S,{preset:"plain",icon:"visibility",class:"mr-2",onClick:n=>t.btnViewClicked(f)},null,8,["onClick"]),o(S,{preset:"plain",icon:"download",onClick:n=>t.btnDownloadClicked(f)},null,8,["onClick"])]),bodyAppend:d(()=>[s("tr",null,[s("td",ht,[s("div",bt,[o(_,{modelValue:t.currentPage,"onUpdate:modelValue":e[3]||(e[3]=f=>t.currentPage=f),pages:t.pages},null,8,["modelValue","pages"])])])])]),_:1},8,["loading","items","columns","per-page","current-page","filter"])],64)}const St=R(yt,[["render",vt]]),_t=B({props:{item:{type:Object,required:!0}},setup(){const{init:t}=H(),e=k(null),{isValid:r,validate:a,resetValidation:c,reset:h}=M(e),m=k(!0),y=S=>{console.log(S),(S.value=="prior"||S.value=="after")&&(m.value=!1)},V=O({airport_name:null,charter_in:null,charter_out:null,arrival:null,installment_narration:null,installment_due_amount:null,installment_amount_type:null,installment_due_days:0,due_days_type:null});return{iformRef:e,isValidForm:r,validateForm:a,resetValidationForm:c,resetForm:h,form:V,init:t,onInputChange:y,isNotUpBookingSelected:m}},data(){return{packages:[],installments:[],regulatoryPackages:[],saving:!1}},computed:{...Q(A,["priceBreakDown"])},mounted(){this.getPL(),this.getLicencePackages()},methods:{...q(A,["createSalesConfirmationFinalization"]),...q(st,["getPriceList","getSalesPackageList"]),...q(A,["getSalesPriceBreakdown","getObservers"]),...q(mt,["getRegulatoryPackages"]),async getPL(){const t=await this.getPriceList();t.status===200?this.packages=t.data.data.map(e=>({value:e.sales_package.id,text:(e==null?void 0:e.sales_package.name)+" - "+e.price_list_type.hunting_type.name})):console.log("Error getting price list")},createInstallmentList(){this.form.installment_narration&&this.form.installment_due_amount?this.installments.push({narration:this.form.installment_narration,amount:this.form.installment_due_amount,amount_type:this.form.installment_amount_type.value,days:this.form.installment_due_days,due_days_type:this.form.due_days_type.value}):this.init({message:"Add at least one installment plan",color:"warning"})},deleteInstallment(t){this.installments.splice(t,1)},async getSalesPriceBreakdownForClient(){const t={salesInquiryId:this.item.id,packageId:this.item.price_list.price_list.sales_package.id};await this.getSalesPriceBreakdown(t)},async onSubmit(){this.saving=!0;const t={charterIn:this.form.charter_in,charterOut:this.form.charter_out,arrival:this.form.arrival,airportName:this.form.airport_name,packageId:this.item.price_list.price_list.sales_package.id,salesInquiryId:this.item.id,regulatoryPackageId:this.item.price_list.price_list.sales_package.regulatory_package.id,installments:this.installments};try{const e=await this.createSalesConfirmationFinalization(t);e.status===201?(this.saving=!1,this.init({message:e.data.message,color:"success"}),this.resetForm(),this.resetValidationForm(),this.installments=[]):this.init({message:e.data.message,color:"error"})}catch(e){this.saving=!1;const r=x(e.response);this.init({message:`
`+r.map((a,c)=>`${c+1}. ${a}`).join(`
`),color:"danger"})}},async getLicencePackages(){try{const t=await this.getRegulatoryPackages();if(t.status===200){const e=t.data;this.regulatoryPackages=e.map(r=>({value:r.id,text:r.name}))}}catch(t){console.log(t)}}}}),kt={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4"},qt={class:"grid grid-cols-1 md:grid-cols-1 gap-4 mb-4"},Ct={class:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-4"},It={key:0,class:"mb-4"},Ft={class:"grid grid-cols-1 md:grid-cols-1 gap-4 mb-4"},Pt={class:"flex items-center"},$t={class:"va-table-responsive"},wt={class:"va-table va-table--striped"},At={class:"flex justify-end"};function Dt(t,e,r,a,c,h){const m=i("VaInput"),y=i("VaDateInput"),V=i("VaTextarea"),S=i("VaSelect"),_=i("VaButton"),g=i("VaForm"),f=i("VaCardContent"),n=i("VaCard");return b(),E(n,{class:"w-full"},{default:d(()=>[o(f,null,{default:d(()=>[o(g,{ref:"iformRef"},{default:d(()=>[e[14]||(e[14]=s("h3",{class:"font-bold text-lg mb-2"},"Main Hunter safari information",-1)),s("div",kt,[o(m,{modelValue:t.form.airport_name,"onUpdate:modelValue":e[0]||(e[0]=u=>t.form.airport_name=u),type:"text",placeholder:" Enter Airport Name",rules:[u=>u&&u.length>0||" Airport Name is required"],label:"Airport Name"},null,8,["modelValue","rules"]),o(y,{modelValue:t.form.arrival,"onUpdate:modelValue":e[1]||(e[1]=u=>t.form.arrival=u),placeholder:"Select Arrival Date",rules:[u=>u||"Arrival Date is required"],label:"Arrival Date"},null,8,["modelValue","rules"]),o(y,{modelValue:t.form.charter_in,"onUpdate:modelValue":e[2]||(e[2]=u=>t.form.charter_in=u),placeholder:"Choose charter in date",rules:[u=>u||"Arrival Date is required"],label:"Charter In Date"},null,8,["modelValue","rules"]),o(y,{modelValue:t.form.charter_out,"onUpdate:modelValue":e[3]||(e[3]=u=>t.form.charter_out=u),placeholder:"Choose charter out date",rules:[u=>u||"Arrival Date is required"],label:"Charter Out Date"},null,8,["modelValue","rules"])]),e[15]||(e[15]=s("h3",{class:"font-bold text-lg mb-2"}," Create Client Installment plan ",-1)),s("div",qt,[o(V,{modelValue:t.form.installment_narration,"onUpdate:modelValue":e[4]||(e[4]=u=>t.form.installment_narration=u),type:"text",placeholder:"Description",rules:[u=>u&&u.length>0||" Installment Description is required"]},null,8,["modelValue","rules"])]),s("div",Ct,[o(m,{modelValue:t.form.installment_due_amount,"onUpdate:modelValue":e[5]||(e[5]=u=>t.form.installment_due_amount=u),type:"number",label:"Amount",placeholder:"Amount",rules:[u=>u&&u>0||" Installment Amount is required"]},null,8,["modelValue","rules"]),o(S,{modelValue:t.form.installment_amount_type,"onUpdate:modelValue":[e[6]||(e[6]=u=>t.form.installment_amount_type=u),t.onInputChange],options:[{value:"PERCENT",text:"PERCENT"},{value:"LAPS",text:"LAPS "}],label:"Amount type",rules:[u=>u||"Due amoun type is required"],placeholder:"Select Due amount type"},null,8,["modelValue","rules","onUpdate:modelValue"]),o(m,{modelValue:t.form.installment_due_days,"onUpdate:modelValue":e[7]||(e[7]=u=>t.form.installment_due_days=u),type:"number",label:"Days",rules:[u=>u&&u>0||" Installment Days is required"],placeholder:"Days"},null,8,["modelValue","rules"]),o(S,{modelValue:t.form.due_days_type,"onUpdate:modelValue":[e[8]||(e[8]=u=>t.form.due_days_type=u),t.onInputChange],label:"Due days type",options:[{value:"UPON_SALES_CONFIRMATION",text:"UPON_SALES_CONFIRMATION"},{value:"PRIOR_SAFARI",text:"PRIOR_SAFARI "}],rules:[u=>u||"Due days type is required"],placeholder:"Select Due days type"},null,8,["modelValue","rules","onUpdate:modelValue"]),o(_,{icon:"add",onClick:e[9]||(e[9]=u=>t.createInstallmentList())})]),t.installments.length>0?(b(),C("div",It,[e[12]||(e[12]=s("h3",{class:"font-bold text-lg mb-2"},"Installment Plans",-1)),s("div",Ft,[s("div",Pt,[s("div",$t,[s("table",wt,[e[11]||(e[11]=s("thead",null,[s("tr",null,[s("th",null,"Description"),s("th",null,"Amount"),s("th",null,"installment In (PERCENT/LAPS)"),s("th",null,"Days"),s("th",null,"Due Days Limit"),s("th",null,"Actions")])],-1)),s("tbody",null,[(b(!0),C(L,null,Y(t.installments,u=>(b(),C("tr",{key:u.id},[s("td",null,v(u.narration),1),s("td",null,v(u.amount),1),s("td",null,v(u.amount_type),1),s("td",null,v(u.days),1),s("td",null,v(u.due_days_type),1),s("td",null,[o(_,{plain:"",icon:"delete",onClick:j=>t.deleteInstallment(u.id)},null,8,["onClick"])])]))),128))])])])])])])):X("",!0),s("div",At,[o(_,{save:"",icon:"save",loading:t.saving,disabled:!t.isValidForm||t.saving||t.installments.length<0,onClick:e[10]||(e[10]=u=>t.validateForm()&&t.onSubmit())},{default:d(()=>e[13]||(e[13]=[p(" save")])),_:1},8,["loading","disabled"])])]),_:1},512)]),_:1})]),_:1})}const Lt=R(_t,[["render",Dt],["__scopeId","data-v-48b7cc01"]]),Ut=B({components:{},setup(){const{init:t}=H(),e=k(),r=O({name:""}),{isValid:a,validate:c,resetValidation:h,reset:m}=M(e);return{formRef:e,isValidForm:a,validateForm:c,resetValidationForm:h,init:t,resetForm:m,form:r}},data(){},computed:{...T(w,{saving:"savingAccommodationType"})},methods:{...q(w,["createAccommodationType"]),async submit(){const t={name:this.form.name};try{(await this.createAccommodationType(t)).status===201?(this.init({message:"Accommodation Type Created Successfully",color:"success"}),this.resetForm()):this.init({message:"Error Creating Accommodation Type",color:"danger"})}catch(e){this.saving=!1;const r=x(e.response);this.init({message:`
`+r.map((a,c)=>`${c+1}. ${a}`).join(`
`),color:"danger"})}}}}),Et={class:"grid grid-cols-1 md:grid-cols-1 gap-4 mb-4"};function Ot(t,e,r,a,c,h){const m=i("VaInput"),y=i("VaForm"),V=i("VaButton");return b(),C(L,null,[o(y,{ref:"formRef"},{default:d(()=>[s("div",Et,[o(m,{modelValue:t.form.name,"onUpdate:modelValue":e[0]||(e[0]=S=>t.form.name=S),label:"Accommodation Type Name",placeholder:"Enter Accommodation Type Name",type:"text",required:"",rules:[S=>!!S||"This field is required"]},null,8,["modelValue","rules"])])]),_:1},512),o(V,{type:"submit",icon:"save",loading:t.saving,disabled:!t.isValidForm||t.saving,onClick:e[1]||(e[1]=S=>t.validateForm()&&t.submit())},{default:d(()=>e[2]||(e[2]=[p("Save")])),_:1},8,["loading","disabled"])],64)}const Nt=R(Ut,[["render",Ot],["__scopeId","data-v-917def3f"]]),Tt=B({components:{AccomodationTypeForm:Nt},props:{item:{type:Object,required:!0}},setup(){const{init:t}=H(),e=k(null),{isValid:r,validate:a,resetValidation:c,reset:h}=M(e),m=O({type_id:null,address_street:"",address_city:"",address_zipcode:"",entity_id:null,booking_number:"",check_in:"",check_out:"",account_id:null,amount:"",currency:null});return{init:t,form:m,formRef:e,isValidForm:r,validateForm:a,resetValidationForm:c,resetForm:h}},data(){return{}},computed:{...Q(w,["salesInquiryEntities","currencies","accommodationTypes"]),...Q(et,["companyAccounts"]),...T(w,{_shtyMd:"showAccommodationTypeModal"})},mounted(){this.getSalesInquiryEntities(this.item.id),this.getCompanyAccounts(),this.getCurrencies(),this.getAccommodationTypes(!0)},methods:{...q(w,["getSalesInquiryEntities","getCurrencies","getAccommodationTypes"]),...q(et,["getCompanyAccounts"]),...q(A,["createAccommodation"]),async submitForm(){const t=new Date(this.form.check_in),e=new Date(this.form.check_out),r={type_id:this.form.type_id.value,address_street:this.form.address_street,address_city:this.form.address_city,address_zipcode:this.form.address_zipcode,entity_id:this.form.entity_id.value,sales_inquiry_id:this.item.id,booking_number:this.form.booking_number,check_in:tt(t,"yyyy-MM-dd HH:mm:ss"),check_out:tt(e,"yyyy-MM-dd HH:mm:ss"),account_id:this.form.account_id.value,amount:this.form.amount,currency:this.form.currency.value};try{const a=await this.createAccommodation(r);a.status===201&&this.init({message:a.data.message,color:"success"})}catch(a){console.error(a);const c=x(a.response);this.init({message:`
`+c.map((h,m)=>`${m+1}. ${h}`).join(`
`),color:"danger"})}},_showModal(){this._shtyMd=!0}}}),Mt={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"};function Bt(t,e,r,a,c,h){const m=i("VaSelect"),y=i("VaIcon"),V=i("VaInput"),S=i("VaButton"),_=i("VaForm"),g=i("AccomodationTypeForm"),f=i("VaModal");return b(),C(L,null,[s("div",null,[o(_,{ref:"formRef",onSubmit:ot(t.submitForm,["prevent"])},{default:d(()=>[s("div",Mt,[s("div",null,[o(m,{modelValue:t.form.entity_id,"onUpdate:modelValue":e[0]||(e[0]=n=>t.form.entity_id=n),options:t.salesInquiryEntities,label:"Accommodation For?",placeholder:"Select client",required:"","required-mark":"",rules:[n=>!!n||"This field is required"]},null,8,["modelValue","options","rules"])]),s("div",null,[o(m,{modelValue:t.form.type_id,"onUpdate:modelValue":e[2]||(e[2]=n=>t.form.type_id=n),options:t.accommodationTypes,label:"Accommodation Type ",placeholder:"Enter type",required:"","required-mark":"",rules:[n=>!!n||"This field is required"]},{append:d(()=>[o(y,{name:"add",class:"ml-2",onClick:e[1]||(e[1]=n=>t._showModal())})]),_:1},8,["modelValue","options","rules"])]),s("div",null,[o(V,{modelValue:t.form.address_street,"onUpdate:modelValue":e[3]||(e[3]=n=>t.form.address_street=n),label:"Accommodation Street Address",placeholder:"Enter street address",required:"","required-mark":"",rules:[n=>!!n||"This field is required"]},null,8,["modelValue","rules"])]),s("div",null,[o(V,{modelValue:t.form.address_city,"onUpdate:modelValue":e[4]||(e[4]=n=>t.form.address_city=n),label:"Accommodation City",placeholder:"Enter city",required:"","required-mark":"",rules:[n=>!!n||"This field is required"]},null,8,["modelValue","rules"])]),s("div",null,[o(V,{modelValue:t.form.address_zipcode,"onUpdate:modelValue":e[5]||(e[5]=n=>t.form.address_zipcode=n),label:"Accommodation Zip Code",placeholder:"Enter zip code",required:"","required-mark":"",rules:[n=>!!n||"This field is required"]},null,8,["modelValue","rules"])]),s("div",null,[o(V,{modelValue:t.form.booking_number,"onUpdate:modelValue":e[6]||(e[6]=n=>t.form.booking_number=n),label:"Booking Number (Optional)",placeholder:"Enter booking number"},null,8,["modelValue"])]),s("div",null,[o(V,{modelValue:t.form.check_in,"onUpdate:modelValue":e[7]||(e[7]=n=>t.form.check_in=n),label:"Check In",placeholder:"Select check-in date",type:"datetime-local",required:"","required-mark":"",rules:[n=>!!n||"This field is required"]},null,8,["modelValue","rules"])]),s("div",null,[o(V,{modelValue:t.form.check_out,"onUpdate:modelValue":e[8]||(e[8]=n=>t.form.check_out=n),label:"Check Out",placeholder:"Select check-out date",type:"datetime-local",required:"","required-mark":"",rules:[n=>!!n||"This field is required",n=>new Date(n)>new Date(t.form.check_in)||"Check out date must be after check-in date"]},null,8,["modelValue","rules"])]),s("div",null,[o(m,{modelValue:t.form.account_id,"onUpdate:modelValue":e[9]||(e[9]=n=>t.form.account_id=n),options:t.companyAccounts,label:"Account",placeholder:"Select account",required:"","required-mark":"",rules:[n=>!!n||"This field is required"]},null,8,["modelValue","options","rules"])]),s("div",null,[o(V,{modelValue:t.form.amount,"onUpdate:modelValue":e[10]||(e[10]=n=>t.form.amount=n),label:"Amount",placeholder:"Enter amount",type:"number",required:"","required-mark":"",rules:[n=>n&&n>0||"Amount must be greater than zero"]},null,8,["modelValue","rules"])]),s("div",null,[o(m,{modelValue:t.form.currency,"onUpdate:modelValue":e[11]||(e[11]=n=>t.form.currency=n),label:"Currency",options:t.currencies,required:"","required-mark":"",rules:[n=>!!n||"This field is required"]},null,8,["modelValue","options","rules"])])]),o(S,{icon:"save",disabled:!t.isValidForm,onClick:e[12]||(e[12]=n=>t.validateForm()&&t.submitForm())},{default:d(()=>e[14]||(e[14]=[p("Save")])),_:1},8,["disabled"])]),_:1},8,["onSubmit"])]),o(f,{modelValue:t._shtyMd,"onUpdate:modelValue":e[13]||(e[13]=n=>t._shtyMd=n),title:"Accommodation Type",width:"600px","show-default-actions":!1},{default:d(()=>[o(g)]),_:1},8,["modelValue"])],64)}const Rt=R(Tt,[["render",Bt],["__scopeId","data-v-cc2115f4"]]),jt=B({components:{},setup(){const{init:t}=H(),e=k(),r=O({name:"",amount:null,currency_id:null,season_id:null,description:""}),{isValid:a,validate:c,resetValidation:h,reset:m}=M(e);return{formRef:e,isValidForm:a,validateForm:c,resetValidationForm:h,init:t,resetForm:m,form:r}},data(){},computed:{...Q(w,["salesChartersPriceList","salesInquiryEntities","seasons","currencies"]),...T(w,{saving:"savingSalesChartersPriceList"})},mounted(){this.getSeasons(!0),this.getCurrencies()},methods:{...q(w,["getSalesChartersPriceList","getSalesInquiryEntities","createSalesChartersPriceList","getSeasons","getCurrencies"]),async submit(){const t={name:this.form.name,amount:this.form.amount,currency_id:this.form.currency_id.value,season_id:this.form.season_id.value,description:this.form.description};try{const e=await this.createSalesChartersPriceList(t);e.status===201?(this.init({message:e.data.message,color:"success"}),this.resetForm()):this.init({message:"Something went wrong",color:"danger"})}catch(e){this.saving=!1;const r=x(e.response);this.init({message:`
`+r.map((a,c)=>`${c+1}. ${a}`).join(`
`),color:"danger"})}}}}),zt={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4"},Qt={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"};function Ht(t,e,r,a,c,h){const m=i("VaInput"),y=i("VaSelect"),V=i("VaTextarea"),S=i("VaForm"),_=i("VaButton");return b(),C(L,null,[o(S,{ref:"formRef"},{default:d(()=>[s("div",zt,[o(m,{modelValue:t.form.name,"onUpdate:modelValue":e[0]||(e[0]=g=>t.form.name=g),label:"Name",placeholder:"Item name",type:"text",required:"",rules:[g=>!!g||"Name is required"]},null,8,["modelValue","rules"]),o(m,{modelValue:t.form.amount,"onUpdate:modelValue":e[1]||(e[1]=g=>t.form.amount=g),label:"Amount",placeholder:"Item amount",type:"number",required:"",rules:[g=>!!g||"Amount is required"]},null,8,["modelValue","rules"]),o(y,{modelValue:t.form.currency_id,"onUpdate:modelValue":e[2]||(e[2]=g=>t.form.currency_id=g),options:t.currencies,label:"Entity",placeholder:"Select Entity",type:"text",required:"",rules:[g=>!!g||"Entity is required"]},null,8,["modelValue","options","rules"])]),s("div",Qt,[o(y,{modelValue:t.form.season_id,"onUpdate:modelValue":e[3]||(e[3]=g=>t.form.season_id=g),options:t.seasons,label:"Season",placeholder:"Select Season",type:"text",required:"",rules:[g=>!!g||"Season is required"]},null,8,["modelValue","options","rules"]),o(V,{modelValue:t.form.description,"onUpdate:modelValue":e[4]||(e[4]=g=>t.form.description=g),label:"Description",placeholder:"Item description",type:"text",required:"",rules:[g=>!!g||"Description is required"]},null,8,["modelValue","rules"])])]),_:1},512),o(_,{type:"submit",icon:"save",loading:t.saving,disabled:!t.isValidForm||t.saving,onClick:e[5]||(e[5]=g=>t.validateForm()&&t.submit())},{default:d(()=>e[6]||(e[6]=[p("Save")])),_:1},8,["loading","disabled"])],64)}const Gt=R(jt,[["render",Ht],["__scopeId","data-v-aca3584c"]]),Wt=B({components:{ChartersPriceListForm:Gt},props:{item:{type:Object,required:!0}},setup(){const{init:t}=H(),e=k(),r=O({charters_price_list_id:null,sales_inquiry_id:null,entity_id:null}),{isValid:a,validate:c,resetValidation:h,reset:m}=M(e);return{formRef:e,isValidForm:a,validateForm:c,resetValidationForm:h,init:t,resetForm:m,form:r}},data(){},computed:{...Q(w,["salesChartersPriceList","salesInquiryEntities"]),...T(A,{saving:"savingCharterPrices"}),...T(w,{_shCM:"showSalesChartersPriceListModal"})},mounted(){this.getSalesChartersPriceList(!0),this.getSalesInquiryEntities(this.item.id)},methods:{...q(w,["getSalesChartersPriceList","getSalesInquiryEntities"]),...q(A,["createChartersPrice"]),async submit(){const t={charters_price_list_id:this.form.charters_price_list_id.value,sales_inquiry_id:this.item.id,entity_id:this.form.entity_id.value};try{const e=await this.createChartersPrice(t);e.status===201?(this.init({message:e.data.message,color:"success"}),this.resetForm()):this.init({message:"Something went wrong",color:"danger"})}catch(e){this.saving=!1;const r=x(e.response);this.init({message:`
`+r.map((a,c)=>`${c+1}. ${a}`).join(`
`),color:"danger"})}},_showModal(){this._shCM=!0}}}),Zt={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"};function Jt(t,e,r,a,c,h){const m=i("VaIcon"),y=i("VaSelect"),V=i("VaForm"),S=i("VaButton"),_=i("ChartersPriceListForm"),g=i("VaModal");return b(),C(L,null,[o(V,{ref:"formRef"},{default:d(()=>[s("div",Zt,[o(y,{modelValue:t.form.charters_price_list_id,"onUpdate:modelValue":e[1]||(e[1]=f=>t.form.charters_price_list_id=f),options:t.salesChartersPriceList,label:"Charters Price List",placeholder:"Item category Name",type:"text",required:"",rules:[f=>!!f||"Item Name is required"]},{append:d(()=>[o(m,{name:"add",class:"ml-2",onClick:e[0]||(e[0]=f=>t._showModal())})]),_:1},8,["modelValue","options","rules"]),o(y,{modelValue:t.form.entity_id,"onUpdate:modelValue":e[2]||(e[2]=f=>t.form.entity_id=f),options:t.salesInquiryEntities,label:"Entity",placeholder:"Select Entity",type:"text",required:"",rules:[f=>!!f||"Entity is required"]},null,8,["modelValue","options","rules"])])]),_:1},512),o(S,{type:"submit",icon:"save",loading:t.saving,disabled:!t.isValidForm||t.saving,onClick:e[3]||(e[3]=f=>t.validateForm()&&t.submit())},{default:d(()=>e[5]||(e[5]=[p("Save")])),_:1},8,["loading","disabled"]),o(g,{modelValue:t._shCM,"onUpdate:modelValue":e[4]||(e[4]=f=>t._shCM=f),width:"50%",height:"80%",scrollable:!0},{default:d(()=>[o(_)]),_:1},8,["modelValue"])],64)}const Kt=R(Wt,[["render",Jt],["__scopeId","data-v-b00c2471"]]),Xt=B({name:"SalesConfirmationClientDetails",components:{SalesProposalForm:Lt,ObserversForm:ft,CompanionForm:ct,SalesClientSafariExtrasForm:pt,AccommodationForm:Rt,ChartersPriceForm:Kt},props:{item:{type:Object,required:!0}},setup(){const{init:t}=H(),e=k(null),r=k(null),a=k(null);return{observerScollRef:e,companionsScollRef:r,safariExtrasRef:a,scrollTo:h=>{console.log("Scroll View:",h),console.log("Section Ref El:",e.value),h?h.scrollIntoView({behavior:"smooth"}):console.error("View is null or undefined")},init:t}},data(){const t=k(),{isValid:e,validate:r,resetValidation:a,reset:c}=M(t),h=O({id:null,package_id:null,airport:null,departure:null,charters:null,arrival:null,hotel_booking:null});return{isValidForm:e,validateForm:r,resetValidationForm:a,resetForm:c,formRef:t,form:h,searchText:""}},computed:{...Q(A,["observers","companions","clientSafariExtras","accommodations","chartersPrices"]),...T(A,{_shM:"showSafariExtrasModal"}),...T(A,{_shAM:"showAccommodationModal"}),...T(A,{_shCM:"showChartersPriceModal"}),logo(){return w().logo}},mounted(){this.getObservers(this.item.id),this.getCompanions(this.item.id),this.getClienSafariExtras(this.item.id),this.getAccommodation(this.item.id),this.getChartersPrice(this.item.id)},methods:{...q(A,["getObservers","getCompanions"]),...q(A,["createsafariExtras","getClienSafariExtras","getAccommodation","getChartersPrice"]),formatDate(t){return t?new Date(t).toLocaleDateString():"Not provided"},safeArray(t){return t||[]},safeString(t,e="Not provided"){return t||e},gotBack(){},getOrsearchSalesInquiry(){},_showSafariExtrasModal(){this._shM=!0},_showAccommodationModal(){this._shAM=!0},_showChartersPriceModal(){this._shCM=!0}}}),Yt={class:"flex justify-end"},xt={class:"p-4 bg-gray-100 rounded-lg shadow-md"},es={class:"text-lg"},ts={class:"flex flex-col"},ss={class:"table-auto w-full mb-4 border-collapse"},os={key:0},as={class:"border px-4 py-2"},ls={class:"border px-4 py-2"},ns={class:"table-auto w-full border-collapse"},rs={key:0},is={class:"border px-4 py-2"},ds={class:"border px-4 py-2"},us={class:"custom-grabber"},ms={class:"p-6"},ps={ref:"observerScollRef"},cs={ref:"companionsScollRef"};function fs(t,e,r,a,c,h){const m=i("VaButton"),y=i("VaTitle"),V=i("VaDivider"),S=i("VaListItemContent"),_=i("VaListItem"),g=i("VaList"),f=i("VaDataTable"),n=i("VaIcon"),u=i("SalesProposalForm"),j=i("ObserversForm"),G=i("CompanionForm"),ee=i("VaSplit"),W=i("SalesClientSafariExtrasForm"),N=i("VaModal"),Z=i("AccommodationForm"),J=i("ChartersPriceForm");return b(),C(L,null,[s("div",Yt,[o(m,{preset:"primary",class:"mr-2 mb-2",round:"",icon:"add",size:"small",onClick:e[0]||(e[0]=I=>t._showChartersPriceModal())},{default:d(()=>e[8]||(e[8]=[p(" Add Charters Costs ")])),_:1}),o(m,{preset:"primary",class:"mr-2 mb-2",round:"",icon:"add",size:"small",onClick:e[1]||(e[1]=I=>t._showAccommodationModal())},{default:d(()=>e[9]||(e[9]=[p(" Add accommodation ")])),_:1}),o(m,{preset:"primary",class:"mr-2 mb-2",round:"",icon:"add",size:"small",onClick:e[2]||(e[2]=I=>t._showSafariExtrasModal())},{default:d(()=>e[10]||(e[10]=[p(" Add Safari Extras Services ")])),_:1}),o(m,{preset:"primary",class:"mr-2 mb-2",round:"",icon:"arrow_downward",size:"small",onClick:e[3]||(e[3]=I=>t.scrollTo(t.observerScollRef))},{default:d(()=>e[11]||(e[11]=[p(" Add Observers ")])),_:1}),o(m,{preset:"primary",class:"mr-2 mb-2",round:"",icon:"arrow_downward",size:"small",onClick:e[4]||(e[4]=I=>t.scrollTo(t.companionsScollRef))},{default:d(()=>e[12]||(e[12]=[p(" Add Companions ")])),_:1})]),o(ee,{class:"split-demo h-[40rem]",limits:[["30px","20rem"],[5,"any"]]},{start:d(()=>{var I,l,U,K,te,se,ae,$,F,P,ie,de,ue,me,pe,ce,fe,ge,ye,Ve,he,be,ve,Se,_e,ke,qe,Ce,Ie,Fe,Pe,$e,we,Ae,De,Le,Ue,Ee,Oe,Ne,Te,Me,Be,Re,je,ze,Qe,He,Ge,We,Ze,Je,Ke,Xe,Ye;return[s("div",xt,[o(y,{class:"font-bold text-xl mb-2"},{default:d(()=>e[13]||(e[13]=[p("Sales Inquiry Details")])),_:1}),s("h2",es,"Inquiry Code: "+v((I=t.item)==null?void 0:I.code),1),o(y,{class:"text-gray-600"},{default:d(()=>{var D;return[p("Created on: "+v(t.formatDate((D=t.item)==null?void 0:D.create_date)),1)]}),_:1}),o(V,{class:"my-4"}),s("div",ts,[o(y,{class:"font-bold"},{default:d(()=>e[14]||(e[14]=[p("Client Information")])),_:1}),s("p",null,[e[15]||(e[15]=s("strong",null,"Full Name:",-1)),p(" "+v(t.safeString((U=(l=t.item)==null?void 0:l.entity)==null?void 0:U.full_name)),1)]),s("p",null,[e[16]||(e[16]=s("strong",null,"Nationality:",-1)),p(" "+v(t.safeString((se=(te=(K=t.item)==null?void 0:K.entity)==null?void 0:te.nationality)==null?void 0:se.name)),1)]),s("p",null,[e[17]||(e[17]=s("strong",null,"Country:",-1)),p(" "+v(t.safeString((F=($=(ae=t.item)==null?void 0:ae.entity)==null?void 0:$.country)==null?void 0:F.name)),1)]),o(y,{class:"font-bold mt-4"},{default:d(()=>e[18]||(e[18]=[p("Contacts:")])),_:1}),o(g,null,{default:d(()=>{var D;return[(b(!0),C(L,null,Y(t.safeArray((D=t.item.entity)==null?void 0:D.contacts),(oe,z)=>(b(),E(_,{key:z},{default:d(()=>[o(S,null,{default:d(()=>[p(v(oe.contact),1)]),_:2},1024)]),_:2},1024))),128))]}),_:1}),o(V,{class:"my-4"}),o(y,{class:"font-bold"},{default:d(()=>e[19]||(e[19]=[p("Preference Information")])),_:1}),s("p",null,[e[20]||(e[20]=s("strong",null,"Preferred Date:",-1)),p(" "+v(t.formatDate((ie=(P=t.item)==null?void 0:P.preference)==null?void 0:ie.preferred_date)),1)]),s("p",null,[e[21]||(e[21]=s("strong",null,"No of Companions:",-1)),p(" "+v(t.safeString((ue=(de=t.item)==null?void 0:de.preference)==null?void 0:ue.no_of_companions.toString())),1)]),s("p",null,[e[22]||(e[22]=s("strong",null,"No of Observers:",-1)),p(" "+v(t.safeString((pe=(me=t.item)==null?void 0:me.preference)==null?void 0:pe.no_of_observers.toString())),1)]),s("p",null,[e[23]||(e[23]=s("strong",null,"Number of Days:",-1)),p(" "+v(t.safeString((fe=(ce=t.item)==null?void 0:ce.preference)==null?void 0:fe.no_of_days.toString())),1)]),o(V,{class:"my-4"}),o(y,{class:"font-bold"},{default:d(()=>e[24]||(e[24]=[p("Preferred Species")])),_:1}),s("table",ss,[e[26]||(e[26]=s("thead",null,[s("tr",null,[s("th",{class:"px-4 py-2 border-b"},"Species Name"),s("th",{class:"px-4 py-2 border-b"},"Quantity")])],-1)),s("tbody",null,[t.safeArray((ge=t.item)==null?void 0:ge.preferred_species).length===0?(b(),C("tr",os,e[25]||(e[25]=[s("td",{colspan:"2",class:"text-center"},"No preferred species listed.",-1)]))):X("",!0),(b(!0),C(L,null,Y(t.safeArray((ye=t.item)==null?void 0:ye.preferred_species),(D,oe)=>{var z,xe;return b(),C("tr",{key:oe},[s("td",as,v(t.safeString((z=D.species)==null?void 0:z.name)),1),s("td",ls,v(t.safeString((xe=D==null?void 0:D.quantity)==null?void 0:xe.toString())),1)])}),128))])]),o(y,{class:"font-bold"},{default:d(()=>e[27]||(e[27]=[p("Area Information")])),_:1}),s("table",ns,[e[29]||(e[29]=s("thead",null,[s("tr",null,[s("th",{class:"px-4 py-2 border-b"},"Area ID"),s("th",{class:"px-4 py-2 border-b"},"Area Name")])],-1)),s("tbody",null,[t.safeArray(t.item.area).length===0?(b(),C("tr",rs,e[28]||(e[28]=[s("td",{colspan:"2",class:"text-center"},"No area information available.",-1)]))):X("",!0),(b(!0),C(L,null,Y(t.safeArray(t.item.area),(D,oe)=>{var z;return b(),C("tr",{key:oe},[s("td",is,v(t.safeString(D.id.toString())),1),s("td",ds,v(t.safeString(((z=D.area)==null?void 0:z.name)||"Unnamed")),1)])}),128))])]),o(V,{class:"my-4"}),o(y,{class:"font-bold"},{default:d(()=>e[30]||(e[30]=[p("Price List Summary")])),_:1}),s("p",null,[e[31]||(e[31]=s("strong",null,"Package Name:",-1)),p(" "+v((ve=(be=(he=(Ve=t.item)==null?void 0:Ve.price_list)==null?void 0:he.price_list)==null?void 0:be.sales_package)==null?void 0:ve.name),1)]),o(V,{class:"my-4"}),o(y,{class:"font-bold"},{default:d(()=>e[32]||(e[32]=[p("License Package")])),_:1}),s("p",null,[e[33]||(e[33]=s("strong",null,"Name:",-1)),p(" "+v((qe=(ke=(_e=(Se=t.item)==null?void 0:Se.price_list)==null?void 0:_e.price_list)==null?void 0:ke.sales_package.regulatory_package)==null?void 0:qe.name),1)]),s("p",null,[e[34]||(e[34]=s("strong",null,"Duration:",-1)),p(" "+v(($e=(Pe=(Fe=(Ie=(Ce=t.item)==null?void 0:Ce.price_list)==null?void 0:Ie.price_list)==null?void 0:Fe.sales_package)==null?void 0:Pe.regulatory_package)==null?void 0:$e.duration)+" days ",1)]),o(V,{class:"my-4"}),o(y,{class:"font-bold"},{default:d(()=>e[35]||(e[35]=[p("Package Area Information")])),_:1}),s("p",null,[e[36]||(e[36]=s("strong",null,"Area Name:",-1)),p(" "+v((Ue=(Le=(De=(Ae=(we=t.item)==null?void 0:we.price_list)==null?void 0:Ae.price_list)==null?void 0:De.sales_package)==null?void 0:Le.area)==null?void 0:Ue.name),1)]),s("p",null,[e[37]||(e[37]=s("strong",null,"Description:",-1)),p(" "+v((Me=(Te=(Ne=(Oe=(Ee=t.item)==null?void 0:Ee.price_list)==null?void 0:Oe.price_list)==null?void 0:Ne.sales_package)==null?void 0:Te.area)==null?void 0:Me.description),1)]),o(V,{class:"my-4"}),o(y,{class:"font-bold"},{default:d(()=>e[38]||(e[38]=[p("Hunting Type")])),_:1}),s("p",null,[e[39]||(e[39]=s("strong",null,"Name:",-1)),p(" "+v((Qe=(ze=(je=(Re=(Be=t.item)==null?void 0:Be.price_list)==null?void 0:Re.price_list)==null?void 0:je.price_list_type)==null?void 0:ze.hunting_type)==null?void 0:Qe.name),1)]),s("p",null,[e[40]||(e[40]=s("strong",null,"Price:",-1)),p(" "+v((Ze=(We=(Ge=(He=t.item)==null?void 0:He.price_list)==null?void 0:Ge.price_list)==null?void 0:We.price_list_type)==null?void 0:Ze.currency)+" "+v((Ye=(Xe=(Ke=(Je=t.item)==null?void 0:Je.price_list)==null?void 0:Ke.price_list)==null?void 0:Xe.price_list_type)==null?void 0:Ye.amount),1)]),o(V,{class:"my-4"}),o(y,{class:"font-bold"},{default:d(()=>e[41]||(e[41]=[p("Companions")])),_:1}),o(f,{items:t.companions},null,8,["items"]),o(V,{class:"my-4"}),e[44]||(e[44]=s("p",null,[s("strong",null,"Observers")],-1)),o(f,{items:t.observers},null,8,["items"]),e[45]||(e[45]=s("p",null,[s("strong",null,"Other Safari Extras")],-1)),o(f,{items:t.clientSafariExtras},null,8,["items"]),o(V,{class:"my-4"}),o(y,{class:"font-bold"},{default:d(()=>e[42]||(e[42]=[p("Accommodation")])),_:1}),o(f,{items:t.accommodations},null,8,["items"]),o(V,{class:"my-4"}),o(y,{class:"font-bold"},{default:d(()=>e[43]||(e[43]=[p("Charters Price")])),_:1}),o(f,{items:t.chartersPrices},null,8,["items"])])])]}),grabber:d(()=>[s("div",us,[o(n,{name:"swap_horiz"})])]),end:d(()=>[s("div",ms,[o(u,{item:t.item},null,8,["item"])]),s("section",ps,[o(j,{"sales-inquiry-id":t.item.id},null,8,["sales-inquiry-id"])],512),s("section",cs,[o(G,{"sales-inquiry-id":t.item.id},null,8,["sales-inquiry-id"])],512)]),_:1}),o(N,{modelValue:t._shM,"onUpdate:modelValue":e[5]||(e[5]=I=>t._shM=I),width:"60%",height:"80%"},{default:d(()=>[o(W,{"table-selectable":!0,item:t.item},null,8,["item"])]),_:1},8,["modelValue"]),o(N,{modelValue:t._shAM,"onUpdate:modelValue":e[6]||(e[6]=I=>t._shAM=I),width:"60%",height:"80%"},{default:d(()=>[o(Z,{item:t.item},null,8,["item"])]),_:1},8,["modelValue"]),o(N,{modelValue:t._shCM,"onUpdate:modelValue":e[7]||(e[7]=I=>t._shCM=I),width:"60%",height:"80%"},{default:d(()=>[o(J,{item:t.item},null,8,["item"])]),_:1},8,["modelValue"])],64)}const gs=R(Xt,[["render",fs],["__scopeId","data-v-054a8c00"]]),ys=B({components:{Salesinquirieslist:St,VaForm:rt,VaInput:nt,VaSelect:lt,VaButton:at,SalesInquiryDetails:gs},setup(){const t=k(),e=k(),r=k(!1),a=k("add"),{isValid:c,validate:h,resetValidation:m,reset:y}=M(t),{isValid:V,validate:S,resetValidation:_,reset:g}=M(e),{init:f}=H(),n=k(!1),u=O({id:null,full_name:"",nick_name:"",country:null,nationality:null,category:null,email:"",phone:"",address:"",no_of_hunters:1,no_of_observers:0,priceListId:null,no_of_days:0,no_of_companions:0,species:null,quantity:0,area:null,season:null,preferred_date:null,id_number:"",start_date:null,end_date:null}),j=O({id:null,client_id:null,contact:"",contact_type:null,contactable:!1}),G=()=>{r.value=!0},ee=()=>{r.value=!1,n.value=!1},W=k([]),N=k([]),Z=k([]),J=k([]),I=k([]),l=k(0),U=async()=>{const $={method:"get",maxBodyLength:1/0,url:"https://backend-bushman-master-kxhmlj.laravel.cloud/api/v1.0/settings/countries/",headers:{"Content-Type":"application/json"}},F=await le.request($);F.status===200&&W.value.push(...F.data.map(P=>({value:P.id,text:P.name})))},K=async()=>{const $={method:"get",maxBodyLength:1/0,url:"https://backend-bushman-master-kxhmlj.laravel.cloud/api/v1.0/settings/entity-categories-vset/"},F=await le.request($);F.status===200&&Z.value.push(...F.data.map(P=>({value:P.id,text:P.name})))},te=async()=>{const $={method:"get",maxBodyLength:1/0,url:"https://backend-bushman-master-kxhmlj.laravel.cloud/api/v1.0/settings/nationalities/",headers:{"Content-Type":"application/json"}},F=await le.request($);F.status===200&&N.value.push(...F.data.map(P=>({value:P.id,text:P.name})))},se=async()=>{const $={method:"get",maxBodyLength:1/0,url:"https://backend-bushman-master-kxhmlj.laravel.cloud/api/v1.0/settings/contact-types/",headers:{"Content-Type":"application/json"}},F=await le.request($);F.status===200&&J.value.push(...F.data.map(P=>({value:P.id,text:P.name})))},ae=it(()=>{var P;let $="";const F=(P=j.contact_type)==null?void 0:P.value;return F==="email"?$="email":F==="phone_number"?$="phone":$="",$});return dt(()=>{U(),K(),te(),se()}),{formRef:t,contactFormRef:e,showAddSalesInquiriesForm:r,btnIcon:a,form:u,contactForm:j,showDetailsPage:n,countries:W,nationality:N,categoryOptions:Z,contactsTypes:J,clients:I,step:l,init:f,toggleAddSalesInquiriesForm:G,isValidForm:c,validateForm:h,resetValidationForm:m,resetForm:y,isValidContactForm:V,validateContactForm:S,resetValidationContactForm:_,resetContactForm:g,validators:ut,getCountries:U,getCategories:K,getNationalities:te,getContactTypes:se,contactFieldType:ae,gotBack:ee}},data(){return{speciesOptions:[],speciesObjects:[],areasOptions:[],seasonsOptions:[],selectedInquiryItem:null,downloadPdf:gt,saving:!1,packagesOptions:[],originalQuantities:O({})}},computed:{...Q(w,["logo","salesPackagesSpecies"]),speciesList(){return this.salesPackagesSpecies}},mounted(){this.getAreas(),this.getSeasonList(),this.getPL()},methods:{...q(re,["getSpeciesList"]),...q(re,["getAreaList"]),...q(re,["getAllSpeciesPerQuotaPerArea"]),...q(A,["createSalesInquiry"]),...q(w,["getSeasons","getSalespackagesSpecies"]),...q(st,["getPriceList"]),async submit(){if(this.saving=!0,this.salesPackagesSpecies.length===0){this.init({message:"Please select at least one species.",color:"warning"});return}if(this.form.no_of_hunters<=0){this.init({message:"Number of hunters must be greater than zero.",color:"warning"});return}const t=[{contact_type:"email",contact:this.form.email},{contact_type:"phone",contact:this.form.phone},{contact_type:"address",contact:this.form.address}],e={fullName:this.form.full_name,contacts:t,nationality:this.form.nationality.value,country:this.form.country.value,noOfHunters:this.form.no_of_hunters,noOfDays:this.form.no_of_days,noOfCompanions:this.form.no_of_companions,noOfObservers:this.form.no_of_observers,species:this.salesPackagesSpecies,areaId:this.form.area.value,season:this.form.season,startDate:this.form.start_date,endDate:this.form.end_date,preferredDate:this.form.preferred_date,identityNumber:this.form.id_number,priceListId:this.form.priceListId.value};try{const r=await this.createSalesInquiry(e);r.status===201&&(this.saving=!1,this.init({message:r.data.message,color:"success"}),this.resetForm(),this.resetValidationContactForm(),this.speciesObjects=[])}catch(r){this.saving=!1;const a=x(r.response);console.log(a),this.init({message:`
`+a.map((c,h)=>`${h+1}. ${c}`).join(`
`),color:"danger"})}},viewInquiries(t){this.showDetailsPage=!0,this.selectedInquiryItem=t.selfitem},addNewSpeciesItemToStorage(){if(!this.form.species||!this.form.quantity){this.init({message:"Please fill all required fields.",color:"warning"});return}if(Number(this.form.quantity)<=0){this.init({message:"Quantity must be greater than zero.",color:"warning"});return}this.speciesObjects.some(e=>e.species_id===this.form.species.value)?console.log("Species item already exists:",this.form.species.value):this.speciesObjects.push({species_id:this.form.species.value,name:this.form.species.text,quantity:this.form.quantity})},deleteFromStorage(t){this.speciesObjects.splice(t,1),console.log("Species item deleted:",t)},async getAreas(){try{const t=await this.getAreaList();this.areasOptions=t.data.map(e=>({value:e.id,text:e.name}))}catch(t){console.log(t)}},async getSeasonList(){try{const t=await this.getSeasons();this.seasonsOptions=t.data.map(e=>({value:e.id,text:e.name}))}catch(t){console.log(t)}},async getPL(){const t=await this.getPriceList();t.status===200?(this.packagesOptions=t.data.data.map(e=>{var r,a,c,h;return{value:e.id,text:((a=(r=e==null?void 0:e.sales_package)==null?void 0:r.regulatory_package)==null?void 0:a.name)+"--->"+(e==null?void 0:e.sales_package.name)+" ---> "+e.price_list_type.hunting_type.name+"---> "+((h=(c=e==null?void 0:e.sales_package)==null?void 0:c.area)==null?void 0:h.name),selfItem:e}}),console.log("packagesOptions:",this.packagesOptions)):console.log("Error getting price list")},async populateSpeciesList(){const t=await this.getSalespackagesSpecies({salespackageId:this.form.priceListId.value});console.log("response:",t)},onChange(t,e){var a;if(console.log("Quantity changed:",t,e),!(t in this.originalQuantities)){const c=this.salesPackagesSpecies.find(h=>h.id===t);this.originalQuantities[t]=c.quantity}const r=this.salesPackagesSpecies.find(c=>c.id===t);r&&(r.quantity=e,this.salesPackagesSpecies=[...this.salesPackagesSpecies]),this.init({message:`Quantity for ${r.name} has been updated to ${e} quantity(s).`,color:"success",position:"bottom-right"}),console.log("updated item list:",(a=this.packagesOptions.selfItem.sales_package)==null?void 0:a.species)}}}),Vs={class:"flex flex-col md:flex-row gap-2 mb-2 justify-between px-4 mt-2"},hs={class:"flex flex-col md:flex-row gap-2 justify-start"},bs={class:"p-1"},vs={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4"},Ss={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},_s={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4"},ks={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4"},qs={class:"grid grid-cols-1 md:grid-cols-1 gap-4 mb-4"},Cs={class:"va-table-responsive"},Is={class:"va-table"},Fs={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4"},Ps={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4"},$s={class:"mt-6"},ws={class:"mt-4 d-flex p-2"};function As(t,e,r,a,c,h){const m=i("VaButton"),y=i("VaButtonGroup"),V=i("SalesInquiryDetails"),S=i("Salesinquirieslist"),_=i("VaInput"),g=i("VaSelect"),f=i("VaDateInput"),n=i("VaCounter"),u=i("VaListLabel"),j=i("VaIcon"),G=i("VaListItemLabel"),ee=i("VaListItemSection"),W=i("VaListItem"),N=i("VaList"),Z=i("VaForm"),J=i("VaCardContent"),I=i("VaCard");return b(),E(I,{class:"w-full"},{default:d(()=>[s("div",Vs,[s("div",hs,[t.showAddSalesInquiriesForm||t.showDetailsPage?(b(),E(m,{key:0,class:"px-2",icon:"arrow_back",size:"small",onClick:e[0]||(e[0]=l=>t.gotBack())},{default:d(()=>e[23]||(e[23]=[p(" Go Back ")])),_:1})):X("",!0)]),!t.showAddSalesInquiriesForm&&!t.showDetailsPage?(b(),E(y,{key:0},{default:d(()=>[o(m,{class:"px-2",color:"primary",label:"Add New Quota",round:"",present:"secondary","border-color":"primary",icon:"add",size:"small",onClick:e[1]||(e[1]=l=>t.toggleAddSalesInquiriesForm())},{default:d(()=>e[24]||(e[24]=[p("Create Enquiry")])),_:1})]),_:1})):X("",!0)]),o(J,null,{default:d(()=>[t.showDetailsPage?(b(),E(V,{key:0,item:t.selectedInquiryItem},null,8,["item"])):(b(),C(L,{key:1},[t.showAddSalesInquiriesForm?(b(),E(Z,{key:1,ref:"formRef"},{default:d(()=>[s("div",bs,[e[29]||(e[29]=s("h3",{class:"font-bold text-lg mb-2"},"Basic Information",-1)),s("div",vs,[o(_,{modelValue:t.form.full_name,"onUpdate:modelValue":e[3]||(e[3]=l=>t.form.full_name=l),type:"text",placeholder:"Enter your Full name",rules:[l=>l&&l.length>0||"Full name is required"],label:"Full name"},null,8,["modelValue","rules"]),o(g,{modelValue:t.form.country,"onUpdate:modelValue":e[4]||(e[4]=l=>t.form.country=l),placeholder:"Select Country",label:"Country",rules:[l=>l||"Country is required"],options:t.countries,searchable:"","highlight-matched-text":""},null,8,["modelValue","rules","options"]),o(g,{modelValue:t.form.nationality,"onUpdate:modelValue":e[5]||(e[5]=l=>t.form.nationality=l),placeholder:"Select Client nationality",label:"Client Nationality",rules:[l=>l||"Nationality is required"],options:t.nationality,searchable:"","highlight-matched-text":""},null,8,["modelValue","rules","options"]),o(_,{modelValue:t.form.id_number,"onUpdate:modelValue":e[6]||(e[6]=l=>t.form.id_number=l),type:"text",placeholder:"passport/ID number",rules:[l=>l&&l.length>0||"passport number/id number is required"],label:"passport/ID number"},null,8,["modelValue","rules"])]),e[30]||(e[30]=s("h3",{class:"font-bold text-lg mb-2"},"Contacts",-1)),s("div",Ss,[o(_,{modelValue:t.form.email,"onUpdate:modelValue":e[7]||(e[7]=l=>t.form.email=l),type:"email",placeholder:"Enter your email",rules:[t.validators.required,t.validators.email],label:"Email"},null,8,["modelValue","rules"]),o(_,{modelValue:t.form.phone,"onUpdate:modelValue":e[8]||(e[8]=l=>t.form.phone=l),type:"tell",placeholder:"eg: +971501234567",rules:[t.validators.required,t.validators.tell],label:"Phone"},null,8,["modelValue","rules"]),o(_,{modelValue:t.form.address,"onUpdate:modelValue":e[9]||(e[9]=l=>t.form.address=l),type:"text","max-length":30,placeholder:"Enter your address",rules:[l=>l&&l.length>0||"Address is required"],label:"Address"},null,8,["modelValue","rules"])]),e[31]||(e[31]=s("h3",{class:"font-bold text-lg mb-2"},"Participants and hunting days",-1)),s("div",_s,[o(_,{modelValue:t.form.no_of_observers,"onUpdate:modelValue":e[10]||(e[10]=l=>t.form.no_of_observers=l),label:"Number of Observers(Optional)",placeholder:"Enter Number of Observers",type:"number",required:""},null,8,["modelValue"]),o(_,{modelValue:t.form.no_of_days,"onUpdate:modelValue":e[11]||(e[11]=l=>t.form.no_of_days=l),label:"Number of Days",placeholder:"Enter Number of Days",type:"number",rules:[l=>l||"This field is required"],required:""},null,8,["modelValue","rules"]),o(_,{modelValue:t.form.no_of_companions,"onUpdate:modelValue":e[12]||(e[12]=l=>t.form.no_of_companions=l),label:"Number of Companions(Optional)",placeholder:"Enter Number of Companions",type:"number",required:""},null,8,["modelValue"]),o(g,{modelValue:t.form.area,"onUpdate:modelValue":e[13]||(e[13]=l=>t.form.area=l),placeholder:"Select Area",label:"Hunting area",rules:[l=>l||"Hunting area is required"],options:t.areasOptions,searchable:"","highlight-matched-text":""},null,8,["modelValue","rules","options"])]),e[32]||(e[32]=s("h3",{class:"font-bold text-lg mb-2"},"Season and Tentative Date",-1)),s("div",ks,[o(g,{modelValue:t.form.season,"onUpdate:modelValue":e[14]||(e[14]=l=>t.form.season=l),placeholder:"Select Season",label:"Season",rules:[l=>l||"Season is required"],options:t.seasonsOptions,searchable:"","highlight-matched-text":""},null,8,["modelValue","rules","options"]),o(f,{modelValue:t.form.preferred_date,"onUpdate:modelValue":e[15]||(e[15]=l=>t.form.preferred_date=l),label:"Preferred Date",placeholder:"Select Preferred Date",rules:[l=>l||"Preferred Date is required"],required:""},null,8,["modelValue","rules"]),o(f,{modelValue:t.form.start_date,"onUpdate:modelValue":e[16]||(e[16]=l=>t.form.start_date=l),label:"Start Date",placeholder:"Select Start Date",rules:[l=>l||"Start Date is required"],required:""},null,8,["modelValue","rules"]),o(f,{modelValue:t.form.end_date,"onUpdate:modelValue":e[17]||(e[17]=l=>t.form.end_date=l),label:"End Date",placeholder:"Select End Date",rules:[l=>l||"End Date is required"],required:""},null,8,["modelValue","rules"])]),e[33]||(e[33]=s("h3",{class:"font-bold text-lg mb-2"},"Package",-1)),s("div",qs,[o(g,{modelValue:t.form.priceListId,"onUpdate:modelValue":[e[18]||(e[18]=l=>t.form.priceListId=l),t.populateSpeciesList],placeholder:"Select Price List",label:"Sales package",rules:[l=>l||"Price List is required"],options:t.packagesOptions,searchable:"","highlight-matched-text":""},null,8,["modelValue","rules","options","onUpdate:modelValue"])]),e[34]||(e[34]=s("h3",{class:"font-bold text-lg mb-2"},"Species",-1)),s("div",Cs,[s("table",Is,[e[25]||(e[25]=s("thead",null,[s("tr",null,[s("th",null,"Name"),s("th",null,"Quantity")])],-1)),s("tbody",null,[(b(!0),C(L,null,Y(t.salesPackagesSpecies,l=>(b(),C("tr",{key:l.id},[s("td",null,v(l.name),1),s("td",null,[o(n,{modelValue:l.quantity,"onUpdate:modelValue":[U=>l.quantity=U,U=>t.onChange(l.id,U)],"increase-icon":"add_circle_outline","decrease-icon":"remove_circle_outline",class:"w-100 p-0","manual-input":"",color:"#6938D1",max:"100",min:"0","max-length":"3"},null,8,["modelValue","onUpdate:modelValue"])])]))),128))])])]),s("div",Fs,[e[28]||(e[28]=s("h3",{class:"font-bold text-lg mb-2"},"Preferred Species",-1)),s("div",Ps,[o(g,{modelValue:t.form.species,"onUpdate:modelValue":e[19]||(e[19]=l=>t.form.species=l),label:"Species",options:t.speciesOptions,placeholder:"Select Species",rules:[l=>!!l||"Species is required"],required:""},null,8,["modelValue","options","rules"]),o(n,{modelValue:t.form.quantity,"onUpdate:modelValue":e[20]||(e[20]=l=>t.form.quantity=l),label:"Quantity","manual-input":"",min:1,max:100,rules:[l=>l||"Quantity is required"]},null,8,["modelValue","rules"]),o(y,null,{default:d(()=>[o(m,{class:"px-0 py-0",color:"primary",icon:"add",size:"small",round:"",onClick:e[21]||(e[21]=l=>t.addNewSpeciesItemToStorage())})]),_:1})]),s("div",$s,[o(N,null,{default:d(()=>[t.speciesObjects.length>0?(b(),E(u,{key:0,class:"text-md mb-2 text-left"},{default:d(()=>e[26]||(e[26]=[p("Selected Species")])),_:1})):(b(),E(u,{key:1,color:"secondary",class:"va-text-code mb-2 text-left"},{default:d(()=>e[27]||(e[27]=[p("No Species Selected")])),_:1})),(b(!0),C(L,null,Y(t.speciesObjects,(l,U)=>(b(),E(W,{key:U,class:"list__item"},{default:d(()=>[o(ee,null,{default:d(()=>[o(G,null,{default:d(()=>[p(" Name: "+v(l.name)+" ",1),o(j,{name:"delete",size:"small",color:"primary",onClick:K=>t.deleteFromStorage(U)},null,8,["onClick"])]),_:2},1024),o(G,{caption:""},{default:d(()=>[p("Quantity: "+v(l.quantity),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])])]),s("div",ws,[t.showDetailsPage?X("",!0):(b(),E(m,{key:0,loading:t.saving,icon:"save",class:"mr-3 mb-2",disabled:!t.isValidForm,onClick:e[22]||(e[22]=l=>t.validateForm()&&t.submit())},{default:d(()=>e[35]||(e[35]=[p(" Save ")])),_:1},8,["loading","disabled"]))])]),_:1},512)):(b(),E(S,{key:0,onDownloadBtnPressed:e[2]||(e[2]=l=>t.downloadPdf(l.selfitem.pdf)),onViewBtnPressed:t.viewInquiries},null,8,["onViewBtnPressed"]))],64))]),_:1})]),_:1})}const Ws=R(ys,[["render",As]]);export{Ws as default};
//# sourceMappingURL=SalesInquiries-Iy6r8nAb.js.map
