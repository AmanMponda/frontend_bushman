import{u as I}from"./sales-store-BCqr4gn-.js";import{d as ne,m as T,l as W,x as $s,y as Ps,z as Us,A as Rs,s as S,B as ee,c as Bs,C as Ms,k as L,_ as ae,a as q,w as c,b as o,i as d,e as s,v as F,h as r,o as C,g as A,F as Z,E as oe,t as n,q as Os}from"./index-D6QR9FQk.js";import{u as O}from"./settings-store-piPbthIS.js";import{h as te}from"./errorHandler-DijQ3xmc.js";import{u as de}from"./account-store-H8uwwaYp.js";import{d as re}from"./pdfDownloader-DiRJnS-k.js";import{u as se}from"./useForm-Dub-z-kP.js";import{u as ie}from"./useToast-BcBMeA7k.js";import{v as Ls}from"./utils-BWc0LXoO.js";import{u as x}from"./quota-store-DfUS8z7f.js";import{u as js}from"./regulatrory-store-CAI3fMl2.js";import{f as le}from"./format-Cn4G_mmc.js";const zs=e=>({pending:"secondary",provision_sales:"warning",confirmed:"success",declined:"danger",cancelled:"danger",completed:"primary"})[e]||"default",Hs=ne({components:{VaForm:Rs,VaInput:Us,VaSelect:Ps,VaButton:$s},props:{salesInquiryId:{type:String,required:!0}},setup(){const e=S(),t=S(),l=S(!1),f=S("add"),{isValid:m,validate:p,resetValidation:i,reset:V}=se(e),{isValid:w,validate:_,resetValidation:k,reset:u}=se(t),{init:a}=ie(),D=S(!1),j=ee({id:null,full_name:"",country:null,nationality:null,email:"",phone:"",address:"",arrival_airport:"",charter_in:null,charter_out:null,regulatory_package_id:null,id_number:""}),E=ee({id:null,client_id:null,contact:"",contact_type:null,contactable:!1}),$=()=>{l.value=!0},Y=()=>{l.value=!1,D.value=!1},N=S([]),z=S([]),H=S([]),Q=S([]),G=S([]),K=S(0),P=async()=>{const b={method:"get",maxBodyLength:1/0,url:"http://localhost:8000/api/v1.0/settings/countries",headers:{"Content-Type":"application/json"}},g=await L.request(b);g.status===200&&N.value.push(...g.data.map(h=>({value:h.id,text:h.name})))},J=async()=>{const b={method:"get",maxBodyLength:1/0,url:"http://localhost:8000/api/v1.0/settings/entity-categories-vset/"},g=await L.request(b);g.status===200&&H.value.push(...g.data.map(h=>({value:h.id,text:h.name})))},U=async()=>{const b={method:"get",maxBodyLength:1/0,url:"http://localhost:8000/api/v1.0/settings/nationalities",headers:{"Content-Type":"application/json"}},g=await L.request(b);g.status===200&&z.value.push(...g.data.map(h=>({value:h.id,text:h.name})))},R=async()=>{const b={method:"get",maxBodyLength:1/0,url:"http://localhost:8000/api/v1.0/settings/contact-types/",headers:{"Content-Type":"application/json"}},g=await L.request(b);g.status===200&&Q.value.push(...g.data.map(h=>({value:h.id,text:h.name})))},X=Bs(()=>{var h;let b="";const g=(h=E.contact_type)==null?void 0:h.value;return g==="email"?b="email":g==="phone_number"?b="phone":b="",b});return Ms(()=>{P(),U(),R()}),{formRef:e,contactFormRef:t,showAddSalesInquiriesForm:l,btnIcon:f,form:j,contactForm:E,showDetailsPage:D,countries:N,nationality:z,categoryOptions:H,contactsTypes:Q,clients:G,step:K,init:a,toggleAddSalesInquiriesForm:$,isValidForm:m,validateForm:p,resetValidationForm:i,resetForm:V,isValidContactForm:w,validateContactForm:_,resetValidationContactForm:k,resetContactForm:u,validators:Ls,getCountries:P,getCategories:J,getNationalities:U,getContactTypes:R,contactFieldType:X,gotBack:Y}},data(){return{preferred_species:[],speciesOptions:[],speciesObjects:[],areasOptions:[],seasonsOptions:[],selectedInquiryItem:null,downloadPdf:re,saving:!1,regulatoryPackages:[]}},computed:{...W(O,["logo"])},mounted(){this.getAreas(),this.getSeasonList(),this.getLicencePackages()},methods:{...T(x,["getSpeciesList"]),...T(x,["getAreaList"]),...T(x,["getAllSpeciesPerQuotaPerArea"]),...T(I,["createSalesInquiry","createSalesConfirmationProposalObservers","createSalesConfirmationCompanion","getCompanions"]),...T(O,["getSeasons"]),...T(js,["getRegulatoryPackages"]),async submit(){this.saving=!0;const e=[{contact_type:"email",contact:this.form.email},{contact_type:"phone",contact:this.form.phone},{contact_type:"address",contact:this.form.address}],t={fullName:this.form.full_name,contacts:e,nationalityId:this.form.nationality.value,countryId:this.form.country.value,salesInquiryId:this.salesInquiryId,regulatoryPackageId:this.form.regulatory_package_id.value,identityNumber:this.form.id_number,arrival_airport:this.form.arrival_airport,charter_in:le(this.form.charter_in,"yyyy-MM-dd HH:mm:ss"),charter_out:le(this.form.charter_in,"yyyy-MM-dd HH:mm:ss")};try{const l=await this.createSalesConfirmationCompanion(t);l.status===201&&(this.saving=!1,this.init({message:l.data.message,color:"success"}),this.resetForm(),this.resetValidationContactForm(),this.speciesObjects=[],this.getCompanions(this.salesInquiryId))}catch(l){this.saving=!1;const f=te(l.response);console.log(l),this.init({message:`
`+f.map((m,p)=>`${p+1}. ${m}`).join(`
`),color:"danger"})}},viewInquiries(e){this.showDetailsPage=!0,this.selectedInquiryItem=e.selfitem},deleteFromStorage(e){this.speciesObjects.splice(e,1),console.log("Species item deleted:",e)},async getLicencePackages(){try{const e=await this.getRegulatoryPackages();if(e.status===200){const t=e.data;this.regulatoryPackages=t.map(l=>({value:l.id,text:l.name}))}}catch(e){console.log(e)}},async getAreas(){try{const e=await this.getAreaList();this.areasOptions=e.data.map(t=>({value:t.id,text:t.name}))}catch(e){console.log(e)}},async getSeasonList(){try{const e=await this.getSeasons();this.seasonsOptions=e.data.map(t=>({value:t.id,text:t.name}))}catch(e){console.log(e)}}}}),Qs={class:"p-1"},Ws={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4"},Ys={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},Gs={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4 mt-6"},Ks={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},Js={class:"mt-4 d-flex p-2 flex justify-end"};function Xs(e,t,l,f,m,p){const i=d("VaInput"),V=d("VaSelect"),w=d("VaButton"),_=d("VaForm"),k=d("VaCardContent"),u=d("VaCard");return C(),q(u,{class:"w-full"},{default:c(()=>[o(k,null,{default:c(()=>[o(_,{ref:"formRef"},{default:c(()=>[s("div",Qs,[t[12]||(t[12]=s("h3",{class:"font-bold text-lg mb-2"},"Companion Basic Information",-1)),s("div",Ws,[o(i,{modelValue:e.form.full_name,"onUpdate:modelValue":t[0]||(t[0]=a=>e.form.full_name=a),type:"text",placeholder:"Enter your Full name",rules:[a=>a&&a.length>0||"Full name is required"],label:"Full name"},null,8,["modelValue","rules"]),o(V,{modelValue:e.form.country,"onUpdate:modelValue":t[1]||(t[1]=a=>e.form.country=a),placeholder:"Select Country",label:"Country",rules:[a=>a||"Country is required"],options:e.countries,searchable:"","highlight-matched-text":""},null,8,["modelValue","rules","options"]),o(V,{modelValue:e.form.nationality,"onUpdate:modelValue":t[2]||(t[2]=a=>e.form.nationality=a),placeholder:"Select Client nationality",label:"Client Nationality",rules:[a=>a||"Nationality is required"],options:e.nationality,searchable:"","highlight-matched-text":""},null,8,["modelValue","rules","options"]),o(i,{modelValue:e.form.id_number,"onUpdate:modelValue":t[3]||(t[3]=a=>e.form.id_number=a),type:"text",placeholder:"passport/ID number",rules:[a=>a&&a.length>0||"passport number/id number is required"],label:"passport/ID number"},null,8,["modelValue","rules"])]),t[13]||(t[13]=s("h3",{class:"font-bold text-lg mb-2"},"Contacts",-1)),s("div",Ys,[o(i,{modelValue:e.form.email,"onUpdate:modelValue":t[4]||(t[4]=a=>e.form.email=a),type:"email",placeholder:"Enter your email",rules:[e.validators.required,e.validators.email],label:"Email"},null,8,["modelValue","rules"]),o(i,{modelValue:e.form.phone,"onUpdate:modelValue":t[5]||(t[5]=a=>e.form.phone=a),type:"tell",placeholder:"eg: +971501234567",rules:[e.validators.required,e.validators.tell],label:"Phone"},null,8,["modelValue","rules"]),o(i,{modelValue:e.form.address,"onUpdate:modelValue":t[6]||(t[6]=a=>e.form.address=a),type:"text","max-length":30,placeholder:"Enter your address",rules:[a=>a&&a.length>0||"Address is required"],label:"Address"},null,8,["modelValue","rules"])]),t[14]||(t[14]=s("h3",{class:"font-bold text-lg mb-2"},"Charters",-1)),s("div",Gs,[o(i,{modelValue:e.form.charter_in,"onUpdate:modelValue":t[7]||(t[7]=a=>e.form.charter_in=a),placeholder:"Charter in",type:"datetime-local",rules:[a=>!!a||"This field is required"],label:"Charter in"},null,8,["modelValue","rules"]),o(i,{modelValue:e.form.charter_out,"onUpdate:modelValue":t[8]||(t[8]=a=>e.form.charter_out=a),type:"datetime-local",placeholder:"Charter out",rules:[a=>!!a||"This field is required",a=>new Date(a)>new Date(e.form.charter_in)||"Check out date must be after check-in date"],label:"Charter out"},null,8,["modelValue","rules"]),o(i,{modelValue:e.form.arrival_airport,"onUpdate:modelValue":t[9]||(t[9]=a=>e.form.arrival_airport=a),type:"text",placeholder:"Arrival airport",rules:[a=>!!a||"This field is required"],label:"Arrival airport"},null,8,["modelValue","rules"])]),t[15]||(t[15]=s("h3",{class:"font-bold text-lg mb-2"},"Licence",-1)),s("div",Ks,[o(V,{modelValue:e.form.regulatory_package_id,"onUpdate:modelValue":t[10]||(t[10]=a=>e.form.regulatory_package_id=a),options:e.regulatoryPackages,rules:[a=>a||"Licence is required"],placeholder:"Select Licence",label:"Licence"},null,8,["modelValue","options","rules"])])]),s("div",Js,[e.showDetailsPage?F("",!0):(C(),q(w,{key:0,loading:e.saving,icon:"save",class:"mr-3 mb-2",disabled:!e.isValidForm,onClick:t[11]||(t[11]=a=>e.validateForm()&&e.submit())},{default:c(()=>t[16]||(t[16]=[r(" Save ")])),_:1},8,["loading","disabled"]))])]),_:1},512)]),_:1})]),_:1})}const Zs=ae(Hs,[["render",Xs]]),xs=ne({components:{VaForm:Rs,VaInput:Us,VaSelect:Ps,VaButton:$s},props:{salesInquiryId:{type:String,required:!0}},setup(){const e=S(),t=S(),l=S(!1),f=S("add"),{isValid:m,validate:p,resetValidation:i,reset:V}=se(e),{isValid:w,validate:_,resetValidation:k,reset:u}=se(t),{init:a}=ie(),D=S(!1),j=ee({id:null,full_name:"",country:null,nationality:null,email:"",phone:"",address:"",arrival_airport:"",charter_in:null,charter_out:null,id_number:""}),E=ee({id:null,client_id:null,contact:"",contact_type:null,contactable:!1}),$=()=>{l.value=!0},Y=()=>{l.value=!1,D.value=!1},N=S([]),z=S([]),H=S([]),Q=S([]),G=S([]),K=S(0),P=async()=>{const b={method:"get",maxBodyLength:1/0,url:"http://localhost:8000/api/v1.0/settings/countries",headers:{"Content-Type":"application/json"}},g=await L.request(b);g.status===200&&N.value.push(...g.data.map(h=>({value:h.id,text:h.name})))},J=async()=>{const b={method:"get",maxBodyLength:1/0,url:"http://localhost:8000/api/v1.0/settings/entity-categories-vset/"},g=await L.request(b);g.status===200&&H.value.push(...g.data.map(h=>({value:h.id,text:h.name})))},U=async()=>{const b={method:"get",maxBodyLength:1/0,url:"http://localhost:8000/api/v1.0/settings/nationalities",headers:{"Content-Type":"application/json"}},g=await L.request(b);g.status===200&&z.value.push(...g.data.map(h=>({value:h.id,text:h.name})))},R=async()=>{const b={method:"get",maxBodyLength:1/0,url:"http://localhost:8000/api/v1.0/settings/contact-types/",headers:{"Content-Type":"application/json"}},g=await L.request(b);g.status===200&&Q.value.push(...g.data.map(h=>({value:h.id,text:h.name})))},X=Bs(()=>{var h;let b="";const g=(h=E.contact_type)==null?void 0:h.value;return g==="email"?b="email":g==="phone_number"?b="phone":b="",b});return Ms(()=>{P(),U(),R()}),{formRef:e,contactFormRef:t,showAddSalesInquiriesForm:l,btnIcon:f,form:j,contactForm:E,showDetailsPage:D,countries:N,nationality:z,categoryOptions:H,contactsTypes:Q,clients:G,step:K,init:a,toggleAddSalesInquiriesForm:$,isValidForm:m,validateForm:p,resetValidationForm:i,resetForm:V,isValidContactForm:w,validateContactForm:_,resetValidationContactForm:k,resetContactForm:u,validators:Ls,getCountries:P,getCategories:J,getNationalities:U,getContactTypes:R,contactFieldType:X,gotBack:Y}},data(){return{preferred_species:[],speciesOptions:[],speciesObjects:[],areasOptions:[],seasonsOptions:[],selectedInquiryItem:null,downloadPdf:re,saving:!1}},computed:{...W(O,["logo"])},mounted(){this.getAreas(),this.getSeasonList()},methods:{...T(x,["getSpeciesList"]),...T(x,["getAreaList"]),...T(x,["getAllSpeciesPerQuotaPerArea"]),...T(I,["createSalesInquiry","createSalesConfirmationProposalObservers","getObservers"]),...T(O,["getSeasons"]),async submit(){this.saving=!0;const e=[{contact_type:"email",contact:this.form.email},{contact_type:"phone",contact:this.form.phone},{contact_type:"address",contact:this.form.address}],t={fullName:this.form.full_name,contacts:e,nationalityId:this.form.nationality.value,countryId:this.form.country.value,salesInquiryId:this.salesInquiryId,arrival_airport:this.form.arrival_airport,charter_in:le(this.form.charter_in,"yyyy-MM-dd HH:mm:ss"),charter_out:le(this.form.charter_in,"yyyy-MM-dd HH:mm:ss"),identityNumber:this.form.id_number};try{const l=await this.createSalesConfirmationProposalObservers(t);l.status===201&&(this.saving=!1,this.init({message:l.data.message,color:"success"}),this.resetForm(),this.resetValidationContactForm(),this.speciesObjects=[],this.getObservers(this.salesInquiryId))}catch(l){this.saving=!1;const f=te(l.response);console.log(f),this.init({message:`
`+f.map((m,p)=>`${p+1}. ${m}`).join(`
`),color:"danger"})}},viewInquiries(e){this.showDetailsPage=!0,this.selectedInquiryItem=e.selfitem},deleteFromStorage(e){this.speciesObjects.splice(e,1),console.log("Species item deleted:",e)},async getAreas(){try{const e=await this.getAreaList();this.areasOptions=e.data.map(t=>({value:t.id,text:t.name}))}catch(e){console.log(e)}},async getSeasonList(){try{const e=await this.getSeasons();this.seasonsOptions=e.data.map(t=>({value:t.id,text:t.name}))}catch(e){console.log(e)}}}}),ea={class:"p-1"},ta={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4"},sa={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},aa={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4 mt-6"},oa={class:"mt-4 d-flex p-2 flex justify-end"};function la(e,t,l,f,m,p){const i=d("VaInput"),V=d("VaSelect"),w=d("VaButton"),_=d("VaForm"),k=d("VaCardContent"),u=d("VaCard");return C(),q(u,{class:"w-full"},{default:c(()=>[o(k,null,{default:c(()=>[o(_,{ref:"formRef"},{default:c(()=>[s("div",ea,[t[11]||(t[11]=s("h3",{class:"font-bold text-lg mb-2"},"Observers Basic Information",-1)),s("div",ta,[o(i,{modelValue:e.form.full_name,"onUpdate:modelValue":t[0]||(t[0]=a=>e.form.full_name=a),type:"text",placeholder:"Enter your Full name",rules:[a=>a&&a.length>0||"Full name is required"],label:"Full name"},null,8,["modelValue","rules"]),o(V,{modelValue:e.form.country,"onUpdate:modelValue":t[1]||(t[1]=a=>e.form.country=a),placeholder:"Select Country",label:"Country",rules:[a=>a||"Country is required"],options:e.countries,searchable:"","highlight-matched-text":""},null,8,["modelValue","rules","options"]),o(V,{modelValue:e.form.nationality,"onUpdate:modelValue":t[2]||(t[2]=a=>e.form.nationality=a),placeholder:"Select Client nationality",label:"Client Nationality",rules:[a=>a||"Nationality is required"],options:e.nationality,searchable:"","highlight-matched-text":""},null,8,["modelValue","rules","options"]),o(i,{modelValue:e.form.id_number,"onUpdate:modelValue":t[3]||(t[3]=a=>e.form.id_number=a),type:"text",placeholder:"passport/ID number",rules:[a=>a&&a.length>0||"passport number/id number is required"],label:"passport/ID number"},null,8,["modelValue","rules"])]),t[12]||(t[12]=s("h3",{class:"font-bold text-lg mb-2"},"Contacts",-1)),s("div",sa,[o(i,{modelValue:e.form.email,"onUpdate:modelValue":t[4]||(t[4]=a=>e.form.email=a),type:"email",placeholder:"Enter your email",rules:[e.validators.required,e.validators.email],label:"Email"},null,8,["modelValue","rules"]),o(i,{modelValue:e.form.phone,"onUpdate:modelValue":t[5]||(t[5]=a=>e.form.phone=a),type:"tell",placeholder:"eg: +971501234567",rules:[e.validators.required,e.validators.tell],label:"Phone"},null,8,["modelValue","rules"]),o(i,{modelValue:e.form.address,"onUpdate:modelValue":t[6]||(t[6]=a=>e.form.address=a),type:"text","max-length":30,placeholder:"Enter your address",rules:[a=>!!a||"This field is required"],label:"Address"},null,8,["modelValue","rules"])]),t[13]||(t[13]=s("h3",{class:"font-bold text-lg mb-2"},"Charters",-1)),s("div",aa,[o(i,{modelValue:e.form.charter_in,"onUpdate:modelValue":t[7]||(t[7]=a=>e.form.charter_in=a),placeholder:"Charter in",type:"datetime-local",rules:[a=>!!a||"This field is required"],label:"Charter in"},null,8,["modelValue","rules"]),o(i,{modelValue:e.form.charter_out,"onUpdate:modelValue":t[8]||(t[8]=a=>e.form.charter_out=a),type:"datetime-local",placeholder:"Charter out",rules:[a=>!!a||"This field is required",a=>new Date(a)>new Date(e.form.charter_in)||"Check out date must be after check-in date"],label:"Charter out"},null,8,["modelValue","rules"]),o(i,{modelValue:e.form.arrival_airport,"onUpdate:modelValue":t[9]||(t[9]=a=>e.form.arrival_airport=a),type:"text",placeholder:"Arrival airport",rules:[a=>!!a||"This field is required"],label:"Arrival airport"},null,8,["modelValue","rules"])])]),s("div",oa,[e.showDetailsPage?F("",!0):(C(),q(w,{key:0,loading:e.saving,icon:"save",class:"mr-3 mb-2",disabled:!e.isValidForm,onClick:t[10]||(t[10]=a=>e.validateForm()&&e.submit())},{default:c(()=>t[14]||(t[14]=[r(" Save ")])),_:1},8,["loading","disabled"]))])]),_:1},512)]),_:1})]),_:1})}const na=ae(xs,[["render",la]]),ra=ne({emits:["submitSelectedItemsEvent"],setup(){const{init:e}=ie(),t=S(null),{isValid:l,validate:f,resetValidation:m,reset:p}=se(t),i=ee({name:"",amount:null,currency_id:null,season_id:null,charges_per:null,description:""});return{formRef:t,isValidForm:l,validateForm:f,resetValidationForm:m,resetForm:p,form:i,init:e}},data(){return{selectedItems:[],columns:[{key:"name",label:"Service name",sortable:!0},{key:"amount",label:"Amount",sortable:!0},{key:"actions",label:"Actions",sortable:!1}],chargesPerOptions:[{value:"PER_HOUR",text:"PER HOUR"},{value:"PER_DAY",text:"PER DAY"},{value:"PER_PERSON",text:"PER PERSON"},{value:"PER_ROUND",text:"PER ROUND"}],seasonsOptions:[],currenciesOptions:[]}},computed:{...W(O,["savingSafariExtra"])},mounted(){this.getSeasonList(),this.getCurrencyList()},methods:{...T(O,["getSeasons","getCurrencies","createSafariExtras"]),async submitSelectedItems(){const e={name:this.form.name,amount:this.form.amount,currency_id:this.form.currency_id.value,season_id:this.form.season_id.value,charges_per:this.form.charges_per.value,description:this.form.description};try{const t=await this.createSafariExtras(e);t.status===201&&(this.$emit("submitSelectedItemsEvent"),this.init({message:t.data.message,color:"success"}))}catch(t){console.error(t);const l=te(t.response);this.init({message:`
`+l.map((f,m)=>`${m+1}. ${f}`).join(`
`),color:"danger"})}},async getSeasonList(){try{const e=await this.getSeasons();this.seasonsOptions=e.data.map(t=>({value:t.id,text:t.name}))}catch(e){console.log(e)}},async getCurrencyList(){try{const e=await this.getCurrencies();this.currenciesOptions=e.data.map(t=>({value:t.id,text:t.name}))}catch(e){console.log(e)}}}}),ia={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},da={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},ua={class:"grid grid-cols-1 md:grid-cols-1 gap-4 mb-4"};function ma(e,t,l,f,m,p){const i=d("VaInput"),V=d("VaSelect"),w=d("VaTextarea"),_=d("VaForm"),k=d("VaButton");return C(),A(Z,null,[o(_,{ref:"formRef"},{default:c(()=>[s("div",ia,[o(i,{modelValue:e.form.name,"onUpdate:modelValue":t[0]||(t[0]=u=>e.form.name=u),type:"text",placeholder:"Service name",rules:[u=>!!u||"This field is required"],label:"Service name"},null,8,["modelValue","rules"]),o(i,{modelValue:e.form.amount,"onUpdate:modelValue":t[1]||(t[1]=u=>e.form.amount=u),type:"number",placeholder:"Amount",rules:[u=>!!u||"This field is required"],label:"Amount"},null,8,["modelValue","rules"]),o(V,{modelValue:e.form.currency_id,"onUpdate:modelValue":t[2]||(t[2]=u=>e.form.currency_id=u),type:"text",placeholder:"Currency",rules:[u=>!!u||"This field is required"],options:e.currenciesOptions,label:"Currency"},null,8,["modelValue","rules","options"])]),s("div",da,[o(V,{modelValue:e.form.season_id,"onUpdate:modelValue":t[3]||(t[3]=u=>e.form.season_id=u),type:"text",placeholder:"Extra service",rules:[u=>!!u||"This field is required"],options:e.seasonsOptions,label:"Service"},null,8,["modelValue","rules","options"]),o(V,{modelValue:e.form.charges_per,"onUpdate:modelValue":t[4]||(t[4]=u=>e.form.charges_per=u),options:e.chargesPerOptions,type:"number",placeholder:"Charges per",rules:[u=>!!u||"This field is required"],label:"Charges per"},null,8,["modelValue","options","rules"])]),s("div",ua,[o(w,{modelValue:e.form.description,"onUpdate:modelValue":t[5]||(t[5]=u=>e.form.description=u),type:"text",placeholder:"Description",rules:[u=>!!u||"This field is required"],label:"Description"},null,8,["modelValue","rules"])])]),_:1},512),o(k,{icon:"save",loading:e.savingSafariExtra,disabled:!e.isValidForm||e.savingSafariExtra,onClick:t[6]||(t[6]=u=>e.submitSelectedItems())},{default:c(()=>t[7]||(t[7]=[r(" Save ")])),_:1},8,["loading","disabled"])],64)}const pa=ae(ra,[["render",ma]]),ca=ne({name:"SalesClientSafariExtrasForm",components:{SafariExtrasForm:pa},props:{tableSelectable:{type:Boolean,required:!1,default:!1},item:{type:Object,required:!0}},emits:["submitSelectedItemsEvent"],setup(){const{init:e}=ie(),t=S(null),{isValid:l,validate:f,resetValidation:m,reset:p}=se(t),i=ee({extra_id:null,account_id:null});return{formRef:t,isValidForm:l,validateForm:f,resetValidationForm:m,resetForm:p,form:i,init:e}},data(){return{selectedItems:[],columns:[{key:"safari_text",label:"Service",sortable:!0},{key:"account_name",label:"Account",sortable:!0},{key:"actions",label:"Actions",sortable:!1}]}},computed:{...W(O,["safariExtras"]),...W(de,["companyAccounts"]),...oe(I,{_savingSafariExtras:"savingSafariExtras"}),...oe(O,{_showCreateSafariExtraModal:"showCreateSafariExtraModal"})},mounted(){this.getSafariExtras(!0),this.getCompanyAccounts()},methods:{...T(O,["getSafariExtras"]),...T(de,["getCompanyAccounts"]),...T(I,["createsafariExtras","getClienSafariExtras"]),_showModal(){this._showCreateSafariExtraModal=!0},addExtraServiceInTempTable(){if(!this.form.extra_id.value){this.init({message:"Please select extra service ",color:"warning"});return}if(!this.form.account_id.value){this.init({message:"Please select account ",color:"warning"});return}const e={safari_extras_id:this.form.extra_id.value,safari_text:this.form.extra_id.text,sales_inquiry_id:this.item.id,account_id:this.form.account_id.value,account_name:this.form.account_id.text};this.selectedItems.findIndex(l=>l.safari_extras_id===e.safari_extras_id)===-1?this.selectedItems.push(e):this.init({message:"This service already added",color:"warning"}),this.resetForm()},deleteTempSubItemList(e){this.selectedItems.splice(e,1)},async submitSelectedItems(){console.log("submitSelectedItems"),console.log(this.item.id);const e=this.selectedItems.map(t=>({safari_extras_id:t.safari_extras_id,account_id:t.account_id,sales_inquiry_id:this.item.id}));try{const t=await this.createsafariExtras(e);t.status===201&&(this.init({message:t.data.message,color:"success"}),this.getClienSafariExtras(this.item.id))}catch(t){console.error(t);const l=te(t.response);this.init({message:`
`+l.map((f,m)=>`${m+1}. ${f}`).join(`
`),color:"danger"}),this._savingSafariExtras=!1}}}}),fa={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"};function ya(e,t,l,f,m,p){const i=d("VaIcon"),V=d("VaSelect"),w=d("VaButton"),_=d("VaForm"),k=d("VaDataTable"),u=d("SafariExtrasForm"),a=d("VaModal");return C(),A(Z,null,[o(_,{ref:"formRef"},{default:c(()=>[s("div",fa,[o(V,{modelValue:e.form.extra_id,"onUpdate:modelValue":t[1]||(t[1]=D=>e.form.extra_id=D),type:"text",placeholder:"Extra service",rules:[D=>!!D||"This field is required"],options:e.safariExtras,label:"Service"},{append:c(()=>[o(i,{name:"add",class:"ml-2",onClick:t[0]||(t[0]=D=>e._showModal())})]),_:1},8,["modelValue","rules","options"]),o(V,{modelValue:e.form.account_id,"onUpdate:modelValue":t[2]||(t[2]=D=>e.form.account_id=D),rules:[D=>!!D||"This field is required"],options:e.companyAccounts,label:"Account"},null,8,["modelValue","rules","options"]),o(w,{type:"submit",preset:"plain",icon:"add",rounded:"",disabled:!e.isValidForm,onClick:e.addExtraServiceInTempTable},{default:c(()=>t[5]||(t[5]=[r(" Add ")])),_:1},8,["disabled","onClick"])])]),_:1},512),o(k,{disabled:!e.selectedItems.length||e._savingSafariExtras,items:e.selectedItems,columns:e.columns},{"cell(actions)":c(({rowData:D})=>[o(w,{disabled:e._savingSafariExtras,preset:"plain",icon:"delete",onClick:j=>e.deleteTempSubItemList(D.index)},null,8,["disabled","onClick"])]),_:1},8,["disabled","items","columns"]),o(w,{loading:e._savingSafariExtras,icon:"save",disabled:!e.selectedItems.length,onClick:t[3]||(t[3]=D=>e.submitSelectedItems())},{default:c(()=>t[6]||(t[6]=[r(" Save ")])),_:1},8,["loading","disabled"]),o(a,{modelValue:e._showCreateSafariExtraModal,"onUpdate:modelValue":t[4]||(t[4]=D=>e._showCreateSafariExtraModal=D),size:"small",title:"Add Extra Service","close-on-click-outside":!1},{default:c(()=>[o(u)]),_:1},8,["modelValue"])],64)}const ga=ae(ca,[["render",ya]]),ha=ne({components:{CompanionForm:Zs,ObserversForm:na,SafariExtrasList:ga},props:{salesData:{type:Object,required:!0}},emits:["download-confirmation"],data(){var t,l,f;return{columns:[{key:"narration",label:"Description"},{key:"amount_due",label:"Amount Due (USD)"},{key:"due_days",label:"Days"},{key:"amount_due_type",label:"Due Type"},{key:"due_days_type",label:"Due Type"}],isOpened:!1,file:[],payfile:[],docType:null,docTypes:[],confirmText:"Confirm",disabledConfirmButton:!1,selection:["provision_sales"],paymentForm:{currency_id:null,date:null,accountType:null,reference_number:null,amount:(f=(l=(t=this.salesData)==null?void 0:t.price_break_down)==null?void 0:l.total_amount)==null?void 0:f.amount,narration:""},buttonColor:"primary",createDRTransaction:!1,createCRTransaction:!1,completingSales:!1,downloadPdf:re,statusOptions:[{value:"provision_sales",text:"Confirmed, but no disposit yet"},{value:"confirmed",text:"Confirmed, With a disposit"},{value:"declined",text:"Declined"},{value:"cancelled",text:"Cancelled"},{value:"completed",text:"Completed"}],getStatusColor:zs,files:[],status:"",loading:!1,transaction_type:"",accountsOption:[{value:"CASH_IN_HAND",text:"Cash in Hand"},{value:"BANK",text:"Bank trasfer"}],currencyOptions:[{value:1,text:"USD"},{value:2,text:"Tsh"}]}},computed:{...W(I,["observers","companions","clientSafariExtras"]),...oe(I,{_shM:"showSafariExtrasModal"}),...oe(I,{_shOMd:"showObserversModal"}),...oe(I,{_shCMd:"showCompanionsModal"})},mounted(){this.showConfirmButtonTextByStatus(),this.getObservers(this.salesData.sales_inquiry.id),this.getCompanions(this.salesData.sales_inquiry.id),this.getClienSafariExtras(this.salesData.sales_inquiry.id)},methods:{...T(O,["getDocTypes"]),...T(I,["updatesalesConfirmationStatus"]),...T(de,["createCRDRTransaction","createDRCRTransaction"]),...T(I,["getObservers","getCompanions"]),...T(I,["createsafariExtras","getClienSafariExtras"]),getContactByType(e){return this.salesData.sales_inquiry.entity.contacts.find(t=>t.contact_type===e)},formatDate(e){const t={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString(void 0,t)},_showSafariExtrasModal(){this._shM=!0},downloadConfirmation(){this.$emit("download-confirmation",this.salesData)},async complete(){this.status="completed",this.completingSales=!0,await this.completeOrCancel("Sales Confirmation Completed.")},async completeOrCancel(e){var l,f,m,p;const t={entityId:this.salesData.sales_inquiry.entity.id,contractDoc:this.file[0],paymentDoc:this.payfile[0],salesConfirmationProposalId:this.salesData.id,statusId:this.status,quotaId:(p=(m=(f=(l=this.salesData)==null?void 0:l.proposed_package)==null?void 0:f.sales_package)==null?void 0:m.sales_quota)==null?void 0:p.id,areaId:this.salesData.sales_inquiry.area[0].area.id};try{(await this.updatesalesConfirmationStatus(t)).status===200?(this.isOpened=!1,this.loading=!1,this.$vaToast.init({message:e,color:"success"}),this.completingSales=!1):this.$vaToast.init({message:"Failed to process the request",color:"danger"})}catch(i){const V=te(i.response);V.length>0&&(this.loading=!1,this.completingSales=!0,this.$vaToast.init({message:`
`+V.map((w,_)=>`${_+1}. ${w}`).join(`
`),color:"danger"}))}},async cancel(){await this.$vaModal.confirm("Are you sure you want to cancel this sales?")&&(this.status="cancelled",await this.completeOrCancel("Sales Confirmation Cancelled."))},handleTransactionTypeStatus(e,t,l){this.loading=!0;const f=m=>this.files.some(p=>p.file===m);if(this.salesData.status.status==="pending"){if(e.includes("provision_sales")&&e.includes("confirm")&&e.length===2){if(this.status="confirmed",this.transaction_type="RECEIPT",this.createCRTransaction=!0,t[0]===void 0&&l[0]===void 0)throw this.$vaToast.init({message:"Please upload both Signed Contract and Payment Document",color:"danger"}),this.loading=!1,new Error("Please upload both Signed Contract and Payment Document")}else if(e.includes("provision_sales")&&e.length===1){if(this.status="provision_sales",this.transaction_type="SALES_INVOICE",this.createDRTransaction=!0,console.log("File:",t[0]),console.log("Payfile:",l[0]),t[0]===void 0)throw this.$vaToast.init({message:"Please upload Signed Contract",color:"danger"}),this.loading=!1,new Error("Please upload Signed Contract")}else if(e.includes("confirm")&&e.length===1&&(this.status="confirmed",this.transaction_type="RECEIPT",this.createCRTransaction=!0,l[0]===void 0))throw this.$vaToast.init({message:"Please upload Payment Document",color:"danger"}),this.loading=!1,new Error("Please upload Payment Document")}else if(this.salesData.status.status==="provision_sales"&&!f(l[0])&&(this.status="confirmed",this.transaction_type="RECEIPT",this.createCRTransaction=!0,l[0]===void 0))throw this.$vaToast.init({message:"Please upload Payment Document",color:"danger"}),this.loading=!1,new Error("Please upload Payment Document")},async submit(){var l,f;try{this.handleTransactionTypeStatus(this.selection,this.file,this.payfile)}catch(m){console.error("Error:",m),this.loading=!1;return}const e={date:le(this.paymentForm.date,"yyyy-MM-dd")??null,account_type:((f=(l=this.paymentForm)==null?void 0:l.accountType)==null?void 0:f.value)??"SALES_ACCOUNT",reference_number:this.paymentForm.reference_number??null,currency_id:this.paymentForm.currency_id.value,transaction_type:this.transaction_type,amount:this.paymentForm.amount,narration:this.paymentForm.narration,accountable_id:this.salesData.sales_inquiry.entity.id,accountable_type_id:this.salesData.sales_inquiry.entity.category.id,sales_confirmation_id:this.salesData.id},t={entityId:this.salesData.sales_inquiry.entity.id,contractDoc:this.file[0],paymentDoc:this.payfile[0],salesConfirmationProposalId:this.salesData.id,statusId:this.status,areaId:this.salesData.sales_inquiry.area[0].area.id};try{if(this.createCRTransaction)if((await this.updatesalesConfirmationStatus(t)).status===200){const p=await this.createCRDRTransaction(e);p.status===201?(this.isOpened=!1,this.loading=!1,this.$vaToast.init({message:p.data.message,color:"success"})):this.$vaToast.init({message:"Failed to create transaction",color:"danger"})}else this.$vaToast.init({message:"Failed to update Sales",color:"danger"});else if(this.createDRTransaction)if((await this.updatesalesConfirmationStatus(t)).status===200){const p=await this.createDRCRTransaction(e);await this.delay(1e3),p.status===201?(this.isOpened=!1,this.loading=!1,this.$vaToast.init({message:p.data.message,color:"success"})):this.$vaToast.init({message:"Failed to create transaction",color:"danger"})}else this.$vaToast.init({message:"Failed to update Sales",color:"danger"})}catch(m){const p=te(m.response);this.loading=!1,p.length>0?this.$vaToast.init({message:`
`+p.map((i,V)=>`${V+1}. ${i}`).join(`
`),color:"danger"}):m.message&&this.$vaToast.init({message:m.message,color:"danger"})}},delay(e){return new Promise(t=>setTimeout(t,e))},showConfirmButtonTextByStatus(){switch(this.salesData.status.status){case"confirmed":this.confirmText="Cancel Now",this.disabledConfirmButton=!1,this.buttonColor="danger";break;case"completed":this.confirmText="Sales Done",this.disabledConfirmButton=!0;break;case"declined":this.confirmText="Confirm and Decline",this.disabledConfirmButton=!1;break;case"cancelled":this.confirmText="Confirm and Cancel",this.disabledConfirmButton=!1;break;case"provision_sales":this.confirmText="Confirm a Provision Sales",this.disabledConfirmButton=!1;break;default:this.confirmText="Confirm";break}},async getDocTypeOptions(){try{const e=await this.getDocTypes();if(console.log("Response from getDocTypes:",e),e.status===200){const t=e.data.map(l=>({value:l.id,text:l.name}));console.log("Mapped docTypes:",t),this.docTypes=t}else console.error("Failed to fetch document types: ",e)}catch(e){console.error("Error fetching document types: ",e)}},showModal(){this.isOpened=!0}}}),va={class:"sales-confirmation"},ba={class:"action-buttons"},Va={class:"section"},Ca={class:"details-grid"},Sa={class:"section"},Da={class:"details-grid"},wa={class:"section"},_a={class:"details-grid"},Ta={class:"section"},ka={class:"details-grid"},Aa={class:"section"},Ia={class:"va-table-responsive"},Fa={class:"va-table"},qa={class:"section"},Ea={class:"details-grid"},Na={class:"section"},Oa={class:"details-grid"},$a={class:"section"},Pa={class:"section"},Ua={class:"details-grid"},Ra={class:"species-list"},Ba={class:"section"},Ma={class:"flex flex-col md:flex-row gap-2 mb-2 justify-between px-4 py-2"},La={class:"flex flex-col md:flex-row gap-2 mb-2 justify-between px-4 py-2"},ja={class:"flex flex-col md:flex-row gap-2 justify-start"},za={class:"flex flex-col md:flex-row gap-2 mb-2 justify-between px-4 py-2"},Ha={class:"flex flex-col md:flex-row gap-2 mb-2 justify-between px-4 py-2"},Qa={class:"flex flex-row"},Wa={class:"flex flex-col"},Ya={class:"flex flex-row mb-4"},Ga={key:0,class:"flex-1"},Ka={key:1,class:"flex-1"},Ja={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Xa={key:0,class:"mb-2"},Za={key:1,class:"mb-2"},xa={key:2,class:"mb-2"},eo={class:"mb-3"},to={class:"mb-2"},so={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},ao={class:"mb-2"},oo={class:"mb-3"},lo={class:"mb-2"},no={class:"mb-2"},ro={class:"mb-2"};function io(e,t,l,f,m,p){var G,K,P,J,U,R,X,b,g,h,ue,me,pe,ce,fe,ye,ge,he,ve,be,Ve,Ce,Se,De,we,_e,Te,ke,Ae,Ie,Fe,qe,Ee,Ne,Oe,$e,Pe,Ue,Re,Be,Me,Le,je,ze,He,Qe,We,Ye,Ge,Ke,Je,Xe,Ze,xe,et,tt,st,at,ot,lt,nt,rt,it,dt,ut,mt,pt,ct,ft,yt,gt,ht,vt,bt,Vt,Ct,St,Dt,wt,_t,Tt,kt,At,It,Ft,qt,Et,Nt,Ot,$t,Pt,Ut,Rt,Bt,Mt,Lt,jt,zt,Ht,Qt,Wt,Yt,Gt,Kt,Jt,Xt,Zt,xt,es,ts,ss,as,os,ls,ns,rs,is,ds,us,ms,ps,cs,fs,ys,gs,hs,vs,bs,Vs,Cs,Ss,Ds,ws,_s,Ts,ks,As,Is,Fs,qs,Es;const i=d("VaButton"),V=d("VaBadge"),w=d("VaDataTable"),_=d("VaDivider"),k=d("VaTitle"),u=d("VaProgressBar"),a=d("VaCheckbox"),D=d("VaFileUpload"),j=d("VaDateInput"),E=d("VaSelect"),$=d("VaInput"),Y=d("VaTextarea"),N=d("VaModal"),z=d("CompanionForm"),H=d("ObserversForm"),Q=d("SafariExtrasList");return C(),A("div",va,[t[82]||(t[82]=s("h1",{class:"header text-center text-lg font-bold"},"SALES CONFIRMATION",-1)),s("div",ba,[o(i,{roud:"",preset:"secondary",class:"px-2 py-2 px-md-4 py-md-4 mr-2",icon:"file_download",size:"small","border-color":"primary",onClick:t[0]||(t[0]=v=>e.downloadPdf(e.salesData.pdf))},{default:c(()=>t[26]||(t[26]=[r("Download")])),_:1}),((K=(G=e.salesData)==null?void 0:G.status)==null?void 0:K.status)==="pending"||((J=(P=e.salesData)==null?void 0:P.status)==null?void 0:J.status)==="provision_sales"?(C(),q(i,{key:0,roud:"",preset:"secondary","border-color":"primary",class:"px-2 py-2",icon:"check_circle",disabled:e.disabledConfirmButton,size:"small",onClick:e.showModal},{default:c(()=>[r(n(e.confirmText),1)]),_:1},8,["disabled","onClick"])):((R=(U=e.salesData)==null?void 0:U.status)==null?void 0:R.status)==="confirmed"?(C(),q(i,{key:1,roud:"",color:e.buttonColor,class:"px-2 py-2 mr-2",disabled:e.disabledConfirmButton,size:"small",onClick:t[1]||(t[1]=v=>e.cancel())},{default:c(()=>[r(n(e.confirmText),1)]),_:1},8,["color","disabled"])):F("",!0)]),s("section",Va,[t[31]||(t[31]=s("h2",null,"Sales Inquiry",-1)),s("div",Ca,[s("div",null,[t[27]||(t[27]=s("strong",null,"ID:",-1)),r(" "+n(((X=e.salesData)==null?void 0:X.id)??"N/A"),1)]),s("div",null,[t[28]||(t[28]=s("strong",null,"Code:",-1)),r(" "+n(((g=(b=e.salesData)==null?void 0:b.sales_inquiry)==null?void 0:g.code)??"N/A"),1)]),s("div",null,[t[29]||(t[29]=s("strong",null,"Created Date:",-1)),r(" "+n(e.formatDate((h=e.salesData)==null?void 0:h.created_date)??"N/A"),1)]),s("div",null,[t[30]||(t[30]=s("strong",null,"Remarks:",-1)),r(" "+n(((me=(ue=e.salesData)==null?void 0:ue.sales_inquiry)==null?void 0:me.remarks)??"None"),1)])])]),s("section",Sa,[t[36]||(t[36]=s("h2",null,"Status Information",-1)),s("div",Da,[s("div",null,[t[32]||(t[32]=s("strong",null,"Status ID:",-1)),r(" "+n(((ce=(pe=e.salesData)==null?void 0:pe.status)==null?void 0:ce.id)??"N/A"),1)]),s("div",null,[t[33]||(t[33]=s("strong",null,"Status:",-1)),o(V,{text:((ye=(fe=e.salesData)==null?void 0:fe.status)==null?void 0:ye.status)??"N/A",color:e.getStatusColor((he=(ge=e.salesData)==null?void 0:ge.status)==null?void 0:he.status),class:"mr-2"},null,8,["text","color"])]),s("div",null,[t[34]||(t[34]=s("strong",null,"Created At:",-1)),r(" "+n(e.formatDate((be=(ve=e.salesData)==null?void 0:ve.status)==null?void 0:be.created_at)??"N/A"),1)]),s("div",null,[t[35]||(t[35]=s("strong",null,"Updated At:",-1)),r(" "+n(e.formatDate((Ce=(Ve=e.salesData)==null?void 0:Ve.status)==null?void 0:Ce.updated_at)??"N/A"),1)])])]),s("section",wa,[t[43]||(t[43]=s("h2",null,"Client Information",-1)),s("div",_a,[s("div",null,[t[37]||(t[37]=s("strong",null,"Full Name:",-1)),r(" "+n(((we=(De=(Se=e.salesData)==null?void 0:Se.sales_inquiry)==null?void 0:De.entity)==null?void 0:we.full_name)??"N/A"),1)]),s("div",null,[t[38]||(t[38]=s("strong",null,"Email:",-1)),r(" "+n(((_e=e.getContactByType(1))==null?void 0:_e.contact)??"N/A"),1)]),s("div",null,[t[39]||(t[39]=s("strong",null,"Phone:",-1)),r(" "+n(((Te=e.getContactByType(4))==null?void 0:Te.contact)??"N/A"),1)]),s("div",null,[t[40]||(t[40]=s("strong",null,"Address:",-1)),r(" "+n(((ke=e.getContactByType(3))==null?void 0:ke.contact)??"N/A"),1)]),s("div",null,[t[41]||(t[41]=s("strong",null,"Nationality:",-1)),r(" "+n(((qe=(Fe=(Ie=(Ae=e.salesData)==null?void 0:Ae.sales_inquiry)==null?void 0:Ie.entity)==null?void 0:Fe.nationality)==null?void 0:qe.name)??"N/A"),1)]),s("div",null,[t[42]||(t[42]=s("strong",null,"Country:",-1)),r(" "+n((($e=(Oe=(Ne=(Ee=e.salesData)==null?void 0:Ee.sales_inquiry)==null?void 0:Ne.entity)==null?void 0:Oe.country)==null?void 0:$e.name)??"N/A"),1)])])]),s("section",Ta,[t[50]||(t[50]=s("h2",null,"Client Preferences",-1)),s("div",ka,[s("div",null,[t[44]||(t[44]=s("strong",null,"No. of Hunters:",-1)),r(" "+n(((Re=(Ue=(Pe=e.salesData)==null?void 0:Pe.sales_inquiry)==null?void 0:Ue.preference)==null?void 0:Re.no_of_hunters)??"N/A"),1)]),s("div",null,[t[45]||(t[45]=s("strong",null,"No. of Observers:",-1)),r(" "+n(((Le=(Me=(Be=e.salesData)==null?void 0:Be.sales_inquiry)==null?void 0:Me.preference)==null?void 0:Le.no_of_observers)??"N/A"),1)]),s("div",null,[t[46]||(t[46]=s("strong",null,"No. of Days:",-1)),r(" "+n(((He=(ze=(je=e.salesData)==null?void 0:je.sales_inquiry)==null?void 0:ze.preference)==null?void 0:He.no_of_days)??"N/A"),1)]),s("div",null,[t[47]||(t[47]=s("strong",null,"No. of Companions:",-1)),r(" "+n(((Ye=(We=(Qe=e.salesData)==null?void 0:Qe.sales_inquiry)==null?void 0:We.preference)==null?void 0:Ye.no_of_companions)??"N/A"),1)]),s("div",null,[t[48]||(t[48]=s("strong",null,"Preferred Date:",-1)),r(" "+n(e.formatDate((Je=(Ke=(Ge=e.salesData)==null?void 0:Ge.sales_inquiry)==null?void 0:Ke.preference)==null?void 0:Je.preferred_date)??"N/A"),1)]),s("div",null,[t[49]||(t[49]=s("strong",null,"Special Requests:",-1)),r(" "+n(((xe=(Ze=(Xe=e.salesData)==null?void 0:Xe.sales_inquiry)==null?void 0:Ze.preference)==null?void 0:xe.special_requests)??"None"),1)])])]),s("section",Aa,[t[52]||(t[52]=s("h2",null,"Preferred Species",-1)),s("div",Ia,[s("table",Fa,[t[51]||(t[51]=s("thead",null,[s("tr",null,[s("th",null,"Name"),s("th",null,"Scientific Name"),s("th",null,"Quantity")])],-1)),s("tbody",null,[(C(!0),A(Z,null,Os(((tt=(et=e.salesData)==null?void 0:et.sales_inquiry)==null?void 0:tt.preferred_species)??[],v=>{var B,M;return C(),A("tr",{key:v.id},[s("td",null,n(((B=v.species)==null?void 0:B.name)??"N/A"),1),s("td",null,n(((M=v.species)==null?void 0:M.scientific_name)??"N/A"),1),s("td",null,n(v.quantity??"N/A"),1)])}),128))])])])]),s("section",qa,[t[55]||(t[55]=s("h2",null,"Area Information",-1)),s("div",Ea,[s("div",null,[t[53]||(t[53]=s("strong",null,"Area Name:",-1)),r(" "+n(((lt=(ot=(at=(st=e.salesData)==null?void 0:st.sales_inquiry)==null?void 0:at.area[0])==null?void 0:ot.area)==null?void 0:lt.name)??"N/A"),1)]),s("div",null,[t[54]||(t[54]=s("strong",null,"Description:",-1)),r(" "+n(((dt=(it=(rt=(nt=e.salesData)==null?void 0:nt.sales_inquiry)==null?void 0:rt.area[0])==null?void 0:it.area)==null?void 0:dt.description)??"N/A"),1)])])]),s("section",Na,[t[60]||(t[60]=s("h2",null,"Itinerary",-1)),s("div",Oa,[s("div",null,[t[56]||(t[56]=s("strong",null,"Airport Name:",-1)),r(" "+n(((mt=(ut=e.salesData)==null?void 0:ut.itinerary)==null?void 0:mt.airport_name)??"N/A"),1)]),s("div",null,[t[57]||(t[57]=s("strong",null,"Arrival:",-1)),r(" "+n(e.formatDate((ct=(pt=e.salesData)==null?void 0:pt.itinerary)==null?void 0:ct.arrival)??"N/A"),1)]),s("div",null,[t[58]||(t[58]=s("strong",null,"Charter In:",-1)),r(" "+n(e.formatDate((yt=(ft=e.salesData)==null?void 0:ft.itinerary)==null?void 0:yt.charter_in)??"N/A"),1)]),s("div",null,[t[59]||(t[59]=s("strong",null,"Charter Out:",-1)),r(" "+n(e.formatDate((ht=(gt=e.salesData)==null?void 0:gt.itinerary)==null?void 0:ht.charter_out)??"N/A"),1)])])]),s("section",$a,[t[61]||(t[61]=s("h2",null,"Installments",-1)),o(w,{items:((vt=e.salesData)==null?void 0:vt.installments)??[],columns:e.columns},null,8,["items","columns"])]),s("section",Pa,[t[67]||(t[67]=s("h2",null,"Proposed Package",-1)),s("div",Ua,[s("div",null,[t[62]||(t[62]=s("strong",null,"Name:",-1)),r(" "+n(((Ct=(Vt=(bt=e.salesData)==null?void 0:bt.proposed_package)==null?void 0:Vt.sales_package)==null?void 0:Ct.name)??"N/A"),1)]),s("div",null,[t[63]||(t[63]=s("strong",null,"Description:",-1)),r(" "+n(((wt=(Dt=(St=e.salesData)==null?void 0:St.proposed_package)==null?void 0:Dt.sales_package)==null?void 0:wt.description)??"N/A"),1)]),s("div",null,[t[64]||(t[64]=s("strong",null,"Amount:",-1)),r(" "+n(((kt=(Tt=(_t=e.salesData)==null?void 0:_t.proposed_package)==null?void 0:Tt.price_list_type)==null?void 0:kt.amount)??"N/A"),1)]),s("div",null,[t[65]||(t[65]=s("strong",null,"Duration (days):",-1)),r(" "+n(((Ft=(It=(At=e.salesData)==null?void 0:At.proposed_package)==null?void 0:It.price_list_type)==null?void 0:Ft.duration)??"N/A"),1)]),s("div",null,[t[66]||(t[66]=s("strong",null,"Hunting Type:",-1)),r(" "+n(((Ot=(Nt=(Et=(qt=e.salesData)==null?void 0:qt.proposed_package)==null?void 0:Et.price_list_type)==null?void 0:Nt.hunting_type)==null?void 0:Ot.name)??"N/A"),1)])]),t[68]||(t[68]=s("h3",null,"Species Included",-1)),s("ul",Ra,[(C(!0),A(Z,null,Os(((Ut=(Pt=($t=e.salesData)==null?void 0:$t.proposed_package)==null?void 0:Pt.sales_package)==null?void 0:Ut.species)??[],v=>{var B,M;return C(),A("li",{key:v.id},[r(n(((B=v.species)==null?void 0:B.name)??"N/A")+" ("+n(((M=v.species)==null?void 0:M.scientific_name)??"N/A")+"): ",1),s("strong",null,n(v.amount??"N/A"),1)])}),128))])]),s("section",Ba,[t[78]||(t[78]=s("h2",null,"Price Breakdown",-1)),s("div",Ma,[s("div",null,[t[69]||(t[69]=s("strong",null,"Total Amount:",-1)),r(" "+n(((Lt=(Mt=(Bt=(Rt=e.salesData)==null?void 0:Rt.price_break_down)==null?void 0:Bt.total_amount)==null?void 0:Mt.currency)==null?void 0:Lt.symbol)??"N/A")+" "+n(((Ht=(zt=(jt=e.salesData)==null?void 0:jt.price_break_down)==null?void 0:zt.total_amount)==null?void 0:Ht.amount)??"N/A"),1)]),s("div",null,[t[70]||(t[70]=s("strong",null,"Companion Cost:",-1)),s("div",null," Number of Companions: "+n(((Yt=(Wt=(Qt=e.salesData)==null?void 0:Qt.price_break_down)==null?void 0:Wt.companion_cost_details)==null?void 0:Yt.number_of_companions)??"N/A"),1),s("div",null," Cost per Companion: "+n(((Zt=(Xt=(Jt=(Kt=(Gt=e.salesData)==null?void 0:Gt.price_break_down)==null?void 0:Kt.companion_cost_details)==null?void 0:Jt.cost_per_companion)==null?void 0:Xt.currency)==null?void 0:Zt.symbol)??"N/A")+" "+n(((ss=(ts=(es=(xt=e.salesData)==null?void 0:xt.price_break_down)==null?void 0:es.companion_cost_details)==null?void 0:ts.cost_per_companion)==null?void 0:ss.amount)??"N/A"),1),s("div",null," Total Companion Cost: "+n(((rs=(ns=(ls=(os=(as=e.salesData)==null?void 0:as.price_break_down)==null?void 0:os.companion_cost_details)==null?void 0:ls.total_companion_cost)==null?void 0:ns.currency)==null?void 0:rs.symbol)??"N/A")+" "+n(((ms=(us=(ds=(is=e.salesData)==null?void 0:is.price_break_down)==null?void 0:ds.companion_cost_details)==null?void 0:us.total_companion_cost)==null?void 0:ms.amount)??"N/A"),1)]),s("div",null,[t[71]||(t[71]=s("strong",null,"Observer Cost:",-1)),s("div",null," Number of Observers: "+n(((fs=(cs=(ps=e.salesData)==null?void 0:ps.price_break_down)==null?void 0:cs.observer_cost_details)==null?void 0:fs.number_of_observers)??"N/A"),1),s("div",null," Cost per Observer: "+n(((bs=(vs=(hs=(gs=(ys=e.salesData)==null?void 0:ys.price_break_down)==null?void 0:gs.observer_cost_details)==null?void 0:hs.cost_per_observer)==null?void 0:vs.currency)==null?void 0:bs.symbol)??"N/A")+" "+n(((Ds=(Ss=(Cs=(Vs=e.salesData)==null?void 0:Vs.price_break_down)==null?void 0:Cs.observer_cost_details)==null?void 0:Ss.cost_per_observer)==null?void 0:Ds.amount)??"N/A"),1),s("div",null," Total Observer Cost: "+n(((As=(ks=(Ts=(_s=(ws=e.salesData)==null?void 0:ws.price_break_down)==null?void 0:_s.observer_cost_details)==null?void 0:Ts.total_observer_cost)==null?void 0:ks.currency)==null?void 0:As.symbol)??"N/A")+" "+n(((Es=(qs=(Fs=(Is=e.salesData)==null?void 0:Is.price_break_down)==null?void 0:Fs.observer_cost_details)==null?void 0:qs.total_observer_cost)==null?void 0:Es.amount)??"N/A"),1)])]),o(_,{class:"my-4"}),t[79]||(t[79]=s("h2",{class:"text-center text-lg font-bold"},"MORE INFORMATION",-1)),o(_,{class:"my-4"}),s("div",La,[s("div",ja,[o(k,{class:"font-bold"},{default:c(()=>t[72]||(t[72]=[r("Companions")])),_:1})]),o(i,{size:"small",preset:"secondary",round:"","border-color":"primary",onClick:t[2]||(t[2]=v=>e._shCMd=!e._shCMd)},{default:c(()=>t[73]||(t[73]=[r(" Add companions ")])),_:1})]),o(w,{items:e.companions},null,8,["items"]),o(_,{class:"my-4"}),t[80]||(t[80]=s("h2",{class:"text-center text-lg font-bold"},"Safari Extras",-1)),o(_,{class:"my-4 va-divider--dashed"}),s("div",za,[t[75]||(t[75]=s("div",{class:"flex flex-col md:flex-row gap-2 justify-start"},[s("p",null,[s("strong",null,"Observers")])],-1)),o(i,{size:"small",round:"",preset:"secondary","border-color":"primary",onClick:t[3]||(t[3]=v=>e._shOMd=!e._shOMd)},{default:c(()=>t[74]||(t[74]=[r(" Add observers ")])),_:1})]),o(w,{items:e.observers},null,8,["items"]),o(_,{class:"my-4"}),s("div",Ha,[t[77]||(t[77]=s("div",{class:"flex flex-col md:flex-row gap-2 justify-start"},[s("p",null,[s("strong",null,"Safari Extras services")])],-1)),o(i,{preset:"primary",class:"mr-2 mb-2","border-color":"primary",round:"",icon:"add",size:"small",onClick:t[4]||(t[4]=v=>e._showSafariExtrasModal())},{default:c(()=>t[76]||(t[76]=[r(" Add Extras ")])),_:1})]),o(w,{items:e.clientSafariExtras},null,8,["items"])]),o(N,{modelValue:e.isOpened,"onUpdate:modelValue":t[22]||(t[22]=v=>e.isOpened=v),overlay:!0,size:"large","no-outside-dismiss":"","hide-default-actions":!0,"close-button":!0},{default:c(()=>{var v,B,M,Ns;return[e.loading?(C(),q(u,{key:0,indeterminate:e.loading,class:"mb-4 mt-6"},null,8,["indeterminate"])):F("",!0),((B=(v=e.salesData)==null?void 0:v.status)==null?void 0:B.status)=="pending"?(C(),A(Z,{key:1},[s("div",Qa,[o(a,{modelValue:e.selection,"onUpdate:modelValue":t[5]||(t[5]=y=>e.selection=y),disabled:!0,"array-value":"provision_sales",label:"Signed Contract",class:"mb-6"},null,8,["modelValue"]),o(a,{modelValue:e.selection,"onUpdate:modelValue":t[6]||(t[6]=y=>e.selection=y),"array-value":"confirm",label:"Payment Document",class:"mb-6"},null,8,["modelValue"])]),s("div",Wa,[s("div",Ya,[e.selection.includes("provision_sales")?(C(),A("div",Ga,[o(D,{modelValue:e.file,"onUpdate:modelValue":t[7]||(t[7]=y=>e.file=y),dropzone:"","upload-button-text":"Upload Signed Contract","drop-zone-text":"",color:"secondary","file-types":"application/pdf","max-size":1e6,"max-files":1},null,8,["modelValue"])])):F("",!0),e.selection.includes("confirm")?(C(),A("div",Ka,[o(D,{modelValue:e.payfile,"onUpdate:modelValue":t[8]||(t[8]=y=>e.payfile=y),"upload-button-text":"Upload Payment Document",dropzone:"",color:"secondary","drop-zone-text":"","file-types":"application/pdf","max-size":1e6,"max-files":1},null,8,["modelValue"])])):F("",!0)]),s("div",Ja,[e.selection.includes("confirm")?(C(),A("div",Xa,[o(j,{modelValue:e.paymentForm.date,"onUpdate:modelValue":t[9]||(t[9]=y=>e.paymentForm.date=y),label:"Transaction Date",placeholder:"Enter Transaction Date"},null,8,["modelValue"])])):F("",!0),e.selection.includes("confirm")?(C(),A("div",Za,[o(E,{modelValue:e.paymentForm.accountType,"onUpdate:modelValue":t[10]||(t[10]=y=>e.paymentForm.accountType=y),options:e.accountsOption,label:"Account",placeholder:"Select Account"},null,8,["modelValue","options"])])):F("",!0),e.selection.includes("confirm")?(C(),A("div",xa,[o($,{modelValue:e.paymentForm.reference_number,"onUpdate:modelValue":t[11]||(t[11]=y=>e.paymentForm.reference_number=y),label:"Reference Number",type:"text",placeholder:"Enter Reference Number"},null,8,["modelValue"])])):F("",!0),s("div",eo,[o($,{modelValue:e.paymentForm.amount,"onUpdate:modelValue":t[12]||(t[12]=y=>e.paymentForm.amount=y),label:"Amount",type:"text",placeholder:"Enter Amount"},null,8,["modelValue"])]),s("div",to,[o(E,{modelValue:e.paymentForm.currency_id,"onUpdate:modelValue":t[13]||(t[13]=y=>e.paymentForm.currency_id=y),options:e.currencyOptions,label:"Currency",placeholder:"Select Currency"},null,8,["modelValue","options"])])]),o(Y,{modelValue:e.paymentForm.narration,"onUpdate:modelValue":t[14]||(t[14]=y=>e.paymentForm.narration=y),label:"Narration",type:"text",placeholder:"Enter Narration",class:"w-full h-full"},null,8,["modelValue"])])],64)):((Ns=(M=e.salesData)==null?void 0:M.status)==null?void 0:Ns.status)=="provision_sales"?(C(),A(Z,{key:2},[o(D,{modelValue:e.payfile,"onUpdate:modelValue":t[15]||(t[15]=y=>e.payfile=y),"upload-button-text":"Upload Payment Document",dropzone:"",color:"secondary","drop-zone-text":"","file-types":"application/pdf","max-size":1e6,"max-files":1},null,8,["modelValue"]),s("div",so,[s("div",ao,[o(E,{modelValue:e.paymentForm.accountType,"onUpdate:modelValue":t[16]||(t[16]=y=>e.paymentForm.accountType=y),options:e.accountsOption,label:"Account",placeholder:"Select Account"},null,8,["modelValue","options"])]),s("div",oo,[o($,{modelValue:e.paymentForm.amount,"onUpdate:modelValue":t[17]||(t[17]=y=>e.paymentForm.amount=y),label:"Amount",type:"text",placeholder:"Enter Amount"},null,8,["modelValue"])]),s("div",lo,[o(E,{modelValue:e.paymentForm.currency_id,"onUpdate:modelValue":t[18]||(t[18]=y=>e.paymentForm.currency_id=y),options:e.currencyOptions,label:"Currency",placeholder:"Select Currency"},null,8,["modelValue","options"])]),s("div",no,[o(j,{modelValue:e.paymentForm.date,"onUpdate:modelValue":t[19]||(t[19]=y=>e.paymentForm.date=y),label:"Transaction Date",placeholder:"Enter Transaction Date"},null,8,["modelValue"])]),s("div",ro,[o($,{modelValue:e.paymentForm.reference_number,"onUpdate:modelValue":t[20]||(t[20]=y=>e.paymentForm.reference_number=y),label:"Reference Number",type:"text",placeholder:"Enter Reference Number"},null,8,["modelValue"])]),o(Y,{modelValue:e.paymentForm.narration,"onUpdate:modelValue":t[21]||(t[21]=y=>e.paymentForm.narration=y),label:"Narration",type:"text",placeholder:"Enter Narration",class:"w-full h-full"},null,8,["modelValue"])])],64)):F("",!0),s("div",null,[o(i,{disabled:e.loading,class:"mt-2",onClick:e.submit},{default:c(()=>t[81]||(t[81]=[r("Save")])),_:1},8,["disabled","onClick"])])]}),_:1},8,["modelValue"]),o(N,{modelValue:e._shCMd,"onUpdate:modelValue":t[23]||(t[23]=v=>e._shCMd=v),"close-button":!0,"hide-default-actions":!0},{default:c(()=>{var v;return[o(z,{"sales-inquiry-id":(v=e.salesData)==null?void 0:v.sales_inquiry.id},null,8,["sales-inquiry-id"])]}),_:1},8,["modelValue"]),o(N,{modelValue:e._shOMd,"onUpdate:modelValue":t[24]||(t[24]=v=>e._shOMd=v),"close-button":!0,"hide-default-actions":!0},{default:c(()=>{var v;return[o(H,{"sales-inquiry-id":(v=e.salesData)==null?void 0:v.sales_inquiry.id},null,8,["sales-inquiry-id"])]}),_:1},8,["modelValue"]),o(N,{modelValue:e._shM,"onUpdate:modelValue":t[25]||(t[25]=v=>e._shM=v),width:"60%",height:"80%","hide-default-actions":!0},{default:c(()=>[o(Q,{"table-selectable":!0,item:e.salesData.sales_inquiry},null,8,["item"])]),_:1},8,["modelValue"])])}const uo=ae(ha,[["render",io],["__scopeId","data-v-5323b135"]]),mo={components:{SalesConfirmationClientDetails:uo},data(){return{items:[],searchText:null,columns:[{key:"name",label:"Client",width:120},{key:"area",label:"Area",width:120},{key:"airport_name",label:"Airport",width:50},{key:"arrival",label:"Arrival",width:120},{key:"charter_in",label:"Charter In",width:120},{key:"charter_out",label:"Charter Out",width:80},{key:"status",label:"Status",width:120},{key:"actions",width:80}],viewDetails:!1,item:null,buttondisables:!0,downloadPdf:re}},computed:{...W(I,["results","loadingresults"])},mounted(){this.getSalesConfirmations()},methods:{...T(I,["getallSalesConfirmation"]),async getSalesConfirmations(){await this.getallSalesConfirmation()},onRowClick(e){this.item=e.selfitem,this.viewDetails=!0},gotBack(){this.viewDetails=!1,this.getSalesConfirmations()},getStatusColorForModal(e){switch(e){case"pending":return"warning";case"provision_sales":return"warning";case"confirmed":return"success";case"declined":return"danger";case"cancelled":return"danger";case"completed":return"primary";default:return"default"}},getbuttonTextBasedOnStatus(e){switch(e){case"pending":return"confirm";case"provision_sales":return"confirm";case"confirmed":return"view";case"declined":return this.buttondisables=!0,"View";case"cancelled":return"view";case"completed":return"View";default:return"default"}}}},po={class:"flex flex-col md:flex-row gap-2 mb-2 justify-between px-4 py-2"},co={class:"flex flex-col md:flex-row gap-2 justify-start"},fo={class:"flex justify-center items-center"};function yo(e,t,l,f,m,p){const i=d("VaButton"),V=d("SalesConfirmationClientDetails"),w=d("VaChip"),_=d("VaDataTable"),k=d("VaCard");return C(),q(k,null,{default:c(()=>[s("div",po,[s("div",co,[m.viewDetails?(C(),q(i,{key:0,class:"px-2 py-2",icon:"arrow_back",size:"small",onClick:t[0]||(t[0]=u=>p.gotBack())},{default:c(()=>t[1]||(t[1]=[r(" Go Back ")])),_:1})):F("",!0)])]),m.viewDetails?(C(),q(V,{key:0,"sales-data":m.item},null,8,["sales-data"])):(C(),q(_,{key:1,items:e.results,columns:m.columns,loading:e.loadingresults,onOnView:p.onRowClick},{"cell(status)":c(({value:u})=>[o(w,{color:p.getStatusColorForModal(u),size:"small"},{default:c(()=>[r(n(u),1)]),_:2},1032,["color"])]),"cell(actions)":c(({rowData:u})=>[s("div",fo,[o(i,{plain:"",color:"primary",class:"mr-2",onClick:a=>p.onRowClick(u)},{default:c(()=>[r(n(p.getbuttonTextBasedOnStatus(u.status)),1)]),_:2},1032,["onClick"]),o(i,{plain:"",icon:"download",onClick:a=>m.downloadPdf(u.selfitem.pdf)},null,8,["onClick"])])]),_:1},8,["items","columns","loading","onOnView"]))]),_:1})}const Ao=ae(mo,[["render",yo],["__scopeId","data-v-aa9bae9c"]]);export{Ao as default};
//# sourceMappingURL=SalesConfirmation-h7SAH7MO.js.map
