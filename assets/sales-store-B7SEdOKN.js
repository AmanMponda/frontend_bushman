import{j as _,k as i}from"./index-Ck95g1n5.js";import{f as u}from"./utils-BWc0LXoO.js";import{f as l}from"./format-Cn4G_mmc.js";const v=_("sales_inquiries",{state:()=>({salesInquiries:[],results:[],loadingresults:!1,priceBreakDown:null,addCompanions:!1,observers:[],showObserversModal:!1,showCompanionsModal:!1,companions:[],savingSafariExtras:!1,clientSafariExtras:[],showSafariExtrasModal:!1,showAccommodationModal:!1,accommodations:[],chartersPrices:[],showChartersPriceModal:!1,savingCharterPrices:!1,loadingCharterPrices:!1}),actions:{async getSalesInquiries(t,r){const n=r?l(new Date(r),"yyyy-MM-dd"):"",e={method:"get",maxBodyLength:1/0,url:"http://localhost:8000/api/v1.0/sales/sales-inquiries/?season_id="+t+"&preferred_date="+n,headers:{"Content-Type":"application/json"}};return await i.request(e)},async createSalesInquiry(t){const r="http://localhost:8000/api/v1.0/sales/sales-inquiries/",n=t!=null&&t.preferredDate?l(new Date(t.preferredDate),"yyyy-MM-dd"):null,s=t.startDate?l(new Date(t.startDate),"yyyy-MM-dd"):null,e=t.endDate?l(new Date(t.endDate),"yyyy-MM-dd"):null,a=JSON.stringify({categories:"Hunter",full_name:t==null?void 0:t.fullName,contacts:t==null?void 0:t.contacts,nationality:t==null?void 0:t.nationality,country:t==null?void 0:t.country,price_list_id:t==null?void 0:t.priceListId,no_of_hunters:t==null?void 0:t.noOfHunters,no_of_days:t==null?void 0:t.noOfDays,no_of_companions:t==null?void 0:t.noOfCompanions,no_of_observers:t==null?void 0:t.noOfObservers,preferred_species:t==null?void 0:t.species,area_id:t==null?void 0:t.areaId,season:t==null?void 0:t.season.value,preferred_date:n,start_date:s,end_date:e,identity_number:t==null?void 0:t.identityNumber}),o={method:"post",maxBodyLength:1/0,url:r,headers:{"Content-Type":"application/json"},data:a};return await i.request(o)},async getallSalesConfirmation(){this.loadingresults=!0;const r={method:"get",maxBodyLength:1/0,url:"http://localhost:8000/api/v1.0/sales-confirmation/sales-confirmation-vset/",headers:{"Content-Type":"application/json"}};try{const n=await i.request(r);return n.data.length>0&&n.status===200?(this.loadingresults=!1,this.results=n.data.map(s=>{var e,a,o,c,h,f,m;return{name:(a=(e=s==null?void 0:s.sales_inquiry)==null?void 0:e.entity)==null?void 0:a.full_name,area:(h=(c=(o=s==null?void 0:s.sales_inquiry)==null?void 0:o.area[0])==null?void 0:c.area)==null?void 0:h.name,airport_name:(f=s==null?void 0:s.itinerary)==null?void 0:f.airport_name,charter_in:u(s.itinerary.charter_in),charter_out:u(s.itinerary.charter_out),arrival:u(s.itinerary.arrival),status:((m=s==null?void 0:s.status)==null?void 0:m.status)??"No Status",selfitem:s}}),n):(this.loadingresults=!1,this.results=[],n)}catch(n){return console.log(n),this.loadingresults=!1,this.results=[],n}},async createSalesConfirmationFinalization(t){const r="http://localhost:8000/api/v1.0/sales-confirmation/sales-confirmation-vset/",n=JSON.stringify({sales_inquiry_id:t.salesInquiryId,package_id:t.packageId,airport_name:t.airportName,charter_in:t.charterIn,charter_out:t.charterOut,arrival:t.arrival,installments:t.installments,regulatory_package_id:t.regulatoryPackageId}),s={method:"post",maxBodyLength:1/0,url:r,headers:{"Content-Type":"application/json"},data:n};return await i.request(s)},async getSalesPriceBreakdown(t){const n={method:"get",maxBodyLength:1/0,url:"http://localhost:8000/api/v1.0/sales-confirmation/sales-price-break-down/?package_id="+t.packageId+"&sales_inquiry_id="+t.salesInquiryId,headers:{"Content-Type":"application/json"}};try{const s=await i.request(n);return this.priceBreakDown=s.data,s}catch(s){return console.log(s),s}},async updatesalesConfirmationStatus(t){const r="http://localhost:8000/api/v1.0/sales-confirmation/sales-confirmation-status-vset/",n=new FormData;n.append("doc_type_id",t.docTypeId),n.append("entity_id",t.entityId),n.append("contract_doc",t.contractDoc),n.append("payment_doc",t.paymentDoc),n.append("sales_confirmation_proposal_id",t.salesConfirmationProposalId),n.append("status_id",t.statusId),n.append("area_id",t.areaId),n.append("quota_id",t.quotaId);const s={method:"patch",maxBodyLength:1/0,url:r,headers:{"Content-Type":"multipart/form-data"},data:n};return await i.request(s)},async createSalesConfirmationProposalObservers(t){const r="http://localhost:8000/api/v1.0/sales-confirmation/sales-confirmation-proposal-observers-vset/",n={full_name:t.fullName,nationality_id:t.nationalityId,country_id:t.countryId,identity_number:t.identityNumber,sales_inquiry_id:t.salesInquiryId,contacts:t.contacts,charter_in:t.charter_in,charter_out:t.charter_out,arrival_airport:t.arrival_airport},s=JSON.stringify(n),e={method:"post",maxBodyLength:1/0,url:r,headers:{"Content-Type":"application/json"},data:s},a=await i.request(e);return a.status===201&&(this.addCompanions=!0,this.showObserversModal=!1),a},async getObservers(t){const n={method:"get",maxBodyLength:1/0,url:"http://localhost:8000/api/v1.0/sales-confirmation/sales-confirmation-proposal-observers-vset/?sales_inquiry_id="+t,headers:{"Content-Type":"application/json"}};try{const s=await i.request(n);return s.status===200&&(this.observers=s.data.map(e=>({id:e.id,full_name:e.observer.full_name,nationality:e.observer.nationality.name}))),s}catch(s){return console.log(s),s}},async createSalesConfirmationCompanion(t){const r="http://localhost:8000/api/v1.0/sales-confirmation/sales-confirmation-companion-vset/",n={full_name:t.fullName,nationality_id:t.nationalityId,country_id:t.countryId,identity_number:t.identityNumber,sales_inquiry_id:t.salesInquiryId,regulatory_package_id:t.regulatoryPackageId,contacts:t.contacts,charter_in:t.charter_in,arrival_airport:t.arrival_airport,charter_out:t.charter_out},s=JSON.stringify(n),e={method:"post",maxBodyLength:1/0,url:r,headers:{"Content-Type":"application/json"},data:s},a=await i.request(e);return a.status===201&&(this.addCompanions=!0,this.showCompanionsModal=!1),a},async getCompanions(t,r=!1){const s={method:"get",maxBodyLength:1/0,url:"http://localhost:8000/api/v1.0/sales-confirmation/sales-confirmation-companion-vset/?sales_inquiry_id="+t,headers:{"Content-Type":"application/json"}};try{const e=await i.request(s);return r===!1?(e.status===200&&(this.companions=e.data.map(a=>({id:a.id,full_name:a.companion.full_name,nationality:a.companion.nationality.name}))),e):(this.companions=e.data.map(a=>({text:a.companion.full_name,value:a.companion.id})),e)}catch(e){return console.log(e),e}},async createsafariExtras(t){this.savingSafariExtras=!0;const r="http://localhost:8000/api/v1.0/sales-confirmation/client-safari-extras-vset/",n=JSON.stringify({safary_extras:t}),s={method:"post",maxBodyLength:1/0,url:r,data:n,headers:{"Content-Type":"application/json"}},e=await i.request(s);return e.status===201?(this.showSafariExtrasModal=!1,this.savingSafariExtras=!1,e):(this.savingSafariExtras=!1,e)},async getClienSafariExtras(t){var e;const n={method:"get",maxBodyLength:1/0,url:"http://localhost:8000/api/v1.0/sales-confirmation/client-safari-extras-vset/?sales_inquiry_id="+t,headers:{"Content-Type":"application/json"}};this.clientSafariExtras=[];const s=await i.request(n);return s.status===200&&(this.clientSafariExtras=(e=s==null?void 0:s.data)==null?void 0:e.map(a=>({name:a.safari_extras.name,amount:`${a.safari_extras.currency.symbol} ${a.safari_extras.amount}`}))),s},async getAccommodation(t){const n={method:"get",maxBodyLength:1/0,url:"http://localhost:8000/api/v1.0/sales-confirmation/sales-confirmation-accommodation-vset/?sales_inquiry_id="+t,headers:{"Content-Type":"application/json"}},s=await i.request(n);return s.status===200&&(this.accommodations=s.data.map(e=>({id:e.id,name:e.entity.full_name,type_name:e.type.name,check_in:u(e.check_in),check_out:u(e.check_out)}))),s},async createAccommodation(t){const r="http://localhost:8000/api/v1.0/sales-confirmation/sales-confirmation-accommodation-vset/",n=JSON.stringify(t),s={method:"post",maxBodyLength:1/0,url:r,headers:{"Content-Type":"application/json"},data:n},e=await i.request(s);return e.status===201&&(this.showAccommodationModal=!1,this.getAccommodation(t.sales_inquiry_id)),e},async getChartersPrice(t){const n={method:"get",maxBodyLength:1/0,url:"http://localhost:8000/api/v1.0/sales-confirmation/sales-charters-price-vset/?sales_inquiry_id="+t,headers:{"Content-Type":"application/json"}},s=await i.request(n);s.status===200&&(this.chartersPrices=s.data.map(e=>{var a,o,c;return{id:e.id,name:e.charters_price_list.name,amount:`${(o=(a=e==null?void 0:e.charters_price_list)==null?void 0:a.currency)==null?void 0:o.symbol} ${(c=e==null?void 0:e.charters_price_list)==null?void 0:c.amount}`}}))},async createChartersPrice(t){const r="http://localhost:8000/api/v1.0/sales-confirmation/sales-charters-price-vset/",n=JSON.stringify(t),s={method:"post",maxBodyLength:1/0,url:r,headers:{"Content-Type":"application/json"},data:n},e=await i.request(s);return e.status===201&&(this.showChartersPriceModal=!1,this.getChartersPrice(t.sales_inquiry_id)),e}}});export{v as u};
//# sourceMappingURL=sales-store-B7SEdOKN.js.map
