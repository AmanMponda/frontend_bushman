services:
  - type: web
    name: frontend-bushman
    env: static
    # Force npm and set VITE_BASE_PATH to / for root deployment
    # Remove yarn.lock if present to prevent Yarn from being used
    buildCommand: |
      rm -f yarn.lock .yarnrc.yml .yarnrc.yaml
      npm install --legacy-peer-deps
      export VITE_BASE_PATH=/
      npm run build:ci
    staticPublishPath: ./dist
    envVars:
      - key: VITE_BASE_PATH
        value: /
      - key: NODE_VERSION
        value: 20
      - key: DISABLE_YARN
        value: "true"
    routes:
      - type: rewrite
        source: /*
        destination: /index.html

